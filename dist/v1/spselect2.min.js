!function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){(function(n,r){(function(){"use strict";function i(e){return"function"==typeof e||"object"==typeof e&&null!==e}function o(e){return"function"==typeof e}function s(e){Q=e}function a(e){J=e}function u(){return function(){n.nextTick(h)}}function l(){return function(){H(h)}}function c(){var e=0,t=new z(h),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function f(){var e=new MessageChannel;return e.port1.onmessage=h,function(){e.port2.postMessage(0)}}function p(){return function(){setTimeout(h,1)}}function h(){for(var e=0;$>e;e+=2){var t=te[e],n=te[e+1];t(n),te[e]=void 0,te[e+1]=void 0}$=0}function d(){try{var t=e,n=t("vertx");return H=n.runOnLoop||n.runOnContext,l()}catch(r){return p()}}function m(e,t){var n=this,r=n._state;if(r===oe&&!e||r===se&&!t)return this;var i=new this.constructor(v),o=n._result;if(r){var s=arguments[r-1];J(function(){C(r,i,s,o)})}else A(n,i,e,t);return i}function g(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(v);return P(n,e),n}function v(){}function y(){return new TypeError("You cannot resolve a promise with itself")}function w(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(t){return ae.error=t,ae}}function _(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function R(e,t,n){J(function(e){var r=!1,i=_(n,t,function(n){r||(r=!0,t!==n?P(e,n):U(e,n))},function(t){r||(r=!0,E(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,E(e,i))},e)}function T(e,t){t._state===oe?U(e,t._result):t._state===se?E(e,t._result):A(t,void 0,function(t){P(e,t)},function(t){E(e,t)})}function S(e,t,n){t.constructor===e.constructor&&n===ne&&constructor.resolve===re?T(e,t):n===ae?E(e,ae.error):void 0===n?U(e,t):o(n)?R(e,t,n):U(e,t)}function P(e,t){e===t?E(e,y()):i(t)?S(e,t,b(t)):U(e,t)}function j(e){e._onerror&&e._onerror(e._result),D(e)}function U(e,t){e._state===ie&&(e._result=t,e._state=oe,0!==e._subscribers.length&&J(D,e))}function E(e,t){e._state===ie&&(e._state=se,e._result=t,J(j,e))}function A(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+oe]=n,i[o+se]=r,0===o&&e._state&&J(D,e)}function D(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,i,o=e._result,s=0;s<t.length;s+=3)r=t[s],i=t[s+n],r?C(n,r,i,o):i(o);e._subscribers.length=0}}function I(){this.error=null}function O(e,t){try{return e(t)}catch(n){return ue.error=n,ue}}function C(e,t,n,r){var i,s,a,u,l=o(n);if(l){if(i=O(n,r),i===ue?(u=!0,s=i.error,i=null):a=!0,t===i)return void E(t,w())}else i=r,a=!0;t._state!==ie||(l&&a?P(t,i):u?E(t,s):e===oe?U(t,i):e===se&&E(t,i))}function x(e,t){try{t(function(t){P(e,t)},function(t){E(e,t)})}catch(n){E(e,n)}}function q(e){return new de(this,e).promise}function F(e){function t(e){P(i,e)}function n(e){E(i,e)}var r=this,i=new r(v);if(!X(e))return E(i,new TypeError("You must pass an array to race.")),i;for(var o=e.length,s=0;i._state===ie&&o>s;s++)A(r.resolve(e[s]),void 0,t,n);return i}function L(e){var t=this,n=new t(v);return E(n,e),n}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function V(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function N(e){this._id=pe++,this._state=void 0,this._result=void 0,this._subscribers=[],v!==e&&("function"!=typeof e&&M(),this instanceof N?x(this,e):V())}function k(e,t){this._instanceConstructor=e,this.promise=new e(v),Array.isArray(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?U(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&U(this.promise,this._result))):E(this.promise,this._validationError())}function G(){var e;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;n&&"[object Promise]"===Object.prototype.toString.call(n.resolve())&&!n.cast||(e.Promise=he)}var B;B=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var H,Q,W,X=B,$=0,J=function(e,t){te[$]=e,te[$+1]=t,$+=2,2===$&&(Q?Q(h):W())},Y="undefined"!=typeof window?window:void 0,K=Y||{},z=K.MutationObserver||K.WebKitMutationObserver,Z="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),ee="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,te=new Array(1e3);W=Z?u():z?c():ee?f():void 0===Y&&"function"==typeof e?d():p();var ne=m,re=g,ie=void 0,oe=1,se=2,ae=new I,ue=new I,le=q,ce=F,fe=L,pe=0,he=N;N.all=le,N.race=ce,N.resolve=re,N.reject=fe,N._setScheduler=s,N._setAsap=a,N._asap=J,N.prototype={constructor:N,then:ne,"catch":function(e){return this.then(null,e)}};var de=k;k.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},k.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ie&&e>n;n++)this._eachEntry(t[n],n)},k.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===re){var i=b(e);if(i===ne&&e._state!==ie)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===he){var o=new n(v);S(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){t(e)}),t)}else this._willSettleAt(r(e),t)},k.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===ie&&(this._remaining--,e===se?E(r,n):this._result[t]=n),0===this._remaining&&U(r,this._result)},k.prototype._willSettleAt=function(e,t){var n=this;A(e,void 0,function(e){n._settledAt(oe,t,e)},function(e){n._settledAt(se,t,e)})};var me=G,ge={Promise:he,polyfill:me};"function"==typeof define&&define.amd?define(function(){return ge}):"undefined"!=typeof t&&t.exports?t.exports=ge:"undefined"!=typeof this&&(this.ES6Promise=ge),me()}).call(this)}).call(this,e("e/U+97"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"e/U+97":3}],2:[function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(e,t){for(var n,s,a=r(e),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var l in n)i.call(n,l)&&(a[l]=n[l]);if(Object.getOwnPropertySymbols){s=Object.getOwnPropertySymbols(n);for(var c=0;c<s.length;c++)o.call(n,s[c])&&(a[s[c]]=n[s[c]])}}return a}},{}],3:[function(e,t,n){function r(){}var i=t.exports={};i.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t,n){var r=e("es6-promise").Promise;!function(){function e(e,t){if(s(t))if(a(e)){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;++n)t(e[n],n)}else if(o(e))for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)}function n(){for(var t={},n=0;n<arguments.length;++n)e(arguments[n],function(e,n){t[n]=e});return t}function i(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function o(e){return"[object Object]"===Object.prototype.toString.call(e)}function s(e){return"function"==typeof e}function a(e){return Array.isArray?Array.isArray(e):e instanceof Array}function u(e){return i(e)&&/^GET|POST|PUT|HEAD|DELETE|PATCH$/.test(e.toUpperCase())}function l(t){function n(t,i){null===t||void 0===t||s(t)?r.push(encodeURIComponent(i)+"="):o(t)?e(t,function(e,t){n(e,i+"["+t+"]")}):a(t)?e(t,function(e){n(e,i+"[]")}):r.push(encodeURIComponent(i)+"="+encodeURIComponent(t))}var r=[];return e(t,n),r.join("&")}function c(){return"undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:"undefined"!=typeof ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null}function f(){function t(t,n){T.onreadystatechange=function(){if(4===T.readyState&&!w){b=!0;var r=T.response;T.body=T.response,y.origin&&(r=T),T.status<400&&T.status>=100?(s(y.success)&&y.success(r),s(a)&&a(null,r),s(t)&&t(r)):(f=new Error("Request Error, Response Code: "+T.status),f.code=T.status,T.error=f,e(d,function(e){s(e)&&e(f,T)}),s(y.error)&&y.error(f),s(a)&&a(f,r),s(n)&&n(f)),s(y.complete)&&y.complete(r)}},s(y.before)&&y.before(),y.timeout&&setTimeout(function(){b||(w=!0,f=new Error("Request Timeout, Response Code: 408"),f.code=408,T.error=f,e(d,function(e){s(e)&&e(f,T)}),s(y.error)&&y.error(f),s(a)&&a(f,T),s(n)&&n(f),s(y.complete)&&y.complete(T))},y.timeout),T.send(v)}for(var a,f,p="",m="",g="GET",v=null,y={},w=!1,b=!1,_=0;_<arguments.length;++_){var R=arguments[_];i(R)?p=R:o(R)?y=R:s(R)&&(a=R)}if(y=n(h,y),i(y.url)&&(p=y.url),u(y.method)&&(g=y.method.toUpperCase()),"POST"===g||"PUT"===g||"DELETE"===g)switch(y.format){case"json":y.headers["Content-Type"]="application/json;charset=UTF-8",v=JSON.stringify(y.data);break;case"formdata":if("undefined"!=typeof FormData){y.headers["Content-Type"]="multipart/form-data",y.data instanceof FormData?v=y.data:(v=new FormData,e(y.data,function(e,t){v.append(t,e)}));break}case"form":default:y.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",m=l(y.data),m&&(v=m)}else m=l(y.data),m&&(p+=(p.indexOf("?")>=0?"&":"?")+m);var T=c();return null!==T?(T.open(g,p,y.async),e(y.headers,function(e,t){T.setRequestHeader(t,e)}),y.type&&(T.responseType=y.type),"undefined"!=typeof r?new r(t):void t()):(f=new Error("Your broswer don't support ajax!"),s(y.error)&&y.error(f),s(a)&&a(f),"undefined"!=typeof r?r.reject(f):void 0)}function p(){return f.apply(this,arguments)}var h={url:"",method:"GET",async:!0,data:{},origin:!1,type:"json",headers:{}},d=[];p.get=function(e,t,n){return f.call(this,{url:e,method:"GET",data:t},n)},p.post=function(e,t,n){return f.call(this,{url:e,method:"POST",data:t},n)},p.setDefault=function(e){return h=n(h,e),p},p.setErrorInterceptor=function(e){return d.push(e),p},"undefined"!=typeof t&&t.exports?t.exports=p:"function"==typeof define&&define.amd?define("ajax",[],function(){return p}):window.ajax=p}()},{"es6-promise":1}],5:[function(e,t,n){var r=e("object-assign"),i=e("./list"),o=e("./web"),s=e("./profiles"),a=e("./search"),u=e("./filesystem"),l=e("./utils"),c=u.Folder,f=function(){var e=this;e.web=new o(e),e.search=new a(e),e.profiles=new s(e)};f.prototype.executeRequest=function(){throw"Not implemented exception"},f.prototype.get=function(e,t,n){var i={method:"GET"};return t&&(i=r({},i,t)),this.executeRequest(e,i)},f.prototype.lists=function(e){return e?new i(e,this):this.get("/web/lists").then(l.validateODataV2)},f.prototype.post=function(e,t,n){var i=JSON.stringify(t),o={method:"POST",data:i,contentType:"application/json;odata=verbose"};return o=r({},o,n),this.executeRequest(e,o)},f.prototype.getFolder=function(e){"/"===e.charAt(0)&&(e=e.substr(1));var t="/web/GetFolderByServerRelativeUrl('"+e+"')?$expand=Folders,Files";return this.get(t).then(l.validateODataV2).then(function(e){var t=new c(e);return t.populateChildren(e),t})},f.prototype.uploadFile=function(e,t,n){var r="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(r,n,i)},t.exports=f},{"./filesystem":7,"./list":8,"./profiles":11,"./search":14,"./utils":15,"./web":16,"object-assign":2}],6:[function(e,t,n){(function(n){n.SPSelect2=e("../plugins/SPSelect2/spselect2"),t.exports=n.SPSelect2}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../plugins/SPSelect2/spselect2":10}],7:[function(e,t,n){var r=(e("./utils"),function(e){var t=this;t.mapProperties(e)});r.prototype.populateChildren=function(e){this.folders=e.Folders.results.map(function(e){return new r(e)}),this.files=e.Files.results.map(function(e){return new i(e)})},r.prototype.mapProperties=function(e){this.name=e.Name,this.serverRelativeUrl=e.ServerRelativeUrl,this.itemCount=e.ItemCount,this.guid=e.UniqueId,this.uri=e.__metadata.uri};var i=function(e){this.mapProperties(e)};i.prototype.mapProperties=function(e){this.name=e.Name,this.title=e.Title,this.checkoutType=e.CheckOutType,this.byteLength=e.Length,this.majorVersion=e.MajorVersion,this.minorVersion=e.MinorVersion,this.serverRelativeUrl=e.ServerRelativeUrl,this.uri=e.__metadata.uri},t.exports={File:i,Folder:r}},{"./utils":15}],8:[function(e,t,n){var r=e("./utils"),i=e("./permissions"),o=e("object-assign"),s=function(e,t){this.listname=e,this.baseUrl="/web/lists/getbytitle('"+e+"')",this._dao=t,this.permissions=new i(this.baseUrl,this._dao)};s.prototype.getItems=function(e){var t=null!=e?"?"+e:"";return this._dao.get(this.baseUrl+"/items"+t).then(r.validateODataV2)},s.prototype.getItemById=function(e,t){var n=this.baseUrl+"/items("+e+")";return n+=null!=t?"?"+t:"",this._dao.get(n).then(r.validateODataV2)},s.prototype.info=function(){return this._dao.get(this.baseUrl).then(r.validateODataV2)},s.prototype.addItem=function(e){var t=this;return t._dao.get(t.baseUrl).then(function(n){e=o({},{__metadata:{type:n.d.ListItemEntityTypeFullName}},e);var i={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest()}};return t._dao.post(baseUrl+"/items",e,i).then(r.validateODataV2)})},s.prototype.updateItem=function(e,t){var n=this;return n.getItemById(e).then(function(e){t=o({},{__metadata:{type:e.__metadata.type}},t);var i={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return n._dao.post(e.__metadata.uri,t,i)})},s.prototype.deleteItem=function(e){var t=this;return t.getItemById(e).then(function(e){var n={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest(),"X-HTTP-Method":"DELETE","If-Match":e.__metadata.etag}};return t._dao.post(e.__metadata.uri,"",n)})},s.prototype.findItems=function(e,t,n){var r="string"==typeof t?"'"+t+"'":t,i="$filter="+e+" eq "+r;return i+=null!=n?"&"+n:"",this.getItems(i)},s.prototype.findItem=function(e,t,n){return this.findItems(e,t,n).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},t.exports=s},{"./permissions":9,"./utils":15,"object-assign":2}],9:[function(e,t,n){var r=e("./utils"),i=function(e,t){this._dao=t,this.baseUrl=e};i.prototype.getRoleAssignments=function(){var e=baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return dao.get(e).then(r.validateODataV2).then(function(e){return e.map(o.roleAssignment)})},i.prototype.check=function(e){var t=this,n=function(e){var n=encodeURIComponent(e.LoginName),i=t.baseUrl+"/getusereffectivepermissions(@v)?@v='"+n+"'";return t._dao.get(i).then(r.validateODataV2)},i=e?t._dao.web.getUser(e):t._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(e){return e.d});return i.then(n).then(function(e){return s(e.GetUserEffectivePermissions.Low,e.GetUserEffectivePermissions.High)})};var o={roleAssignment:function(e){var t={member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id}};return t.roles=e.RoleDefinitionBindings.results.map(function(e){return{name:e.Name,description:e.Description,basePermissions:s(e.BasePermissions.Low,e.BasePermissions.High)}}),t}},s=function(e,t){var n=[];return a.forEach(function(r){((r.low&e)>0||(r.high&t)>0)&&n.push(r.name)}),n},a=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}];t.exports=i},{"./utils":15}],10:[function(e,t,n){var r=e("../../restDao"),i=function(e,t){var n=document.getElementsByTagName("head")[0];if(!window.jQuery){var i=document.createElement("script");i.setAttribute("src","//code.jquery.com/jquery-2.1.4.min.js"),i.setAttribute("type","text/javascript"),n.appendChild(i)}var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href","//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css"),n.appendChild(o);var s=function(e){var t={};t.Templates={Fields:{}},t.Templates.Fields[e]={EditForm:a,NewForm:a},SPClientTemplates.TemplateManager.RegisterTemplateOverrides(t)},a=function(e){var n=SPClientTemplates.Utility.GetFormContextForCurrentField(e);console.log(n);var i=n.webAttributes.WebUrl,o=new r(i),s="LookupMulti"===n.fieldSchema.FieldType?"multiple='multple'":"",a="<select id='"+n.fieldName+"' "+s+"class='ms-long' name='"+n.fieldName+"'><option value=''></option></select>",u="[name='"+n.fieldName+"']";return n.registerGetValueCallback(n.fieldName,function(){var e=$(u).val();return"LookupMulti"===n.fieldSchema.FieldType&&(e=e.join(";#")),e}),$(document).ready(function(){$.getScript("//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js").then(function(){$(u).select2({minimumInputLength:1,placeholder:"Begin typing...",ajax:{delay:150,url:"",data:function(e){return{q:e.term}},processResults:function(e){var t=e.map(function(e){return{id:e.Id+";#"+e.Title,text:e.Title}});return{results:t}},cache:!0,transport:function(e,n,r){var i=e.data.q||"",s="$top=10&$select=Title, Id&$filter=substringof('"+i+"', Title)";o.lists(t).getItems(s).then(function(e){n(e)},r)}}})})}),a};s(e)};n.init=i},{"../../restDao":13}],11:[function(e,t,n){var r=e("./utils"),i=function(e){this._dao=e,this.baseUrl="/SP.UserProfiles.PeopleManager"},o=function(e){return e.UserProfileProperties.results.forEach(function(t){e[t.Key]=t.Value}),e};i.prototype.current=function(){var e=this.baseUrl+"/GetMyProperties";return this._dao.get(e).then(r.validateODataV2).then(o)},i.prototype.setProperty=function(e,t,n){var i=this,o=this.baseUrl+"/SetSingleValueProfileProperty",s={propertyName:t,propertyValue:n},a={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest()}};return"string"==typeof e?i.getByEmail(e).then(function(e){return s.accountName=e.AccountName,i._dao.post(o,s,a)}):(s.accountName=e.LoginName||e.AccountName,i._dao.post(o,s,a))},i.prototype.getProfile=function(e){var t=encodeURIComponent(e.LoginName),n=this.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+t+"'";return this._dao.get(n).then(r.validateODataV2).then(o)},i.prototype.getByEmail=function(e){var t=this;return t._dao.web.getUser(e).then(function(e){return t.getProfile(e)})},t.exports=i},{"./utils":15}],12:[function(e,t,n){var r={_queryString:{},_processed:!1,_processQueryString:function(e){if(e||window.location.search)for(var t,n=e||window.location.search.substring(1),r=n.split("&"),i=0;i<r.length;i++)t=r[i].split("="),this._queryString[t[0]]=decodeURIComponent(t[1].replace(/\+/g," "));this._processed=!0},contains:function(e,t){return this._processed||this._processQueryString(t),this._queryString.hasOwnProperty(e)},getValue:function(e,t){return this._processed||this._processQueryString(t),this.contains(e)?this._queryString[e]:""},getAll:function(e){return this._processed||this._processQueryString(e),this._queryString},objectToQueryString:function(e,t){var n=[];for(var r in e)value=e[r],null!==value&&(t?n.push(encodeURIComponent(r)+"='"+encodeURIComponent(value)+"'"):n.push(encodeURIComponent(r)+"="+encodeURIComponent(value)));return n.join("&")}};t.exports=r},{}],13:[function(e,t,n){var r=e("./baseDao"),i=e("object-assign"),o=e("./ajax"),s=function(e){r.call(this),this.webUrl=e||_spPageContextInfo.webAbsoluteUrl};s.prototype=new r,s.prototype.executeRequest=function(e,t){var n=/^http/i.test(e)?e:this.webUrl+"/_api"+e,r={url:n,method:"GET",headers:{Accept:"application/json; odata=verbose"}};return r=i({},r,t),o(r)},t.exports=s},{"./ajax":4,"./baseDao":5,"object-assign":2}],14:[function(e,t,n){var r=e("./queryString"),i=e("./utils"),o=function(e){this._dao=e};o.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var s=function(e){for(var t=[],n=0;n<e.length;n++){for(var r=e[n],i={},o=0;o<r.Cells.results.length;o++)i[r.Cells.results[o].Key]=r.Cells.results[o].Value;t.push(i)}return t},a=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=s(e.PrimaryQueryResult.RelevantResults.Table.Rows.results),this.refiners=e.PrimaryQueryResult.RefinementResults?u(e.PrimaryQueryResult.RefinementResults.Refiners.results):null},u=function(e){for(var t=[],n=0;n<e.length;n++){var r={};r.RefinerName=e[n].Name,r.RefinerOptions=e[n].Entries.results,t.push(r)}return t};o.prototype.query=function(e,t){var n=this,o=null!=t?"&"+r.objectToQueryString(t,!0):"",s="/search/query?querytext='"+e+"'"+o;return n._dao.get(s).then(i.validateODataV2).then(function(e){if(e.query)return new a(e.query);throw new Error("Invalid response back from search service")})},o.prototype.people=function(e,t){var n=t||{};return n.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(e,n)},t.exports=o},{"./queryString":12,"./utils":15}],15:[function(e,t,n){var r=(n.getRequestDigest=function(){return document.querySelector("#__REQUESTDIGEST").value},n.acceptHeader="application/json;odata=verbose",n.validateODataV2=function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e;return e.d&&e.d.results&&null!=e.d.results.length?t=e.d.results:e.d&&(t=e.d),t},n.validateCrossDomainODataV2=function(e){var t=$.parseJSON(e.body);helpers.validateODataV2(t)},n.arrayFromBitMask=function(e){"string"==typeof e&&(e=parseInt(e));for(var t=e,n=[];t;n.push(Boolean(1&t)),t>>>=1);return n},n.waitForLibraries=function(e,t){var n=e.filter(function(e){return!i(e)});0===n.length?t():setTimeout(function(){r(e,t)},25)}),i=(n.waitForLibrary=function(e,t){return r([e],t)},n.validateNamespace=function(e){for(var t=window,n=e.split("."),r=n.length,i=0;r>i;i++){var o=n[i];if(!(o in t))return!1;t=t[o]}return!0})},{}],16:[function(e,t,n){var r=e("./utils"),i=e("./permissions"),o=e("object-assign"),s=function(e){this._dao=e,this.baseUrl="/web",this.permissions=new i(this.baseUrl,this._dao)};s.prototype.info=function(){return this._dao.get(this.baseUrl).then(r.validateODataV2)},s.prototype.subsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(r.validateODataV2)},s.prototype.getRequestDigest=function(){var e="/contextinfo",t={headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"}};return this._dao.post(e,{},t).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},s.prototype.copyFile=function(e,t,n){var r=this;return n?r._copyFileWithDigest(e,t,n):void r.getRequestDigest().then(function(n){return r._copyFileWithDigest(e,t,n)})},s.prototype.deleteFile=function(e,t){var n=this;return t?n._deleteFileWithDigest(e,t):void n.getRequestDigest().then(function(t){return n._deleteFileWithDigest(e,t)})};var a={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"};s.prototype._deleteFileWithDigest=function(e,t){var n="/web/getfilebyserverrelativeurl(@url)/?@Url='"+e+"'",r={headers:o({},a,{"X-HTTP-Method":"DELETE","X-RequestDigest":t})};return this._dao.post(n,{},r)},s.prototype._copyFileWithDigest=function(e,t,n){var r="/web/getfilebyserverrelativeurl(@url)/CopyTo?@Url='"+e+"'&strNewUrl='"+t+"'&bOverWrite='true'",i={headers:o({},a,{"X-RequestDigest":n})};return this._dao.post(r,{},i)},s.prototype.getUser=function(e){var t=baseUrl+"/SiteUsers/GetByEmail('"+e+"')";return this._dao.get(t).then(r.validateODataV2)},t.exports=s},{"./permissions":9,"./utils":15,"object-assign":2}]},{},[6]);