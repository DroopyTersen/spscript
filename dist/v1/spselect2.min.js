!function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){!function(){function e(e,t){if(o(t))if(s(e)){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;++n)t(e[n],n)}else if(i(e))for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)}function n(){for(var t={},n=0;n<arguments.length;++n)e(arguments[n],function(e,n){t[n]=e});return t}function r(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function i(e){return"[object Object]"===Object.prototype.toString.call(e)}function o(e){return"function"==typeof e}function s(e){return Array.isArray?Array.isArray(e):e instanceof Array}function a(e){return r(e)&&/^GET|POST|PUT|HEAD|DELETE|PATCH$/.test(e.toUpperCase())}function u(t){function n(t,a){null===t||void 0===t||o(t)?r.push(encodeURIComponent(a)+"="):i(t)?e(t,function(e,t){n(e,a+"["+t+"]")}):s(t)?e(t,function(e){n(e,a+"[]")}):r.push(encodeURIComponent(a)+"="+encodeURIComponent(t))}var r=[];return e(t,n),r.join("&")}function l(){return"undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:"undefined"!=typeof ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null}function c(){function t(t,n){_.onreadystatechange=function(){if(4===_.readyState&&!v){w=!0;var r=_.response;_.body=_.response,y.origin&&(r=_),_.status<400&&_.status>=100?(o(y.success)&&y.success(r),o(s)&&s(null,r),o(t)&&t(r)):(c=new Error("Request Error, Response Code: "+_.status),c.code=_.status,_.error=c,e(f,function(e){o(e)&&e(c,_)}),o(y.error)&&y.error(c),o(s)&&s(c,r),o(n)&&n(c)),o(y.complete)&&y.complete(r)}},o(y.before)&&y.before(),y.timeout&&setTimeout(function(){w||(v=!0,c=new Error("Request Timeout, Response Code: 408"),c.code=408,_.error=c,e(f,function(e){o(e)&&e(c,_)}),o(y.error)&&y.error(c),o(s)&&s(c,_),o(n)&&n(c),o(y.complete)&&y.complete(_))},y.timeout),_.send(g)}for(var s,c,p="",d="",m="GET",g=null,y={},v=!1,w=!1,b=0;b<arguments.length;++b){var R=arguments[b];r(R)?p=R:i(R)?y=R:o(R)&&(s=R)}if(y=n(h,y),r(y.url)&&(p=y.url),a(y.method)&&(m=y.method.toUpperCase()),p=p.replace(/:([^\/]+)|\{([^\/]+)\}/g,function(e,t){return y[t]?y[t]:t}),"POST"===m||"PUT"===m||"DELETE"===m)switch(y.format){case"json":y.headers["Content-Type"]="application/json;charset=UTF-8",g=JSON.stringify(y.data);break;case"formdata":if("undefined"!=typeof FormData){y.headers["Content-Type"]="multipart/form-data",y.data instanceof FormData?g=y.data:(g=new FormData,e(y.data,function(e,t){g.append(t,e)}));break}case"form":default:y.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",d=u(y.data),d&&(g=d)}else d=u(y.data),d&&(p+=(p.indexOf("?")>=0?"&":"?")+d);var _=l();return null!==_?(_.open(m,p,y.async),e(y.headers,function(e,t){_.setRequestHeader(t,e)}),y.type&&(_.responseType=y.type),"undefined"!=typeof Promise?new Promise(t):void t()):(c=new Error("Your broswer don't support ajax!"),o(y.error)&&y.error(c),o(s)&&s(c),"undefined"!=typeof Promise?Promise.reject(c):void 0)}function p(){return c.apply(this,arguments)}var h={url:"",method:"GET",async:!0,data:{},origin:!1,type:"json",headers:{}},f=[];p.get=function(e,t,n){return c.call(this,{url:e,method:"GET",data:t},n)},p.post=function(e,t,n){return c.call(this,{url:e,method:"POST",data:t},n)},p.setDefault=function(e){return h=n(h,e),p},p.setErrorInterceptor=function(e){return f.push(e),p},"undefined"!=typeof t&&t.exports?t.exports=p:"function"==typeof define&&define.amd?define("ajax",[],function(){return p}):window.ajax=p}()},{}],2:[function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(e,t){for(var n,s,a=r(e),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var l in n)i.call(n,l)&&(a[l]=n[l]);if(Object.getOwnPropertySymbols){s=Object.getOwnPropertySymbols(n);for(var c=0;c<s.length;c++)o.call(n,s[c])&&(a[s[c]]=n[s[c]])}}return a}},{}],3:[function(e,t,n){var r=e("object-assign"),i=e("./list"),o=e("./web"),s=e("./profiles"),a=e("./search"),u=e("./filesystem"),l=e("./utils"),c=u.Folder,p=function(){var e=this;e.web=new o(e),e.search=new a(e),e.profiles=new s(e)};p.prototype.executeRequest=function(){throw"Not implemented exception"},p.prototype.get=function(e,t,n){var i={method:"GET"};return t&&(i=r({},i,t)),this.executeRequest(e,i)},p.prototype.lists=function(e){return e?new i(e,this):this.get("/web/lists").then(l.validateODataV2)},p.prototype.post=function(e,t,n){var i=JSON.stringify(t),o={method:"POST",data:i,contentType:"application/json;odata=verbose"};return o=r({},o,n),this.executeRequest(e,o)},p.prototype.getFolder=function(e){"/"===e.charAt(0)&&(e=e.substr(1));var t="/web/GetFolderByServerRelativeUrl('"+e+"')?$expand=Folders,Files";return this.get(t).then(l.validateODataV2).then(function(e){var t=new c(e);return t.populateChildren(e),t})},p.prototype.uploadFile=function(e,t,n){var r="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(r,n,i)},t.exports=p},{"./filesystem":5,"./list":6,"./profiles":9,"./search":12,"./utils":13,"./web":14,"object-assign":2}],4:[function(e,t,n){(function(n){n.SPSelect2=e("../plugins/SPSelect2/spselect2"),t.exports=n.SPSelect2}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../plugins/SPSelect2/spselect2":8}],5:[function(e,t,n){var r=(e("./utils"),function(e){var t=this;t.mapProperties(e)});r.prototype.populateChildren=function(e){this.folders=e.Folders.results.map(function(e){return new r(e)}),this.files=e.Files.results.map(function(e){return new i(e)})},r.prototype.mapProperties=function(e){this.name=e.Name,this.serverRelativeUrl=e.ServerRelativeUrl,this.itemCount=e.ItemCount,this.guid=e.UniqueId,this.uri=e.__metadata.uri};var i=function(e){this.mapProperties(e)};i.prototype.mapProperties=function(e){this.name=e.Name,this.title=e.Title,this.checkoutType=e.CheckOutType,this.byteLength=e.Length,this.majorVersion=e.MajorVersion,this.minorVersion=e.MinorVersion,this.serverRelativeUrl=e.ServerRelativeUrl,this.uri=e.__metadata.uri},t.exports={File:i,Folder:r}},{"./utils":13}],6:[function(e,t,n){var r=e("./utils"),i=e("./permissions"),o=e("object-assign"),s=function(e,t){this.listname=e,this.baseUrl="/web/lists/getbytitle('"+e+"')",this._dao=t,this.permissions=new i(this.baseUrl,this._dao)};s.prototype.getItems=function(e){var t=null!=e?"?"+e:"";return this._dao.get(this.baseUrl+"/items"+t).then(r.validateODataV2)},s.prototype.getItemById=function(e,t){var n=this.baseUrl+"/items("+e+")";return n+=null!=t?"?"+t:"",this._dao.get(n).then(r.validateODataV2)},s.prototype.info=function(){return this._dao.get(this.baseUrl).then(r.validateODataV2)},s.prototype.addItem=function(e){var t=this;return t._dao.get(t.baseUrl).then(function(n){e=o({},{__metadata:{type:n.d.ListItemEntityTypeFullName}},e);var i={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest()}};return t._dao.post(baseUrl+"/items",e,i).then(r.validateODataV2)})},s.prototype.updateItem=function(e,t){var n=this;return n.getItemById(e).then(function(e){t=o({},{__metadata:{type:e.__metadata.type}},t);var i={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return n._dao.post(e.__metadata.uri,t,i)})},s.prototype.deleteItem=function(e){var t=this;return t.getItemById(e).then(function(e){var n={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest(),"X-HTTP-Method":"DELETE","If-Match":e.__metadata.etag}};return t._dao.post(e.__metadata.uri,"",n)})},s.prototype.findItems=function(e,t,n){var r="string"==typeof t?"'"+t+"'":t,i="$filter="+e+" eq "+r;return i+=null!=n?"&"+n:"",this.getItems(i)},s.prototype.findItem=function(e,t,n){return this.findItems(e,t,n).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},t.exports=s},{"./permissions":7,"./utils":13,"object-assign":2}],7:[function(e,t,n){var r=e("./utils"),i=function(e,t){this._dao=t,this.baseUrl=e};i.prototype.getRoleAssignments=function(){var e=baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return dao.get(e).then(r.validateODataV2).then(function(e){return e.map(o.roleAssignment)})},i.prototype.check=function(e){var t=this,n=function(e){var n=encodeURIComponent(e.LoginName),i=t.baseUrl+"/getusereffectivepermissions(@v)?@v='"+n+"'";return t._dao.get(i).then(r.validateODataV2)},i=e?t._dao.web.getUser(e):t._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(e){return e.d});return i.then(n).then(function(e){return s(e.GetUserEffectivePermissions.Low,e.GetUserEffectivePermissions.High)})};var o={roleAssignment:function(e){var t={member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id}};return t.roles=e.RoleDefinitionBindings.results.map(function(e){return{name:e.Name,description:e.Description,basePermissions:s(e.BasePermissions.Low,e.BasePermissions.High)}}),t}},s=function(e,t){var n=[];return a.forEach(function(r){((r.low&e)>0||(r.high&t)>0)&&n.push(r.name)}),n},a=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}];t.exports=i},{"./utils":13}],8:[function(e,t,n){var r=e("../../restDao"),i=function(e,t){var n=document.getElementsByTagName("head")[0];if(!window.jQuery){var i=document.createElement("script");i.setAttribute("src","//code.jquery.com/jquery-2.1.4.min.js"),i.setAttribute("type","text/javascript"),n.appendChild(i)}var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href","//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css"),n.appendChild(o);var s=function(e){var t={};t.Templates={Fields:{}},t.Templates.Fields[e]={EditForm:a,NewForm:a},SPClientTemplates.TemplateManager.RegisterTemplateOverrides(t)},a=function(e){var n=SPClientTemplates.Utility.GetFormContextForCurrentField(e);console.log(n);var i=n.webAttributes.WebUrl,o=new r(i),s="LookupMulti"===n.fieldSchema.FieldType?"multiple='multple'":"",a="<select id='"+n.fieldName+"' "+s+"class='ms-long' name='"+n.fieldName+"'><option value=''></option></select>",u="[name='"+n.fieldName+"']";return n.registerGetValueCallback(n.fieldName,function(){var e=$(u).val();return"LookupMulti"===n.fieldSchema.FieldType&&(e=e.join(";#")),e}),$(document).ready(function(){$.getScript("//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js").then(function(){$(u).select2({minimumInputLength:1,placeholder:"Begin typing...",ajax:{delay:150,url:"",data:function(e){return{q:e.term}},processResults:function(e){var t=e.map(function(e){return{id:e.Id+";#"+e.Title,text:e.Title}});return{results:t}},cache:!0,transport:function(e,n,r){var i=e.data.q||"",s="$top=10&$select=Title, Id&$filter=substringof('"+i+"', Title)";o.lists(t).getItems(s).then(function(e){n(e)},r)}}})})}),a};s(e)};n.init=i},{"../../restDao":11}],9:[function(e,t,n){var r=e("./utils"),i=function(e){this._dao=e,this.baseUrl="/SP.UserProfiles.PeopleManager"},o=function(e){return e.UserProfileProperties.results.forEach(function(t){e[t.Key]=t.Value}),e};i.prototype.current=function(){var e=this.baseUrl+"/GetMyProperties";return this._dao.get(e).then(r.validateODataV2).then(o)},i.prototype.setProperty=function(e,t,n){var i=this,o=this.baseUrl+"/SetSingleValueProfileProperty",s={propertyName:t,propertyValue:n},a={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest()}};return"string"==typeof e?i.getByEmail(e).then(function(e){return s.accountName=e.AccountName,i._dao.post(o,s,a)}):(s.accountName=e.LoginName||e.AccountName,i._dao.post(o,s,a))},i.prototype.getProfile=function(e){var t=encodeURIComponent(e.LoginName),n=this.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+t+"'";return this._dao.get(n).then(r.validateODataV2).then(o)},i.prototype.getByEmail=function(e){var t=this;return t._dao.web.getUser(e).then(function(e){return t.getProfile(e)})},t.exports=i},{"./utils":13}],10:[function(e,t,n){var r={_queryString:{},_processed:!1,_processQueryString:function(e){if(e||window.location.search)for(var t,n=e||window.location.search.substring(1),r=n.split("&"),i=0;i<r.length;i++)t=r[i].split("="),this._queryString[t[0]]=decodeURIComponent(t[1].replace(/\+/g," "));this._processed=!0},contains:function(e,t){return this._processed||this._processQueryString(t),this._queryString.hasOwnProperty(e)},getValue:function(e,t){return this._processed||this._processQueryString(t),this.contains(e)?this._queryString[e]:""},getAll:function(e){return this._processed||this._processQueryString(e),this._queryString},objectToQueryString:function(e,t){var n=[];for(var r in e)value=e[r],null!==value&&(t?n.push(encodeURIComponent(r)+"='"+encodeURIComponent(value)+"'"):n.push(encodeURIComponent(r)+"="+encodeURIComponent(value)));return n.join("&")}};t.exports=r},{}],11:[function(e,t,n){var r=e("./baseDao"),i=e("object-assign"),o=e("client-ajax"),s=function(e){r.call(this),this.webUrl=e||_spPageContextInfo.webAbsoluteUrl};s.prototype=new r,s.prototype.executeRequest=function(e,t){var n=/^http/i.test(e)?e:this.webUrl+"/_api"+e,r={url:n,method:"GET",headers:{Accept:"application/json; odata=verbose"}};return r=i({},r,t),o(r)},t.exports=s},{"./baseDao":3,"client-ajax":1,"object-assign":2}],12:[function(e,t,n){var r=e("./queryString"),i=function(e){this._dao=e};i.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var o=function(e){for(var t=[],n=0;n<e.length;n++){for(var r=e[n],i={},o=0;o<r.Cells.results.length;o++)i[r.Cells.results[o].Key]=r.Cells.results[o].Value;t.push(i)}return t},s=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=o(e.PrimaryQueryResult.RelevantResults.Table.Rows.results),this.refiners=e.PrimaryQueryResult.RefinementResults?a(e.PrimaryQueryResult.RefinementResults.Refiners.results):null},a=function(e){for(var t=[],n=0;n<e.length;n++){var r={};r.RefinerName=e[n].Name,r.RefinerOptions=e[n].Entries.results,t.push(r)}return t};i.prototype.query=function(e,t){var n=this,i=null!=t?"&"+r.objectToQueryString(t,!0):"",o="/search/query?querytext='"+e+"'"+i;return n._dao.get(o).then(function(e){if(e.d&&e.d.query)return new s(e.d.query);throw new Error("Invalid response back from search service")})},i.prototype.people=function(e,t){var n=t||{};return n.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(e,n)},t.exports=i},{"./queryString":10}],13:[function(e,t,n){var r=(n.getRequestDigest=function(){return document.querySelector("#__REQUESTDIGEST").value},n.acceptHeader="application/json;odata=verbose",n.validateODataV2=function(e){var t=e;return e.d&&e.d.results&&null!=e.d.results.length?t=e.d.results:e.d&&(t=e.d),t},n.validateCrossDomainODataV2=function(e){var t=$.parseJSON(e.body);helpers.validateODataV2(t)},n.arrayFromBitMask=function(e){"string"==typeof e&&(e=parseInt(e));for(var t=e,n=[];t;n.push(Boolean(1&t)),t>>>=1);return n},n.waitForLibraries=function(e,t){var n=e.filter(function(e){return!i(e)});0===n.length?t():setTimeout(function(){r(e,t)},25)}),i=(n.waitForLibrary=function(e,t){return r([e],t)},n.validateNamespace=function(e){for(var t=window,n=e.split("."),r=n.length,i=0;r>i;i++){var o=n[i];if(!(o in t))return!1;t=t[o]}return!0})},{}],14:[function(e,t,n){var r=e("./utils"),i=e("./permissions"),o=e("object-assign"),s=function(e){this._dao=e,this.baseUrl="/web",this.permissions=new i(this.baseUrl,this._dao)};s.prototype.info=function(){return this._dao.get(this.baseUrl).then(r.validateODataV2)},s.prototype.subsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(r.validateODataV2)},s.prototype.getRequestDigest=function(){var e="/contextinfo",t={headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"}};return this._dao.post(e,{},t).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},s.prototype.copyFile=function(e,t,n){var r=this;return n?r._copyFileWithDigest(e,t,n):void r.getRequestDigest().then(function(n){return r._copyFileWithDigest(e,t,n)})},s.prototype.deleteFile=function(e,t){var n=this;return t?n._deleteFileWithDigest(e,t):void n.getRequestDigest().then(function(t){return n._deleteFileWithDigest(e,t)})};var a={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"};s.prototype._deleteFileWithDigest=function(e,t){var n="/web/getfilebyserverrelativeurl(@url)/?@Url='"+e+"'",r={headers:o({},a,{"X-HTTP-Method":"DELETE","X-RequestDigest":t})};return this._dao.post(n,{},r)},s.prototype._copyFileWithDigest=function(e,t,n){var r="/web/getfilebyserverrelativeurl(@url)/CopyTo?@Url='"+e+"'&strNewUrl='"+t+"'&bOverWrite='true'",i={headers:o({},a,{"X-RequestDigest":n})};return this._dao.post(r,{},i)},s.prototype.getUser=function(e){var t=baseUrl+"/SiteUsers/GetByEmail('"+e+"')";return this._dao.get(t).then(r.validateODataV2)},t.exports=s},{"./permissions":7,"./utils":13,"object-assign":2}]},{},[4]);