!function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){var r={Placeholder:function(e){this.raw=e,this.fullProperty=e.slice(2,e.length-2)},getPlaceHolders:function(e,t){var n=t||/\{\{[^\}]+\}\}?/g,r=e.match(n);return r||[]},getObjectValue:function(e,t){for(var n=e,r=t.split("."),i=0;i<r.length;i++){var s=r[i];n=null!=n[s]?n[s]:""}if("_"===t&&(n=e),"string"==typeof n&&-1!==n.indexOf("/Date(")){var a=o(n);n=a.toLocaleDateString()}return n},populateTemplate:function(e,t,n){for(var r=this.getPlaceHolders(e,n)||[],o=e,i=0;i<r.length;i++){var s=new this.Placeholder(r[i]);s.val=this.getObjectValue(t,s.fullProperty);var a=s.raw.replace("[","\\[").replace("]","\\]"),u="g";o=o.replace(new RegExp(a,u),s.val)}return o}};r.Each={regExp:/\{\[[^\]]+\]\}?/g,populateEachTemplates:function(e,t){var n=$(e),o=n.find("[data-each]");o.each(function(){var e="",o=$(this).html(),i=$(this).data("each"),s=sp.templating.getObjectValue(t,i);if(null!=s&&$.isArray(s))for(var a=0;a<s.length;a++)e+=r.populateTemplate(o,s[a],r.Each.regExp);n.find($(this)).html(e)});var i=n.clone().wrap("<div>");return i.parent().html()}},r.renderTemplate=function(e,t,n){var o=r.populateTemplate(e,t);return n&&(o=r.Each.populateEachTemplates(o,t)),o};var o=function(e){var t=e.substring(e.indexOf("(")+1);t=t.substring(0,t.indexOf(")"));var n=new Date(parseInt(t,10)),r=n.getTimezoneOffset()/60;return n.setHours(n.getHours()+r),n};t.exports=r},{}],2:[function(e,t,n){(function(n,r){(function(){"use strict";function o(e){return"function"==typeof e||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function s(e){Q=e}function a(e){J=e}function u(){return function(){n.nextTick(h)}}function l(){return function(){k(h)}}function c(){var e=0,t=new z(h),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function f(){var e=new MessageChannel;return e.port1.onmessage=h,function(){e.port2.postMessage(0)}}function p(){return function(){setTimeout(h,1)}}function h(){for(var e=0;$>e;e+=2){var t=te[e],n=te[e+1];t(n),te[e]=void 0,te[e+1]=void 0}$=0}function d(){try{var t=e,n=t("vertx");return k=n.runOnLoop||n.runOnContext,l()}catch(r){return p()}}function m(e,t){var n=this,r=n._state;if(r===ie&&!e||r===se&&!t)return this;var o=new this.constructor(v),i=n._result;if(r){var s=arguments[r-1];J(function(){x(r,o,s,i)})}else O(n,o,e,t);return o}function g(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(v);return E(n,e),n}function v(){}function y(){return new TypeError("You cannot resolve a promise with itself")}function w(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(t){return ae.error=t,ae}}function _(e,t,n,r){try{e.call(t,n,r)}catch(o){return o}}function R(e,t,n){J(function(e){var r=!1,o=_(n,t,function(n){r||(r=!0,t!==n?E(e,n):S(e,n))},function(t){r||(r=!0,U(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,U(e,o))},e)}function P(e,t){t._state===ie?S(e,t._result):t._state===se?U(e,t._result):O(t,void 0,function(t){E(e,t)},function(t){U(e,t)})}function T(e,t,n){t.constructor===e.constructor&&n===ne&&constructor.resolve===re?P(e,t):n===ae?U(e,ae.error):void 0===n?S(e,t):i(n)?R(e,t,n):S(e,t)}function E(e,t){e===t?U(e,y()):o(t)?T(e,t,b(t)):S(e,t)}function D(e){e._onerror&&e._onerror(e._result),j(e)}function S(e,t){e._state===oe&&(e._result=t,e._state=ie,0!==e._subscribers.length&&J(j,e))}function U(e,t){e._state===oe&&(e._state=se,e._result=t,J(D,e))}function O(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+ie]=n,o[i+se]=r,0===i&&e._state&&J(j,e)}function j(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,o,i=e._result,s=0;s<t.length;s+=3)r=t[s],o=t[s+n],r?x(n,r,o,i):o(i);e._subscribers.length=0}}function A(){this.error=null}function I(e,t){try{return e(t)}catch(n){return ue.error=n,ue}}function x(e,t,n,r){var o,s,a,u,l=i(n);if(l){if(o=I(n,r),o===ue?(u=!0,s=o.error,o=null):a=!0,t===o)return void U(t,w())}else o=r,a=!0;t._state!==oe||(l&&a?E(t,o):u?U(t,s):e===ie?S(t,o):e===se&&U(t,o))}function q(e,t){try{t(function(t){E(e,t)},function(t){U(e,t)})}catch(n){U(e,n)}}function C(e){return new de(this,e).promise}function F(e){function t(e){E(o,e)}function n(e){U(o,e)}var r=this,o=new r(v);if(!W(e))return U(o,new TypeError("You must pass an array to race.")),o;for(var i=e.length,s=0;o._state===oe&&i>s;s++)O(r.resolve(e[s]),void 0,t,n);return o}function V(e){var t=this,n=new t(v);return U(n,e),n}function L(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function M(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function N(e){this._id=pe++,this._state=void 0,this._result=void 0,this._subscribers=[],v!==e&&("function"!=typeof e&&L(),this instanceof N?q(this,e):M())}function H(e,t){this._instanceConstructor=e,this.promise=new e(v),Array.isArray(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&S(this.promise,this._result))):U(this.promise,this._validationError())}function G(){var e;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;n&&"[object Promise]"===Object.prototype.toString.call(n.resolve())&&!n.cast||(e.Promise=he)}var B;B=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var k,Q,X,W=B,$=0,J=function(e,t){te[$]=e,te[$+1]=t,$+=2,2===$&&(Q?Q(h):X())},Y="undefined"!=typeof window?window:void 0,K=Y||{},z=K.MutationObserver||K.WebKitMutationObserver,Z="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),ee="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,te=new Array(1e3);X=Z?u():z?c():ee?f():void 0===Y&&"function"==typeof e?d():p();var ne=m,re=g,oe=void 0,ie=1,se=2,ae=new A,ue=new A,le=C,ce=F,fe=V,pe=0,he=N;N.all=le,N.race=ce,N.resolve=re,N.reject=fe,N._setScheduler=s,N._setAsap=a,N._asap=J,N.prototype={constructor:N,then:ne,"catch":function(e){return this.then(null,e)}};var de=H;H.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},H.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===oe&&e>n;n++)this._eachEntry(t[n],n)},H.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===re){var o=b(e);if(o===ne&&e._state!==oe)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===he){var i=new n(v);T(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){t(e)}),t)}else this._willSettleAt(r(e),t)},H.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===oe&&(this._remaining--,e===se?U(r,n):this._result[t]=n),0===this._remaining&&S(r,this._result)},H.prototype._willSettleAt=function(e,t){var n=this;O(e,void 0,function(e){n._settledAt(ie,t,e)},function(e){n._settledAt(se,t,e)})};var me=G,ge={Promise:he,polyfill:me};"function"==typeof define&&define.amd?define(function(){return ge}):"undefined"!=typeof t&&t.exports?t.exports=ge:"undefined"!=typeof this&&(this.ES6Promise=ge),me()}).call(this)}).call(this,e("e/U+97"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"e/U+97":4}],3:[function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(e,t){for(var n,s,a=r(e),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var l in n)o.call(n,l)&&(a[l]=n[l]);if(Object.getOwnPropertySymbols){s=Object.getOwnPropertySymbols(n);for(var c=0;c<s.length;c++)i.call(n,s[c])&&(a[s[c]]=n[s[c]])}}return a}},{}],4:[function(e,t,n){function r(){}var o=t.exports={};o.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=r,o.addListener=r,o.once=r,o.off=r,o.removeListener=r,o.removeAllListeners=r,o.emit=r,o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],5:[function(e,t,n){var r=e("es6-promise").Promise;!function(){function e(e,t){if(s(t))if(a(e)){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;++n)t(e[n],n)}else if(i(e))for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)}function n(){for(var t={},n=0;n<arguments.length;++n)e(arguments[n],function(e,n){t[n]=e});return t}function o(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function i(e){return"[object Object]"===Object.prototype.toString.call(e)}function s(e){return"function"==typeof e}function a(e){return Array.isArray?Array.isArray(e):e instanceof Array}function u(e){return o(e)&&/^GET|POST|PUT|HEAD|DELETE|PATCH$/.test(e.toUpperCase())}function l(t){function n(t,o){null===t||void 0===t||s(t)?r.push(encodeURIComponent(o)+"="):i(t)?e(t,function(e,t){n(e,o+"["+t+"]")}):a(t)?e(t,function(e){n(e,o+"[]")}):r.push(encodeURIComponent(o)+"="+encodeURIComponent(t))}var r=[];return e(t,n),r.join("&")}function c(){return"undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:"undefined"!=typeof ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null}function f(){function t(t,n){P.onreadystatechange=function(){if(4===P.readyState&&!w){b=!0;var r=P.response;P.body=P.response,y.origin&&(r=P),P.status<400&&P.status>=100?(s(y.success)&&y.success(r),s(a)&&a(null,r),s(t)&&t(r)):(f=new Error("Request Error, Response Code: "+P.status),f.code=P.status,P.error=f,e(d,function(e){s(e)&&e(f,P)}),s(y.error)&&y.error(f),s(a)&&a(f,r),s(n)&&n(f)),s(y.complete)&&y.complete(r)}},s(y.before)&&y.before(),y.timeout&&setTimeout(function(){b||(w=!0,f=new Error("Request Timeout, Response Code: 408"),f.code=408,P.error=f,e(d,function(e){s(e)&&e(f,P)}),s(y.error)&&y.error(f),s(a)&&a(f,P),s(n)&&n(f),s(y.complete)&&y.complete(P))},y.timeout),P.send(v)}for(var a,f,p="",m="",g="GET",v=null,y={},w=!1,b=!1,_=0;_<arguments.length;++_){var R=arguments[_];o(R)?p=R:i(R)?y=R:s(R)&&(a=R)}if(y=n(h,y),o(y.url)&&(p=y.url),u(y.method)&&(g=y.method.toUpperCase()),"POST"===g||"PUT"===g||"DELETE"===g)switch(y.format){case"json":y.headers["Content-Type"]="application/json;charset=UTF-8",v=JSON.stringify(y.data);break;case"formdata":if("undefined"!=typeof FormData){y.headers["Content-Type"]="multipart/form-data",y.data instanceof FormData?v=y.data:(v=new FormData,e(y.data,function(e,t){v.append(t,e)}));break}case"form":default:y.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",m=l(y.data),m&&(v=m)}else m=l(y.data),m&&(p+=(p.indexOf("?")>=0?"&":"?")+m);var P=c();return null!==P?(P.open(g,p,y.async),e(y.headers,function(e,t){P.setRequestHeader(t,e)}),y.type&&(P.responseType=y.type),"undefined"!=typeof r?new r(t):void t()):(f=new Error("Your broswer don't support ajax!"),s(y.error)&&y.error(f),s(a)&&a(f),"undefined"!=typeof r?r.reject(f):void 0)}function p(){return f.apply(this,arguments)}var h={url:"",method:"GET",async:!0,data:{},origin:!1,type:"json",headers:{}},d=[];p.get=function(e,t,n){return f.call(this,{url:e,method:"GET",data:t},n)},p.post=function(e,t,n){return f.call(this,{url:e,method:"POST",data:t},n)},p.setDefault=function(e){return h=n(h,e),p},p.setErrorInterceptor=function(e){return d.push(e),p},"undefined"!=typeof t&&t.exports?t.exports=p:"function"==typeof define&&define.amd?define("ajax",[],function(){return p}):window.ajax=p}()},{"es6-promise":2}],6:[function(e,t,n){var r=e("object-assign"),o=e("./list"),i=e("./web"),s=e("./profiles"),a=e("./search"),u=e("./filesystem"),l=e("./utils"),c=u.Folder,f=function(){var e=this;e.web=new i(e),e.search=new a(e),e.profiles=new s(e)};f.prototype.executeRequest=function(){throw"Not implemented exception"},f.prototype.get=function(e,t,n){var o={method:"GET"};return t&&(o=r({},o,t)),this.executeRequest(e,o)},f.prototype.lists=function(e){return e?new o(e,this):this.get("/web/lists").then(l.validateODataV2)},f.prototype.post=function(e,t,n){var o=JSON.stringify(t),i={method:"POST",data:o,contentType:"application/json;odata=verbose"};return i=r({},i,n),this.executeRequest(e,i)},f.prototype.getFolder=function(e){"/"===e.charAt(0)&&(e=e.substr(1));var t="/web/GetFolderByServerRelativeUrl('"+e+"')?$expand=Folders,Files";return this.get(t).then(l.validateODataV2).then(function(e){var t=new c(e);return t.populateChildren(e),t})},f.prototype.uploadFile=function(e,t,n){var r="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",o={binaryStringRequestBody:!0,state:"Update"};return this.post(r,n,o)},t.exports=f},{"./filesystem":8,"./list":9,"./profiles":11,"./search":14,"./utils":15,"./web":16,"object-assign":3}],7:[function(e,t,n){(function(n){var r={};r.RestDao=e("../restDao"),r.queryString=e("../queryString"),r.templating=e("droopy-templating"),r.utils=e("../utils"),t.exports=n.SPScript=r}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../queryString":12,"../restDao":13,"../utils":15,"droopy-templating":1}],8:[function(e,t,n){var r=(e("./utils"),function(e){var t=this;t.mapProperties(e)});r.prototype.populateChildren=function(e){this.folders=e.Folders.results.map(function(e){return new r(e)}),this.files=e.Files.results.map(function(e){return new o(e)})},r.prototype.mapProperties=function(e){this.name=e.Name,this.serverRelativeUrl=e.ServerRelativeUrl,this.itemCount=e.ItemCount,this.guid=e.UniqueId,this.uri=e.__metadata.uri};var o=function(e){this.mapProperties(e)};o.prototype.mapProperties=function(e){this.name=e.Name,this.title=e.Title,this.checkoutType=e.CheckOutType,this.byteLength=e.Length,this.majorVersion=e.MajorVersion,this.minorVersion=e.MinorVersion,this.serverRelativeUrl=e.ServerRelativeUrl,this.uri=e.__metadata.uri},t.exports={File:o,Folder:r}},{"./utils":15}],9:[function(e,t,n){var r=e("./utils"),o=e("./permissions"),i=e("object-assign"),s=function(e,t){this.listname=e,this.baseUrl="/web/lists/getbytitle('"+e+"')",this._dao=t,this.permissions=new o(this.baseUrl,this._dao)};s.prototype.getItems=function(e){var t=null!=e?"?"+e:"";return this._dao.get(this.baseUrl+"/items"+t).then(r.validateODataV2)},s.prototype.getItemById=function(e,t){var n=this.baseUrl+"/items("+e+")";return n+=null!=t?"?"+t:"",this._dao.get(n).then(r.validateODataV2)},s.prototype.info=function(){return this._dao.get(this.baseUrl).then(r.validateODataV2)},s.prototype.addItem=function(e){var t=this;return t._dao.get(t.baseUrl).then(function(n){e=i({},{__metadata:{type:n.d.ListItemEntityTypeFullName}},e);var o={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest()}};return t._dao.post(baseUrl+"/items",e,o).then(r.validateODataV2)})},s.prototype.updateItem=function(e,t){var n=this;return n.getItemById(e).then(function(e){t=i({},{__metadata:{type:e.__metadata.type}},t);var o={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return n._dao.post(e.__metadata.uri,t,o)})},s.prototype.deleteItem=function(e){var t=this;return t.getItemById(e).then(function(e){var n={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest(),"X-HTTP-Method":"DELETE","If-Match":e.__metadata.etag}};return t._dao.post(e.__metadata.uri,"",n)})},s.prototype.findItems=function(e,t,n){var r="string"==typeof t?"'"+t+"'":t,o="$filter="+e+" eq "+r;return o+=null!=n?"&"+n:"",this.getItems(o)},s.prototype.findItem=function(e,t,n){return this.findItems(e,t,n).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},t.exports=s},{"./permissions":10,"./utils":15,"object-assign":3}],10:[function(e,t,n){var r=e("./utils"),o=function(e,t){this._dao=t,this.baseUrl=e};o.prototype.getRoleAssignments=function(){var e=baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return dao.get(e).then(r.validateODataV2).then(function(e){return e.map(i.roleAssignment)})},o.prototype.check=function(e){var t=this,n=function(e){var n=encodeURIComponent(e.LoginName),o=t.baseUrl+"/getusereffectivepermissions(@v)?@v='"+n+"'";return t._dao.get(o).then(r.validateODataV2)},o=e?t._dao.web.getUser(e):t._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(e){return e.d});return o.then(n).then(function(e){return s(e.GetUserEffectivePermissions.Low,e.GetUserEffectivePermissions.High)})};var i={roleAssignment:function(e){var t={member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id}};return t.roles=e.RoleDefinitionBindings.results.map(function(e){return{name:e.Name,description:e.Description,basePermissions:s(e.BasePermissions.Low,e.BasePermissions.High)}}),t}},s=function(e,t){var n=[];return a.forEach(function(r){((r.low&e)>0||(r.high&t)>0)&&n.push(r.name)}),n},a=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}];t.exports=o},{"./utils":15}],11:[function(e,t,n){var r=e("./utils"),o=function(e){this._dao=e,this.baseUrl="/SP.UserProfiles.PeopleManager"},i=function(e){return e.UserProfileProperties.results.forEach(function(t){e[t.Key]=t.Value}),e};o.prototype.current=function(){var e=this.baseUrl+"/GetMyProperties";return this._dao.get(e).then(r.validateODataV2).then(i)},o.prototype.setProperty=function(e,t,n){var o=this,i=this.baseUrl+"/SetSingleValueProfileProperty",s={propertyName:t,propertyValue:n},a={headers:{Accept:r.acceptHeader,"X-RequestDigest":r.getRequestDigest()}};return"string"==typeof e?o.getByEmail(e).then(function(e){return s.accountName=e.AccountName,o._dao.post(i,s,a)}):(s.accountName=e.LoginName||e.AccountName,o._dao.post(i,s,a))},o.prototype.getProfile=function(e){var t=encodeURIComponent(e.LoginName),n=this.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+t+"'";return this._dao.get(n).then(r.validateODataV2).then(i)},o.prototype.getByEmail=function(e){var t=this;return t._dao.web.getUser(e).then(function(e){return t.getProfile(e)})},t.exports=o},{"./utils":15}],12:[function(e,t,n){var r={_queryString:{},_processed:!1,_processQueryString:function(e){if(e||window.location.search)for(var t,n=e||window.location.search.substring(1),r=n.split("&"),o=0;o<r.length;o++)t=r[o].split("="),this._queryString[t[0]]=decodeURIComponent(t[1].replace(/\+/g," "));this._processed=!0},contains:function(e,t){return this._processed||this._processQueryString(t),this._queryString.hasOwnProperty(e)},getValue:function(e,t){return this._processed||this._processQueryString(t),this.contains(e)?this._queryString[e]:""},getAll:function(e){return this._processed||this._processQueryString(e),this._queryString},objectToQueryString:function(e,t){var n=[];for(var r in e)value=e[r],null!==value&&(t?n.push(encodeURIComponent(r)+"='"+encodeURIComponent(value)+"'"):n.push(encodeURIComponent(r)+"="+encodeURIComponent(value)));return n.join("&")}};t.exports=r},{}],13:[function(e,t,n){var r=e("./baseDao"),o=e("object-assign"),i=e("./ajax"),s=function(e){r.call(this),this.webUrl=e||_spPageContextInfo.webAbsoluteUrl};s.prototype=new r,s.prototype.executeRequest=function(e,t){var n=/^http/i.test(e)?e:this.webUrl+"/_api"+e,r={url:n,method:"GET",headers:{Accept:"application/json; odata=verbose"}};return r=o({},r,t),i(r)},t.exports=s},{"./ajax":5,"./baseDao":6,"object-assign":3}],14:[function(e,t,n){var r=e("./queryString"),o=e("./utils"),i=function(e){this._dao=e};i.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var s=function(e){for(var t=[],n=0;n<e.length;n++){for(var r=e[n],o={},i=0;i<r.Cells.results.length;i++)o[r.Cells.results[i].Key]=r.Cells.results[i].Value;t.push(o)}return t},a=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=s(e.PrimaryQueryResult.RelevantResults.Table.Rows.results),this.refiners=e.PrimaryQueryResult.RefinementResults?u(e.PrimaryQueryResult.RefinementResults.Refiners.results):null},u=function(e){for(var t=[],n=0;n<e.length;n++){var r={};r.RefinerName=e[n].Name,r.RefinerOptions=e[n].Entries.results,t.push(r)}return t};i.prototype.query=function(e,t){var n=this,i=null!=t?"&"+r.objectToQueryString(t,!0):"",s="/search/query?querytext='"+e+"'"+i;return n._dao.get(s).then(o.validateODataV2).then(function(e){if(e.query)return new a(e.query);throw new Error("Invalid response back from search service")})},i.prototype.people=function(e,t){var n=t||{};return n.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(e,n)},t.exports=i},{"./queryString":12,"./utils":15}],15:[function(e,t,n){var r=(n.getRequestDigest=function(){return document.querySelector("#__REQUESTDIGEST").value},n.acceptHeader="application/json;odata=verbose",n.validateODataV2=function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e;return e.d&&e.d.results&&null!=e.d.results.length?t=e.d.results:e.d&&(t=e.d),t},n.validateCrossDomainODataV2=function(e){var t=$.parseJSON(e.body);helpers.validateODataV2(t)},n.arrayFromBitMask=function(e){"string"==typeof e&&(e=parseInt(e));for(var t=e,n=[];t;n.push(Boolean(1&t)),t>>>=1);return n},n.waitForLibraries=function(e,t){var n=e.filter(function(e){return!o(e)});0===n.length?t():setTimeout(function(){r(e,t)},25)}),o=(n.waitForLibrary=function(e,t){return r([e],t)},n.validateNamespace=function(e){for(var t=window,n=e.split("."),r=n.length,o=0;r>o;o++){var i=n[o];if(!(i in t))return!1;t=t[i]}return!0})},{}],16:[function(e,t,n){var r=e("./utils"),o=e("./permissions"),i=e("object-assign"),s=function(e){this._dao=e,this.baseUrl="/web",this.permissions=new o(this.baseUrl,this._dao)};s.prototype.info=function(){return this._dao.get(this.baseUrl).then(r.validateODataV2)},s.prototype.subsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(r.validateODataV2)},s.prototype.getRequestDigest=function(){var e="/contextinfo",t={headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"}};return this._dao.post(e,{},t).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},s.prototype.copyFile=function(e,t,n){var r=this;return n?r._copyFileWithDigest(e,t,n):void r.getRequestDigest().then(function(n){return r._copyFileWithDigest(e,t,n)})},s.prototype.deleteFile=function(e,t){var n=this;return t?n._deleteFileWithDigest(e,t):void n.getRequestDigest().then(function(t){return n._deleteFileWithDigest(e,t)})};var a={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"};s.prototype._deleteFileWithDigest=function(e,t){var n="/web/getfilebyserverrelativeurl(@url)/?@Url='"+e+"'",r={headers:i({},a,{"X-HTTP-Method":"DELETE","X-RequestDigest":t})};return this._dao.post(n,{},r)},s.prototype._copyFileWithDigest=function(e,t,n){var r="/web/getfilebyserverrelativeurl(@url)/CopyTo?@Url='"+e+"'&strNewUrl='"+t+"'&bOverWrite='true'",o={headers:i({},a,{"X-RequestDigest":n})};return this._dao.post(r,{},o)},s.prototype.getUser=function(e){var t=baseUrl+"/SiteUsers/GetByEmail('"+e+"')";return this._dao.get(t).then(r.validateODataV2)},t.exports=s},{"./permissions":10,"./utils":15,"object-assign":3}]},{},[7]);