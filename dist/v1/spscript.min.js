!function e(t,r,n){function i(o,a){if(!r[o]){if(!t[o]){var p="function"==typeof require&&require;if(!a&&p)return p(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=r[o]={exports:{}};t[o][0].call(l.exports,function(e){var r=t[o][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t){SPScript=e("./spscript"),SPScript.List=e("./list"),SPScript.Web=e("./web"),SPScript.Profiles=e("./profiles"),SPScript.helpers=e("./helpers"),function(e){var t=function(){var t=this;t.web=new e.Web(t),t.search=new e.Search(t),t.profiles=new e.Profiles(t)};t.prototype.executeRequest=function(){throw"Not implemented exception"},t.prototype.get=function(e,t){var r={type:"GET"};return t&&$.extend(r,t),this.executeRequest(e,r)},t.prototype.lists=function(t){return t?new e.List(t,this):this.get("/web/lists").then(e.helpers.validateODataV2)},t.prototype.post=function(e,t,r){var n=JSON.stringify(t),i={type:"POST",data:n,contentType:"application/json;odata=verbose"};return $.extend(i,r),this.executeRequest(e,i)},t.prototype.uploadFile=function(e,t,r){var n="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(n,r,i)},e.BaseDao=t}(SPScript),t.exports=SPScript.BaseDao},{"./helpers":4,"./list":5,"./profiles":7,"./spscript":11,"./web":13}],2:[function(e,t){SPScript=e("./spscript"),SPScript.helpers=e("./helpers"),SPScript.BaseDao=e("./baseDao"),function(e){var t=function(e,t){this.appUrl=e,this.hostUrl=t,this.scriptReady=new $.Deferred,SP&&SP.RequestExecutor?setTimeout(function(){this.scriptReady.resolve()},1):this.scriptReady=$.getScript(t+"/_layouts/15/SP.RequestExecutor.js")};t.prototype=new SPScript.BaseDao,t.prototype.executeRequest=function(t,r){var n=this,i=new $.Deferred,s=function(t){var n=$.parseJSON(t.body);r.success?r.success(n,i):e.helpers.validateODataV2(n,i)},o=function(e,t,n){r.error?r.error(e,t,n,i):i.reject(n)};return this.scriptReady.done(function(){-1===t.indexOf("?")&&(t+="?");var e=new SP.RequestExecutor(n.appUrl),i=n.appUrl+"/_api/SP.AppContextSite(@target)"+t+"@target='"+n.hostUrl+"'",a={url:i,type:"GET",headers:{Accept:"application/json; odata=verbose"},success:s,error:o};$.extend(!0,a,r),e.executeAsync(a)}),i.promise()},e.CrossDomainDao=t}(SPScript),t.exports=SPScript.CrossDomainDao},{"./baseDao":1,"./helpers":4,"./spscript":11}],3:[function(e,t){(function(r){r.SPScript={},r.SPScript.RestDao=e("../restDao"),r.SPScript.CrossDomainDao=e("../crossDomainDao"),r.SPScript.queryString=e("../queryString"),r.SPScript.Search=e("../search"),r.SPScript.templating=e("../templating"),t.exports=r.SPScript}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../crossDomainDao":2,"../queryString":8,"../restDao":9,"../search":10,"../templating":12}],4:[function(e,t){var r=e("./spscript.js");!function(e){var t={};t.validateODataV2=function(e){var t=e;return e.d&&e.d.results&&null!=e.d.results.length?t=e.d.results:e.d&&(t=e.d),t},t.validateCrossDomainODataV2=function(e){var r=$.parseJSON(e.body);t.validateODataV2(r)},t.arrayFromBitMask=function(e){"string"==typeof e&&(e=parseInt(e));for(var t=e,r=[];t;r.push(Boolean(1&t)),t>>>=1);return r},e.helpers=t}(r),t.exports=r.helpers},{"./spscript.js":11}],5:[function(e,t){var r=e("./spscript");r.helpers=e("./helpers"),r.permissions=e("./permissions"),function(e){var t=null,r=function(e,r){this.listname=e,t="/web/lists/getbytitle('"+e+"')",this._dao=r};r.prototype.getItems=function(r){var n=null!=r?"?"+r:"";return this._dao.get(t+"/items"+n).then(e.helpers.validateODataV2)},r.prototype.getItemById=function(r,n){var i=t+"/items("+r+")";return i+=null!=n?"?"+n:"",this._dao.get(i).then(e.helpers.validateODataV2)},r.prototype.info=function(){return this._dao.get(t).then(e.helpers.validateODataV2)},r.prototype.addItem=function(r){var n=this;return n._dao.get(t).then(function(i){r=$.extend({__metadata:{type:i.d.ListItemEntityTypeFullName}},r);var s={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return n._dao.post(t+"/items",r,s).then(e.helpers.validateODataV2)})},r.prototype.updateItem=function(e,t){var r=this;return r.getItemById(e).then(function(e){t=$.extend({__metadata:{type:e.__metadata.type}},t);var n={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return r._dao.post(e.__metadata.uri,t,n)})},r.prototype.deleteItem=function(e){var t=this;return t.getItemById(e).then(function(e){var r={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"DELETE","If-Match":e.__metadata.etag}};return t._dao.post(e.__metadata.uri,"",r)})},r.prototype.findItems=function(e,t,r){var n="string"==typeof t?"'"+t+"'":t,i="$filter="+e+" eq "+n;return i+=null!=r?"&"+r:"",this.getItems(i)},r.prototype.findItem=function(e,t,r){return this.findItems(e,t,r).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},r.prototype.permissions=function(r){return e.permissions(t,this._dao,r)},e.List=r}(r),t.exports=r.List},{"./helpers":4,"./permissions":6,"./spscript":11}],6:[function(e,t){var r=e("./spscript");r.helpers=e("./helpers"),function(e){var t={roleAssignment:function(e){var t={member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id}};return t.roles=e.RoleDefinitionBindings.results.map(function(e){return{name:e.Name,description:e.Description,basePermissions:r(e.BasePermissions.Low,e.BasePermissions.High)}}),t}},r=function(e,t){var r=[];return i.forEach(function(n){((n.low&e)>0||(n.high&t)>0)&&r.push(n.name)}),r},n=function(n,i,s){if(!s){var o=n+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return i.get(o).then(e.helpers.validateODataV2).then(function(e){return e.map(t.roleAssignment)})}var a=function(t){var r=encodeURIComponent(t.LoginName),s=n+"/getusereffectivepermissions(@v)?@v='"+r+"'";return i.get(s).then(e.helpers.validateODataV2)};return i.web.getUser(s).then(a).then(function(e){return r(e.GetUserEffectivePermissions.Low,e.GetUserEffectivePermissions.High)})},i=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}];e.permissions=n}(r),t.exports=r.permissions},{"./helpers":4,"./spscript":11}],7:[function(e,t){var r=e;r.helpers=e("./helpers"),function(e){var t=function(e){this._dao=e,this.baseUrl="/SP.UserProfiles.PeopleManager"},r=function(e){return e.UserProfileProperties.results.forEach(function(t){e[t.Key]=t.Value}),e};t.prototype.current=function(){var t=this.baseUrl+"/GetMyProperties";return this._dao.get(t).then(e.helpers.validateODataV2).then(r)},t.prototype.getProfile=function(t){var n=encodeURIComponent(t.LoginName),i=this.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+n+"'";return this._dao.get(i).then(e.helpers.validateODataV2).then(r)},t.prototype.getByEmail=function(e){var t=this;return t._dao.web.getUser(e).then(function(e){return t.getProfile(e)})},e.Profiles=t}(r),t.exports=r.Profiles},{"./helpers":4}],8:[function(e,t){SPScript=e("./spscript"),function(e){e.queryString={_queryString:{},_processed:!1,_processQueryString:function(e){for(var t,r=e||window.location.search.substring(1),n=r.split("&"),i=0;i<n.length;i++)t=n[i].split("="),this._queryString[t[0]]=decodeURIComponent(t[1].replace(/\+/g," "));this._processed=!0},contains:function(e,t){return this._processed||this._processQueryString(t),this._queryString.hasOwnProperty(e)},getValue:function(e,t){return this._processed||this._processQueryString(t),this.contains(e)?this._queryString[e]:""},getAll:function(e){return this._processed||this._processQueryString(e),this._queryString},objectToQueryString:function(e,t){var r=[];for(var n in e)value=e[n],null!==value&&r.push(t?encodeURIComponent(n)+"='"+encodeURIComponent(value)+"'":encodeURIComponent(n)+"="+encodeURIComponent(value));return r.join("&")}}}(SPScript),t.exports=SPScript.queryString},{"./spscript":11}],9:[function(e,t){var r=e("./spscript");r.BaseDao=e("./baseDao"),r.Search=e("./search"),function(e){var t=function(t){e.BaseDao.call(this),this.webUrl=t};t.prototype=new e.BaseDao,t.prototype.executeRequest=function(e,t){var r=/^http/i.test(e)?e:this.webUrl+"/_api"+e,n={url:r,type:"GET",headers:{Accept:"application/json; odata=verbose"}};return $.extend(n,t),$.ajax(n)},e.RestDao=t}(r),t.exports=r.RestDao},{"./baseDao":1,"./search":10,"./spscript":11}],10:[function(e,t){SPScript=e("./spscript"),SPScript.RestDao=e("./restDao"),SPScript.queryString=e("./queryString"),function(e){var t=function(t){this.dao="string"==typeof t?new e.RestDao(t):t};t.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var r=function(e){for(var t=[],r=0;r<e.length;r++){for(var n=e[r],i={},s=0;s<n.Cells.results.length;s++)i[n.Cells.results[s].Key]=n.Cells.results[s].Value;t.push(i)}return t},n=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=r(e.PrimaryQueryResult.RelevantResults.Table.Rows.results)};t.prototype.query=function(t,r){var i=this,s=null!=r?"&"+e.queryString.objectToQueryString(r,!0):"",o=new $.Deferred,a="/search/query?querytext='"+t+"'"+s,p=i.dao.get(a);return p.done(function(e){if(e.d&&e.d.query){var t=new n(e.d.query);o.resolve(t)}else o.reject(e)}),o.promise()},t.prototype.people=function(e,t){var r=t||{};return r.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(e,r)},e.Search=t}(SPScript),t.exports=SPScript.Search},{"./queryString":8,"./restDao":9,"./spscript":11}],11:[function(e,t){t.exports={}},{}],12:[function(e,t){SPScript=e("./spscript"),function(e){e.templating={Placeholder:function(e){this.raw=e,this.fullProperty=e.slice(2,e.length-2)},getPlaceHolders:function(e,t){var r=t||/\{\{[^\}]+\}\}?/g;return e.match(r)},getObjectValue:function(e,t){for(var r=e,n=t.split("."),i=0;i<n.length;i++){var s=n[i];r=null!=r[s]?r[s]:"Not Found: "+t}if("_"===t&&(r=e),"string"==typeof r&&-1!==r.indexOf("/Date(")){var o=r.UTCJsonToDate();r=o.toLocaleDateString()}return r},populateTemplate:function(e,t,r){for(var n=this.getPlaceHolders(e,r)||[],i=e,s=0;s<n.length;s++){var o=new this.Placeholder(n[s]);o.val=this.getObjectValue(t,o.fullProperty);var a=o.raw.replace("[","\\[").replace("]","\\]"),p="g";i=i.replace(new RegExp(a,p),o.val)}return i}},e.templating.Each={regExp:/\{\[[^\]]+\]\}?/g,populateEachTemplates:function(t,r){var n=$(t),i=n.find("[data-each]");i.each(function(){var t="",i=$(this).html(),s=$(this).data("each"),o=e.templating.getObjectValue(r,s);if(null!=o&&$.isArray(o))for(var a=0;a<o.length;a++)t+=e.templating.populateTemplate(i,o[a],e.templating.Each.regExp);n.find($(this)).html(t)});var s=n.clone().wrap("<div>");return s.parent().html()}},e.templating.renderTemplate=function(t,r,n){var i=e.templating.populateTemplate(t,r);return n&&(i=e.templating.Each.populateEachTemplates(i,r)),i}}(SPScript),String.prototype.UTCJsonToDate=function(){var e=this.substring(this.indexOf("(")+1);e=e.substring(0,e.indexOf(")"));var t=new Date(parseInt(e,10)),r=t.getTimezoneOffset()/60;return t.setHours(t.getHours()+r),t},t.exports=SPScript.templating},{"./spscript":11}],13:[function(e,t){var r=e;r.helpers=e("./helpers"),r.permissions=e("./permissions"),function(e){var t="/web",r=function(e){this._dao=e};r.prototype.info=function(){return this._dao.get(t).then(e.helpers.validateODataV2)},r.prototype.subsites=function(){return this._dao.get(t+"/webinfos").then(e.helpers.validateODataV2)},r.prototype.permissions=function(r){return e.permissions(t,this._dao,r)},r.prototype.getUser=function(r){var n=t+"/SiteUsers/GetByEmail('"+r+"')";return this._dao.get(n).then(e.helpers.validateODataV2)},e.Web=r}(r),t.exports=r.Web},{"./helpers":4,"./permissions":6}]},{},[3]);