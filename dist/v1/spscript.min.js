!function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return o(r?r:e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){!function(){function e(e,t){if(i(t))if(s(e)){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;++r)t(e[r],r)}else if(o(e))for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function r(){for(var t={},r=0;r<arguments.length;++r)e(arguments[r],function(e,r){t[r]=e});return t}function n(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function o(e){return"[object Object]"===Object.prototype.toString.call(e)}function i(e){return"function"==typeof e}function s(e){return Array.isArray?Array.isArray(e):e instanceof Array}function a(e){return n(e)&&/^GET|POST|PUT|HEAD|DELETE|PATCH$/.test(e.toUpperCase())}function u(t){function r(t,a){null===t||void 0===t||i(t)?n.push(encodeURIComponent(a)+"="):o(t)?e(t,function(e,t){r(e,a+"["+t+"]")}):s(t)?e(t,function(e){r(e,a+"[]")}):n.push(encodeURIComponent(a)+"="+encodeURIComponent(t))}var n=[];return e(t,r),n.join("&")}function l(){return"undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:"undefined"!=typeof ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null}function c(){function t(t,r){_.onreadystatechange=function(){if(4===_.readyState&&!v){w=!0;var n=_.response;_.body=_.response,y.origin&&(n=_),_.status<400&&_.status>=100?(i(y.success)&&y.success(n),i(s)&&s(null,n),i(t)&&t(n)):(c=new Error("Request Error, Response Code: "+_.status),c.code=_.status,_.error=c,e(f,function(e){i(e)&&e(c,_)}),i(y.error)&&y.error(c),i(s)&&s(c,n),i(r)&&r(c)),i(y.complete)&&y.complete(n)}},i(y.before)&&y.before(),y.timeout&&setTimeout(function(){w||(v=!0,c=new Error("Request Timeout, Response Code: 408"),c.code=408,_.error=c,e(f,function(e){i(e)&&e(c,_)}),i(y.error)&&y.error(c),i(s)&&s(c,_),i(r)&&r(c),i(y.complete)&&y.complete(_))},y.timeout),_.send(m)}for(var s,c,p="",d="",g="GET",m=null,y={},v=!1,w=!1,b=0;b<arguments.length;++b){var R=arguments[b];n(R)?p=R:o(R)?y=R:i(R)&&(s=R)}if(y=r(h,y),n(y.url)&&(p=y.url),a(y.method)&&(g=y.method.toUpperCase()),p=p.replace(/:([^\/]+)|\{([^\/]+)\}/g,function(e,t){return y[t]?y[t]:t}),"POST"===g||"PUT"===g||"DELETE"===g)switch(y.format){case"json":y.headers["Content-Type"]="application/json;charset=UTF-8",m=JSON.stringify(y.data);break;case"formdata":if("undefined"!=typeof FormData){y.headers["Content-Type"]="multipart/form-data",y.data instanceof FormData?m=y.data:(m=new FormData,e(y.data,function(e,t){m.append(t,e)}));break}case"form":default:y.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",d=u(y.data),d&&(m=d)}else d=u(y.data),d&&(p+=(p.indexOf("?")>=0?"&":"?")+d);var _=l();return null!==_?(_.open(g,p,y.async),e(y.headers,function(e,t){_.setRequestHeader(t,e)}),y.type&&(_.responseType=y.type),"undefined"!=typeof Promise?new Promise(t):void t()):(c=new Error("Your broswer don't support ajax!"),i(y.error)&&y.error(c),i(s)&&s(c),"undefined"!=typeof Promise?Promise.reject(c):void 0)}function p(){return c.apply(this,arguments)}var h={url:"",method:"GET",async:!0,data:{},origin:!1,type:"json",headers:{}},f=[];p.get=function(e,t,r){return c.call(this,{url:e,method:"GET",data:t},r)},p.post=function(e,t,r){return c.call(this,{url:e,method:"POST",data:t},r)},p.setDefault=function(e){return h=r(h,e),p},p.setErrorInterceptor=function(e){return f.push(e),p},"undefined"!=typeof t&&t.exports?t.exports=p:"function"==typeof define&&define.amd?define("ajax",[],function(){return p}):window.ajax=p}()},{}],2:[function(e,t,r){var n={Placeholder:function(e){this.raw=e,this.fullProperty=e.slice(2,e.length-2)},getPlaceHolders:function(e,t){var r=t||/\{\{[^\}]+\}\}?/g,n=e.match(r);return n||[]},getObjectValue:function(e,t){for(var r=e,n=t.split("."),i=0;i<n.length;i++){var s=n[i];r=null!=r[s]?r[s]:""}if("_"===t&&(r=e),"string"==typeof r&&-1!==r.indexOf("/Date(")){var a=o(r);r=a.toLocaleDateString()}return r},populateTemplate:function(e,t,r){for(var n=this.getPlaceHolders(e,r)||[],o=e,i=0;i<n.length;i++){var s=new this.Placeholder(n[i]);s.val=this.getObjectValue(t,s.fullProperty);var a=s.raw.replace("[","\\[").replace("]","\\]"),u="g";o=o.replace(new RegExp(a,u),s.val)}return o}};n.Each={regExp:/\{\[[^\]]+\]\}?/g,populateEachTemplates:function(e,t){var r=$(e),o=r.find("[data-each]");o.each(function(){var e="",o=$(this).html(),i=$(this).data("each"),s=sp.templating.getObjectValue(t,i);if(null!=s&&$.isArray(s))for(var a=0;a<s.length;a++)e+=n.populateTemplate(o,s[a],n.Each.regExp);r.find($(this)).html(e)});var i=r.clone().wrap("<div>");return i.parent().html()}},n.renderTemplate=function(e,t,r){var o=n.populateTemplate(e,t);return r&&(o=n.Each.populateEachTemplates(o,t)),o};var o=function(e){var t=e.substring(e.indexOf("(")+1);t=t.substring(0,t.indexOf(")"));var r=new Date(parseInt(t,10)),n=r.getTimezoneOffset()/60;return r.setHours(r.getHours()+n),r};t.exports=n},{}],3:[function(e,t,r){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(e,t){for(var r,s,a=n(e),u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var l in r)o.call(r,l)&&(a[l]=r[l]);if(Object.getOwnPropertySymbols){s=Object.getOwnPropertySymbols(r);for(var c=0;c<s.length;c++)i.call(r,s[c])&&(a[s[c]]=r[s[c]])}}return a}},{}],4:[function(e,t,r){var n=e("object-assign"),o=e("./list"),i=e("./web"),s=e("./profiles"),a=e("./search"),u=e("./filesystem"),l=e("./utils"),c=u.Folder,p=function(){var e=this;e.web=new i(e),e.search=new a(e),e.profiles=new s(e)};p.prototype.executeRequest=function(){throw"Not implemented exception"},p.prototype.get=function(e,t,r){var o={method:"GET"};return t&&(o=n({},o,t)),this.executeRequest(e,o)},p.prototype.lists=function(e){return e?new o(e,this):this.get("/web/lists").then(l.validateODataV2)},p.prototype.post=function(e,t,r){var o=JSON.stringify(t),i={method:"POST",data:o,contentType:"application/json;odata=verbose"};return i=n({},i,r),this.executeRequest(e,i)},p.prototype.getFolder=function(e){"/"===e.charAt(0)&&(e=e.substr(1));var t="/web/GetFolderByServerRelativeUrl('"+e+"')?$expand=Folders,Files";return this.get(t).then(l.validateODataV2).then(function(e){var t=new c(e);return t.populateChildren(e),t})},p.prototype.uploadFile=function(e,t,r){var n="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",o={binaryStringRequestBody:!0,state:"Update"};return this.post(n,r,o)},t.exports=p},{"./filesystem":6,"./list":7,"./profiles":9,"./search":12,"./utils":13,"./web":14,"object-assign":3}],5:[function(e,t,r){(function(r){var n={};n.RestDao=e("../restDao"),n.queryString=e("../queryString"),n.templating=e("droopy-templating"),n.utils=e("../utils"),t.exports=r.SPScript=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../queryString":10,"../restDao":11,"../utils":13,"droopy-templating":2}],6:[function(e,t,r){var n=(e("./utils"),function(e){var t=this;t.mapProperties(e)});n.prototype.populateChildren=function(e){this.folders=e.Folders.results.map(function(e){return new n(e)}),this.files=e.Files.results.map(function(e){return new o(e)})},n.prototype.mapProperties=function(e){this.name=e.Name,this.serverRelativeUrl=e.ServerRelativeUrl,this.itemCount=e.ItemCount,this.guid=e.UniqueId,this.uri=e.__metadata.uri};var o=function(e){this.mapProperties(e)};o.prototype.mapProperties=function(e){this.name=e.Name,this.title=e.Title,this.checkoutType=e.CheckOutType,this.byteLength=e.Length,this.majorVersion=e.MajorVersion,this.minorVersion=e.MinorVersion,this.serverRelativeUrl=e.ServerRelativeUrl,this.uri=e.__metadata.uri},t.exports={File:o,Folder:n}},{"./utils":13}],7:[function(e,t,r){var n=e("./utils"),o=e("./permissions"),i=e("object-assign"),s=function(e,t){this.listname=e,this.baseUrl="/web/lists/getbytitle('"+e+"')",this._dao=t,this.permissions=new o(this.baseUrl,this._dao)};s.prototype.getItems=function(e){var t=null!=e?"?"+e:"";return this._dao.get(this.baseUrl+"/items"+t).then(n.validateODataV2)},s.prototype.getItemById=function(e,t){var r=this.baseUrl+"/items("+e+")";return r+=null!=t?"?"+t:"",this._dao.get(r).then(n.validateODataV2)},s.prototype.info=function(){return this._dao.get(this.baseUrl).then(n.validateODataV2)},s.prototype.addItem=function(e){var t=this;return t._dao.get(t.baseUrl).then(function(r){e=i({},{__metadata:{type:r.d.ListItemEntityTypeFullName}},e);var o={headers:{Accept:n.acceptHeader,"X-RequestDigest":n.getRequestDigest()}};return t._dao.post(baseUrl+"/items",e,o).then(n.validateODataV2)})},s.prototype.updateItem=function(e,t){var r=this;return r.getItemById(e).then(function(e){t=i({},{__metadata:{type:e.__metadata.type}},t);var o={headers:{Accept:n.acceptHeader,"X-RequestDigest":n.getRequestDigest(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return r._dao.post(e.__metadata.uri,t,o)})},s.prototype.deleteItem=function(e){var t=this;return t.getItemById(e).then(function(e){var r={headers:{Accept:n.acceptHeader,"X-RequestDigest":n.getRequestDigest(),"X-HTTP-Method":"DELETE","If-Match":e.__metadata.etag}};return t._dao.post(e.__metadata.uri,"",r)})},s.prototype.findItems=function(e,t,r){var n="string"==typeof t?"'"+t+"'":t,o="$filter="+e+" eq "+n;return o+=null!=r?"&"+r:"",this.getItems(o)},s.prototype.findItem=function(e,t,r){return this.findItems(e,t,r).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},t.exports=s},{"./permissions":8,"./utils":13,"object-assign":3}],8:[function(e,t,r){var n=e("./utils"),o=function(e,t){this._dao=t,this.baseUrl=e};o.prototype.getRoleAssignments=function(){var e=baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return dao.get(e).then(n.validateODataV2).then(function(e){return e.map(i.roleAssignment)})},o.prototype.check=function(e){var t=this,r=function(e){var r=encodeURIComponent(e.LoginName),o=t.baseUrl+"/getusereffectivepermissions(@v)?@v='"+r+"'";return t._dao.get(o).then(n.validateODataV2)},o=e?t._dao.web.getUser(e):t._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(e){return e.d});return o.then(r).then(function(e){return s(e.GetUserEffectivePermissions.Low,e.GetUserEffectivePermissions.High)})};var i={roleAssignment:function(e){var t={member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id}};return t.roles=e.RoleDefinitionBindings.results.map(function(e){return{name:e.Name,description:e.Description,basePermissions:s(e.BasePermissions.Low,e.BasePermissions.High)}}),t}},s=function(e,t){var r=[];return a.forEach(function(n){((n.low&e)>0||(n.high&t)>0)&&r.push(n.name)}),r},a=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}];t.exports=o},{"./utils":13}],9:[function(e,t,r){var n=e("./utils"),o=function(e){this._dao=e,this.baseUrl="/SP.UserProfiles.PeopleManager"},i=function(e){return e.UserProfileProperties.results.forEach(function(t){e[t.Key]=t.Value}),e};o.prototype.current=function(){var e=this.baseUrl+"/GetMyProperties";return this._dao.get(e).then(n.validateODataV2).then(i)},o.prototype.setProperty=function(e,t,r){var o=this,i=this.baseUrl+"/SetSingleValueProfileProperty",s={propertyName:t,propertyValue:r},a={headers:{Accept:n.acceptHeader,"X-RequestDigest":n.getRequestDigest()}};return"string"==typeof e?o.getByEmail(e).then(function(e){return s.accountName=e.AccountName,o._dao.post(i,s,a)}):(s.accountName=e.LoginName||e.AccountName,o._dao.post(i,s,a))},o.prototype.getProfile=function(e){var t=encodeURIComponent(e.LoginName),r=this.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+t+"'";return this._dao.get(r).then(n.validateODataV2).then(i)},o.prototype.getByEmail=function(e){var t=this;return t._dao.web.getUser(e).then(function(e){return t.getProfile(e)})},t.exports=o},{"./utils":13}],10:[function(e,t,r){var n={_queryString:{},_processed:!1,_processQueryString:function(e){if(e||window.location.search)for(var t,r=e||window.location.search.substring(1),n=r.split("&"),o=0;o<n.length;o++)t=n[o].split("="),this._queryString[t[0]]=decodeURIComponent(t[1].replace(/\+/g," "));this._processed=!0},contains:function(e,t){return this._processed||this._processQueryString(t),this._queryString.hasOwnProperty(e)},getValue:function(e,t){return this._processed||this._processQueryString(t),this.contains(e)?this._queryString[e]:""},getAll:function(e){return this._processed||this._processQueryString(e),this._queryString},objectToQueryString:function(e,t){var r=[];for(var n in e)value=e[n],null!==value&&(t?r.push(encodeURIComponent(n)+"='"+encodeURIComponent(value)+"'"):r.push(encodeURIComponent(n)+"="+encodeURIComponent(value)));return r.join("&")}};t.exports=n},{}],11:[function(e,t,r){var n=e("./baseDao"),o=e("object-assign"),i=e("client-ajax"),s=function(e){n.call(this),this.webUrl=e||_spPageContextInfo.webAbsoluteUrl};s.prototype=new n,s.prototype.executeRequest=function(e,t){var r=/^http/i.test(e)?e:this.webUrl+"/_api"+e,n={url:r,method:"GET",headers:{Accept:"application/json; odata=verbose"}};return n=o({},n,t),i(n)},t.exports=s},{"./baseDao":4,"client-ajax":1,"object-assign":3}],12:[function(e,t,r){var n=e("./queryString"),o=function(e){this._dao=e};o.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var i=function(e){for(var t=[],r=0;r<e.length;r++){for(var n=e[r],o={},i=0;i<n.Cells.results.length;i++)o[n.Cells.results[i].Key]=n.Cells.results[i].Value;t.push(o)}return t},s=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=i(e.PrimaryQueryResult.RelevantResults.Table.Rows.results),this.refiners=e.PrimaryQueryResult.RefinementResults?a(e.PrimaryQueryResult.RefinementResults.Refiners.results):null},a=function(e){for(var t=[],r=0;r<e.length;r++){var n={};n.RefinerName=e[r].Name,n.RefinerOptions=e[r].Entries.results,t.push(n)}return t};o.prototype.query=function(e,t){var r=this,o=null!=t?"&"+n.objectToQueryString(t,!0):"",i="/search/query?querytext='"+e+"'"+o;return r._dao.get(i).then(function(e){if(e.d&&e.d.query)return new s(e.d.query);throw new Error("Invalid response back from search service")})},o.prototype.people=function(e,t){var r=t||{};return r.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(e,r)},t.exports=o},{"./queryString":10}],13:[function(e,t,r){var n=(r.getRequestDigest=function(){return document.querySelector("#__REQUESTDIGEST").value},r.acceptHeader="application/json;odata=verbose",r.validateODataV2=function(e){var t=e;return e.d&&e.d.results&&null!=e.d.results.length?t=e.d.results:e.d&&(t=e.d),t},r.validateCrossDomainODataV2=function(e){var t=$.parseJSON(e.body);helpers.validateODataV2(t)},r.arrayFromBitMask=function(e){"string"==typeof e&&(e=parseInt(e));for(var t=e,r=[];t;r.push(Boolean(1&t)),t>>>=1);return r},r.waitForLibraries=function(e,t){var r=e.filter(function(e){return!o(e)});0===r.length?t():setTimeout(function(){n(e,t)},25)}),o=(r.waitForLibrary=function(e,t){return n([e],t)},r.validateNamespace=function(e){for(var t=window,r=e.split("."),n=r.length,o=0;n>o;o++){var i=r[o];if(!(i in t))return!1;t=t[i]}return!0})},{}],14:[function(e,t,r){var n=e("./utils"),o=e("./permissions"),i=e("object-assign"),s=function(e){this._dao=e,this.baseUrl="/web",this.permissions=new o(this.baseUrl,this._dao)};s.prototype.info=function(){return this._dao.get(this.baseUrl).then(n.validateODataV2)},s.prototype.subsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(n.validateODataV2)},s.prototype.getRequestDigest=function(){var e="/contextinfo",t={headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"}};return this._dao.post(e,{},t).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},s.prototype.copyFile=function(e,t,r){var n=this;return r?n._copyFileWithDigest(e,t,r):void n.getRequestDigest().then(function(r){return n._copyFileWithDigest(e,t,r)})},s.prototype.deleteFile=function(e,t){var r=this;return t?r._deleteFileWithDigest(e,t):void r.getRequestDigest().then(function(t){return r._deleteFileWithDigest(e,t)})};var a={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"};s.prototype._deleteFileWithDigest=function(e,t){var r="/web/getfilebyserverrelativeurl(@url)/?@Url='"+e+"'",n={headers:i({},a,{"X-HTTP-Method":"DELETE","X-RequestDigest":t})};return this._dao.post(r,{},n)},s.prototype._copyFileWithDigest=function(e,t,r){var n="/web/getfilebyserverrelativeurl(@url)/CopyTo?@Url='"+e+"'&strNewUrl='"+t+"'&bOverWrite='true'",o={headers:i({},a,{"X-RequestDigest":r})};return this._dao.post(n,{},o)},s.prototype.getUser=function(e){var t=baseUrl+"/SiteUsers/GetByEmail('"+e+"')";return this._dao.get(t).then(n.validateODataV2)},t.exports=s},{"./permissions":8,"./utils":13,"object-assign":3}]},{},[5]);