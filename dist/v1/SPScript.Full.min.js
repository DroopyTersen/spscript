SPScript=window.SPScript||{},function(e){var t={};t.validateODataV2=function(e,t){var n=e;return e.d&&e.d.results&&null!=e.d.results.length?n=e.d.results:e.d&&(n=e.d),t?void t.resolve(n):n},t.validateCrossDomainODataV2=function(e,t){var n=$.parseJSON(e.body);SPScript.helpers.validateODataV2(n,t)},t.arrayFromBitMask=function(e){"string"==typeof e&&(e=parseInt(e));for(var t=e,n=[];t;n.push(Boolean(1&t)),t>>>=1);return n},e.helpers=t}(SPScript),SPScript=window.SPScript||{},function(e){var t={roleAssignment:function(e){var t={member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id}};return t.roles=e.RoleDefinitionBindings.results.map(function(e){var t=[];return r.forEach(function(n){((n.low&e.BasePermissions.Low)>0||(n.high&e.BasePermissions.High)>0)&&t.push(n.name)}),{name:e.Name,description:e.Description,basePermissions:t}}),t}},n=function(n,r,i){if(!i){var o=n+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return r.get(o).then(e.helpers.validateODataV2).then(function(e){return e.map(t.roleAssignment)})}},r=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}];e.permissions=n}(SPScript),SPScript=window.SPScript||{},function(e){var t="/web",n=function(e){this._dao=e};n.prototype.info=function(){return this._dao.get(t).then(e.helpers.validateODataV2)},n.prototype.subsites=function(){return this._dao.get(t+"/webinfos").then(e.helpers.validateODataV2)},n.prototype.permissions=function(){return e.permissions(t,this._dao)},e.Web=n}(SPScript),SPScript=window.SPScript||{},function(e){var t=null,n=function(e,n){this.listname=e,t="/web/lists/getbytitle('"+e+"')",this._dao=n};n.prototype.getItems=function(n){var r=null!=n?"?"+n:"";return this._dao.get(t+"/items"+r).then(e.helpers.validateODataV2)},n.prototype.getItemById=function(n){var r=t+"/items("+n+")";return this._dao.get(r).then(e.helpers.validateODataV2)},n.prototype.info=function(){return this._dao.get(t).then(e.helpers.validateODataV2)},n.prototype.addItem=function(e){var n=this;return n._dao.get(t).then(function(r){e=$.extend({__metadata:{type:r.d.ListItemEntityTypeFullName}},e);var i={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return n._dao.post(t+"/items",e,i)})},n.prototype.updateItem=function(e,t){var n=this;return n.getItemById(e).then(function(e){t=$.extend({__metadata:{type:e.__metadata.type}},t);var r={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return n._dao.post(url,t,r)})},n.prototype.findItems=function(e,t){var n="string"==typeof t?"'"+t+"'":t,r="$filter="+e+" eq "+n;return this.getItems(r)},n.prototype.findItem=function(e,t){return this.findItems(e,t).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},n.prototype.permissions=function(){return e.permissions(t,this._dao)},e.List=n}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(){var t=this;t.web=new e.Web(t)};t.prototype.executeRequest=function(){throw"Not implemented exception"},t.prototype.get=function(e,t){var n={method:"GET"};return t&&$.extend(n,t),this.executeRequest(e,n)},t.prototype.lists=function(t){return t?new e.List(t,this):this.get("/web/lists").then(e.helpers.validateODataV2)},t.prototype.post=function(e,t,n){var r=JSON.stringify(t),i={method:"POST",data:r,contentType:"application/json;odata=verbose"};return $.extend(i,n),this.executeRequest(e,i)},t.prototype.uploadFile=function(e,t,n){var r="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(r,n,i)},e.BaseDao=t}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(t){e.BaseDao.call(this),this.webUrl=t};t.prototype=new SPScript.BaseDao,t.prototype.executeRequest=function(e,t){var n=new $.Deferred,r=function(e){t.success?t.success(e,n):n.resolve(e)},i=function(e,r,i){t.error?t.error(e,r,i,n):n.reject(i)},o=this.webUrl+"/_api"+e,s={url:o,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:r,error:i};return $.extend(s,t),$.ajax(s),n.promise()},e.RestDao=t}(SPScript),SPScript=window.SPScript||{},function(e){e.queryString={_queryString:{},_processed:!1,_processQueryString:function(e){for(var t,n=e||window.location.search.substring(1),r=n.split("&"),i=0;i<r.length;i++)t=r[i].split("="),this._queryString[t[0]]=decodeURIComponent(t[1].replace(/\+/g," "));this._processed=!0},contains:function(e,t){return this._processed||this._processQueryString(t),this._queryString.hasOwnProperty(e)},getValue:function(e,t){return this._processed||this._processQueryString(t),this.contains(e)?this._queryString[e]:""},getAll:function(e){return this._processed||this._processQueryString(e),this._queryString},objectToQueryString:function(e,t){var n=[];for(var r in e)value=e[r],null!==value&&n.push(t?encodeURIComponent(r)+"='"+encodeURIComponent(value)+"'":encodeURIComponent(r)+"="+encodeURIComponent(value));return n.join("&")}}}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(e){this.dao=new SPScript.RestDao(e),this.webUrl=e};t.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var n=function(e){for(var t=[],n=0;n<e.length;n++){for(var r=e[n],i={},o=0;o<r.Cells.results.length;o++)i[r.Cells.results[o].Key]=r.Cells.results[o].Value;t.push(i)}return t},r=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=n(e.PrimaryQueryResult.RelevantResults.Table.Rows.results)};t.prototype.query=function(e,t){var n=this,i=null!=t?"&"+SPScript.queryString.objectToQueryString(t,!0):"",o=new $.Deferred,s="/search/query?querytext='"+e+"'"+i,a=n.dao.get(s);return a.done(function(e){if(e.d&&e.d.query){var t=new r(e.d.query);o.resolve(t)}else o.reject(e)}),o.promise()},e.Search=t}(SPScript),SPScript=window.SPScript||{},function(e){e.templating={Placeholder:function(e){this.raw=e,this.fullProperty=e.slice(2,e.length-2)},getPlaceHolders:function(e,t){var n=t||/\{\{[^\}]+\}\}?/g;return e.match(n)},getObjectValue:function(e,t){for(var n=e,r=t.split("."),i=0;i<r.length;i++){var o=r[i];n=null!=n[o]?n[o]:"Not Found: "+t}if("_"===t&&(n=e),"string"==typeof n&&-1!==n.indexOf("/Date(")){var s=n.UTCJsonToDate();n=s.toLocaleDateString()}return n},populateTemplate:function(e,t,n){for(var r=this.getPlaceHolders(e,n)||[],i=e,o=0;o<r.length;o++){var s=new this.Placeholder(r[o]);s.val=this.getObjectValue(t,s.fullProperty);var a=s.raw.replace("[","\\[").replace("]","\\]"),l="g";i=i.replace(new RegExp(a,l),s.val)}return i}},e.templating.Each={regExp:/\{\[[^\]]+\]\}?/g,populateEachTemplates:function(t,n){var r=$(t),i=r.find("[data-each]");i.each(function(){var t="",i=$(this).html(),o=$(this).data("each"),s=e.templating.getObjectValue(n,o);if(null!=s&&$.isArray(s))for(var a=0;a<s.length;a++)t+=e.templating.populateTemplate(i,s[a],e.templating.Each.regExp);r.find($(this)).html(t)});var o=r.clone().wrap("<div>");return o.parent().html()}},e.templating.renderTemplate=function(t,n,r){var i=e.templating.populateTemplate(t,n);return r&&(i=e.templating.Each.populateEachTemplates(i,n)),i}}(SPScript),String.prototype.UTCJsonToDate=function(){var e=this.substring(this.indexOf("(")+1);e=e.substring(0,e.indexOf(")"));var t=new Date(parseInt(e,10)),n=t.getTimezoneOffset()/60;return t.setHours(t.getHours()+n),t};