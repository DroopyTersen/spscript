SPScript=window.SPScript||{},function(t){var e={};e.validateODataV2=function(t,e){var n=t;return t.d&&t.d.results&&null!=t.d.results.length?n=t.d.results:t.d&&(n=t.d),e?void e.resolve(n):n},e.validateCrossDomainODataV2=function(t,e){var n=$.parseJSON(t.body);SPScript.helpers.validateODataV2(n,e)},t.helpers=e}(SPScript),SPScript=window.SPScript||{},function(t){t.models={},t.models.roleAssignment={},t.models.roleAssignment.fromRaw=function(t){var e={member:{login:t.Member.LoginName,name:t.Member.Title,id:t.Member.Id}};return e.roles=t.RoleDefinitionBindings.results.map(function(t){return{name:t.Name,description:t.Description}}),e}}(SPScript),SPScript=window.SPScript||{},function(t){var e="/web",n=function(t){this._dao=t};n.prototype.info=function(){return this._dao.get(e).then(t.helpers.validateODataV2)},n.prototype.subsites=function(){return this._dao.get(e+"/webinfos").then(t.helpers.validateODataV2)},n.prototype.permissions=function(){var n=e+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(n).then(t.helpers.validateODataV2).then(function(e){return e.map(t.models.roleAssignment.fromRaw)})},t.Web=n}(SPScript),SPScript=window.SPScript||{},function(t){var e=null,n=function(t,n){this.listname=t,e="/web/lists/getbytitle('"+t+"')",this._dao=n};n.prototype.getItems=function(n){var r=null!=n?"?"+n:"";return this._dao.get(e+"/items"+r).then(t.helpers.validateODataV2)},n.prototype.getItemById=function(n){var r=e+"/items("+n+")";return this._dao.get(r).then(t.helpers.validateODataV2)},n.prototype.info=function(){return this._dao.get(e).then(t.helpers.validateODataV2)},n.prototype.addItem=function(t){var n=this;return n._dao.get(e).then(function(r){t=$.extend({__metadata:{type:r.d.ListItemEntityTypeFullName}},t);var i={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return n._dao.post(e+"/items",t,i)})},n.prototype.updateItem=function(t,e){var n=this;return n.getItemById(t).then(function(t){e=$.extend({__metadata:{type:t.__metadata.type}},e);var r={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":t.__metadata.etag}};return n._dao.post(url,e,r)})},n.prototype.findItems=function(t,e){var n="string"==typeof e?"'"+e+"'":e,r="$filter="+t+" eq "+n;return this.getItems(r)},n.prototype.findItem=function(t,e){return this.findItems(t,e).then(function(t){return t&&t.length&&t.length>0?t[0]:null})},n.prototype.permissions=function(){var n=e+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(n).then(t.helpers.validateODataV2).then(function(e){return e.map(t.models.roleAssignment.fromRaw)})},t.List=n}(SPScript),SPScript=window.SPScript||{},function(t){var e=function(){var e=this;e.web=new t.Web(e)};e.prototype.executeRequest=function(){throw"Not implemented exception"},e.prototype.get=function(t,e){var n={method:"GET"};return e&&$.extend(n,e),this.executeRequest(t,n)},e.prototype.lists=function(e){return e?new t.List(e,this):this.get("/web/lists").then(t.helpers.validateODataV2)},e.prototype.post=function(t,e,n){var r=JSON.stringify(e),i={method:"POST",data:r,contentType:"application/json;odata=verbose"};return $.extend(i,n),this.executeRequest(t,i)},e.prototype.uploadFile=function(t,e,n){var r="/web/GetFolderByServerRelativeUrl('"+t+"')/Files/Add(url='"+e+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(r,n,i)},t.BaseDao=e}(SPScript),SPScript=window.SPScript||{},function(t){var e=function(e){t.BaseDao.call(this),this.webUrl=e};e.prototype=new SPScript.BaseDao,e.prototype.executeRequest=function(t,e){var n=new $.Deferred,r=function(t){e.success?e.success(t,n):n.resolve(t)},i=function(t,r,i){e.error?e.error(t,r,i,n):n.reject(i)},o=this.webUrl+"/_api"+t,s={url:o,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:r,error:i};return $.extend(s,e),$.ajax(s),n.promise()},t.RestDao=e}(SPScript),SPScript=window.SPScript||{},function(t){t.queryString={_queryString:{},_processed:!1,_processQueryString:function(t){for(var e,n=t||window.location.search.substring(1),r=n.split("&"),i=0;i<r.length;i++)e=r[i].split("="),this._queryString[e[0]]=decodeURIComponent(e[1].replace(/\+/g," "));this._processed=!0},contains:function(t,e){return this._processed||this._processQueryString(e),this._queryString.hasOwnProperty(t)},getValue:function(t,e){return this._processed||this._processQueryString(e),this.contains(t)?this._queryString[t]:""},getAll:function(t){return this._processed||this._processQueryString(t),this._queryString},objectToQueryString:function(t,e){var n=[];for(var r in t)value=t[r],null!==value&&n.push(e?encodeURIComponent(r)+"='"+encodeURIComponent(value)+"'":encodeURIComponent(r)+"="+encodeURIComponent(value));return n.join("&")}}}(SPScript),SPScript=window.SPScript||{},function(t){var e=function(t){this.dao=new SPScript.RestDao(t),this.webUrl=t};e.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var n=function(t){for(var e=[],n=0;n<t.length;n++){for(var r=t[n],i={},o=0;o<r.Cells.results.length;o++)i[r.Cells.results[o].Key]=r.Cells.results[o].Value;e.push(i)}return e},r=function(t){this.elapsedTime=t.ElapsedTime,this.suggestion=t.SpellingSuggestion,this.resultsCount=t.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=t.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=t.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=n(t.PrimaryQueryResult.RelevantResults.Table.Rows.results)};e.prototype.query=function(t,e){var n=this,i=null!=e?"&"+SPScript.queryString.objectToQueryString(e,!0):"",o=new $.Deferred,s="/search/query?querytext='"+t+"'"+i,a=n.dao.get(s);return a.done(function(t){if(t.d&&t.d.query){var e=new r(t.d.query);o.resolve(e)}else o.reject(t)}),o.promise()},t.Search=e}(SPScript),SPScript=window.SPScript||{},function(t){t.templating={Placeholder:function(t){this.raw=t,this.fullProperty=t.slice(2,t.length-2)},getPlaceHolders:function(t,e){var n=e||/\{\{[^\}]+\}\}?/g;return t.match(n)},getObjectValue:function(t,e){for(var n=t,r=e.split("."),i=0;i<r.length;i++){var o=r[i];n=null!=n[o]?n[o]:"Not Found: "+e}if("_"===e&&(n=t),"string"==typeof n&&-1!==n.indexOf("/Date(")){var s=n.UTCJsonToDate();n=s.toLocaleDateString()}return n},populateTemplate:function(t,e,n){for(var r=this.getPlaceHolders(t,n)||[],i=t,o=0;o<r.length;o++){var s=new this.Placeholder(r[o]);s.val=this.getObjectValue(e,s.fullProperty);var a=s.raw.replace("[","\\[").replace("]","\\]"),l="g";i=i.replace(new RegExp(a,l),s.val)}return i}},t.templating.Each={regExp:/\{\[[^\]]+\]\}?/g,populateEachTemplates:function(e,n){var r=$(e),i=r.find("[data-each]");i.each(function(){var e="",i=$(this).html(),o=$(this).data("each"),s=t.templating.getObjectValue(n,o);if(null!=s&&$.isArray(s))for(var a=0;a<s.length;a++)e+=t.templating.populateTemplate(i,s[a],t.templating.Each.regExp);r.find($(this)).html(e)});var o=r.clone().wrap("<div>");return o.parent().html()}},t.templating.renderTemplate=function(e,n,r){var i=t.templating.populateTemplate(e,n);return r&&(i=t.templating.Each.populateEachTemplates(i,n)),i}}(SPScript),String.prototype.UTCJsonToDate=function(){var t=this.substring(this.indexOf("(")+1);t=t.substring(0,t.indexOf(")"));var e=new Date(parseInt(t,10)),n=e.getTimezoneOffset()/60;return e.setHours(e.getHours()+n),e};