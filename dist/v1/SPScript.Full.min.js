SPScript=window.SPScript||{},function(t){var e=function(){};e.prototype.executeRequest=function(){throw"Not implemented exception"},e.prototype.get=function(t,e){var r={method:"GET"};return e&&$.extend(r,e),this.executeRequest(t,r)},e.prototype.lists=function(t){var e=this,r="/web/lists/getbytitle('"+t+"')",n=function(t){var n=null!=t?"?"+t:"";return e.get(r+"/items"+n).then(function(t){return t&&t.d&&t.d.results?t.d.results:t})},i=function(t){var n=r+"/items("+t+")";return e.get(n).then(function(t){return t.d?t.d:t})};return t?{info:function(){return e.get(r)},getItemById:i,getItems:n,addItem:function(t){return e.get(r).then(function(n){t=$.extend({__metadata:{type:n.d.ListItemEntityTypeFullName}},t);var i={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return e.post(r+"/items",t,i)})},updateItem:function(t,r){return i(t).then(function(t){r=$.extend({__metadata:{type:t.__metadata.type}},r);var n={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":t.__metadata.etag}};return e.post(url,r,n)})},items:{find:function(t,e){var r="$filter="+t+" eq '"+e+"'";return n(r)},findOne:function(t,e){var r="$filter="+t+" eq '"+e+"'";return n(r).then(function(t){return t&&t.length&&t.length>0?t[0]:null})}}}:e.get("/web/lists")},e.prototype.post=function(t,e,r){var n=JSON.stringify(e),i={method:"POST",data:n,contentType:"application/json;odata=verbose"};return $.extend(i,r),this.executeRequest(t,i)},e.prototype.uploadFile=function(t,e,r){var n="/web/GetFolderByServerRelativeUrl('"+t+"')/Files/Add(url='"+e+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(n,r,i)},t.BaseDao=e}(SPScript),SPScript=window.SPScript||{},function(t){var e=function(t){this.webUrl=t};e.prototype=new SPScript.BaseDao,e.prototype.executeRequest=function(t,e){var r=new $.Deferred,n=function(t){e.success?e.success(t,r):r.resolve(t)},i=function(t,n,i){e.error?e.error(t,n,i,r):r.reject(i)},a=this.webUrl+"/_api"+t,s={url:a,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:n,error:i};return $.extend(s,e),$.ajax(s),r.promise()},t.RestDao=e}(SPScript),SPScript=window.SPScript||{},function(t){var e=function(t){this.dao=new SPScript.RestDao(t),this.webUrl=t};e.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var r=function(t){for(var e=[],r=0;r<t.length;r++){for(var n=t[r],i={},a=0;a<n.Cells.results.length;a++)i[n.Cells.results[a].Key]=n.Cells.results[a].Value;e.push(i)}return e},n=function(t){this.elapsedTime=t.ElapsedTime,this.suggestion=t.SpellingSuggestion,this.resultsCount=t.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=t.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=t.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=r(t.PrimaryQueryResult.RelevantResults.Table.Rows.results)};e.prototype.query=function(t,e){var r=this,i=null!=e?"&"+SPScript.queryString.objectToQueryString(e,!0):"",a=new $.Deferred,s="/search/query?querytext='"+t+"'"+i,o=r.dao.get(s);return o.done(function(t){if(t.d&&t.d.query){var e=new n(t.d.query);a.resolve(e)}else a.reject(t)}),a.promise()},t.Search=e}(SPScript),SPScript=window.SPScript||{},function(t){t.templating={Placeholder:function(t){this.raw=t,this.fullProperty=t.slice(2,t.length-2)},getPlaceHolders:function(t,e){var r=e||/\{\{[^\}]+\}\}?/g;return t.match(r)},getObjectValue:function(t,e){for(var r=t,n=e.split("."),i=0;i<n.length;i++){var a=n[i];r=null!=r[a]?r[a]:"Not Found: "+e}if("_"===e&&(r=t),"string"==typeof r&&-1!==r.indexOf("/Date(")){var s=r.UTCJsonToDate();r=s.toLocaleDateString()}return r},populateTemplate:function(t,e,r){for(var n=this.getPlaceHolders(t,r)||[],i=t,a=0;a<n.length;a++){var s=new this.Placeholder(n[a]);s.val=this.getObjectValue(e,s.fullProperty);var o=s.raw.replace("[","\\[").replace("]","\\]"),l="g";i=i.replace(new RegExp(o,l),s.val)}return i}},t.templating.Each={regExp:/\{\[[^\]]+\]\}?/g,populateEachTemplates:function(e,r){var n=$(e),i=n.find("[data-each]");i.each(function(){var e="",i=$(this).html(),a=$(this).data("each"),s=t.templating.getObjectValue(r,a);if(null!=s&&$.isArray(s))for(var o=0;o<s.length;o++)e+=t.templating.populateTemplate(i,s[o],t.templating.Each.regExp);n.find($(this)).html(e)});var a=n.clone().wrap("<div>");return a.parent().html()}},t.templating.renderTemplate=function(e,r,n){var i=t.templating.populateTemplate(e,r);return n&&(i=t.templating.Each.populateEachTemplates(i,r)),i}}(SPScript),String.prototype.UTCJsonToDate=function(){var t=this.substring(this.indexOf("(")+1);t=t.substring(0,t.indexOf(")"));var e=new Date(parseInt(t,10)),r=e.getTimezoneOffset()/60;return e.setHours(e.getHours()+r),e};