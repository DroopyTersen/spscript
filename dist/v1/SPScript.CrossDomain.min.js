SPScript=window.SPScript||{},function(t){var e={};e.validateODataV2=function(t,e){var n=t;return t.d&&t.d.results&&null!=t.d.results.length?n=t.d.results:t.d&&(n=t.d),e?void e.resolve(n):n},e.validateCrossDomainODataV2=function(t,e){var n=$.parseJSON(t.body);SPScript.helpers.validateODataV2(n,e)},t.helpers=e}(SPScript),SPScript=window.SPScript||{},function(t){t.models={},t.models.roleAssignment={},t.models.roleAssignment.fromRaw=function(t){var e={member:{login:t.Member.LoginName,name:t.Member.Title,id:t.Member.Id}};return e.roles=t.RoleDefinitionBindings.results.map(function(t){return{name:t.Name,description:t.Description}}),e}}(SPScript),SPScript=window.SPScript||{},function(t){var e=null,n=function(t,n){this.listname=t,e="/web/lists/getbytitle('"+t+"')",this._dao=n};n.prototype.getItems=function(n){var r=null!=n?"?"+n:"";return this._dao.get(e+"/items"+r).then(t.helpers.validateODataV2)},n.prototype.getItemById=function(n){var r=e+"/items("+n+")";return this._dao.get(r).then(t.helpers.validateODataV2)},n.prototype.info=function(){return this._dao.get(e).then(t.helpers.validateODataV2)},n.prototype.addItem=function(t){var n=this;return n._dao.get(e).then(function(r){t=$.extend({__metadata:{type:r.d.ListItemEntityTypeFullName}},t);var i={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return n._dao.post(e+"/items",t,i)})},n.prototype.updateItem=function(t,e){var n=this;return n.getItemById(t).then(function(t){e=$.extend({__metadata:{type:t.__metadata.type}},e);var r={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":t.__metadata.etag}};return n._dao.post(url,e,r)})},n.prototype.findItems=function(t,e){var n="string"==typeof e?"'"+e+"'":e,r="$filter="+t+" eq "+n;return this.getItems(r)},n.prototype.findItem=function(t,e){return this.findItems(t,e).then(function(t){return t&&t.length&&t.length>0?t[0]:null})},n.prototype.permissions=function(){var n=e+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(n).then(t.helpers.validateODataV2).then(function(e){return e.map(t.models.roleAssignment.fromRaw)})},t.List=n}(SPScript),SPScript=window.SPScript||{},function(t){var e="/web",n=function(t){this._dao=t};n.prototype.info=function(){return this._dao.get(e).then(t.helpers.validateODataV2)},n.prototype.subsites=function(){return this._dao.get(e+"/webinfos").then(t.helpers.validateODataV2)},n.prototype.permissions=function(){var n=e+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(n).then(t.helpers.validateODataV2).then(function(e){return e.map(t.models.roleAssignment.fromRaw)})},t.Web=n}(SPScript),SPScript=window.SPScript||{},function(t){var e=function(){var e=this;e.web=new t.Web(e)};e.prototype.executeRequest=function(){throw"Not implemented exception"},e.prototype.get=function(t,e){var n={method:"GET"};return e&&$.extend(n,e),this.executeRequest(t,n)},e.prototype.lists=function(e){return e?new t.List(e,this):this.get("/web/lists").then(t.helpers.validateODataV2)},e.prototype.post=function(t,e,n){var r=JSON.stringify(e),i={method:"POST",data:r,contentType:"application/json;odata=verbose"};return $.extend(i,n),this.executeRequest(t,i)},e.prototype.uploadFile=function(t,e,n){var r="/web/GetFolderByServerRelativeUrl('"+t+"')/Files/Add(url='"+e+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(r,n,i)},t.BaseDao=e}(SPScript),SPScript=window.SPScript||{},function(t){var e=function(t,e){this.appUrl=t,this.hostUrl=e,this.scriptReady=new $.Deferred,SP&&SP.RequestExecutor?setTimeout(function(){this.scriptReady.resolve()},1):this.scriptReady=$.getScript(e+"/_layouts/15/SP.RequestExecutor.js")};e.prototype=new SPScript.BaseDao,e.prototype.executeRequest=function(e,n){var r=this,i=new $.Deferred,o=function(e){var r=$.parseJSON(e.body);n.success?n.success(r,i):t.helpers.validateODataV2(r,i)},a=function(t,e,r){n.error?n.error(t,e,r,i):i.reject(r)};return this.scriptReady.done(function(){-1===e.indexOf("?")&&(e+="?");var t=new SP.RequestExecutor(r.appUrl),i=r.appUrl+"/_api/SP.AppContextSite(@target)"+e+"@target='"+r.hostUrl+"'",s={url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:o,error:a};$.extend(!0,s,n),t.executeAsync(s)}),i.promise()},t.CrossDomainDao=e}(SPScript);