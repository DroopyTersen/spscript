SPScript=window.SPScript||{},function(e){var t={};t.validateODataV2=function(e,t){var n=e;return e.d&&e.d.results&&null!=e.d.results.length?n=e.d.results:e.d&&(n=e.d),t?void t.resolve(n):n},t.validateCrossDomainODataV2=function(e,t){var n=$.parseJSON(e.body);SPScript.helpers.validateODataV2(n,t)},t.arrayFromBitMask=function(e){"string"==typeof e&&(e=parseInt(e));for(var t=e,n=[];t;n.push(Boolean(1&t)),t>>>=1);return n},e.helpers=t}(SPScript),SPScript=window.SPScript||{},function(e){var t={roleAssignment:function(e){var t={member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id}};return t.roles=e.RoleDefinitionBindings.results.map(function(e){return{name:e.Name,description:e.Description,basePermissions:n(e.BasePermissions.Low,e.BasePermissions.High)}}),t}},n=function(e,t){var n=[];return r.forEach(function(i){((i.low&e)>0||(i.high&t)>0)&&n.push(i.name)}),n},i=function(i,r,o){if(!o){var a=i+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return r.get(a).then(e.helpers.validateODataV2).then(function(e){return e.map(t.roleAssignment)})}var s=function(t){var n=encodeURIComponent(t.LoginName),o=i+"/getusereffectivepermissions(@v)?@v='"+n+"'";return r.get(o).then(e.helpers.validateODataV2)};return r.web.getUser(o).then(s,function(){return[]}).then(function(e){return n(e.GetUserEffectivePermissions.Low,e.GetUserEffectivePermissions.High)}).fail(function(){throw"User not found"})},r=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}];e.permissions=i}(SPScript),SPScript=window.SPScript||{},function(e){var t=null,n=function(e,n){this.listname=e,t="/web/lists/getbytitle('"+e+"')",this._dao=n};n.prototype.getItems=function(n){var i=null!=n?"?"+n:"";return this._dao.get(t+"/items"+i).then(e.helpers.validateODataV2)},n.prototype.getItemById=function(n){var i=t+"/items("+n+")";return this._dao.get(i).then(e.helpers.validateODataV2)},n.prototype.info=function(){return this._dao.get(t).then(e.helpers.validateODataV2)},n.prototype.addItem=function(e){var n=this;return n._dao.get(t).then(function(i){e=$.extend({__metadata:{type:i.d.ListItemEntityTypeFullName}},e);var r={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return n._dao.post(t+"/items",e,r)})},n.prototype.updateItem=function(e,t){var n=this;return n.getItemById(e).then(function(e){t=$.extend({__metadata:{type:e.__metadata.type}},t);var i={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return n._dao.post(url,t,i)})},n.prototype.findItems=function(e,t){var n="string"==typeof t?"'"+t+"'":t,i="$filter="+e+" eq "+n;return this.getItems(i)},n.prototype.findItem=function(e,t){return this.findItems(e,t).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},n.prototype.permissions=function(n){return e.permissions(t,this._dao,n)},e.List=n}(SPScript),SPScript=window.SPScript||{},function(e){var t="/web",n=function(e){this._dao=e};n.prototype.info=function(){return this._dao.get(t).then(e.helpers.validateODataV2)},n.prototype.subsites=function(){return this._dao.get(t+"/webinfos").then(e.helpers.validateODataV2)},n.prototype.permissions=function(n){return e.permissions(t,this._dao,n)};n.prototype.getUser=function(n){var i=t+"/SiteUsers/GetByEmail('"+n+"')";return this._dao.get(i).then(e.helpers.validateODataV2)},e.Web=n}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(){var t=this;t.web=new e.Web(t)};t.prototype.executeRequest=function(){throw"Not implemented exception"},t.prototype.get=function(e,t){var n={method:"GET"};return t&&$.extend(n,t),this.executeRequest(e,n)},t.prototype.lists=function(t){return t?new e.List(t,this):this.get("/web/lists").then(e.helpers.validateODataV2)},t.prototype.post=function(e,t,n){var i=JSON.stringify(t),r={method:"POST",data:i,contentType:"application/json;odata=verbose"};return $.extend(r,n),this.executeRequest(e,r)},t.prototype.uploadFile=function(e,t,n){var i="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",r={binaryStringRequestBody:!0,state:"Update"};return this.post(i,n,r)},e.BaseDao=t}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(e,t){this.appUrl=e,this.hostUrl=t,this.scriptReady=new $.Deferred,SP&&SP.RequestExecutor?setTimeout(function(){this.scriptReady.resolve()},1):this.scriptReady=$.getScript(t+"/_layouts/15/SP.RequestExecutor.js")};t.prototype=new SPScript.BaseDao,t.prototype.executeRequest=function(t,n){var i=this,r=new $.Deferred,o=function(t){var i=$.parseJSON(t.body);n.success?n.success(i,r):e.helpers.validateODataV2(i,r)},a=function(e,t,i){n.error?n.error(e,t,i,r):r.reject(i)};return this.scriptReady.done(function(){-1===t.indexOf("?")&&(t+="?");var e=new SP.RequestExecutor(i.appUrl),r=i.appUrl+"/_api/SP.AppContextSite(@target)"+t+"@target='"+i.hostUrl+"'",s={url:r,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:o,error:a};$.extend(!0,s,n),e.executeAsync(s)}),r.promise()},e.CrossDomainDao=t}(SPScript);