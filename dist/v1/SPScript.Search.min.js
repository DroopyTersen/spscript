SPScript=window.SPScript||{},function(e){var t=function(){};t.prototype.executeRequest=function(){throw"Not implemented exception"},t.prototype.get=function(e,t){var r={method:"GET"};return t&&$.extend(r,t),this.executeRequest(e,r)},t.prototype.lists=function(e){var t=this,r="/web/lists/getbytitle('"+e+"')",n=function(e){var n=null!=e?"?"+e:"";return t.get(r+"/items"+n).then(function(e){return e&&e.d&&e.d.results?e.d.results:e})},s=function(e){var n=r+"/items("+e+")";return t.get(n).then(function(e){return e.d?e.d:e})};return e?{info:function(){return t.get(r)},getItemById:s,getItems:n,addItem:function(e){return t.get(r).then(function(n){e=$.extend({__metadata:{type:n.d.ListItemEntityTypeFullName}},e);var s={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return t.post(r+"/items",e,s)})},updateItem:function(e,r){return s(e).then(function(e){r=$.extend({__metadata:{type:e.__metadata.type}},r);var n={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return t.post(url,r,n)})},items:{find:function(e,t){var r="$filter="+e+" eq '"+t+"'";return n(r)},findOne:function(e,t){var r="$filter="+e+" eq '"+t+"'";return n(r).then(function(e){return e&&e.length&&e.length>0?e[0]:null})}}}:t.get("/web/lists")},t.prototype.post=function(e,t,r){var n=JSON.stringify(t),s={method:"POST",data:n,contentType:"application/json;odata=verbose"};return $.extend(s,r),this.executeRequest(e,s)},t.prototype.uploadFile=function(e,t,r){var n="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",s={binaryStringRequestBody:!0,state:"Update"};return this.post(n,r,s)},e.BaseDao=t}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(e){this.webUrl=e};t.prototype=new SPScript.BaseDao,t.prototype.executeRequest=function(e,t){var r=new $.Deferred,n=function(e){t.success?t.success(e,r):r.resolve(e)},s=function(e,n,s){t.error?t.error(e,n,s,r):r.reject(s)},i=this.webUrl+"/_api"+e,u={url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:n,error:s};return $.extend(u,t),$.ajax(u),r.promise()},e.RestDao=t}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(e){this.dao=new SPScript.RestDao(e),this.webUrl=e};t.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var r=function(e){for(var t=[],r=0;r<e.length;r++){for(var n=e[r],s={},i=0;i<n.Cells.results.length;i++)s[n.Cells.results[i].Key]=n.Cells.results[i].Value;t.push(s)}return t},n=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=r(e.PrimaryQueryResult.RelevantResults.Table.Rows.results)};t.prototype.query=function(e,t){var r=this,s=null!=t?"&"+SPScript.queryString.objectToQueryString(t,!0):"",i=new $.Deferred,u="/search/query?querytext='"+e+"'"+s,o=r.dao.get(u);return o.done(function(e){if(e.d&&e.d.query){var t=new n(e.d.query);i.resolve(t)}else i.reject(e)}),i.promise()},e.Search=t}(SPScript);