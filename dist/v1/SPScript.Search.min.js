SPScript=window.SPScript||{},function(e){var t={};t.validateODataV2=function(e,t){var n=e;return e.d&&e.d.results&&null!=e.d.results.length?n=e.d.results:e.d&&(n=e.d),t?void t.resolve(n):n},t.validateCrossDomainODataV2=function(e,t){var n=$.parseJSON(e.body);SPScript.helpers.validateODataV2(n,t)},e.helpers=t}(SPScript),SPScript=window.SPScript||{},function(e){e.models={},e.models.roleAssignment={},e.models.roleAssignment.fromRaw=function(e){var t={member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id}};return t.roles=e.RoleDefinitionBindings.results.map(function(e){return{name:e.Name,description:e.Description}}),t}}(SPScript),SPScript=window.SPScript||{},function(e){var t=null,n=function(e,n){this.listname=e,t="/web/lists/getbytitle('"+e+"')",this._dao=n};n.prototype.getItems=function(n){var r=null!=n?"?"+n:"";return this._dao.get(t+"/items"+r).then(e.helpers.validateODataV2)},n.prototype.getItemById=function(n){var r=t+"/items("+n+")";return this._dao.get(r).then(e.helpers.validateODataV2)},n.prototype.info=function(){return this._dao.get(t).then(e.helpers.validateODataV2)},n.prototype.addItem=function(e){var n=this;return n._dao.get(t).then(function(r){e=$.extend({__metadata:{type:r.d.ListItemEntityTypeFullName}},e);var i={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return n._dao.post(t+"/items",e,i)})},n.prototype.updateItem=function(e,t){var n=this;return n.getItemById(e).then(function(e){t=$.extend({__metadata:{type:e.__metadata.type}},t);var r={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return n._dao.post(url,t,r)})},n.prototype.findItems=function(e,t){var n="string"==typeof t?"'"+t+"'":t,r="$filter="+e+" eq "+n;return this.getItems(r)},n.prototype.findItem=function(e,t){return this.findItems(e,t).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},n.prototype.permissions=function(){var n=t+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(n).then(e.helpers.validateODataV2).then(function(t){return t.map(e.models.roleAssignment.fromRaw)})},e.List=n}(SPScript),SPScript=window.SPScript||{},function(e){var t="/web",n=function(e){this._dao=e};n.prototype.info=function(){return this._dao.get(t).then(e.helpers.validateODataV2)},n.prototype.subsites=function(){return this._dao.get(t+"/webinfos").then(e.helpers.validateODataV2)},n.prototype.permissions=function(){var n=t+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(n).then(e.helpers.validateODataV2).then(function(t){return t.map(e.models.roleAssignment.fromRaw)})},e.Web=n}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(){var t=this;t.web=new e.Web(t)};t.prototype.executeRequest=function(){throw"Not implemented exception"},t.prototype.get=function(e,t){var n={method:"GET"};return t&&$.extend(n,t),this.executeRequest(e,n)},t.prototype.lists=function(t){return t?new e.List(t,this):this.get("/web/lists").then(e.helpers.validateODataV2)},t.prototype.post=function(e,t,n){var r=JSON.stringify(t),i={method:"POST",data:r,contentType:"application/json;odata=verbose"};return $.extend(i,n),this.executeRequest(e,i)},t.prototype.uploadFile=function(e,t,n){var r="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(r,n,i)},e.BaseDao=t}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(t){e.BaseDao.call(this),this.webUrl=t};t.prototype=new SPScript.BaseDao,t.prototype.executeRequest=function(e,t){var n=new $.Deferred,r=function(e){t.success?t.success(e,n):n.resolve(e)},i=function(e,r,i){t.error?t.error(e,r,i,n):n.reject(i)},s=this.webUrl+"/_api"+e,o={url:s,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:r,error:i};return $.extend(o,t),$.ajax(o),n.promise()},e.RestDao=t}(SPScript),SPScript=window.SPScript||{},function(e){e.queryString={_queryString:{},_processed:!1,_processQueryString:function(e){for(var t,n=e||window.location.search.substring(1),r=n.split("&"),i=0;i<r.length;i++)t=r[i].split("="),this._queryString[t[0]]=decodeURIComponent(t[1].replace(/\+/g," "));this._processed=!0},contains:function(e,t){return this._processed||this._processQueryString(t),this._queryString.hasOwnProperty(e)},getValue:function(e,t){return this._processed||this._processQueryString(t),this.contains(e)?this._queryString[e]:""},getAll:function(e){return this._processed||this._processQueryString(e),this._queryString},objectToQueryString:function(e,t){var n=[];for(var r in e)value=e[r],null!==value&&n.push(t?encodeURIComponent(r)+"='"+encodeURIComponent(value)+"'":encodeURIComponent(r)+"="+encodeURIComponent(value));return n.join("&")}}}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(e){this.dao=new SPScript.RestDao(e),this.webUrl=e};t.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var n=function(e){for(var t=[],n=0;n<e.length;n++){for(var r=e[n],i={},s=0;s<r.Cells.results.length;s++)i[r.Cells.results[s].Key]=r.Cells.results[s].Value;t.push(i)}return t},r=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=n(e.PrimaryQueryResult.RelevantResults.Table.Rows.results)};t.prototype.query=function(e,t){var n=this,i=null!=t?"&"+SPScript.queryString.objectToQueryString(t,!0):"",s=new $.Deferred,o="/search/query?querytext='"+e+"'"+i,a=n.dao.get(o);return a.done(function(e){if(e.d&&e.d.query){var t=new r(e.d.query);s.resolve(t)}else s.reject(e)}),s.promise()},e.Search=t}(SPScript);