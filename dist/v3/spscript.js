!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("isomorphic-fetch")):"function"==typeof define&&define.amd?define("SPScript",["isomorphic-fetch"],e):"object"==typeof exports?exports.SPScript=e(require("isomorphic-fetch")):t.SPScript=e(t["isomorphic-fetch"])}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=16)}([function(t,e,n){"use strict";function r(){return!("undefined"==typeof window)}function o(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return null}return t}function i(t){t=o(t);var e=null;return t.d&&t.d.results&&null!=t.d.results.length?e=t.d.results:t.d&&(e=t.d),e||t}function s(t,e){f().then(function(){var n={title:" "},r=Object.assign({},n,e,{url:t});return SP.UI.ModalDialog.showModalDialog(r)})}Object.defineProperty(e,"__esModule",{value:!0});var a=n(22),u=n(25),c=n(26),l=n(27),h=function(t){if(t&&t instanceof File)return new Promise(function(e,n){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.readAsArrayBuffer(t)});throw"SPScript.utils.getArrayBuffer: Cant get ArrayBuffer if you don't pass in a file"},f=function(){return l.validateNamespace("SP.UI.ModalDialog")?Promise.resolve(!0):c.loadScript("/_layouts/15/1033/sp.res.js").then(function(){return c.loadScript("/_layouts/15/sp.ui.dialog.js")})},p={isBrowser:r,headers:u.default,parseJSON:o,validateODataV2:i,qs:{toObj:a.toObj,fromObj:a.fromObj},loadScript:c.loadScript,loadScripts:c.loadScripts,loadCSS:c.loadCSS,getArrayBuffer:h,waitForLibraries:l.waitForLibraries,waitForLibrary:l.waitForLibrary,validateNamespace:l.validateNamespace,waitForElement:l.waitForElement,openModal:s};e.default=p},,function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},,,function(e,n){e.exports=t},function(t,e,n){"use strict";e.decode=e.parse=n(23),e.encode=e.stringify=n(24)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o={method:"GET",credentials:"include",redirect:"follow"},i=function(t,e){var n=Object.assign({},o,e);return fetch(t,n).then(function(t){t.ok;return t.ok?t.text().then(function(t){return r.default.parseJSON(t)||t}):t.text().then(function(t){throw new Error(t)})})};e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(30),i=function(){function t(t,e){this.baseUrl=t,this._dao=e}return t.prototype.getRoleAssignments=function(){var t=this.baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(t).then(r.default.validateODataV2).then(function(t){return t.map(s)})},t.prototype.checkPrivs=function(t){var e=encodeURIComponent(t.LoginName),n=this.baseUrl+"/getusereffectivepermissions(@v)?@v='"+e+"'";return this._dao.get(n).then(r.default.validateODataV2)},t.prototype.check=function(t){var e=this;return t||r.default.isBrowser()?(t?this._dao.web.getUser(t):this._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(t){return t.d})).then(function(t){return e.checkPrivs(t)}).then(function(t){return a(t.GetUserEffectivePermissions.Low,t.GetUserEffectivePermissions.High)}):Promise.reject("Can't check permissions. No email passed and no current user")},t}();e.default=i;var s=function(t){return{member:{login:t.Member.LoginName,name:t.Member.Title,id:t.Member.Id},roles:t.RoleDefinitionBindings.results.map(function(t){return{name:t.Name,description:t.Description,basePermissions:a(t.BasePermissions.Low,t.BasePermissions.High)}})}},a=function(t,e){var n=[];return o.basePermissions.forEach(function(r){((r.low&t)>0||(r.high&e)>0)&&n.push(r.name)}),n}},,,,,,function(t,e,n){"use strict";n(17),n(5);var r=n(21);t.exports=r.default},function(t,e,n){"use strict";t.exports=n(18).polyfill()},function(t,e,n){(function(e,r){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   4.1.1
 */
!function(e,n){t.exports=n()}(0,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function o(t){return"function"==typeof t}function i(t){W=t}function s(t){z=t}function a(){return void 0!==G?function(){G(c)}:u()}function u(){var t=setTimeout;return function(){return t(c,1)}}function c(){for(var t=0;t<H;t+=2){(0,X[t])(X[t+1]),X[t]=void 0,X[t+1]=void 0}H=0}function l(t,e){var n=arguments,r=this,o=new this.constructor(f);void 0===o[tt]&&R(o);var i=r._state;return i?function(){var t=n[i-1];z(function(){return C(i,o,t,r._result)})}():j(r,o,t,e),o}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(f);return w(n,t),n}function f(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function m(t){try{return t.then}catch(t){return ot.error=t,ot}}function v(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function g(t,e,n){z(function(t){var r=!1,o=v(n,e,function(n){r||(r=!0,e!==n?w(t,n):O(t,n))},function(e){r||(r=!0,S(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,S(t,o))},t)}function y(t,e){e._state===nt?O(t,e._result):e._state===rt?S(t,e._result):j(e,void 0,function(e){return w(t,e)},function(e){return S(t,e)})}function b(t,e,n){e.constructor===t.constructor&&n===l&&e.constructor.resolve===h?y(t,e):n===ot?(S(t,ot.error),ot.error=null):void 0===n?O(t,e):o(n)?g(t,e,n):O(t,e)}function w(e,n){e===n?S(e,p()):t(n)?b(e,n,m(n)):O(e,n)}function _(t){t._onerror&&t._onerror(t._result),P(t)}function O(t,e){t._state===et&&(t._result=e,t._state=nt,0!==t._subscribers.length&&z(P,t))}function S(t,e){t._state===et&&(t._state=rt,t._result=e,z(_,t))}function j(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+nt]=n,o[i+rt]=r,0===i&&t._state&&z(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?C(n,r,o,i):o(i);t._subscribers.length=0}}function A(){this.error=null}function T(t,e){try{return t(e)}catch(t){return it.error=t,it}}function C(t,e,n,r){var i=o(n),s=void 0,a=void 0,u=void 0,c=void 0;if(i){if(s=T(n,r),s===it?(c=!0,a=s.error,s.error=null):u=!0,e===s)return void S(e,d())}else s=r,u=!0;e._state!==et||(i&&u?w(e,s):c?S(e,a):t===nt?O(e,s):t===rt&&S(e,s))}function x(t,e){try{e(function(e){w(t,e)},function(e){S(t,e)})}catch(e){S(t,e)}}function I(){return st++}function R(t){t[tt]=st++,t._state=void 0,t._result=void 0,t._subscribers=[]}function U(t,e){this._instanceConstructor=t,this.promise=new t(f),this.promise[tt]||R(this.promise),B(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&O(this.promise,this._result))):S(this.promise,E())}function E(){return new Error("Array Methods must be provided an Array")}function k(t){return new U(this,t).promise}function N(t){var e=this;return new e(B(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function D(t){var e=this,n=new e(f);return S(n,t),n}function q(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function M(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(t){this[tt]=I(),this._result=this._state=void 0,this._subscribers=[],f!==t&&("function"!=typeof t&&q(),this instanceof F?x(this,t):M())}function V(){var t=void 0;if(void 0!==r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=F}var L=void 0;L=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var B=L,H=0,G=void 0,W=void 0,z=function(t,e){X[H]=t,X[H+1]=e,2===(H+=2)&&(W?W(c):Z())},Q="undefined"!=typeof window?window:void 0,J=Q||{},Y=J.MutationObserver||J.WebKitMutationObserver,$="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),K="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,X=new Array(1e3),Z=void 0;Z=$?function(){return function(){return e.nextTick(c)}}():Y?function(){var t=0,e=new Y(c),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():K?function(){var t=new MessageChannel;return t.port1.onmessage=c,function(){return t.port2.postMessage(0)}}():void 0===Q?function(){try{var t=n(20);return G=t.runOnLoop||t.runOnContext,a()}catch(t){return u()}}():u();var tt=Math.random().toString(36).substring(16),et=void 0,nt=1,rt=2,ot=new A,it=new A,st=0;return U.prototype._enumerate=function(t){for(var e=0;this._state===et&&e<t.length;e++)this._eachEntry(t[e],e)},U.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=m(t);if(o===l&&t._state!==et)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===F){var i=new n(f);b(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},U.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===et&&(this._remaining--,t===rt?S(r,n):this._result[e]=n),0===this._remaining&&O(r,this._result)},U.prototype._willSettleAt=function(t,e){var n=this;j(t,void 0,function(t){return n._settledAt(nt,e,t)},function(t){return n._settledAt(rt,e,t)})},F.all=k,F.race=N,F.resolve=h,F.reject=D,F._setScheduler=i,F._setAsap=s,F._asap=z,F.prototype={constructor:F,then:l,catch:function(t){return this.then(null,t)}},F.polyfill=V,F.Promise=F,F})}).call(e,n(19),n(2))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function i(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){m&&p&&(m=!1,p.length?d=p.concat(d):v=-1,d.length&&a())}function a(){if(!m){var t=o(s);m=!0;for(var e=d.length;e;){for(p=d,d=[];++v<e;)p&&p[v].run();v=-1,e=d.length}p=null,m=!1,i(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var l,h,f=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var p,d=[],m=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new u(t,e)),1!==d.length||m||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e){},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(28),i=n(41),s={utils:r.default,CSR:i.default,createContext:function(e,n){try{return!e&&t._spPageContextInfo&&(e=t._spPageContextInfo.webAbsoluteUrl),new o.default(e,n)}catch(t){throw new Error("Unable to create SPScript Context: "+t.message)}}};e.default=s}).call(e,n(2))},function(t,e,n){"use strict";function r(t,e){var n=function(n){var r=(t[n]+"").trim();return(r.indexOf(" ")>-1||e)&&(r="'"+r+"'"),n+"="+r};return Object.keys(t).map(n).join("&")}function o(t){return void 0===t&&window&&window.location&&window.location.search&&(t=window.location.search),t?("?"===t[0]&&(t=t.substr(1)),i.parse(t)):{}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(6);e.fromObj=r,e.toObj=o},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,i){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var h,f,p,d,m=t[l].replace(a,"%20"),v=m.indexOf(n);v>=0?(h=m.substr(0,v),f=m.substr(v+1)):(h=m,f=""),p=decodeURIComponent(h),d=decodeURIComponent(f),r(s,p)?o(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var o=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(s(t),function(s){var a=encodeURIComponent(o(s))+n;return i(t[s])?r(t[s],function(t){return a+encodeURIComponent(o(t))}).join(e):a+encodeURIComponent(o(t[s]))}).join(e):a?encodeURIComponent(o(a))+n+encodeURIComponent(o(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){"use strict";function r(t){var e={Accept:o,"Content-Type":o};return t&&(e["X-RequestDigest"]=t),e}Object.defineProperty(e,"__esModule",{value:!0});var o="application/json;odata=verbose",i=r,s=function(t){return{Accept:o,"X-RequestDigest":t,"Content-Type":"application/octet-stream",binaryStringRequestBody:"true"}},a=function(t,e){return Object.assign({},r(e),{"X-HTTP-Method":t})},u=function(t,e){return e&&(t["If-Match"]=e),t},c=function(t,e){return u(a("MERGE",t),e)},l=function(t,e){return u(a("DELETE",t),e)},h={getStandardHeaders:r,getAddHeaders:i,getFilestreamHeaders:s,getUpdateHeaders:c,getDeleteHeaders:l,getActionHeaders:a};e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loadCSS=function(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t),document.querySelector("head").appendChild(e)},e.loadScript=function(t){return new Promise(function(e,n){var r=window.document.createElement("script"),o=document.getElementsByTagName("script")[0];r.async=!0,o.parentNode.insertBefore(r,o),r.onload=r.onreadystatechange=function(t,n){(n||!r.readyState||/loaded|complete/.test(r.readyState))&&(r.onload=r.onreadystatechange=null,r=void 0,n||e())},r.src=t})},e.loadScripts=function(t){return Promise.all(t.map(e.loadScript))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateNamespace=function(t){for(var e=window,n=t.split("."),r=n.length,o=0;o<r;o++){var i=n[o];if(!(i in e))return!1;e=e[i]}return!0};var r=function(t,n){0===t.filter(function(t){return!e.validateNamespace(t)}).length?n():setTimeout(function(){return r(t,n)},25)};e.waitForLibraries=function(t){return new Promise(function(e,n){return r(t,e)})},e.waitForLibrary=function(t){return e.waitForLibraries([t])},e.waitForElement=function(t,e){void 0===e&&(e=5e3);var n=0,r=e/25;return new Promise(function(e,o){var i=function(){n>r&&o("Unable to find element: "+t);var s=document.querySelector(t);s?e(s):(n++,setTimeout(i,25))};i()})}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),s=n(0),a=n(29),u=n(31),c=n(32),l=n(34),h=n(36),f=n(37),p=function(){function t(t,e){void 0===e&&(e={});var n=this;this.webUrl=t,this.clientId=e.clientId,this.clientSecret=e.clientSecret,this.ensureToken=e.clientId?f.getAppOnlyToken(t,e.clientId,e.clientSecret).then(function(t){return n.accessToken=t}):Promise.resolve(!0),this.search=new c.default(this),this.customActions=new l.default(this),this.web=new u.default(this),this.profiles=new h.default(this)}return t.prototype.executeRequest=function(t,e){return r(this,void 0,void 0,function(){var n,r,s;return o(this,function(o){switch(o.label){case 0:return[4,this.ensureToken];case 1:return o.sent(),n=/^http/i.test(t)?t:this.webUrl+"/_api"+t,r={method:"GET",headers:{Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}},s=Object.assign({},r,e),this.accessToken&&(s.headers.Authorization="Bearer "+this.accessToken),[2,i.default(n,s)]}})})},t.prototype.get=function(t,e){var n=Object.assign({},{method:"GET"},e);return this.executeRequest(t,n).then(s.default.parseJSON)},t.prototype.post=function(t,e,n){e=this._packagePostBody(e,n);var r={method:"POST",body:e};return r=Object.assign({},r,n),this.executeRequest(t,r).then(s.default.parseJSON)},t.prototype.authorizedPost=function(t,e,n){var r=this;return this.getRequestDigest().then(function(t){return s.default.headers.getActionHeaders(n,t)}).then(function(n){return r.post(t,e,{headers:n})})},t.prototype._ensureRequestDigest=function(t){return t?Promise.resolve(t):this.getRequestDigest()},t.prototype.getRequestDigest=function(){return this.post("/contextInfo",{}).then(function(t){return t.d.GetContextWebInformation.FormDigestValue})},t.prototype.lists=function(t){return new a.default(t,this)},t.prototype._packagePostBody=function(t,e){return"string"==typeof t?t:e&&e.headers&&e.headers["Content-Type"]&&-1===e.headers["Content-Type"].indexOf("json")?t:JSON.stringify(t)},t}();e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(10),i=function(){function t(t,e){this.listName=t,this.baseUrl="/web/lists/getbytitle('"+this.listName+"')",this._dao=e,this.permissions=new o.default(this.baseUrl,e)}return t.prototype.getItems=function(t){return this._dao.get(this.baseUrl+"/items"+s(t)).then(r.default.validateODataV2)},t.prototype.getItemById=function(t,e){var n=this.baseUrl+"/items("+t+")"+s(e);return this._dao.get(n).then(r.default.validateODataV2)},t.prototype.getItemsByView=function(t){var e=this,n=this.baseUrl+"/Views/getByTitle('"+t+"')/ViewQuery";return this._dao.get(n).then(r.default.validateODataV2).then(function(t){var n=e.baseUrl+"/GetItems",r={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:t.ViewQuery}};return e._dao.authorizedPost(n,r)}).then(r.default.validateODataV2)},t.prototype.findItems=function(t,e,n){return n="$filter="+t+" eq "+("string"==typeof e?"'"+e+"'":e)+s(n,"&"),this.getItems(n)},t.prototype.findItem=function(t,e,n){return this.findItems(t,e,n).then(function(t){return t&&t.length&&t.length>0?t[0]:null})},t.prototype.getInfo=function(){return this._dao.get(this.baseUrl).then(r.default.validateODataV2)},t.prototype.addItem=function(t,e){var n=this;return this._dao._ensureRequestDigest(e).then(function(e){return n._dao.get(n.baseUrl).then(function(o){t=Object.assign({},{__metadata:{type:o.d.ListItemEntityTypeFullName}},t);var i={headers:r.default.headers.getAddHeaders(e)};return n._dao.post(n.baseUrl+"/items",t,i)}).then(r.default.validateODataV2)})},t.prototype.updateItem=function(t,e,n){var o=this;return this._dao._ensureRequestDigest(n).then(function(n){return o.getItemById(t).then(function(t){e=Object.assign({},{__metadata:{type:t.__metadata.type}},e);var i={headers:r.default.headers.getUpdateHeaders(n,t.__metadata.etag)};return o._dao.post(t.__metadata.uri,e,i)})})},t.prototype.deleteItem=function(t,e){var n=this;return this._dao._ensureRequestDigest(e).then(function(e){return n.getItemById(t).then(function(t){var o={headers:r.default.headers.getDeleteHeaders(e,t.__metadata.etag)};return n._dao.post(t.__metadata.uri,"",o)})})},t}();e.default=i;var s=function(t,e){return e=e||"?",t?e+t:""}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.basePermissions=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(10),i=function(){function t(t){this.baseUrl="/web",this._dao=t,this.permissions=new o.default(this.baseUrl,t)}return t.prototype.getInfo=function(){return this._dao.get(this.baseUrl).then(r.default.validateODataV2)},t.prototype.getSubsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(r.default.validateODataV2)},t.prototype.getUser=function(t){var e=t?this.baseUrl+"/SiteUsers/GetByEmail('"+t+"')":this.baseUrl+"/CurrentUser";return this._dao.get(e).then(r.default.validateODataV2)},t.prototype.ensureUser=function(t){return this._dao.post("/web/ensureUser('"+t+"')").then(r.default.validateODataV2)},t.prototype.getFile=function(t){var t="/web/getfilebyserverrelativeurl('"+t+"')";return this._dao.get(t).then(r.default.validateODataV2)},t.prototype._copyFile=function(t,e,n){var o="/web/getfilebyserverrelativeurl('"+t+"')/CopyTo",i={headers:r.default.headers.getAddHeaders(n)},s={strNewUrl:e,bOverWrite:!0};return this._dao.post(o,s,i)},t.prototype.copyFile=function(t,e,n){var r=this;return this._dao._ensureRequestDigest(n).then(function(n){return r._copyFile(t,e,n)})},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(33),i=function(){function t(t){this._dao=t}return Object.defineProperty(t.prototype,"defaultQueryOptions",{get:function(){return{sourceid:null,startrow:null,rowlimit:100,selectedproperties:null,refiners:null,refinementfilters:null,hiddencontstraints:null,sortlist:null}},enumerable:!0,configurable:!0}),t.prototype.query=function(t,e){void 0===e&&(e={});var n=r.default.qs.fromObj(e,!0),i="/search/query?querytext='"+t+"'&"+n;return this._dao.get(i).then(r.default.validateODataV2).then(function(t){if(t.query)return o.mapResponse(t.query);throw new Error("Invalid response back from search service")})},t.prototype.people=function(t,e){return void 0===e&&(e={}),e.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(t,e)},t.prototype.sites=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===n&&(n={}),e=e?"Path:"+e+"*":"";var r=(t+" contentclass:STS_Web "+e).trim();return n.rowlimit=n.rowlimit||499,this.query(r,n)},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapResponse=function(t){return{elapsedTime:t.ElapsedTime,suggestion:t.SpellingSuggestion,resultsCount:t.PrimaryQueryResult.RelevantResults.RowCount,totalResults:t.PrimaryQueryResult.RelevantResults.TotalRows,totalResultsIncludingDuplicates:t.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,items:e.mapItems(t.PrimaryQueryResult.RelevantResults.Table.Rows.results),refiners:e.mapRefiners(t.PrimaryQueryResult.RefinementResults)}},e.mapRefiners=function(t){var e=[];return t&&t.Refiners&&t.Refiners.results&&(e=t.Refiners.results.map(function(t){return{RefinerName:t.Name,RefinerOptions:t.Entries.results}})),e},e.mapItems=function(t){for(var e=[],n=0;n<t.length;n++){for(var r=t[n],o={},i=0;i<r.Cells.results.length;i++)o[r.Cells.results[i].Key]=r.Cells.results[i].Value;e.push(o)}return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(35),i=function(){function t(t){this._dao=t}return t.prototype.getScope=function(t){if(3===t)return o.scopes.Web;if(2===t)return o.scopes.Site;throw new Error("Invalid Custom Action Scope")},t.prototype.get=function(t){var e=this;return this._dao.get(o.scopes.Site.url).then(r.default.validateODataV2).then(function(t){return e._dao.get(o.scopes.Web.url).then(r.default.validateODataV2).then(function(e){return t.concat(e)})}).then(function(e){if(t){var n=e.filter(function(e){return e.Name===t});if(n.length)return n[0];throw new Error("Unable to find Custom Action with name: "+t)}return e})},t.prototype._getUrl=function(t){var e=this;return this.get(t).then(function(t){return e.getScope(t.Scope).url+"('"+t.Id+"')"})},t.prototype._getUrlAndDigest=function(t){var e=this,n={};return this._getUrl(t).then(function(t){return n.url=t,e._dao.getRequestDigest()}).then(function(t){return n.digest=t,n})},t.prototype.update=function(t){var e=this;if(!t||!t.Name)throw new Error("You must at least pass a Custom Action 'Name'");return this._getUrlAndDigest(t.Name).then(function(n){t=Object.assign({},o.metadata,t);var i={headers:r.default.headers.getUpdateHeaders(n.digest)};return e._dao.post(n.url,t,i)})},t.prototype.remove=function(t){var e=this;if(!t)throw new Error("You must at least pass an existing Custom Action name");return this._getUrlAndDigest(t).then(function(t){var n={headers:r.default.headers.getDeleteHeaders(t.digest)};return e._dao.post(t.url,{},n)})},t.prototype.add=function(t){var e=this;if(!t||!t.Name)throw new Error("You must at least pass a Custom Action 'Name'");var n={Name:t.Name,Title:t.Name,Description:t.Name,Group:t.Name,Sequence:100,Scope:"Site",Location:"ScriptLink"};return t=Object.assign({},n,t),this.get().then(function(n){return!n.filter(function(e){return e.Name===t.Name}).length||e.remove(t.Name)}).then(function(){return e._dao.getRequestDigest()}).then(function(n){t=Object.assign({},o.metadata,t);var i=o.scopes[t.Scope];t.Scope=i.id;var s={headers:r.default.headers.getAddHeaders(n)};return e._dao.post(i.url,t,s)})},t.prototype.addScriptBlock=function(t,e,n){void 0===n&&(n={});var r={Name:t,ScriptBlock:e};return r=Object.assign({},r,n),this.add(r)},t.prototype.addCSSLink=function(t,e,n){void 0===n&&(n={});var r='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar styleTag = document.createElement("style");\n\t\t\tstyleTag.appendChild(document.createTextNode("body { opacity: 0 }"));\n\t\t\t\n\t\t\tvar linkTag = document.createElement("link");\n\t\t\tlinkTag.rel = "stylesheet";\tlinkTag.href = "'+e+'"; linkTag.type = "text/css";\n\t\t\tlinkTag.addEventListener("load", function() {\n\t\t\t\thead.removeChild(styleTag);\n\t\t\t});\n\n\t\t\thead.appendChild(styleTag);\n\t\t\thead.appendChild(linkTag);\n\t\t})();';return this.addScriptBlock(t,r,n)},t.prototype.addScriptLink=function(t,e,n){void 0===n&&(n={});var r='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar scriptTag = document.createElement("script");\n            scriptTag.src = "'+e+'";\n            scriptTag.type = "text/javascript";\n\t\t\thead.appendChild(scriptTag);\n\t\t})();';return this.addScriptBlock(t,r,n)},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.metadata={__metadata:{type:"SP.UserCustomAction"}},e.scopes={Web:{id:3,name:"Web",url:"/web/usercustomactions"},Site:{id:2,name:"Site",url:"/site/usercustomactions"}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(){function t(t){this._dao=t,this.baseUrl="/SP.UserProfiles.PeopleManager"}return t.prototype.current=function(){var t=this.baseUrl+"/GetMyProperties";return this._dao.get(t).then(r.default.validateODataV2).then(i)},t.prototype.get=function(t){var e=this;return t?this.getUserObj(t).then(function(t){var n=encodeURIComponent(t.LoginName||t.AccountName),o=e.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+n+"'";return e._dao.get(o).then(r.default.validateODataV2).then(i)}):this.current()},t.prototype.getUserObj=function(t){if(t&&"string"!=typeof t){if(t.AccountName||t.LoginName)return Promise.resolve(t);throw new Error("profiles.setProperty Error: Invalid user parameter")}return this._dao.web.getUser(t)},t.prototype.setProperty=function(t,e,n){var r=this;return this.getUserObj(n).then(function(n){var o={propertyName:t,propertyValue:e,accountName:n.LoginName||n.AccountName},i=r.baseUrl+"/SetSingleValueProfileProperty";return r._dao.authorizedPost(i,o)})},t}();e.default=o;var i=function(t){return t.UserProfileProperties.results.forEach(function(e){t[e.Key]=e.Value}),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(38),o=n(6),i=n(9);e.getAppOnlyToken=function(t,e,n){var a=r.parse(t);return s(t).then(function(t){var r="https://accounts.accesscontrol.windows.net/"+t.realm+"/tokens/OAuth/2",s=e+"@"+t.realm,u=t.client_id+"/"+a.host+"@"+t.realm,c={grant_type:"client_credentials",client_id:s,client_secret:n,resource:u,scope:u},l=o.stringify(c),h={method:"POST",body:l,headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":l.length}};return i.default(r,h).then(function(t){return t.access_token})})};var s=function(t){var e=t+"/_api/web",n={method:"GET",headers:{Authorization:"Bearer ",Accept:"application/json;odata=verbose",response_type:"code"}};return new Promise(function(t,r){fetch(e,n).then(function(e){if(!e.ok){var n=a(e.headers["www-authenticate"]||e.headers._headers["www-authenticate"][0]);t(n)}r("Get Realm succeeded somehow?!")})})},a=function(t){if(t&&t.startsWith("Bearer")){t=t.substr(7);return t.split(",").filter(function(t){return t.indexOf("=")>-1}).reduce(function(t,e){var n=e.split("=");return 2===n.length&&(t[n[0].trim()]=n[1].trim().replace(/\"/g,"")),t},{})}return null}},function(t,e,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,n){if(t&&c.isObject(t)&&t instanceof r)return t;var o=new r;return o.parse(t,e,n),o}function i(t){return c.isString(t)&&(t=o(t)),t instanceof r?t.format():r.prototype.format.call(t)}function s(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}var u=n(39),c=n(40);e.parse=o,e.resolve=s,e.resolveObject=a,e.format=i,e.Url=r;var l=/^([a-z0-9.+-]+:)/i,h=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(p),m=["'"].concat(d),v=["%","/","?",";","#"].concat(m),g=["/","?","#"],y=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,w={javascript:!0,"javascript:":!0},_={javascript:!0,"javascript:":!0},O={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=n(6);r.prototype.parse=function(t,e,n){if(!c.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),o=-1!==r&&r<t.indexOf("#")?"?":"#",i=t.split(o),s=/\\/g;i[0]=i[0].replace(s,"/"),t=i.join(o);var a=t;if(a=a.trim(),!n&&1===t.split("#").length){var h=f.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],this.query=e?S.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var p=l.exec(a);if(p){p=p[0];var d=p.toLowerCase();this.protocol=d,a=a.substr(p.length)}if(n||p||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var j="//"===a.substr(0,2);!j||p&&_[p]||(a=a.substr(2),this.slashes=!0)}if(!_[p]&&(j||p&&!O[p])){for(var P=-1,A=0;A<g.length;A++){var T=a.indexOf(g[A]);-1!==T&&(-1===P||T<P)&&(P=T)}var C,x;x=-1===P?a.lastIndexOf("@"):a.lastIndexOf("@",P),-1!==x&&(C=a.slice(0,x),a=a.slice(x+1),this.auth=decodeURIComponent(C)),P=-1;for(var A=0;A<v.length;A++){var T=a.indexOf(v[A]);-1!==T&&(-1===P||T<P)&&(P=T)}-1===P&&(P=a.length),this.host=a.slice(0,P),a=a.slice(P),this.parseHost(),this.hostname=this.hostname||"";var I="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!I)for(var R=this.hostname.split(/\./),A=0,U=R.length;A<U;A++){var E=R[A];if(E&&!E.match(y)){for(var k="",N=0,D=E.length;N<D;N++)E.charCodeAt(N)>127?k+="x":k+=E[N];if(!k.match(y)){var q=R.slice(0,A),M=R.slice(A+1),F=E.match(b);F&&(q.push(F[1]),M.unshift(F[2])),M.length&&(a="/"+M.join(".")+a),this.hostname=q.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),I||(this.hostname=u.toASCII(this.hostname));var V=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+V,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!w[d])for(var A=0,U=m.length;A<U;A++){var B=m[A];if(-1!==a.indexOf(B)){var H=encodeURIComponent(B);H===B&&(H=escape(B)),a=a.split(B).join(H)}}var G=a.indexOf("#");-1!==G&&(this.hash=a.substr(G),a=a.slice(0,G));var W=a.indexOf("?");if(-1!==W?(this.search=a.substr(W),this.query=a.substr(W+1),e&&(this.query=S.parse(this.query)),a=a.slice(0,W)):e&&(this.search="",this.query={}),a&&(this.pathname=a),O[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var V=this.pathname||"",z=this.search||"";this.path=V+z}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(i=S.stringify(this.query));var s=this.search||i&&"?"+i||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||O[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+o+n+s+r},r.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(c.isString(t)){var e=new r;e.parse(t,!1,!0),t=e}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var s=o[i];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),u=0;u<a.length;u++){var l=a[u];"protocol"!==l&&(n[l]=t[l])}return O[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!O[t.protocol]){for(var h=Object.keys(t),f=0;f<h.length;f++){var p=h[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||_[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var m=n.pathname||"",v=n.search||"";n.path=m+v}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var g=n.pathname&&"/"===n.pathname.charAt(0),y=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=y||g||n.host&&t.pathname,w=b,S=n.pathname&&n.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],j=n.protocol&&!O[n.protocol];if(j&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),b=b&&(""===d[0]||""===S[0])),y)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,S=d;else if(d.length)S||(S=[]),S.pop(),S=S.concat(d),n.search=t.search,n.query=t.query;else if(!c.isNullOrUndefined(t.search)){if(j){n.hostname=n.host=S.shift();var P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");P&&(n.auth=P.shift(),n.host=n.hostname=P.shift())}return n.search=t.search,n.query=t.query,c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var A=S.slice(-1)[0],T=(n.host||t.host||S.length>1)&&("."===A||".."===A)||""===A,C=0,x=S.length;x>=0;x--)A=S[x],"."===A?S.splice(x,1):".."===A?(S.splice(x,1),C++):C&&(S.splice(x,1),C--);if(!b&&!w)for(;C--;C)S.unshift("..");!b||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),T&&"/"!==S.join("/").substr(-1)&&S.push("");var I=""===S[0]||S[0]&&"/"===S[0].charAt(0);if(j){n.hostname=n.host=I?"":S.length?S.shift():"";var P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");P&&(n.auth=P.shift(),n.host=n.hostname=P.shift())}return b=b||n.host&&S.length,b&&!I&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=h.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){(function(t,r){var o;!function(i){function s(t){throw new RangeError(U[t])}function a(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function u(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(R,"."),r+a(t.split("."),e).join(".")}function c(t){for(var e,n,r=[],o=0,i=t.length;o<i;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<i?(n=t.charCodeAt(o++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--)):r.push(e);return r}function l(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=N(t>>>10&1023|55296),t=56320|1023&t),e+=N(t)}).join("")}function h(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:_}function f(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function p(t,e,n){var r=0;for(t=n?k(t/P):t>>1,t+=k(t/e);t>E*S>>1;r+=_)t=k(t/E);return k(r+(E+1)*t/(t+j))}function d(t){var e,n,r,o,i,a,u,c,f,d,m=[],v=t.length,g=0,y=T,b=A;for(n=t.lastIndexOf(C),n<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&s("not-basic"),m.push(t.charCodeAt(r));for(o=n>0?n+1:0;o<v;){for(i=g,a=1,u=_;o>=v&&s("invalid-input"),c=h(t.charCodeAt(o++)),(c>=_||c>k((w-g)/a))&&s("overflow"),g+=c*a,f=u<=b?O:u>=b+S?S:u-b,!(c<f);u+=_)d=_-f,a>k(w/d)&&s("overflow"),a*=d;e=m.length+1,b=p(g-i,e,0==i),k(g/e)>w-y&&s("overflow"),y+=k(g/e),g%=e,m.splice(g++,0,y)}return l(m)}function m(t){var e,n,r,o,i,a,u,l,h,d,m,v,g,y,b,j=[];for(t=c(t),v=t.length,e=T,n=0,i=A,a=0;a<v;++a)(m=t[a])<128&&j.push(N(m));for(r=o=j.length,o&&j.push(C);r<v;){for(u=w,a=0;a<v;++a)(m=t[a])>=e&&m<u&&(u=m);for(g=r+1,u-e>k((w-n)/g)&&s("overflow"),n+=(u-e)*g,e=u,a=0;a<v;++a)if(m=t[a],m<e&&++n>w&&s("overflow"),m==e){for(l=n,h=_;d=h<=i?O:h>=i+S?S:h-i,!(l<d);h+=_)b=l-d,y=_-d,j.push(N(f(d+b%y,0))),l=k(b/y);j.push(N(f(l,0))),i=p(n,g,r==o),n=0,++r}++n,++e}return j.join("")}function v(t){return u(t,function(t){return x.test(t)?d(t.slice(4).toLowerCase()):t})}function g(t){return u(t,function(t){return I.test(t)?"xn--"+m(t):t})}var y=("object"==typeof e&&e&&e.nodeType,"object"==typeof t&&t&&t.nodeType,"object"==typeof r&&r);var b,w=2147483647,_=36,O=1,S=26,j=38,P=700,A=72,T=128,C="-",x=/^xn--/,I=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,U={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=_-O,k=Math.floor,N=String.fromCharCode;b={version:"1.4.1",ucs2:{decode:c,encode:l},decode:d,encode:m,toASCII:g,toUnicode:v},void 0!==(o=function(){return b}.call(e,n,e,t))&&(t.exports=o)}()}).call(e,n(7)(t),n(2))},function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";function r(t){return function(e){var n=e.FormContext,r=Object.assign({},e);return t.onReady&&(n?n.registerInitCallback(t.name,t.onReady.bind(null,r)):setTimeout(t.onReady.bind(null,r),100)),t.getValue&&n&&n.registerGetValueCallback(t.name,t.getValue.bind(null,r)),n&&n.updateControlValue&&(t.setValue=function(e){n.updateControlValue(t.name,e)}),t.render(e)}}function o(t){return function(e){var n=e.FormContext;return n&&n.registerInitCallback&&t.onReady&&n.registerInitCallback(t.name,t.onReady),t.render(e)}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),s=function(t,e,n){if(void 0===n&&(n={}),!i.default.validateNamespace("SPClientTemplates.TemplateManager"))throw new Error("Unable to register CSR template.  SPClientTemplates.TemplateManager does not exist");var r={};t.locations.forEach(function(t){return r[t]=e});var o={Templates:{Fields:{}}},s=Object.assign({},o,n);return s.Templates.Fields[t.name]=r,SPClientTemplates.TemplateManager.RegisterTemplateOverrides(s),t},a=function(t,e){void 0===e&&(e={});var n=o(t);return t.locations=t.locations||["View","DisplayForm"],s(t,n,e)},u=function(t,e){void 0===e&&(e={});var n=r(t);return t.locations=t.locations||["NewForm","EditForm"],s(t,n,e)},c={registerDisplayField:a,registerFormField:u};e.default=c}])});
//# sourceMappingURL=spscript.js.map