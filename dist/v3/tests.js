!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){(function(t){"use strict";var e=n(27);t.Promise||(t.Promise=e),mocha.setup("bdd"),chai.should();var r=n(9);n(45).run(r.default),mocha.run()}).call(e,function(){return this}())},function(t,e,n){"use strict";function r(){return!("undefined"==typeof window)}function o(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return null}return t}function i(t){t=o(t);var e=null;return t.d&&t.d.results&&null!=t.d.results.length?e=t.d.results:t.d&&(e=t.d),e||t}function s(t,e){if(!l.validateNamespace("SP.UI.ModalDialog"))throw new Error("Sorry. Unable to open modal because native SharePoint Modal JavaScript is on loaded on page.");var n={width:800,title:" "},r=a({},n,e,{url:t});return SP.UI.ModalDialog.showModalDialog(r)}var a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var u=n(22),c=n(20),h=n(21),l=n(19),f=function(t){if(t&&t instanceof File)return new Promise(function(e,n){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.readAsArrayBuffer(t)});throw"SPScript.utils.getArrayBuffer: Cant get ArrayBuffer if you don't pass in a file"},p={isBrowser:r,headers:c.default,parseJSON:o,validateODataV2:i,qs:{toObj:u.toObj,fromObj:u.fromObj},loadScript:h.loadScript,loadScripts:h.loadScripts,loadCSS:h.loadCSS,getArrayBuffer:f,waitForLibraries:l.waitForLibraries,waitForLibrary:l.waitForLibrary,validateNamespace:l.validateNamespace,waitForElement:l.waitForElement,openModal:s};e.default=p},function(t,e,n){t.exports=n(53)},function(t,e,n){"use strict";var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0}),n(25);var o={method:"GET",credentials:"include"},i=function(t,e){var n=r({},o,e);return fetch(t,n).then(function(t){t.ok;return t.ok?t.text():t.text().then(function(t){throw new Error(t)})})};e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(15),i=function(){function t(t,e){this.baseUrl=t,this._dao=e}return t.prototype.getRoleAssignments=function(){var t=this.baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(t).then(r.default.validateODataV2).then(function(t){return t.map(s)})},t.prototype.checkPrivs=function(t){var e=encodeURIComponent(t.LoginName),n=this.baseUrl+"/getusereffectivepermissions(@v)?@v='"+e+"'";return this._dao.get(n).then(r.default.validateODataV2)},t.prototype.check=function(t){var e=this;if(!t&&!r.default.isBrowser())return Promise.reject("Can't check permissions. No email passed and no current user");var n=t?this._dao.web.getUser(t):this._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(t){return t.d});return n.then(function(t){return e.checkPrivs(t)}).then(function(t){return a(t.GetUserEffectivePermissions.Low,t.GetUserEffectivePermissions.High)})},t}();e.default=i;var s=function(t){var e={login:t.Member.LoginName,name:t.Member.Title,id:t.Member.Id},n=t.RoleDefinitionBindings.results.map(function(t){return{name:t.Name,description:t.Description,basePermissions:a(t.BasePermissions.Low,t.BasePermissions.High)}});return{member:e,roles:n}},a=function(t,e){var n=[];return o.basePermissions.forEach(function(r){((r.low&t)>0||(r.high&e)>0)&&n.push(r.name)}),n}},function(t,e){t.exports={includeStack:!1,showDiff:!0,truncateThreshold:40}},function(t,e){/*!
	 * Chai - flag utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){var r=t.__flags||(t.__flags=Object.create(null));return 3!==arguments.length?r[e]:void(r[e]=n)}},function(t,e,n){"use strict";e.decode=e.parse=n(28),e.encode=e.stringify=n(29)},function(t,e,n){"use strict";var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=n(4),s=function(){function t(t,e){this.listName=t,this.baseUrl="/web/lists/getbytitle('"+this.listName+"')",this._dao=e,this.permissions=new i.default(this.baseUrl,e)}return t.prototype.getItems=function(t){return this._dao.get(this.baseUrl+"/items"+a(t)).then(o.default.validateODataV2)},t.prototype.getItemById=function(t,e){var n=this.baseUrl+"/items("+t+")"+a(e);return this._dao.get(n).then(o.default.validateODataV2)},t.prototype.getItemsByView=function(t){var e=this,n=this.baseUrl+"/Views/getByTitle('"+t+"')/ViewQuery";return this._dao.get(n).then(o.default.validateODataV2).then(function(t){var n=e.baseUrl+"/GetItems",r={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:t.ViewQuery}};return e._dao.authorizedPost(n,r)}).then(o.default.validateODataV2)},t.prototype.findItems=function(t,e,n){var r="string"==typeof e?"'"+e+"'":e;return n="$filter="+t+" eq "+r+a(n,"&"),this.getItems(n)},t.prototype.findItem=function(t,e,n){return this.findItems(t,e,n).then(function(t){return t&&t.length&&t.length>0?t[0]:null})},t.prototype.getInfo=function(){return this._dao.get(this.baseUrl).then(o.default.validateODataV2)},t.prototype.addItem=function(t,e){var n=this;return this._dao._ensureRequestDigest(e).then(function(e){return n._dao.get(n.baseUrl).then(function(i){t=r({},{__metadata:{type:i.d.ListItemEntityTypeFullName}},t);var s={headers:o.default.headers.getAddHeaders(e)};return n._dao.post(n.baseUrl+"/items",t,s)}).then(o.default.validateODataV2)})},t.prototype.updateItem=function(t,e,n){var i=this;return this._dao._ensureRequestDigest(n).then(function(n){return i.getItemById(t).then(function(t){e=r({},{__metadata:{type:t.__metadata.type}},e);var s={headers:o.default.headers.getUpdateHeaders(n,t.__metadata.etag)};return i._dao.post(t.__metadata.uri,e,s)})})},t.prototype.deleteItem=function(t,e){var n=this;return this._dao._ensureRequestDigest(e).then(function(e){return n.getItemById(t).then(function(t){var r={headers:o.default.headers.getDeleteHeaders(e,t.__metadata.etag)};return n._dao.post(t.__metadata.uri,"",r)})})},t}();e.default=s;var a=function(t,e){return e=e||"?",t?e+t:""}},function(t,e,n){(function(t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(10),i=n(12),s={utils:r.default,CSR:i.default,createContext:function(e,n,r){try{return!e&&t._spPageContextInfo&&(e=t._spPageContextInfo.webAbsoluteUrl),new o.default(e)}catch(t){throw new Error("Unable to create SPScript Context: "+t.message)}}};e.default=s}).call(e,function(){return this}())},function(t,e,n){"use strict";var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),i=n(1),s=n(8),a=n(23),u=n(17),c=n(13),h=n(16),l=n(11),f=function(){function t(t,e){void 0===e&&(e={});var n=this;this.webUrl=t,this.clientId=e.clientId,this.clientSecret=e.clientSecret,this.ensureToken=e.clientId?l.getAppOnlyToken(t,e.clientId,e.clientSecret).then(function(t){return n.accessToken=t}):Promise.resolve(!0),this.search=new u.default(this),this.customActions=new c.default(this),this.web=new a.default(this),this.profiles=new h.default(this)}return t.prototype.executeRequest=function(t,e){var n=/^http/i.test(t)?t:this.webUrl+"/_api"+t,i={method:"GET",headers:{Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}};this.accessToken&&(i.headers.Authorization="Bearer "+this.accessToken);var s=r({},i,e);return o.default(n,s)},t.prototype.get=function(t,e){var n=r({},{method:"GET"},e);return this.executeRequest(t,n).then(i.default.parseJSON)},t.prototype.post=function(t,e,n){e=this._packagePostBody(e,n);var o={method:"POST",body:e};return o=r({},o,n),this.executeRequest(t,o).then(i.default.parseJSON)},t.prototype.authorizedPost=function(t,e,n){var r=this;return this.getRequestDigest().then(function(t){return i.default.headers.getActionHeaders(n,t)}).then(function(n){return r.post(t,e,{headers:n})})},t.prototype._ensureRequestDigest=function(t){return t?Promise.resolve(t):this.getRequestDigest()},t.prototype.getRequestDigest=function(){return this.post("/contextInfo",{}).then(function(t){return t.d.GetContextWebInformation.FormDigestValue})},t.prototype.lists=function(t){return new s.default(t,this)},t.prototype._packagePostBody=function(t,e){return"string"==typeof t?t:e&&e.headers&&e.headers["Content-Type"]&&e.headers["Content-Type"].indexOf("json")===-1?t:JSON.stringify(t)},t}();e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(33),o=n(3);e.getAppOnlyToken=function(t,e,n){var s=r.parse(t);return i(t).then(function(t){var e="https://accounts.accesscontrol.windows.net/"+t.realm+"/tokens/OAuth/2",r=r+"@"+t.realm,i=t.client_id+"/"+s.host+"@"+t.realm,a={grant_type:"client_credentials",client_id:r,client_secret:n,resource:i,scope:i},u={method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}};return o.default(e,u).then(function(t){return t.access_token})})};var i=function(t){var e={url:t+"/_vti_bin/client.svc",method:"GET",headers:{Authorization:"Bearer ",Accept:"application/json;odata=verbose",response_type:"code"}};return new Promise(function(t,n){o.default(e).then(function(t){n("Get Realm succeeded somehow?!")}).catch(function(e){var r=s(e.headers["www-authenticate"]);r?t(r):n("Unable to find Realm:\n"+JSON.stringify(e,null,"  "))})})},s=function(t){if(t&&t.startsWith("Bearer")){t=t.substr(7);var e=t.split(",").filter(function(t){return t.indexOf("=")>-1}).reduce(function(t,e){var n=e.split("=");return 2===n.length&&(t[n[0].trim()]=n[1].trim().replace(/\"/g,"")),t},{});return e}return null}},function(t,e,n){"use strict";function r(t){return function(e){var n=e.FormContext,r=i({},e);return t.onReady&&(n?n.registerInitCallback(t.name,t.onReady.bind(null,r)):setTimeout(t.onReady.bind(null,r),100)),t.getValue&&n&&n.registerGetValueCallback(t.name,t.getValue.bind(null,r)),n&&n.updateControlValue&&(t.setValue=function(e){n.updateControlValue(t.name,e)}),t.render(e)}}function o(t){return function(e){var n=e.FormContext;return n&&n.registerInitCallback&&t.onReady&&n.registerInitCallback(t.name,t.onReady),t.render(e)}}var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),a=function(t,e,n){if(void 0===n&&(n={}),!s.default.validateNamespace("SPClientTemplates.TemplateManager"))throw new Error("Unable to register CSR template.  SPClientTemplates.TemplateManager does not exist");var r={};t.locations.forEach(function(t){return r[t]=e});var o={Templates:{Fields:{}}},a=i({},o,n);return a.Templates.Fields[t.name]=r,SPClientTemplates.TemplateManager.RegisterTemplateOverrides(a),t},u=function(t,e){void 0===e&&(e={});var n=o(t);return t.locations=t.locations||["View","DisplayForm"],a(t,n,e)},c=function(t,e){void 0===e&&(e={});var n=r(t);return t.locations=t.locations||["NewForm","EditForm"],a(t,n,e)},h={registerDisplayField:u,registerFormField:c};e.default=h},function(t,e,n){"use strict";var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=n(14),s=function(){function t(t){this._dao=t}return t.prototype.getScope=function(t){if(3===t)return i.scopes.Web;if(2===t)return i.scopes.Site;throw new Error("Invalid Custom Action Scope")},t.prototype.get=function(t){var e=this;return this._dao.get(i.scopes.Site.url).then(o.default.validateODataV2).then(function(t){return e._dao.get(i.scopes.Web.url).then(o.default.validateODataV2).then(function(e){return t.concat(e)})}).then(function(e){if(t){var n=e.filter(function(e){return e.Name===t});if(n.length)return n[0];throw new Error("Unable to find Custom Action with name: "+t)}return e})},t.prototype._getUrl=function(t){var e=this;return this.get(t).then(function(t){return e.getScope(t.Scope).url+"('"+t.Id+"')"})},t.prototype._getUrlAndDigest=function(t){var e=this,n={};return this._getUrl(t).then(function(t){return n.url=t,e._dao.getRequestDigest()}).then(function(t){return n.digest=t,n})},t.prototype.update=function(t){var e=this;if(!t||!t.Name)throw new Error("You must at least pass a Custom Action 'Name'");return this._getUrlAndDigest(t.Name).then(function(n){t=r({},i.metadata,t);var s={headers:o.default.headers.getUpdateHeaders(n.digest)};return e._dao.post(n.url,t,s)})},t.prototype.remove=function(t){var e=this;if(!t)throw new Error("You must at least pass an existing Custom Action name");return this._getUrlAndDigest(t).then(function(t){var n={headers:o.default.headers.getDeleteHeaders(t.digest)};return e._dao.post(t.url,{},n)})},t.prototype.add=function(t){var e=this;if(!t||!t.Name)throw new Error("You must at least pass a Custom Action 'Name'");var n={Name:t.Name,Title:t.Name,Description:t.Name,Group:t.Name,Sequence:100,Scope:"Site",Location:"ScriptLink"};return t=r({},n,t),this.get().then(function(n){return!n.filter(function(e){return e.Name===t.Name}).length||e.remove(t.Name)}).then(function(){return e._dao.getRequestDigest()}).then(function(n){t=r({},i.metadata,t);var s=i.scopes[t.Scope];t.Scope=s.id;var a={headers:o.default.headers.getAddHeaders(n)};return e._dao.post(s.url,t,a)})},t.prototype.addScriptBlock=function(t,e,n){void 0===n&&(n={});var o={Name:t,ScriptBlock:e};return o=r({},o,n),this.add(o)},t.prototype.addCSSLink=function(t,e,n){void 0===n&&(n={});var r='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar styleTag = document.createElement("style");\n\t\t\tstyleTag.appendChild(document.createTextNode("body { opacity: 0 }"));\n\t\t\t\n\t\t\tvar linkTag = document.createElement("link");\n\t\t\tlinkTag.rel = "stylesheet";\tlinkTag.href = "'+e+'"; linkTag.type = "text/css";\n\t\t\tlinkTag.addEventListener("load", function() {\n\t\t\t\thead.removeChild(styleTag);\n\t\t\t});\n\n\t\t\thead.appendChild(styleTag);\n\t\t\thead.appendChild(linkTag);\n\t\t})();';return this.addScriptBlock(t,r,n)},t.prototype.addScriptLink=function(t,e,n){void 0===n&&(n={});var r='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar scriptTag = document.createElement("script");\n            scriptTag.src = "'+e+'";\n            scriptTag.type = "text/javascript";\n\t\t\thead.appendChild(scriptTag);\n\t\t})();';return this.addScriptBlock(t,r,n)},t}();e.default=s},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.metadata={__metadata:{type:"SP.UserCustomAction"}},e.scopes={Web:{id:3,name:"Web",url:"/web/usercustomactions"},Site:{id:2,name:"Site",url:"/site/usercustomactions"}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.basePermissions=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=function(){function t(t){this._dao=t,this.baseUrl="/SP.UserProfiles.PeopleManager"}return t.prototype.current=function(){var t=this.baseUrl+"/GetMyProperties";return this._dao.get(t).then(r.default.validateODataV2).then(i)},t.prototype.get=function(t){var e=this;return t?this.getUserObj(t).then(function(t){var n=encodeURIComponent(t.LoginName||t.AccountName),o=e.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+n+"'";return e._dao.get(o).then(r.default.validateODataV2).then(i)}):this.current()},t.prototype.getUserObj=function(t){if(t&&"string"!=typeof t){if(t.AccountName||t.LoginName)return Promise.resolve(t);throw new Error("profiles.setProperty Error: Invalid user parameter")}return this._dao.web.getUser(t)},t.prototype.setProperty=function(t,e,n){var r=this;return this.getUserObj(n).then(function(n){var o={propertyName:t,propertyValue:e,accountName:n.LoginName||n.AccountName},i=r.baseUrl+"/SetSingleValueProfileProperty";return r._dao.authorizedPost(i,o)})},t}();e.default=o;var i=function(t){return console.log(t),t.UserProfileProperties.results.forEach(function(e){t[e.Key]=e.Value}),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(18),i=function(){function t(t){this._dao=t}return Object.defineProperty(t.prototype,"defaultQueryOptions",{get:function(){return{sourceid:null,startrow:null,rowlimit:100,selectedproperties:null,refiners:null,refinementfilters:null,hiddencontstraints:null,sortlist:null}},enumerable:!0,configurable:!0}),t.prototype.query=function(t,e){void 0===e&&(e={});var n=r.default.qs.fromObj(e,!0),i="/search/query?querytext='"+t+"'&"+n;return this._dao.get(i).then(r.default.validateODataV2).then(function(t){if(t.query)return o.mapResponse(t.query);throw new Error("Invalid response back from search service")})},t.prototype.people=function(t,e){return void 0===e&&(e={}),e.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(t,e)},t.prototype.sites=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===n&&(n={}),e=e?"Path:"+e+"*":"";var r=(t+" contentclass:STS_Web "+e).trim();return n.rowlimit=n.rowlimit||499,this.query(r,n)},t}();e.default=i},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapResponse=function(t){return{elapsedTime:t.ElapsedTime,suggestion:t.SpellingSuggestion,resultsCount:t.PrimaryQueryResult.RelevantResults.RowCount,totalResults:t.PrimaryQueryResult.RelevantResults.TotalRows,totalResultsIncludingDuplicates:t.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,items:e.mapItems(t.PrimaryQueryResult.RelevantResults.Table.Rows.results),refiners:e.mapRefiners(t.PrimaryQueryResult.RefinementResults)}},e.mapRefiners=function(t){var e=[];return t&&t.Refiners&&t.Refiners.results&&(e=t.Refiners.results.map(function(t){return{RefinerName:t.Name,RefinerOptions:t.Entries.results}})),e},e.mapItems=function(t){for(var e=[],n=0;n<t.length;n++){for(var r=t[n],o={},i=0;i<r.Cells.results.length;i++)o[r.Cells.results[i].Key]=r.Cells.results[i].Value;e.push(o)}return e}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateNamespace=function(t){for(var e=window,n=t.split("."),r=n.length,o=0;o<r;o++){var i=n[o];if(!(i in e))return!1;e=e[i]}return!0};var n=function t(n,r){var o=n.filter(function(t){return!e.validateNamespace(t)});0===o.length?r():setTimeout(function(){return t(n,r)},25)};e.waitForLibraries=function(t){return new Promise(function(e,r){return n(t,e)})},e.waitForLibrary=function(t){return e.waitForLibraries([t])},e.waitForElement=function(t,e){void 0===e&&(e=5e3);var n=0,r=25,o=e/r;return new Promise(function(e,i){var s=function s(){n>o&&i("Unable to find element: "+t);var a=document.querySelector(t);a?e(a):(n++,setTimeout(s,r))};s()})}},function(t,e){"use strict";function n(t){var e={Accept:o,"Content-Type":o};return t&&(e["X-RequestDigest"]=t),e}var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o="application/json;odata=verbose",i=n,s=function(t){return{Accept:o,"X-RequestDigest":t,"Content-Type":"application/octet-stream",binaryStringRequestBody:"true"}},a=function(t,e){return r({},n(e),{"X-HTTP-Method":t})},u=function(t,e){return e&&(t["If-Match"]=e),t},c=function(t,e){return u(a("MERGE",t),e)},h=function(t,e){return u(a("DELETE",t),e)},l={getStandardHeaders:n,getAddHeaders:i,getFilestreamHeaders:s,getUpdateHeaders:c,getDeleteHeaders:h,getActionHeaders:a};e.default=l},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loadCSS=function(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t),document.querySelector("head").appendChild(e)},e.loadScript=function(t){return new Promise(function(e,n){var r=window.document.createElement("script"),o=document.getElementsByTagName("script")[0];r.async=!0,o.parentNode.insertBefore(r,o),r.onload=r.onreadystatechange=function(t,n){(n||!r.readyState||/loaded|complete/.test(r.readyState))&&(r.onload=r.onreadystatechange=null,r=void 0,n||e())},r.src=t})},e.loadScripts=function(t){return Promise.all(t.map(e.loadScript))}},function(t,e,n){"use strict";function r(t,e){var n=function(n){var r=(t[n]+"").trim();return(r.indexOf(" ")>-1||e)&&(r="'"+r+"'"),n+"="+r},r=Object.keys(t).map(n).join("&");return r}function o(t){return void 0===t&&window&&window.location&&window.location.search&&(t=window.location.search),t?("?"===t[0]&&(t=t.substr(1)),i.parse(t)):{}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(7);e.fromObj=r,e.toObj=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(4),i=function(){function t(t){this.baseUrl="/web",this._dao=t,this.permissions=new o.default(this.baseUrl,t)}return t.prototype.getInfo=function(){return this._dao.get(this.baseUrl).then(r.default.validateODataV2)},t.prototype.getSubsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(r.default.validateODataV2)},t.prototype.getUser=function(t){var e=t?this.baseUrl+"/SiteUsers/GetByEmail('"+t+"')":this.baseUrl+"/CurrentUser";return this._dao.get(e).then(r.default.validateODataV2)},t.prototype.ensureUser=function(t){return this._dao.post("/web/ensureUser('"+t+"')").then(r.default.validateODataV2)},t.prototype.getFile=function(t){var t="/web/getfilebyserverrelativeurl('"+t+"')";return this._dao.get(t).then(r.default.validateODataV2)},t.prototype._copyFile=function(t,e,n){var o="/web/getfilebyserverrelativeurl('"+t+"')/CopyTo",i={headers:r.default.headers.getAddHeaders(n)},s={strNewUrl:e,bOverWrite:!0};return this._dao.post(o,s,i)},t.prototype.copyFile=function(t,e,n){var r=this;return this._dao._ensureRequestDigest(n).then(function(n){return r._copyFile(t,e,n)})},t}();e.default=i},function(t,e,n){function r(t,e,n,r){var i={showHidden:e,seen:[],stylize:function(t){return t}};return o(i,t,"undefined"==typeof n?2:n)}function o(t,n,r){if(n&&"function"==typeof n.inspect&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var d=n.inspect(r);return"string"!=typeof d&&(d=o(t,d,r)),d}var b=i(t,n);if(b)return b;if(g(n)){if("outerHTML"in n)return n.outerHTML;try{if(document.xmlVersion){var w=new XMLSerializer;return w.serializeToString(n)}var S="http://www.w3.org/1999/xhtml",A=document.createElementNS(S,"_");return A.appendChild(n.cloneNode(!1)),html=A.innerHTML.replace("><",">"+n.innerHTML+"<"),A.innerHTML="",html}catch(t){}}var x=v(n),_=t.showHidden?y(n):x;if(0===_.length||p(n)&&(1===_.length&&"stack"===_[0]||2===_.length&&"description"===_[0]&&"stack"===_[1])){if("function"==typeof n){var j=m(n),T=j?": "+j:"";return t.stylize("[Function"+T+"]","special")}if(l(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(f(n))return t.stylize(Date.prototype.toUTCString.call(n),"date");if(p(n))return s(n)}var P="",E=!1,O=["{","}"];if(h(n)&&(E=!0,O=["[","]"]),"function"==typeof n){var j=m(n),T=j?": "+j:"";P=" [Function"+T+"]"}if(l(n)&&(P=" "+RegExp.prototype.toString.call(n)),f(n)&&(P=" "+Date.prototype.toUTCString.call(n)),p(n))return s(n);if(0===_.length&&(!E||0==n.length))return O[0]+P+O[1];if(r<0)return l(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var R;return R=E?a(t,n,r,x,_):_.map(function(e){return u(t,n,r,x,e,E)}),t.seen.pop(),c(R,P,O)}function i(t,e){switch(typeof e){case"undefined":return t.stylize("undefined","undefined");case"string":var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string");case"number":return 0===e&&1/e===-(1/0)?t.stylize("-0","number"):t.stylize(""+e,"number");case"boolean":return t.stylize(""+e,"boolean")}if(null===e)return t.stylize("null","null")}function s(t){return"["+Error.prototype.toString.call(t)+"]"}function a(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)Object.prototype.hasOwnProperty.call(e,String(s))?i.push(u(t,e,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(u(t,e,n,r,o,!0))}),i}function u(t,e,n,r,i,s){var a,u;if(e.__lookupGetter__&&(e.__lookupGetter__(i)?u=e.__lookupSetter__(i)?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):e.__lookupSetter__(i)&&(u=t.stylize("[Setter]","special"))),r.indexOf(i)<0&&(a="["+i+"]"),u||(t.seen.indexOf(e[i])<0?(u=null===n?o(t,e[i],null):o(t,e[i],n-1),u.indexOf("\n")>-1&&(u=s?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n"))):u=t.stylize("[Circular]","special")),"undefined"==typeof a){if(s&&i.match(/^\d+$/))return u;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+u}function c(t,e,n){var r=0,o=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.length+1},0);return o>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function h(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===d(t)}function l(t){return"object"==typeof t&&"[object RegExp]"===d(t)}function f(t){return"object"==typeof t&&"[object Date]"===d(t)}function p(t){return"object"==typeof t&&"[object Error]"===d(t)}function d(t){return Object.prototype.toString.call(t)}var m=n(39),y=n(65),v=n(62);t.exports=r;var g=function(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName}},function(t,e,n){n(36),t.exports=self.fetch.bind(self)},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(h===setTimeout)return setTimeout(t,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){m&&p&&(m=!1,p.length?d=p.concat(d):y=-1,d.length&&a())}function a(){if(!m){var t=o(s);m=!0;for(var e=d.length;e;){for(p=d,d=[];++y<e;)p&&p[y].run();y=-1,e=d.length}p=null,m=!1,i(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var h,l,f=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(t){h=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var p,d=[],m=!1,y=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new u(t,e)),1!==d.length||m||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){(function(e){!function(n){function r(){}function o(t,e){return function(){t.apply(e,arguments)}}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function s(t,e){for(;3===t._state;)t=t._value;return 0===t._state?void t._deferreds.push(e):(t._handled=!0,void i._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?a:u)(e.promise,t._value);var r;try{r=n(t._value)}catch(t){return void u(e.promise,t)}a(e.promise,r)}))}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void l(o(n,e),t)}t._state=1,t._value=e,c(t)}catch(e){u(t,e)}}function u(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)s(t,t._deferreds[e]);t._deferreds=null}function h(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,u(e,t))})}catch(t){if(n)return;n=!0,u(e,t)}}var f=setTimeout;i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(r);return s(this,new h(t,e,n)),n},i.all=function(t){var e=Array.prototype.slice.call(t);return new i(function(t,n){function r(i,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(t){r(i,t)},n)}e[i]=s,0===--o&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var o=e.length,i=0;i<e.length;i++)r(i,e[i])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)})},i._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){f(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},"undefined"!=typeof t&&t.exports?t.exports=i:n.Promise||(n.Promise=i)}(this)}).call(e,n(31).setImmediate)},function(t,e){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,r,o){e=e||"&",r=r||"=";var i={};if("string"!=typeof t||0===t.length)return i;var s=/\+/g;t=t.split(e);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var u=t.length;a>0&&u>a&&(u=a);for(var c=0;c<u;++c){var h,l,f,p,d=t[c].replace(s,"%20"),m=d.indexOf(r);m>=0?(h=d.substr(0,m),l=d.substr(m+1)):(h=d,l=""),f=decodeURIComponent(h),p=decodeURIComponent(l),n(i,f)?Array.isArray(i[f])?i[f].push(p):i[f]=[i[f],p]:i[f]=p}return i}},function(t,e){"use strict";var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,r,o){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(o){var i=encodeURIComponent(n(o))+r;return Array.isArray(t[o])?t[o].map(function(t){return i+encodeURIComponent(n(t))}).join(e):i+encodeURIComponent(n(t[o]))}).join(e):o?encodeURIComponent(n(o))+r+encodeURIComponent(n(t)):""}},function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return m[d]=r,p(d),d++}function o(t){delete m[t]}function i(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}function s(t){if(y)setTimeout(s,0,t);else{var e=m[t];if(e){y=!0;try{i(e)}finally{o(t),y=!1}}}}function a(){p=function(t){e.nextTick(function(){s(t)})}}function u(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}function c(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&s(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),p=function(n){t.postMessage(e+n,"*")}}function h(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;s(e)},p=function(e){t.port2.postMessage(e)}}function l(){var t=v.documentElement;p=function(e){var n=v.createElement("script");n.onreadystatechange=function(){s(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}function f(){p=function(t){setTimeout(s,0,t)}}if(!t.setImmediate){var p,d=1,m={},y=!1,v=t.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(t);g=g&&g.setTimeout?g:t,"[object process]"==={}.toString.call(t.process)?a():u()?c():t.MessageChannel?h():v&&"onreadystatechange"in v.createElement("script")?l():f(),g.setImmediate=r,g.clearImmediate=o}}("undefined"==typeof self?"undefined"==typeof t?this:t:self)}).call(e,function(){return this}(),n(26))},function(t,e,n){function r(t,e){this._id=t,this._clearFn=e}var o=Function.prototype.apply;e.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(30),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){var r;(function(t,o){!function(i){function s(t){throw RangeError(q[t])}function a(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function u(t,e){var n=t.split("@"),r="";n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(I,".");
var o=t.split("."),i=a(o,e).join(".");return r+i}function c(t){for(var e,n,r=[],o=0,i=t.length;o<i;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<i?(n=t.charCodeAt(o++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--)):r.push(e);return r}function h(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=N(t>>>10&1023|55296),t=56320|1023&t),e+=N(t)}).join("")}function l(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:S}function f(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function p(t,e,n){var r=0;for(t=n?U(t/j):t>>1,t+=U(t/e);t>k*x>>1;r+=S)t=U(t/k);return U(r+(k+1)*t/(t+_))}function d(t){var e,n,r,o,i,a,u,c,f,d,m=[],y=t.length,v=0,g=P,b=T;for(n=t.lastIndexOf(E),n<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&s("not-basic"),m.push(t.charCodeAt(r));for(o=n>0?n+1:0;o<y;){for(i=v,a=1,u=S;o>=y&&s("invalid-input"),c=l(t.charCodeAt(o++)),(c>=S||c>U((w-v)/a))&&s("overflow"),v+=c*a,f=u<=b?A:u>=b+x?x:u-b,!(c<f);u+=S)d=S-f,a>U(w/d)&&s("overflow"),a*=d;e=m.length+1,b=p(v-i,e,0==i),U(v/e)>w-g&&s("overflow"),g+=U(v/e),v%=e,m.splice(v++,0,g)}return h(m)}function m(t){var e,n,r,o,i,a,u,h,l,d,m,y,v,g,b,_=[];for(t=c(t),y=t.length,e=P,n=0,i=T,a=0;a<y;++a)m=t[a],m<128&&_.push(N(m));for(r=o=_.length,o&&_.push(E);r<y;){for(u=w,a=0;a<y;++a)m=t[a],m>=e&&m<u&&(u=m);for(v=r+1,u-e>U((w-n)/v)&&s("overflow"),n+=(u-e)*v,e=u,a=0;a<y;++a)if(m=t[a],m<e&&++n>w&&s("overflow"),m==e){for(h=n,l=S;d=l<=i?A:l>=i+x?x:l-i,!(h<d);l+=S)b=h-d,g=S-d,_.push(N(f(d+b%g,0))),h=U(b/g);_.push(N(f(h,0))),i=p(n,v,r==o),n=0,++r}++n,++e}return _.join("")}function y(t){return u(t,function(t){return O.test(t)?d(t.slice(4).toLowerCase()):t})}function v(t){return u(t,function(t){return R.test(t)?"xn--"+m(t):t})}var g=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof o&&o);g.global!==g&&g.window!==g&&g.self!==g||(i=g);var b,w=2147483647,S=36,A=1,x=26,_=38,j=700,T=72,P=128,E="-",O=/^xn--/,R=/[^\x20-\x7E]/,I=/[\x2E\u3002\uFF0E\uFF61]/g,q={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=S-A,U=Math.floor,N=String.fromCharCode;b={version:"1.3.2",ucs2:{decode:c,encode:h},decode:d,encode:m,toASCII:v,toUnicode:y},r=function(){return b}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))}(this)}).call(e,n(35)(t),function(){return this}())},function(t,e,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,n){if(t&&c.isObject(t)&&t instanceof r)return t;var o=new r;return o.parse(t,e,n),o}function i(t){return c.isString(t)&&(t=o(t)),t instanceof r?t.format():r.prototype.format.call(t)}function s(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}var u=n(32),c=n(34);e.parse=o,e.resolve=s,e.resolveObject=a,e.format=i,e.Url=r;var h=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(p),m=["'"].concat(d),y=["%","/","?",";","#"].concat(m),v=["/","?","#"],g=255,b=/^[+a-z0-9A-Z_-]{0,63}$/,w=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,S={javascript:!0,"javascript:":!0},A={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=n(7);r.prototype.parse=function(t,e,n){if(!c.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),o=r!==-1&&r<t.indexOf("#")?"?":"#",i=t.split(o),s=/\\/g;i[0]=i[0].replace(s,"/"),t=i.join(o);var a=t;if(a=a.trim(),!n&&1===t.split("#").length){var l=f.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=_.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var p=h.exec(a);if(p){p=p[0];var d=p.toLowerCase();this.protocol=d,a=a.substr(p.length)}if(n||p||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var j="//"===a.substr(0,2);!j||p&&A[p]||(a=a.substr(2),this.slashes=!0)}if(!A[p]&&(j||p&&!x[p])){for(var T=-1,P=0;P<v.length;P++){var E=a.indexOf(v[P]);E!==-1&&(T===-1||E<T)&&(T=E)}var O,R;R=T===-1?a.lastIndexOf("@"):a.lastIndexOf("@",T),R!==-1&&(O=a.slice(0,R),a=a.slice(R+1),this.auth=decodeURIComponent(O)),T=-1;for(var P=0;P<y.length;P++){var E=a.indexOf(y[P]);E!==-1&&(T===-1||E<T)&&(T=E)}T===-1&&(T=a.length),this.host=a.slice(0,T),a=a.slice(T),this.parseHost(),this.hostname=this.hostname||"";var I="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!I)for(var q=this.hostname.split(/\./),P=0,k=q.length;P<k;P++){var U=q[P];if(U&&!U.match(b)){for(var N="",C=0,M=U.length;C<M;C++)N+=U.charCodeAt(C)>127?"x":U[C];if(!N.match(b)){var B=q.slice(0,P),D=q.slice(P+1),L=U.match(w);L&&(B.push(L[1]),D.unshift(L[2])),D.length&&(a="/"+D.join(".")+a),this.hostname=B.join(".");break}}}this.hostname.length>g?this.hostname="":this.hostname=this.hostname.toLowerCase(),I||(this.hostname=u.toASCII(this.hostname));var F=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+F,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!S[d])for(var P=0,k=m.length;P<k;P++){var H=m[P];if(a.indexOf(H)!==-1){var Y=encodeURIComponent(H);Y===H&&(Y=escape(H)),a=a.split(H).join(Y)}}var G=a.indexOf("#");G!==-1&&(this.hash=a.substr(G),a=a.slice(0,G));var z=a.indexOf("?");if(z!==-1?(this.search=a.substr(z),this.query=a.substr(z+1),e&&(this.query=_.parse(this.query)),a=a.slice(0,z)):e&&(this.search="",this.query={}),a&&(this.pathname=a),x[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",J=this.search||"";this.path=F+J}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=t+this.host:this.hostname&&(o=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(i=_.stringify(this.query));var s=this.search||i&&"?"+i||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||x[e])&&o!==!1?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+o+n+s+r},r.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(c.isString(t)){var e=new r;e.parse(t,!1,!0),t=e}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var s=o[i];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),u=0;u<a.length;u++){var h=a[u];"protocol"!==h&&(n[h]=t[h])}return x[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!x[t.protocol]){for(var l=Object.keys(t),f=0;f<l.length;f++){var p=l[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||A[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=g||v||n.host&&t.pathname,w=b,S=n.pathname&&n.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],_=n.protocol&&!x[n.protocol];if(_&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),b=b&&(""===d[0]||""===S[0])),g)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,S=d;else if(d.length)S||(S=[]),S.pop(),S=S.concat(d),n.search=t.search,n.query=t.query;else if(!c.isNullOrUndefined(t.search)){if(_){n.hostname=n.host=S.shift();var j=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");j&&(n.auth=j.shift(),n.host=n.hostname=j.shift())}return n.search=t.search,n.query=t.query,c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var T=S.slice(-1)[0],P=(n.host||t.host||S.length>1)&&("."===T||".."===T)||""===T,E=0,O=S.length;O>=0;O--)T=S[O],"."===T?S.splice(O,1):".."===T?(S.splice(O,1),E++):E&&(S.splice(O,1),E--);if(!b&&!w)for(;E--;E)S.unshift("..");!b||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),P&&"/"!==S.join("/").substr(-1)&&S.push("");var R=""===S[0]||S[0]&&"/"===S[0].charAt(0);if(_){n.hostname=n.host=R?"":S.length?S.shift():"";var j=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");j&&(n.auth=j.shift(),n.host=n.hostname=j.shift())}return b=b||n.host&&S.length,b&&!R&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=l.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return v.iterable&&(e[Symbol.iterator]=function(){return e}),e}function o(t){this.map={},t instanceof o?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function i(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function s(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function a(t){var e=new FileReader,n=s(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=s(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function h(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(v.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(v.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(v.arrayBuffer&&v.blob&&b(t))this._bodyArrayBuffer=h(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!w(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(t){var e=t.toUpperCase();return S.indexOf(e)>-1?e:t}function p(t,e){e=e||{};var n=e.body;if(t instanceof p){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new o(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new o(e.headers)),this.method=f(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function d(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function m(t){var e=new o;return t.split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}}),e}function y(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new o(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var v={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(v.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=function(t){return t&&DataView.prototype.isPrototypeOf(t)},w=ArrayBuffer.isView||function(t){return t&&g.indexOf(Object.prototype.toString.call(t))>-1};o.prototype.append=function(t,r){t=e(t),r=n(r);var o=this.map[t];this.map[t]=o?o+","+r:r},o.prototype.delete=function(t){delete this.map[e(t)]},o.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},o.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},o.prototype.set=function(t,r){this.map[e(t)]=n(r)},o.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},o.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),r(t)},o.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},o.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),r(t)},v.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var S=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},l.call(p.prototype),l.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},y.error=function(){var t=new y(null,{status:0,statusText:""});return t.type="error",t};var A=[301,302,303,307,308];y.redirect=function(t,e){if(A.indexOf(e)===-1)throw new RangeError("Invalid status code");return new y(null,{status:e,headers:{location:t}})},t.Headers=o,t.Request=p,t.Response=y,t.fetch=function(t,e){return new Promise(function(n,r){var o=new p(t,e),i=new XMLHttpRequest;i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:m(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var e="response"in i?i.response:i.responseText;n(new y(e,t))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&v.blob&&(i.responseType="blob"),o.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(t,e,n){"use strict";n(2).should(),e.create=function(t,e,n){return"check"===e?function(){var e=null;before(function(r){t.permissions.check(n).then(function(t){e=t,r()}).catch(function(t){r(t)})}),it("Should return a promise that resolves to an array of base permission strings",function(){e.should.be.an("array"),e.should.not.be.empty}),it("Should reject the promise for an invalid email",function(e){t.permissions.check("invalid@invalid123.com").then(function(t){"one".should.equal("two"),e()}).catch(function(t){e()})})}:function(){var e=null;before(function(n){t.permissions.getRoleAssignments().then(function(t){e=t,n()})}),it("Should return a promise that resolves to an array of objects",function(){e.should.be.an("array"),e.should.not.be.empty}),it("Should return objects that each have a member and a roles array",function(){e.forEach(function(t){t.should.have.property("member"),t.should.have.property("roles"),t.roles.should.be.an("array")})}),it("Should return permission objects that contain member.name, member.login, and member.id",function(){e.forEach(function(t){t.member.should.have.property("name"),t.member.should.have.property("login"),t.member.should.have.property("id")})}),it("Should return permission objects, each with a roles array that has a name and description",function(){e.forEach(function(t){t.roles.forEach(function(t){t.should.have.property("name"),t.should.have.property("description")})})})}}},function(t,e){/*!
	 * Chai - getActual utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e){return e.length>4?e[4]:t._obj}},function(t,e){/*!
	 * Chai - getName utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t){if(t.name)return t.name;var e=/^\s?function ([^(]*)\(/.exec(t);return e&&e[1]?e[1]:""}},function(t,e,n){/*!
	 * Chai - flag utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependancies
	 */
var r=n(24),o=n(5);t.exports=function(t){var e=r(t),n=Object.prototype.toString.call(t);if(o.truncateThreshold&&e.length>=o.truncateThreshold){if("[object Function]"===n)return t.name&&""!==t.name?"[Function: "+t.name+"]":"[Function]";if("[object Array]"===n)return"[ Array("+t.length+") ]";if("[object Object]"===n){var i=Object.keys(t),s=i.length>2?i.splice(0,2).join(", ")+", ...":i.join(", ");return"{ Object ("+s+") }"}return e}return e}},function(t,e){/*!
	 * Chai - transferFlags utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){var r=t.__flags||(t.__flags=Object.create(null));e.__flags||(e.__flags=Object.create(null)),n=3!==arguments.length||n;for(var o in r)(n||"object"!==o&&"ssfi"!==o&&"message"!=o)&&(e.__flags[o]=r[o])}},function(t,e){/*!
	 * assertion-error
	 * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>
	 * MIT Licensed
	 */
/*!
	 * Return a function that will copy properties from
	 * one object to another excluding any originally
	 * listed. Returned function will create a new `{}`.
	 *
	 * @param {String} excluded properties ...
	 * @return {Function}
	 */
function n(){function t(t,n){Object.keys(n).forEach(function(r){~e.indexOf(r)||(t[r]=n[r])})}var e=[].slice.call(arguments);return function(){for(var e=[].slice.call(arguments),n=0,r={};n<e.length;n++)t(r,e[n]);return r}}function r(t,e,r){var o=n("name","message","stack","constructor","toJSON"),i=o(e||{});this.message=t||"Unspecified AssertionError",this.showDiff=!1;for(var s in i)this[s]=i[s];r=r||arguments.callee,r&&Error.captureStackTrace&&Error.captureStackTrace(this,r)}/*!
	 * Primary Exports
	 */
t.exports=r,/*!
	 * Inherit from Error.prototype
	 */
r.prototype=Object.create(Error.prototype),/*!
	 * Statically set name
	 */
r.prototype.name="AssertionError",/*!
	 * Ensure correct constructor
	 */
r.prototype.constructor=r,r.prototype.toJSON=function(t){var e=n("constructor","toJSON","stack"),r=e({name:this.name},this);return!1!==t&&this.stack&&(r.stack=this.stack),r}},function(t,e,n){"use strict";n(2).should();e.run=function(t){describe("SPScript Context",function(){var e=t.createContext();describe("var ctx = SPScript.createContext(url)",function(){it("Should create the primary object you use to interact with the site",function(){if(!e)throw new Error("Context is null");e.should.have.property("webUrl"),e.should.have.property("executeRequest"),e.should.have.property("get"),e.should.have.property("post"),e.should.have.property("authorizedPost"),e.should.have.property("lists")}),it("Should allow a url to be passed in",function(){var e="http://blah.sharepoint.com",n=t.createContext(e);n.webUrl.should.equal(e)}),it("Should default to the current web if no url is passed",function(){var e=t.createContext();e.webUrl.should.equal(_spPageContextInfo.webAbsoluteUrl)})}),describe("Namespaces",function(){describe("ctx.web",function(){it("Should have an SPScript Web object with site methods (getUser, getSubsites etc...)",function(){e.should.have.property("web"),e.web.should.have.property("getUser"),e.web.should.have.property("getSubsites")})}),describe("ctx.search",function(){it("Should have an SPScript Search object with search methods (query, people, sites etc...)",function(){e.search.should.have.property("query"),e.search.should.have.property("people")})}),describe("ctx.profiles",function(){it("Should have an SPScript Profiles object with methods to hit the Profile Service (current, setProperty etc...)",function(){e.should.have.property("profiles"),e.profiles.should.have.property("get"),e.profiles.should.have.property("setProperty")})})}),describe("Methods",function(){describe("ctx.list(name)",function(){it("Should return an SPScript List instance",function(){var t=e.lists("My List");t.should.have.property("listName"),t.should.have.property("getInfo")})}),describe("ctx.get(url, [opts])",function(){var t;before(function(){t=e.get("/lists?$select=Title")}),it("Should return a Promise",function(){if(!t)throw new Error("Promise is null");t.should.have.property("then")}),it("Should resolve to a JS object, not a JSON string",function(e){t.then(function(t){t.should.have.property("d"),e()}).catch(function(t){return e(t)})}),it("Should return valid API results: ctx.get('/lists')",function(e){t.then(function(t){t.should.have.property("d"),t.d.should.have.property("results"),t.d.results.should.be.an("array"),e()}).catch(function(t){return e(t)})})}),describe("ctx.post(url, [body], [opts]",function(){it("Should return a Promise"),it("Should resolve to a JS object, not a JSON string")}),describe("ctx.authorizedPost(url, [body], [opts]",function(){it("Should include a request digest in the headers"),it("Should return a Promise"),it("Should resolve to a JS object, not a JSON string")}),describe("ctx.getRequestDigest()",function(){it("Should resolve to a string request digest",function(t){e.getRequestDigest().then(function(e){e.should.be.a("string"),e.should.not.be.empty,t()})})})})})}},function(t,e){"use strict";e.run=function(t){describe("ctx.customActions",function(){this.timeout(1e4);var e={Name:"spscript-test",Location:"ScriptLink",ScriptBlock:"console.log('deployed from spscript-mocha test');"};describe("ctx.customActions.add(customAction)",function(){var n=0;before(function(e){t.customActions.get().then(function(t){n=t.length,e()})}),it("Should add a Custom Action with the given name",function(r){t.customActions.add(e).then(function(){t.customActions.get().then(function(t){t.length.should.equal(n+1),r()})})}),it("Should not add duplicate Custom Action names. It should remove old one first.",function(r){t.customActions.add(e).then(function(){t.customActions.get().then(function(t){t.length.should.equal(n+1),r()})})})}),describe("ctx.customActions.get()",function(){var e=null;before(function(n){t.customActions.get().then(function(t){e=t,n()})}),it("Should return a promise that resolves to an array of custom actions",function(){e.should.be.an("array"),e.should.not.be.empty}),it("Should bring back properties like Name, Url, and Location",function(){var t=e[0];t.should.have.property("Name"),t.should.have.property("Url"),t.should.have.property("Location")})}),describe("ctx.customActions.get(name)",function(){var e=null;before(function(n){t.customActions.get().then(function(r){t.customActions.get(r[0].Name).then(function(t){e=t,n()})})}),it("Should return one object w/ properties like Name, Location, Url, Id",function(){e.should.not.be.null,e.should.have.property("Name"),e.should.have.property("Location"),e.should.have.property("Id")}),it("Should reject the promise with a decent error if the Custom Action name is not found",function(e){t.customActions.get("INVALID-NAME").then(function(){"one".should.equal("two"),e()}).catch(function(t){console.log(t),e()})})}),describe("ctx.customActions.update(updates)",function(){var n=null;before(function(r){t.customActions.get(e.Name).then(function(t){n=t,r()})});var r="updated title - "+Date.now();it("Should update the property",function(e){t.customActions.update({Name:n.Name,Title:r}).then(function(){t.customActions.get(n.Name).then(function(t){t.Title.should.equal(r),e()})})})}),describe("dao.customActions.remove(name)",function(){var n=0;before(function(r){t.customActions.get().then(function(t){n=t.filter(function(t){return t.Name===e.Name}).length,r()}).catch(function(t){console.log(t),r()})}),it("Should remove all custom actions with that name",function(n){t.customActions.remove(e.Name).then(function(){t.customActions.get().then(function(t){var r=t.filter(function(t){return t.Name===e.Name});r.should.be.empty(),n()})})})}),describe("ctx.customActions.addScriptLink(name, url)",function(){var e="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",n="SPScriptJSTest-Web";before(function(r){t.customActions.addScriptLink(n,e).then(function(){r()})}),it("Should add a custom action with that name and ScriptBlock with specified URL",function(r){t.customActions.get(n).then(function(t){t.should.have.property("Name"),t.Name.should.equal(n),t.should.have.property("ScriptBlock"),t.ScriptBlock.should.contain(e),r()})}),after(function(e){t.customActions.remove(n).then(function(){e()})})}),describe("ctx.customActions.addScriptLink(name, url, opts)",function(){var e="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",n="SPScriptJSTest-Site",r={Sequence:25,Group:"Custom Group"};before(function(o){t.customActions.addScriptLink(n,e,r).then(function(){o()})}),it("Should add a custom action with that name and ScriptBlock with specified URL",function(o){t.customActions.get(n).then(function(t){t.should.have.property("Name"),t.Name.should.equal(n),t.should.have.property("ScriptBlock"),t.ScriptBlock.should.contain(e),t.should.have.property("Group"),t.Group.should.equal(r.Group),t.should.have.property("Sequence"),t.Sequence.should.equal(25),o()})}),after(function(e){t.customActions.remove(n).then(function(){e()})})}),describe("ctx.customActions.addCSSLink(name, url)",function(){var e="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css",n="SPScriptCSSTest-Web";before(function(r){t.customActions.addCSSLink(n,e).then(function(){r()})}),it("Should add a custom action with that name and ScriptBlock containing specified URL",function(r){t.customActions.get(n).then(function(t){t.should.have.property("Name"),t.Name.should.equal(n),t.should.have.property("ScriptBlock"),t.ScriptBlock.should.contain(e),r()})}),after(function(e){t.customActions.remove(n).then(function(){e()})})}),describe("ctx.customActions.addCSSLink(name, url, opts)",function(){var e="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css",n="SPScriptCSSTest-Site",r={Sequence:50,Group:"Custom Group"};before(function(o){t.customActions.addCSSLink(n,e,r).then(function(){o()})}),it("Should add a custom action with that name and ScriptBlock containing specified URL with Site scope",function(o){t.customActions.get(n).then(function(t){t.should.have.property("Name"),t.Name.should.equal(n),t.should.have.property("ScriptBlock"),t.ScriptBlock.should.contain(e),t.should.have.property("Group"),t.Group.should.equal(r.Group),t.should.have.property("Sequence"),t.Sequence.should.equal(50),o()})}),after(function(e){t.customActions.remove(n).then(function(){e()})})})})}},function(t,e,n){"use strict";e.run=function(t,e){console.log("SPScript Env: "+t._env);n(2).should();describe("SPScript Global Namespace",function(){it("Should have a 'SPScript.createContext()' method",function(){t.should.have.property("createContext"),t.createContext.should.be.a("function")}),it("Should have a 'SPScript.utils' namespace",function(){t.should.not.be.null,t.should.have.property("utils")})}),n(43).run(t);var r=t.createContext();n(50).run(r),n(46).run(r),n(48).run(r),n(44).run(r),n(47).run(r),n(49).run(t.utils)}},function(t,e,n){"use strict";function r(){return!("undefined"==typeof window)}var o=n(37);n(2).should();e.run=function(t){describe("var list = ctx.lists(listname)",function(){this.timeout(1e4);var e=t.lists("TestList");describe("list.info()",function(){var t=null;before(function(n){e.getInfo().then(function(e){t=e,n()})}),it("Should return a promise that resolves to list info",function(){t.should.be.an("object")}),it("Should bring back list info like Title, ItemCount, and ListItemEntityTypeFullName",function(){t.should.have.property("Title"),t.should.have.property("ItemCount"),t.should.have.property("ListItemEntityTypeFullName")})}),describe("list.getItems()",function(){var t=null;before(function(n){e.getItems().then(function(e){t=e,n()})}),it("Should return a promise that resolves to an array of items",function(){t.should.be.an("array")}),it("Should return all the items in the list",function(n){e.getInfo().then(function(e){t.length.should.equal(e.ItemCount),n()})})}),describe("list.getItems(odata)",function(){var t="$filter=MyStatus eq 'Green'",n=null;before(function(r){e.getItems(t).then(function(t){n=t,r()})}),it("Should return a promise that resolves to an array of items",function(){n.should.be.an("array")}),it("Should return only items that match the OData params",function(){n.forEach(function(t){t.should.have.property("MyStatus"),t.MyStatus.should.equal("Green")})})}),describe("list.getItemById(id)",function(){var t=null,n=-1;before(function(r){e.getItems().then(function(t){return n=t[0].Id}).then(function(t){return e.getItemById(t)}).then(function(e){t=e,r()})}),it("Should return a promise that resolves to a single item",function(){t.should.be.an("object"),t.should.have.property("Title")}),it("Should resolve an item with a matching ID",function(){t.should.have.property("Id"),t.Id.should.equal(n)}),it("Should be able to return attachments using the optional odata query",function(t){e.getItemById(n,"$expand=AttachmentFiles").then(function(e){e.should.have.property("AttachmentFiles"),e.AttachmentFiles.should.have.property("results"),e.AttachmentFiles.results.should.be.an("Array"),t()})})}),describe("list.findItems(key, value)",function(){var t=null;before(function(n){e.findItems("MyStatus","Green").then(function(e){t=e,n()})}),it("Should return a promise that resolves to an array of list items",function(){t.should.be.an("array"),t.should.not.be.empty}),it("Should only bring back items the match the key value query",function(){t.forEach(function(t){t.should.have.property("MyStatus"),t.MyStatus.should.equal("Green")})})}),describe("list.findItem(key, value)",function(){var t=null;before(function(n){e.findItem("MyStatus","Green").then(function(e){t=e,n()})}),it("Should resolve to one list item",function(){t.should.be.an("object")}),it("Should only bring back an item if it matches the key value query",function(){t.should.have.property("MyStatus"),t.MyStatus.should.equal("Green")})}),describe("list.addItem()",function(){var t={Title:"Test Created Item",MyStatus:"Red"},n=null;before(function(r){e.addItem(t).then(function(t){n=t,r()}).catch(function(t){console.log(t),r()})}),it("Should return a promise that resolves with the new list item",function(){n.should.not.be.null,n.should.be.an("object"),n.should.have.property("Id")}),it("Should save the item right away so it can be queried.",function(){e.getItemById(n.Id).then(function(e){e.should.not.be.null,e.should.have.property("Title"),e.Title.should.equal(t.Title)})}),it("Should throw an error if a invalid field is set",function(n){t.InvalidColumn="test",e.addItem(t).then(function(){"one".should.equal("two")}).catch(function(t,e,r){n()})})}),describe("list.deleteItem(id)",function(){var t=null;before(function(n){e.getItems("$orderby=Id").then(function(n){return t=n[n.length-1],e.deleteItem(t.Id)}).then(function(){n()}).catch(function(t){n(t)})}),it("Should delete that item",function(n){e.getItemById(t.Id).then(function(){throw"Should have failed because item has been deleted"}).catch(function(){n()})}),it("Should reject the promise if the item id can not be found",function(t){e.deleteItem(99999999).then(function(){throw"Should have failed because id doesnt exist"}).catch(function(){t()})})}),describe("list.updateItem()",function(){var t=null,n={Title:"Updated Title"};before(function(n){e.getItems("$orderby=Id desc").then(function(e){t=e[e.length-1],n()})}),it("Should return a promise",function(r){e.updateItem(t.Id,n).then(function(){r()})}),it("Should update only the properties that were passed",function(r){e.getItemById(t.Id).then(function(t){t.should.have.property("Title"),t.Title.should.equal(n.Title),r()})})}),describe("list.permissions.getRoleAssignments()",o.create(e)),r()&&describe("list.permissions.check()",o.create(e,"check")),describe("list.permissions.check(email)",o.create(e,"check","andrew@andrewpetersen.onmicrosoft.com"))})}},function(t,e,n){"use strict";n(2).should();e.run=function(t){console.log("HERE I AM"),describe("var profiles = ctx.profiles",function(){this.timeout(5e3),describe("ctx.profiles.current()",function(){var e=null;before(function(n){t.profiles.current().then(function(t){e=t,console.log(e),n()})}),it("Should return a promise that resolves to a profile properties object",function(){e.should.be.an("object"),e.should.have.property("AccountName"),e.should.have.property("Email"),e.should.have.property("PreferredName")}),it("Should return the profile of the current user",function(){e.should.have.property("Email"),e.Email.should.equal(_spPageContextInfo.userEmail)})}),describe("ctx.profiles.get()",function(){var e=null;before(function(n){t.profiles.get().then(function(t){e=t,n()})}),it("Should return a promise that resolves to a profile properties object",function(){e.should.be.an("object"),e.should.have.property("AccountName"),e.should.have.property("Email"),e.should.have.property("PreferredName")}),it("Should return the profile of the current user",function(){e.should.have.property("Email"),e.Email.should.equal(_spPageContextInfo.userEmail)})}),describe("ctx.profiles.get(email)",function(){var e="andrew@andrewpetersen.onmicrosoft.com",n=null;before(function(r){t.profiles.get(e).then(function(t){n=t,r()}).catch(function(t){r(t)})}),it("Should return a promise that resolves to a profile properties object",function(){n.should.be.an("object"),n.should.have.property("AccountName"),n.should.have.property("Email"),n.should.have.property("PreferredName")}),it("Should give you the matching person",function(){n.should.have.property("Email"),n.Email.should.equal(e)}),it("Should reject the promise for an invalid email",function(e){t.profiles.get("invalid@invalid123.com").then(function(t){e("The request should have failed.")}).catch(function(){e()})})}),describe("ctx.profiles.get({ AccountName })",function(){var e="andrew@andrewpetersen.onmicrosoft.com",n="i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com",r=null;before(function(e){t.profiles.get({AccountName:n}).then(function(t){r=t,e()}).catch(function(t){e(t)})}),it("Should return a promise that resolves to a profile properties object",function(){r.should.be.an("object"),r.should.have.property("AccountName"),r.should.have.property("Email"),r.should.have.property("PreferredName")}),it("Should give you the matching person",function(){r.should.have.property("Email"),r.Email.should.equal(e)}),it("Should reject the promise for an invalid account name",function(e){t.profiles.get({AccountName:"Invalid"}).then(function(t){e("The request should have failed.")}).catch(function(){e()})})}),describe("ctx.profiles.get({ LoginName })",function(){var e="andrew@andrewpetersen.onmicrosoft.com",n="i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com",r=null;before(function(e){t.profiles.get({LoginName:n}).then(function(t){r=t,e()}).catch(function(t){e(t)})}),it("Should return a promise that resolves to a profile properties object",function(){r.should.be.an("object"),r.should.have.property("AccountName"),r.should.have.property("Email"),r.should.have.property("PreferredName")}),it("Should give you the matching person",function(){r.should.have.property("Email"),r.Email.should.equal(e)}),it("Should reject the promise for an invalid account name",function(e){t.profiles.get({LoginName:"Invalid"}).then(function(t){e("The request should have failed.")}).catch(function(){e()})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue)",function(){it("Should update the About Me profile property of the current user",function(e){var n="Hi there. I was updated with SPScript 1";t.profiles.setProperty("AboutMe",n).then(function(){return t.profiles.current()}).then(function(t){t.should.have.property("AboutMe"),t.AboutMe.should.equal(n),e()}).catch(function(t){e(t)})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue, email)",function(){var e="andrew@andrewpetersen.onmicrosoft.com";it("Should update the About Me profile property based on the specified email",function(n){var r="Hi there. I was updated with SPScript 2";t.profiles.setProperty("AboutMe",r,e).then(function(){return t.profiles.get(e)}).then(function(t){t.should.have.property("AboutMe"),t.AboutMe.should.equal(r),n()}).catch(function(t){n(t)})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue, { AccountName|LoginName })",function(){var e="i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com";it("Should update the About Me profile property of the passed in User object",function(n){var r="Hi there. I was updated with SPScript 3";t.profiles.setProperty("AboutMe",r,{AccountName:e}).then(function(){return t.profiles.get({AccountName:e})}).then(function(t){t.should.have.property("AboutMe"),t.AboutMe.should.equal(r),n()}).catch(function(t){n(t)})})})})}},function(t,e,n){"use strict";n(2).should();e.run=function(t){describe("var search = ctx.search;",function(){this.timeout(5e3),describe("ctx.search.query(queryText)",function(){it("Should return promise that resolves to a SearchResults object",function(e){var n="andrew";t.search.query(n).then(function(t){t.should.be.an("object"),t.should.have.property("resultsCount"),t.should.have.property("totalResults"),t.should.have.property("items"),t.should.have.property("refiners"),t.items.should.be.an("array"),t.items.should.not.be.empty,e()})})}),describe("ctx.search.query(queryText, queryOptions)",function(){it("Should obey the extra query options that were passed",function(e){var n="andrew",r={rowLimit:1};t.search.query(n,r).then(function(t){t.should.be.an("object"),t.should.have.property("resultsCount"),t.should.have.property("totalResults"),t.should.have.property("items"),t.should.have.property("refiners"),t.items.should.be.an("array"),t.items.should.not.be.empty,t.items.length.should.equal(1),e()})})}),describe("ctx.search.query(queryText, queryOptions) - w/ Refiners",function(){it("Should return SearchResults that include a refiners array",function(e){var n="FileType",r="andrew",o={refiners:n};t.search.query(r,o).then(function(t){t.should.be.an("object"),t.should.have.property("refiners"),t.refiners.should.not.be.empty;var r=t.refiners[0];r.should.have.property("RefinerName"),r.should.have.property("RefinerOptions"),r.RefinerName.should.equal(n),r.RefinerOptions.should.be.an("array"),e()})})}),describe("ctx.search.people(queryText)",function(){it("Should only return search results that are people",function(e){var n="andrew";t.search.people(n).then(function(t){t.should.be.an("object"),t.should.have.property("items"),t.items.should.be.an("array"),t.items.should.not.be.empty;var n=t.items[0];n.should.have.property("AccountName"),n.should.have.property("PreferredName"),n.should.have.property("AboutMe"),n.should.have.property("WorkEmail"),n.should.have.property("PictureURL"),e()})})}),describe("ctx.search.sites(queryText, scope)",function(){it("Should only return search results that are sites",function(e){var n="";t.search.sites(n).then(function(t){t.should.be.an("object"),t.should.have.property("items"),t.items.should.be.an("array"),t.items.should.not.be.empty();for(var n,r=0;r<t.items.length;r++)n=t.items[r],n.should.have.property("Path"),n.should.have.property("contentclass"),n.contentclass.should.equal("STS_Web");e()})}),it("Should only return sites underneath the specified scope",function(e){var n="https://andrewpetersen.sharepoint.com/sites/ep";t.search.sites("",n).then(function(t){t.should.be.an("object"),t.should.have.property("items"),t.items.should.be.an("array"),t.items.should.not.be.empty();for(var r,o=0;o<t.items.length;o++)r=t.items[o],r.should.have.property("Path"),r.Path.indexOf(n).should.equal(0),r.should.have.property("contentclass"),r.contentclass.should.equal("STS_Web");e()})})})})}},function(t,e,n){"use strict";n(2).should();e.run=function(t){describe("var utils = SPScript.utils",function(){describe("utils.parseJSON(data)",function(){it("Should exist on the utils object",function(){t.should.have.property("parseJSON"),t.parseJSON.should.be.a("function")}),it("Should take a string or an object and return an object",function(){var e={one:"value of one",two:"value of two"},n=JSON.stringify(e),r=t.parseJSON(e);r.should.not.be.null,r.should.have.property("one"),r.one.should.equal(e.one);var o=t.parseJSON(n);o.should.not.be.null,o.should.have.property("one"),o.one.should.equal(e.one)})}),describe("Query String",function(){describe("utils.qs.toObj(str)",function(){it("Should take in a string in the form of key=value&key2=value and return an Object",function(){var e="key1=value1",n="key1=value1&key2=value2",r=t.qs.toObj(e);r.should.have.property("key1"),r.key1.should.equal("value1");var o=t.qs.toObj(n);o.should.have.property("key1"),o.should.have.property("key2"),o.key2.should.equal("value2")}),it("Should support an optional leading '?' ",function(){var e="?key1=value1",n=t.qs.toObj(e);n.should.have.property("key1"),n.key1.should.equal("value1")}),it("Should default to 'window.location.search' if no value is passed")}),describe("utils.qs.fromObj(obj, quoteValues?)",function(){it("Should turn { key1: 'value1', key2: 'value2' } into 'key1=value1&key2=value2'",function(){var e={key1:"value1",key2:"value2"},n=t.qs.fromObj(e);n.should.equal("key1=value1&key2=value2")}),it("Should put single quotes around words with spaces",function(){var e={key1:"my value"},n=t.qs.fromObj(e);n.should.equal("key1='my value'")}),it("Should put single quotes around every value is an optional 'quoteValues' param is set to true",function(){var e={key1:"value1",key2:"value2"},n=t.qs.fromObj(e,!0);n.should.equal("key1='value1'&key2='value2'")})})}),describe("Headers",function(){describe("utils.headers.getStandardHeaders(digest?)",function(){var e="application/json;odata=verbose";it("Should set the Accept header",function(){var n=t.headers.getStandardHeaders();n.should.have.property("Accept"),n.Accept.should.equal(e)}),it("Should set the Request Digest if a digest is passed",function(){var n="123Fake",r=t.headers.getStandardHeaders(n);r.should.have.property("Accept"),r.Accept.should.equal(e),r.should.have.property("X-RequestDigest"),r["X-RequestDigest"].should.equal(n)})}),describe("utils.headers.getAddHeaders(digest)",function(){var e="application/json;odata=verbose";it("Should set the Request Digest if a digest is passed",function(){var n="123Fake",r=t.headers.getAddHeaders(n);r.should.have.property("Accept"),r.Accept.should.equal(e),r.should.have.property("X-RequestDigest"),r["X-RequestDigest"].should.equal(n)})}),describe("utils.headers.getUpdateHeaders(digest)",function(){var e="application/json;odata=verbose";it("Should set X-HTTP-Method to MERGE and include X-RequestDigest",function(){var n="123Fake",r=t.headers.getUpdateHeaders(n);r.should.have.property("Accept"),r.Accept.should.equal(e),r.should.have.property("X-RequestDigest"),r["X-RequestDigest"].should.equal(n),r.should.have.property("X-HTTP-Method"),r["X-HTTP-Method"].should.equal("MERGE")})}),describe("utils.headers.getDeleteHeaders(digest)",function(){var e="application/json;odata=verbose";it("Should set X-HTTP-Method to DELETE and include X-RequestDigest",function(){var n="123Fake",r=t.headers.getDeleteHeaders(n);r.should.have.property("Accept"),r.Accept.should.equal(e),r.should.have.property("X-RequestDigest"),r["X-RequestDigest"].should.equal(n),r.should.have.property("X-HTTP-Method"),r["X-HTTP-Method"].should.equal("DELETE")})})}),describe("Dependency Management",function(){describe("utils.validateNamespace(namespace)",function(){it("Should return false if that namespace is not on global window"),it("Should return true if that namespace is on global window")}),describe("utils.waitForLibrary(namespace)",function(){it("Should return a promise that resolves when that namespace is on the global")}),describe("utils.waitForLibraries(namespaces)",function(){it("Should return a promise that resolves when all the namespacea are on the global")}),describe("utils.waitForElement(selector)",function(){it("Should return a promise that resolves an element that matches the selector is on the page"),it("Should eventually time out")})})})}},function(t,e,n){"use strict";function r(){return!("undefined"==typeof window)}var o=n(37);n(2).should();e.run=function(t){describe("var web = ctx.web",function(){this.timeout(5e3),describe("ctx.web.getInfo()",function(){it("Should return a promise that resolves to web info",function(e){t.web.getInfo().then(function(t){t.should.have.property("Url"),t.should.have.property("Title"),e()}).catch(function(t){console.log(t)})})}),describe("ctx.web.getSubsites()",function(){it("Should return a promise that resolves to an array of subsite web infos.",function(e){t.web.getSubsites().then(function(t){t.should.be.an("array"),t.length&&(t[0].should.have.property("Title"),t[0].should.have.property("ServerRelativeUrl")),e()})})}),describe("ctx.web.getUser()",function(){var e=null;before(function(n){t.web.getUser().then(function(t){e=t,n()})}),it("Should return a promise that resolves to a user object",function(){e.should.not.be.null,e.should.have.property("Id"),e.should.have.property("LoginName"),e.should.have.property("Email")}),it("Should return the current user",function(){e.should.have.property("Id"),e.Id.should.equal(_spPageContextInfo.userId)})}),describe("ctx.web.getUser(email)",function(){var e="andrew@andrewpetersen.onmicrosoft.com",n=null;before(function(r){t.web.getUser(e).then(function(t){n=t,r()})}),it("Should return a promise that resolves to a user object",function(){n.should.not.be.null,n.should.have.property("Id"),n.should.have.property("LoginName"),n.should.have.property("Email")}),it("Should return a user whose email matches the specified email",function(){n.should.have.property("Email"),n.Email.should.equal(e)})});var e="/spscript/Shared Documents",n="testfile.txt",i=e+"/"+n;describe("ctx.web.getFile(serverRelativeFileUrl)",function(){var e=null;before(function(n){t.web.getFile(i).then(function(t){e=t,n()})}),it("Should return a promise that resolves to a file object",function(){e.should.not.be.null,e.should.property("CheckOutType"),e.should.property("ETag"),e.should.property("Exists"),e.should.property("TimeLastModified"),e.should.property("Name"),e.should.property("UIVersionLabel")})});var s="/spscript/Shared%20Documents/testfile2.txt";describe("ctx.web.copyFile(serverRelativeSourceUrl, serverRelativeDestUrl)",function(){var e=(new Date,null);before(function(n){t.web.copyFile(i,s).then(function(){return t.web.getFile(s)}).then(function(t){e=t,n()}).catch(function(t){"one".should.equal("two","Error in CopyFile requst"),n()})}),it("Should return a promise, and once resolved, the new (copied) file should be retrievable.",function(){e.should.not.be.null,e.should.property("CheckOutType"),e.should.property("ETag"),e.should.property("Exists"),e.should.property("TimeLastModified"),e.should.property("Name"),e.should.property("UIVersionLabel")})}),describe("ctx.web.permissions.getRoleAssignments()",o.create(t.web)),r()&&describe("ctx.web.permissions.check()",o.create(t.web,"check")),describe("ctx.web.permissions.check(email)",o.create(t.web,"check","andrew@andrewpetersen.onmicrosoft.com"))})}},function(t,e){"use strict";function n(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function r(t){return 3*t.length/4-n(t)}function o(t){var e,r,o,i,s,a,u=t.length;s=n(t),a=new h(3*u/4-s),o=s>0?u-4:u;var l=0;for(e=0,r=0;e<o;e+=4,r+=3)i=c[t.charCodeAt(e)]<<18|c[t.charCodeAt(e+1)]<<12|c[t.charCodeAt(e+2)]<<6|c[t.charCodeAt(e+3)],a[l++]=i>>16&255,a[l++]=i>>8&255,a[l++]=255&i;return 2===s?(i=c[t.charCodeAt(e)]<<2|c[t.charCodeAt(e+1)]>>4,a[l++]=255&i):1===s&&(i=c[t.charCodeAt(e)]<<10|c[t.charCodeAt(e+1)]<<4|c[t.charCodeAt(e+2)]>>2,a[l++]=i>>8&255,a[l++]=255&i),a}function i(t){return u[t>>18&63]+u[t>>12&63]+u[t>>6&63]+u[63&t]}function s(t,e,n){for(var r,o=[],s=e;s<n;s+=3)r=(t[s]<<16)+(t[s+1]<<8)+t[s+2],o.push(i(r));return o.join("")}function a(t){for(var e,n=t.length,r=n%3,o="",i=[],a=16383,c=0,h=n-r;c<h;c+=a)i.push(s(t,c,c+a>h?h:c+a));return 1===r?(e=t[n-1],o+=u[e>>2],o+=u[e<<4&63],o+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],o+=u[e>>10],o+=u[e>>4&63],o+=u[e<<2&63],o+="="),i.push(o),i.join("")}e.byteLength=r,e.toByteArray=o,e.fromByteArray=a;for(var u=[],c=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,p=l.length;f<p;++f)u[f]=l[f],c[l.charCodeAt(f)]=f;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(t,e,n){(function(t){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function r(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function o(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=s.prototype):(null===t&&(t=new s(e)),t.length=e),t}function s(t,e,n){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return a(this,t,e,n)}function a(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?p(t,e,n,r):"string"==typeof e?l(t,e,n):d(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function c(t,e,n,r){return u(e),e<=0?i(t,e):void 0!==n?"string"==typeof r?i(t,e).fill(n,r):i(t,e).fill(n):i(t,e)}function h(t,e){if(u(e),t=i(t,e<0?0:0|m(e)),!s.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function l(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!s.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|v(e,n);t=i(t,r);var o=t.write(e,n);return o!==r&&(t=t.slice(0,o)),t}function f(t,e){var n=e.length<0?0:0|m(e.length);t=i(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),s.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=s.prototype):t=f(t,e),t}function d(t,e){if(s.isBuffer(e)){var n=0|m(e.length);return t=i(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||W(e.length)?i(t,0):f(t,e);if("Buffer"===e.type&&Z(e.data))return f(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function y(t){return+t!=t&&(t=0),s.alloc(+t)}function v(t,e){if(s.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(t).length;default:if(r)return G(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return I(this,e,n);case"latin1":case"binary":return q(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function b(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function w(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:S(t,e,n,r,o);if("number"==typeof e)return e&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):S(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function S(t,e,n,r,o){function i(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var s=1,a=t.length,u=e.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}var c;if(o){var h=-1;for(c=n;c<a;c++)if(i(t,c)===i(e,h===-1?0:c-h)){if(h===-1&&(h=c),c-h+1===u)return h*s}else h!==-1&&(c-=c-h),h=-1}else for(n+u>a&&(n=a-u),c=n;c>=0;c--){for(var l=!0,f=0;f<u;f++)if(i(t,c+f)!==i(e,f)){l=!1;break}if(l)return c}return-1}function A(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r),r>o&&(r=o)):r=o;var i=e.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function x(t,e,n,r){return $(G(e,t.length-n),t,n,r)}function _(t,e,n,r){return $(z(e),t,n,r)}function j(t,e,n,r){return _(t,e,n,r)}function T(t,e,n,r){return $(X(e),t,n,r)}function P(t,e,n,r){return $(J(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?Q.fromByteArray(t):Q.fromByteArray(t.slice(e,n))}function O(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i=t[o],s=null,a=i>239?4:i>223?3:i>191?2:1;if(o+a<=n){var u,c,h,l;switch(a){case 1:i<128&&(s=i);break;case 2:u=t[o+1],128===(192&u)&&(l=(31&i)<<6|63&u,l>127&&(s=l));break;case 3:u=t[o+1],c=t[o+2],128===(192&u)&&128===(192&c)&&(l=(15&i)<<12|(63&u)<<6|63&c,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:u=t[o+1],c=t[o+2],h=t[o+3],128===(192&u)&&128===(192&c)&&128===(192&h)&&(l=(15&i)<<18|(63&u)<<12|(63&c)<<6|63&h,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),o+=a}return R(r)}function R(t){var e=t.length;if(e<=tt)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=tt));return n}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function q(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function k(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=Y(t[i]);return o}function U(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function N(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,n,r,o,i){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function M(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function B(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function D(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,r,o){return o||D(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),K.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,o){return o||D(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),K.write(t,e,n,r,52,8),n+8}function V(t){if(t=H(t).replace(et,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function H(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Y(t){return t<16?"0"+t.toString(16):t.toString(16)}function G(t,e){e=e||1/0;for(var n,r=t.length,o=null,i=[],s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function z(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function J(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function X(t){return Q.toByteArray(V(t))}function $(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function W(t){return t!==t}var Q=n(51),K=n(74),Z=n(75);e.Buffer=s,e.SlowBuffer=y,e.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:r(),e.kMaxLength=o(),s.poolSize=8192,s._augment=function(t){return t.__proto__=s.prototype,t},s.from=function(t,e,n){return a(null,t,e,n)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(t,e,n){return c(null,t,e,n)},s.allocUnsafe=function(t){return h(null,t)},s.allocUnsafeSlow=function(t){return h(null,t)},s.isBuffer=function(t){return!(null==t||!t._isBuffer)},s.compare=function(t,e){if(!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Z(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=s.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var i=t[n];if(!s.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},s.byteLength=v,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)b(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},s.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):g.apply(this,arguments)},s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},s.prototype.compare=function(t,e,n,r,o){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var i=o-r,a=n-e,u=Math.min(i,a),c=this.slice(r,o),h=t.slice(e,n),l=0;l<u;++l)if(c[l]!==h[l]){i=c[l],a=h[l];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1},s.prototype.indexOf=function(t,e,n){return w(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return w(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return A(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return j(this,t,e,n);case"base64":return T(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;s.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);var r;if(s.TYPED_ARRAY_SUPPORT)r=this.subarray(t,e),r.__proto__=s.prototype;else{var o=e-t;r=new s(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+t]}return r},s.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},s.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},s.prototype.readUInt8=function(t,e){return e||N(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return e||N(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return e||N(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUInt32BE=function(t,e){return e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},s.prototype.readInt8=function(t,e){return e||N(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},s.prototype.readInt16LE=function(t,e){e||N(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){e||N(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return e||N(t,4,this.length),K.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return e||N(t,4,this.length),K.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return e||N(t,8,this.length),K.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return e||N(t,8,this.length),K.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var o=Math.pow(2,8*n)-1;C(this,t,e,n,o,0)}var i=1,s=0;for(this[e]=255&t;++s<n&&(i*=256);)this[e+s]=t/i&255;return e+n},s.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var o=Math.pow(2,8*n)-1;C(this,t,e,n,o,0)}var i=n-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+n},s.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,255,0),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):B(this,t,e,!0),e+4},s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);C(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);C(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,127,-128),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):B(this,t,e,!0),e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},s.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!s.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var i;if("number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var a=s.isBuffer(t)?t:G(new s(t,r).toString()),u=a.length;for(i=0;i<n-e;++i)this[i+e]=a[i%u]}return this};var et=/[^+\/0-9A-Za-z-_]/g}).call(e,function(){return this}())},function(t,e,n){/*!
	 * chai
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
var r=[],e=t.exports={};/*!
	 * Chai version
	 */
e.version="1.10.0",/*!
	 * Assertion Error
	 */
e.AssertionError=n(42);/*!
	 * Utils for plugins (not exported)
	 */
var o=n(66);e.use=function(t){return~r.indexOf(t)||(t(this,o),r.push(t)),this};/*!
	 * Configuration
	 */
var i=n(5);e.config=i;/*!
	 * Primary `Assertion` prototype
	 */
var s=n(54);e.use(s);/*!
	 * Core Assertions
	 */
var a=n(55);e.use(a);/*!
	 * Expect interface
	 */
var u=n(57);e.use(u);/*!
	 * Should interface
	 */
var c=n(58);e.use(c);/*!
	 * Assert interface
	 */
var h=n(56);e.use(h)},function(t,e,n){/*!
	 * chai
	 * http://chaijs.com
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
var r=n(5),o=function(){};t.exports=function(t,e){/*!
	   * Assertion Constructor
	   *
	   * Creates object for chaining.
	   *
	   * @api private
	   */
function n(t,e,n){s(this,"ssfi",n||arguments.callee),s(this,"object",t),s(this,"message",e)}/*!
	   * Module dependencies.
	   */
var i=t.AssertionError,s=e.flag;/*!
	   * Module export.
	   */
t.Assertion=n,Object.defineProperty(n,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack},set:function(t){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack=t}}),Object.defineProperty(n,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff},set:function(t){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff=t}}),n.addProperty=function(t,n){e.addProperty(this.prototype,t,n)},n.addMethod=function(t,n){e.addMethod(this.prototype,t,n)},n.addChainableMethod=function(t,n,r){e.addChainableMethod(this.prototype,t,n,r)},n.addChainableNoop=function(t,n){e.addChainableMethod(this.prototype,t,o,n)},n.overwriteProperty=function(t,n){e.overwriteProperty(this.prototype,t,n)},n.overwriteMethod=function(t,n){e.overwriteMethod(this.prototype,t,n)},n.overwriteChainableMethod=function(t,n,r){e.overwriteChainableMethod(this.prototype,t,n,r)},/*!
	   * ### .assert(expression, message, negateMessage, expected, actual)
	   *
	   * Executes an expression and check expectations. Throws AssertionError for reporting if test doesn't pass.
	   *
	   * @name assert
	   * @param {Philosophical} expression to be tested
	   * @param {String or Function} message or function that returns message to display if fails
	   * @param {String or Function} negatedMessage or function that returns negatedMessage to display if negated expression fails
	   * @param {Mixed} expected value (remember to check for negation)
	   * @param {Mixed} actual (optional) will default to `this.obj`
	   * @api private
	   */
n.prototype.assert=function(t,n,o,a,u,c){var h=e.test(this,arguments);if(!0!==c&&(c=!1),!0!==r.showDiff&&(c=!1),!h){var n=e.getMessage(this,arguments),l=e.getActual(this,arguments);throw new i(n,{actual:l,expected:a,showDiff:c},r.includeStack?this.assert:s(this,"ssfi"))}},/*!
	   * ### ._obj
	   *
	   * Quick reference to stored `actual` value for plugin developers.
	   *
	   * @api private
	   */
Object.defineProperty(n.prototype,"_obj",{get:function(){return s(this,"object")},set:function(t){s(this,"object",t)}})}},function(t,e){/*!
	 * chai
	 * http://chaijs.com
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e){function n(t,n){n&&w(this,"message",n),t=t.toLowerCase();var r=w(this,"object"),o=~["a","e","i","o","u"].indexOf(t.charAt(0))?"an ":"a ";this.assert(t===e.type(r),"expected #{this} to be "+o+t,"expected #{this} not to be "+o+t)}function r(){w(this,"contains",!0)}function o(t,n){n&&w(this,"message",n);var r=w(this,"object"),o=!1;if("array"===e.type(r)&&"object"===e.type(t)){for(var i in r)if(e.eql(r[i],t)){o=!0;break}}else if("object"===e.type(t)){if(!w(this,"negate")){for(var s in t)new b(r).property(s,t[s]);return}var a={};for(var s in t)a[s]=r[s];o=e.eql(a,t)}else o=r&&~r.indexOf(t);this.assert(o,"expected #{this} to include "+e.inspect(t),"expected #{this} to not include "+e.inspect(t))}function i(){var t=w(this,"object"),e=Object.prototype.toString.call(t);this.assert("[object Arguments]"===e,"expected #{this} to be arguments but got "+e,"expected #{this} to not be arguments")}function s(t,e){e&&w(this,"message",e);var n=w(this,"object");return w(this,"deep")?this.eql(t):void this.assert(t===n,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",t,this._obj,!0)}function a(t,n){n&&w(this,"message",n),this.assert(e.eql(t,w(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",t,this._obj,!0)}function u(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"doLength")){new b(n,e).to.have.property("length");var r=n.length;this.assert(r>t,"expected #{this} to have a length above #{exp} but got #{act}","expected #{this} to not have a length above #{exp}",t,r)}else this.assert(n>t,"expected #{this} to be above "+t,"expected #{this} to be at most "+t)}function c(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"doLength")){new b(n,e).to.have.property("length");var r=n.length;this.assert(r>=t,"expected #{this} to have a length at least #{exp} but got #{act}","expected #{this} to have a length below #{exp}",t,r)}else this.assert(n>=t,"expected #{this} to be at least "+t,"expected #{this} to be below "+t)}function h(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"doLength")){new b(n,e).to.have.property("length");var r=n.length;this.assert(r<t,"expected #{this} to have a length below #{exp} but got #{act}","expected #{this} to not have a length below #{exp}",t,r)}else this.assert(n<t,"expected #{this} to be below "+t,"expected #{this} to be at least "+t)}function l(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"doLength")){new b(n,e).to.have.property("length");var r=n.length;this.assert(r<=t,"expected #{this} to have a length at most #{exp} but got #{act}","expected #{this} to have a length above #{exp}",t,r)}else this.assert(n<=t,"expected #{this} to be at most "+t,"expected #{this} to be above "+t)}function f(t,n){n&&w(this,"message",n);var r=e.getName(t);this.assert(w(this,"object")instanceof t,"expected #{this} to be an instance of "+r,"expected #{this} to not be an instance of "+r)}function p(t,n){n&&w(this,"message",n);var r=w(this,"object");this.assert(r.hasOwnProperty(t),"expected #{this} to have own property "+e.inspect(t),"expected #{this} to not have own property "+e.inspect(t))}function d(){w(this,"doLength",!0)}function m(t,e){e&&w(this,"message",e);var n=w(this,"object");new b(n,e).to.have.property("length");var r=n.length;this.assert(r==t,"expected #{this} to have a length of #{exp} but got #{act}","expected #{this} to not have a length of #{act}",t,r)}function y(t){var n,r=w(this,"object"),o=!0;if(t=t instanceof Array?t:Array.prototype.slice.call(arguments),!t.length)throw new Error("keys required");var i=Object.keys(r),s=t,a=t.length;if(o=t.every(function(t){return~i.indexOf(t)}),w(this,"negate")||w(this,"contains")||(o=o&&t.length==i.length),a>1){t=t.map(function(t){return e.inspect(t)});var u=t.pop();n=t.join(", ")+", and "+u}else n=e.inspect(t[0]);n=(a>1?"keys ":"key ")+n,n=(w(this,"contains")?"contain ":"have ")+n,this.assert(o,"expected #{this} to "+n,"expected #{this} to not "+n,s.sort(),i.sort(),!0)}function v(t,n,r){r&&w(this,"message",r);var o=w(this,"object");new b(o,r).is.a("function");var i=!1,s=null,a=null,u=null;0===arguments.length?(n=null,t=null):t&&(t instanceof RegExp||"string"==typeof t)?(n=t,t=null):t&&t instanceof Error?(s=t,t=null,n=null):"function"==typeof t?(a=t.prototype.name||t.name,"Error"===a&&t!==Error&&(a=(new t).name)):t=null;try{o()}catch(r){if(s)return this.assert(r===s,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}",s instanceof Error?s.toString():s,r instanceof Error?r.toString():r),w(this,"object",r),this;if(t&&(this.assert(r instanceof t,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp} but #{act} was thrown",a,r instanceof Error?r.toString():r),!n))return w(this,"object",r),this;var c="object"===e.type(r)&&"message"in r?r.message:""+r;if(null!=c&&n&&n instanceof RegExp)return this.assert(n.exec(c),"expected #{this} to throw error matching #{exp} but got #{act}","expected #{this} to throw error not matching #{exp}",n,c),w(this,"object",r),this;if(null!=c&&n&&"string"==typeof n)return this.assert(~c.indexOf(n),"expected #{this} to throw error including #{exp} but got #{act}","expected #{this} to throw error not including #{act}",n,c),w(this,"object",r),this;i=!0,u=r}var h="",l=null!==a?a:s?"#{exp}":"an error";i&&(h=" but #{act} was thrown"),this.assert(i===!0,"expected #{this} to throw "+l+h,"expected #{this} to not throw "+l+h,s instanceof Error?s.toString():s,u instanceof Error?u.toString():u),w(this,"object",u)}function g(t,e,n){return t.every(function(t){return n?e.some(function(e){return n(t,e)}):e.indexOf(t)!==-1})}var b=t.Assertion,w=(Object.prototype.toString,e.flag);["to","be","been","is","and","has","have","with","that","at","of","same"].forEach(function(t){b.addProperty(t,function(){return this})}),b.addProperty("not",function(){w(this,"negate",!0)}),b.addProperty("deep",function(){w(this,"deep",!0)}),b.addChainableMethod("an",n),b.addChainableMethod("a",n),b.addChainableMethod("include",o,r),b.addChainableMethod("contain",o,r),b.addChainableNoop("ok",function(){this.assert(w(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),b.addChainableNoop("true",function(){this.assert(!0===w(this,"object"),"expected #{this} to be true","expected #{this} to be false",!this.negate)}),b.addChainableNoop("false",function(){this.assert(!1===w(this,"object"),"expected #{this} to be false","expected #{this} to be true",!!this.negate)}),b.addChainableNoop("null",function(){this.assert(null===w(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),b.addChainableNoop("undefined",function(){this.assert(void 0===w(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),b.addChainableNoop("exist",function(){this.assert(null!=w(this,"object"),"expected #{this} to exist","expected #{this} to not exist")}),b.addChainableNoop("empty",function(){var t=w(this,"object"),e=t;Array.isArray(t)||"string"==typeof object?e=t.length:"object"==typeof t&&(e=Object.keys(t).length),this.assert(!e,"expected #{this} to be empty","expected #{this} not to be empty")}),b.addChainableNoop("arguments",i),b.addChainableNoop("Arguments",i),b.addMethod("equal",s),b.addMethod("equals",s),b.addMethod("eq",s),b.addMethod("eql",a),b.addMethod("eqls",a),b.addMethod("above",u),b.addMethod("gt",u),b.addMethod("greaterThan",u),b.addMethod("least",c),b.addMethod("gte",c),b.addMethod("below",h),b.addMethod("lt",h),b.addMethod("lessThan",h),b.addMethod("most",l),b.addMethod("lte",l),b.addMethod("within",function(t,e,n){n&&w(this,"message",n);var r=w(this,"object"),o=t+".."+e;if(w(this,"doLength")){new b(r,n).to.have.property("length");var i=r.length;this.assert(i>=t&&i<=e,"expected #{this} to have a length within "+o,"expected #{this} to not have a length within "+o)}else this.assert(r>=t&&r<=e,"expected #{this} to be within "+o,"expected #{this} to not be within "+o)}),b.addMethod("instanceof",f),b.addMethod("instanceOf",f),b.addMethod("property",function(t,n,r){r&&w(this,"message",r);var o=w(this,"deep")?"deep property ":"property ",i=w(this,"negate"),s=w(this,"object"),a=w(this,"deep")?e.getPathValue(t,s):s[t];if(i&&void 0!==n){if(void 0===a)throw r=null!=r?r+": ":"",new Error(r+e.inspect(s)+" has no "+o+e.inspect(t))}else this.assert(void 0!==a,"expected #{this} to have a "+o+e.inspect(t),"expected #{this} to not have "+o+e.inspect(t));void 0!==n&&this.assert(n===a,"expected #{this} to have a "+o+e.inspect(t)+" of #{exp}, but got #{act}","expected #{this} to not have a "+o+e.inspect(t)+" of #{act}",n,a),w(this,"object",a)}),b.addMethod("ownProperty",p),b.addMethod("haveOwnProperty",p),b.addChainableMethod("length",m,d),b.addMethod("lengthOf",m),b.addMethod("match",function(t,e){e&&w(this,"message",e);var n=w(this,"object");this.assert(t.exec(n),"expected #{this} to match "+t,"expected #{this} not to match "+t)}),b.addMethod("string",function(t,n){n&&w(this,"message",n);var r=w(this,"object");new b(r,n).is.a("string"),this.assert(~r.indexOf(t),"expected #{this} to contain "+e.inspect(t),"expected #{this} to not contain "+e.inspect(t))}),b.addMethod("keys",y),b.addMethod("key",y),b.addMethod("throw",v),b.addMethod("throws",v),b.addMethod("Throw",v),b.addMethod("respondTo",function(t,n){n&&w(this,"message",n);var r=w(this,"object"),o=w(this,"itself"),i="function"!==e.type(r)||o?r[t]:r.prototype[t];this.assert("function"==typeof i,"expected #{this} to respond to "+e.inspect(t),"expected #{this} to not respond to "+e.inspect(t))}),b.addProperty("itself",function(){w(this,"itself",!0)}),b.addMethod("satisfy",function(t,n){n&&w(this,"message",n);var r=w(this,"object"),o=t(r);this.assert(o,"expected #{this} to satisfy "+e.objDisplay(t),"expected #{this} to not satisfy"+e.objDisplay(t),!this.negate,o)}),b.addMethod("closeTo",function(t,n,r){r&&w(this,"message",r);var o=w(this,"object");if(new b(o,r).is.a("number"),"number"!==e.type(t)||"number"!==e.type(n))throw new Error("the arguments to closeTo must be numbers");this.assert(Math.abs(o-t)<=n,"expected #{this} to be close to "+t+" +/- "+n,"expected #{this} not to be close to "+t+" +/- "+n)}),b.addMethod("members",function(t,n){n&&w(this,"message",n);var r=w(this,"object");new b(r).to.be.an("array"),new b(t).to.be.an("array");var o=w(this,"deep")?e.eql:void 0;return w(this,"contains")?this.assert(g(t,r,o),"expected #{this} to be a superset of #{act}","expected #{this} to not be a superset of #{act}",r,t):void this.assert(g(r,t,o)&&g(t,r,o),"expected #{this} to have the same members as #{act}","expected #{this} to not have the same members as #{act}",r,t)})}},function(module,exports){/*!
	 * chai
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
module.exports=function(chai,util){/*!
	   * Chai dependencies.
	   */
var Assertion=chai.Assertion,flag=util.flag,assert=chai.assert=function(t,e){var n=new Assertion(null,null,chai.assert);n.assert(t,e,"[ negation message unavailable ]")};assert.fail=function(t,e,n,r){throw n=n||"assert.fail()",new chai.AssertionError(n,{actual:t,expected:e,operator:r},assert.fail)},assert.ok=function(t,e){new Assertion(t,e).is.ok},assert.notOk=function(t,e){new Assertion(t,e).is.not.ok},assert.equal=function(t,e,n){var r=new Assertion(t,n,assert.equal);r.assert(e==flag(r,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",e,t)},assert.notEqual=function(t,e,n){var r=new Assertion(t,n,assert.notEqual);r.assert(e!=flag(r,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",e,t)},assert.strictEqual=function(t,e,n){new Assertion(t,n).to.equal(e)},assert.notStrictEqual=function(t,e,n){new Assertion(t,n).to.not.equal(e)},assert.deepEqual=function(t,e,n){new Assertion(t,n).to.eql(e)},assert.notDeepEqual=function(t,e,n){new Assertion(t,n).to.not.eql(e)},assert.isTrue=function(t,e){new Assertion(t,e).is.true},assert.isFalse=function(t,e){new Assertion(t,e).is.false},assert.isNull=function(t,e){new Assertion(t,e).to.equal(null)},assert.isNotNull=function(t,e){new Assertion(t,e).to.not.equal(null)},assert.isUndefined=function(t,e){new Assertion(t,e).to.equal(void 0)},assert.isDefined=function(t,e){new Assertion(t,e).to.not.equal(void 0)},assert.isFunction=function(t,e){new Assertion(t,e).to.be.a("function")},assert.isNotFunction=function(t,e){new Assertion(t,e).to.not.be.a("function")},assert.isObject=function(t,e){new Assertion(t,e).to.be.a("object")},assert.isNotObject=function(t,e){new Assertion(t,e).to.not.be.a("object")},assert.isArray=function(t,e){new Assertion(t,e).to.be.an("array")},assert.isNotArray=function(t,e){new Assertion(t,e).to.not.be.an("array")},assert.isString=function(t,e){new Assertion(t,e).to.be.a("string")},assert.isNotString=function(t,e){new Assertion(t,e).to.not.be.a("string")},assert.isNumber=function(t,e){new Assertion(t,e).to.be.a("number")},assert.isNotNumber=function(t,e){new Assertion(t,e).to.not.be.a("number")},assert.isBoolean=function(t,e){new Assertion(t,e).to.be.a("boolean")},assert.isNotBoolean=function(t,e){new Assertion(t,e).to.not.be.a("boolean")},assert.typeOf=function(t,e,n){new Assertion(t,n).to.be.a(e)},assert.notTypeOf=function(t,e,n){new Assertion(t,n).to.not.be.a(e)},assert.instanceOf=function(t,e,n){new Assertion(t,n).to.be.instanceOf(e)},assert.notInstanceOf=function(t,e,n){new Assertion(t,n).to.not.be.instanceOf(e)},assert.include=function(t,e,n){new Assertion(t,n,assert.include).include(e)},assert.notInclude=function(t,e,n){new Assertion(t,n,assert.notInclude).not.include(e)},assert.match=function(t,e,n){new Assertion(t,n).to.match(e)},assert.notMatch=function(t,e,n){new Assertion(t,n).to.not.match(e)},assert.property=function(t,e,n){new Assertion(t,n).to.have.property(e)},assert.notProperty=function(t,e,n){new Assertion(t,n).to.not.have.property(e)},assert.deepProperty=function(t,e,n){new Assertion(t,n).to.have.deep.property(e)},assert.notDeepProperty=function(t,e,n){new Assertion(t,n).to.not.have.deep.property(e)},assert.propertyVal=function(t,e,n,r){new Assertion(t,r).to.have.property(e,n)},assert.propertyNotVal=function(t,e,n,r){new Assertion(t,r).to.not.have.property(e,n)},assert.deepPropertyVal=function(t,e,n,r){new Assertion(t,r).to.have.deep.property(e,n)},assert.deepPropertyNotVal=function(t,e,n,r){new Assertion(t,r).to.not.have.deep.property(e,n)},assert.lengthOf=function(t,e,n){new Assertion(t,n).to.have.length(e)},assert.Throw=function(t,e,n,r){("string"==typeof e||e instanceof RegExp)&&(n=e,e=null);var o=new Assertion(t,r).to.Throw(e,n);return flag(o,"object")},assert.doesNotThrow=function(t,e,n){"string"==typeof e&&(n=e,e=null),new Assertion(t,n).to.not.Throw(e)},assert.operator=function(val,operator,val2,msg){if(!~["==","===",">",">=","<","<=","!=","!=="].indexOf(operator))throw new Error('Invalid operator "'+operator+'"');var test=new Assertion(eval(val+operator+val2),msg);test.assert(!0===flag(test,"object"),"expected "+util.inspect(val)+" to be "+operator+" "+util.inspect(val2),"expected "+util.inspect(val)+" to not be "+operator+" "+util.inspect(val2))},assert.closeTo=function(t,e,n,r){new Assertion(t,r).to.be.closeTo(e,n)},assert.sameMembers=function(t,e,n){new Assertion(t,n).to.have.same.members(e)},assert.includeMembers=function(t,e,n){new Assertion(t,n).to.include.members(e)},/*!
	   * Undocumented / untested
	   */
assert.ifError=function(t,e){new Assertion(t,e).to.not.be.ok},/*!
	   * Aliases.
	   */
function t(e,n){return assert[n]=assert[e],t}("Throw","throw")("Throw","throws")}},function(t,e){/*!
	 * chai
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e){t.expect=function(e,n){return new t.Assertion(e,n)}}},function(t,e){/*!
	 * chai
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e){function n(){function t(){return this instanceof String||this instanceof Number?new r(this.constructor(this),null,t):this instanceof Boolean?new r(1==this,null,t):new r(this,null,t)}function e(t){Object.defineProperty(this,"should",{value:t,enumerable:!0,configurable:!0,writable:!0})}Object.defineProperty(Object.prototype,"should",{set:e,get:t,configurable:!0});var n={};return n.equal=function(t,e,n){new r(t,n).to.equal(e)},n.Throw=function(t,e,n,o){new r(t,o).to.Throw(e,n)},n.exist=function(t,e){new r(t,e).to.exist},n.not={},n.not.equal=function(t,e,n){new r(t,n).to.not.equal(e)},n.not.Throw=function(t,e,n,o){new r(t,o).to.not.Throw(e,n)},n.not.exist=function(t,e){new r(t,e).to.not.exist},n.throw=n.Throw,n.not.throw=n.not.Throw,n}var r=t.Assertion;t.should=n,t.Should=n}},function(t,e,n){/*!
	 * Chai - addChainingMethod utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependencies
	 */
var r=n(41),o=n(6),i=n(5),s="__proto__"in Object,a=/^(?:length|name|arguments|caller)$/,u=Function.prototype.call,c=Function.prototype.apply;t.exports=function(t,e,n,h){"function"!=typeof h&&(h=function(){});var l={method:n,chainingBehavior:h};t.__methods||(t.__methods={}),t.__methods[e]=l,Object.defineProperty(t,e,{get:function(){l.chainingBehavior.call(this);var e=function t(){var e=o(this,"ssfi");e&&i.includeStack===!1&&o(this,"ssfi",t);var n=l.method.apply(this,arguments);return void 0===n?this:n};if(s){var n=e.__proto__=Object.create(this);n.call=u,n.apply=c}else{var h=Object.getOwnPropertyNames(t);h.forEach(function(n){if(!a.test(n)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r)}})}return r(this,e),e},configurable:!0})}},function(t,e,n){/*!
	 * Chai - addMethod utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
var r=n(5),o=n(6);t.exports=function(t,e,n){t[e]=function(){var i=o(this,"ssfi");i&&r.includeStack===!1&&o(this,"ssfi",t[e]);var s=n.apply(this,arguments);return void 0===s?this:s}}},function(t,e){/*!
	 * Chai - addProperty utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){Object.defineProperty(t,e,{get:function(){var t=n.call(this);return void 0===t?this:t},configurable:!0})}},function(t,e){/*!
	 * Chai - getEnumerableProperties utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t){var e=[];for(var n in t)e.push(n);return e}},function(t,e,n){/*!
	 * Chai - message composition utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependancies
	 */
var r=n(6),o=n(38),i=(n(24),n(40));t.exports=function(t,e){var n=r(t,"negate"),s=r(t,"object"),a=e[3],u=o(t,e),c=n?e[2]:e[1],h=r(t,"message");return"function"==typeof c&&(c=c()),c=c||"",c=c.replace(/#{this}/g,i(s)).replace(/#{act}/g,i(u)).replace(/#{exp}/g,i(a)),h?h+": "+c:c}},function(t,e){/*!
	 * ## parsePath(path)
	 *
	 * Helper function used to parse string object
	 * paths. Use in conjunction with `_getPathValue`.
	 *
	 *      var parsed = parsePath('myobject.property.subprop');
	 *
	 * ### Paths:
	 *
	 * * Can be as near infinitely deep and nested
	 * * Arrays are also valid using the formal `myobject.document[3].property`.
	 *
	 * @param {String} path
	 * @returns {Object} parsed
	 * @api private
	 */
function n(t){var e=t.replace(/\[/g,".["),n=e.match(/(\\\.|[^.]+?)+/g);return n.map(function(t){var e=/\[(\d+)\]$/,n=e.exec(t);return n?{i:parseFloat(n[1])}:{p:t}})}/*!
	 * ## _getPathValue(parsed, obj)
	 *
	 * Helper companion function for `.parsePath` that returns
	 * the value located at the parsed address.
	 *
	 *      var value = getPathValue(parsed, obj);
	 *
	 * @param {Object} parsed definition from `parsePath`.
	 * @param {Object} object to search against
	 * @returns {Object|Undefined} value
	 * @api private
	 */
function r(t,e){for(var n,r=e,o=0,i=t.length;o<i;o++){var s=t[o];r?("undefined"!=typeof s.p?r=r[s.p]:"undefined"!=typeof s.i&&(r=r[s.i]),o==i-1&&(n=r)):n=void 0}return n}/*!
	 * Chai - getPathValue utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * @see https://github.com/logicalparadox/filtr
	 * MIT Licensed
	 */
t.exports=function(t,e){var o=n(t);return r(o,e)}},function(t,e){/*!
	 * Chai - getProperties utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t){function e(t){n.indexOf(t)===-1&&n.push(t)}for(var n=Object.getOwnPropertyNames(subject),r=Object.getPrototypeOf(subject);null!==r;)Object.getOwnPropertyNames(r).forEach(e),r=Object.getPrototypeOf(r);return n}},function(t,e,n){/*!
	 * chai
	 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Main exports
	 */
var e=t.exports={};/*!
	 * test utility
	 */
e.test=n(70),/*!
	 * type utility
	 */
e.type=n(71),/*!
	 * message utility
	 */
e.getMessage=n(63),/*!
	 * actual utility
	 */
e.getActual=n(38),/*!
	 * Inspect util
	 */
e.inspect=n(24),/*!
	 * Object Display util
	 */
e.objDisplay=n(40),/*!
	 * Flag utility
	 */
e.flag=n(6),/*!
	 * Flag transferring utility
	 */
e.transferFlags=n(41),/*!
	 * Deep equal utility
	 */
e.eql=n(72),/*!
	 * Deep path value
	 */
e.getPathValue=n(64),/*!
	 * Function name
	 */
e.getName=n(39),/*!
	 * add Property
	 */
e.addProperty=n(61),/*!
	 * add Method
	 */
e.addMethod=n(60),/*!
	 * overwrite Property
	 */
e.overwriteProperty=n(69),/*!
	 * overwrite Method
	 */
e.overwriteMethod=n(68),/*!
	 * Add a chainable method
	 */
e.addChainableMethod=n(59),/*!
	 * Overwrite chainable method
	 */
e.overwriteChainableMethod=n(67)},function(t,e){/*!
	 * Chai - overwriteChainableMethod utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n,r){var o=t.__methods[e],i=o.chainingBehavior;o.chainingBehavior=function(){var t=r(i).call(this);return void 0===t?this:t};var s=o.method;o.method=function(){var t=n(s).apply(this,arguments);return void 0===t?this:t}}},function(t,e){/*!
	 * Chai - overwriteMethod utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){var r=t[e],o=function(){return this};r&&"function"==typeof r&&(o=r),t[e]=function(){var t=n(o).apply(this,arguments);return void 0===t?this:t}}},function(t,e){/*!
	 * Chai - overwriteProperty utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e),o=function(){};r&&"function"==typeof r.get&&(o=r.get),Object.defineProperty(t,e,{get:function(){var t=n(o).call(this);return void 0===t?this:t},configurable:!0})}},function(t,e,n){/*!
	 * Chai - test utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependancies
	 */
var r=n(6);t.exports=function(t,e){var n=r(t,"negate"),o=e[0];return n?!o:o}},function(t,e){/*!
	 * Chai - type utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Detectable javascript natives
	 */
var n={"[object Arguments]":"arguments","[object Array]":"array","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string"};t.exports=function(t){var e=Object.prototype.toString.call(t);return n[e]?n[e]:null===t?"null":void 0===t?"undefined":t===Object(t)?"object":typeof t}},function(t,e,n){t.exports=n(73)},function(t,e,n){function r(t,e,n){return!!o(t,e)||("date"===m(t)?s(t,e):"regexp"===m(t)?a(t,e):d.isBuffer(t)?l(t,e):"arguments"===m(t)?u(t,e,n):!!i(t,e)&&("object"!==m(t)&&"object"!==m(e)&&"array"!==m(t)&&"array"!==m(e)?o(t,e):p(t,e,n)))}/*!
	 * Strict (egal) equality test. Ensures that NaN always
	 * equals NaN and `-0` does not equal `+0`.
	 *
	 * @param {Mixed} a
	 * @param {Mixed} b
	 * @return {Boolean} equal match
	 */
function o(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}/*!
	 * Compare the types of two given objects and
	 * return if they are equal. Note that an Array
	 * has a type of `array` (not `object`) and arguments
	 * have a type of `arguments` (not `array`/`object`).
	 *
	 * @param {Mixed} a
	 * @param {Mixed} b
	 * @return {Boolean} result
	 */
function i(t,e){return m(t)===m(e)}/*!
	 * Compare two Date objects by asserting that
	 * the time values are equal using `saveValue`.
	 *
	 * @param {Date} a
	 * @param {Date} b
	 * @return {Boolean} result
	 */
function s(t,e){return"date"===m(e)&&o(t.getTime(),e.getTime())}/*!
	 * Compare two regular expressions by converting them
	 * to string and checking for `sameValue`.
	 *
	 * @param {RegExp} a
	 * @param {RegExp} b
	 * @return {Boolean} result
	 */
function a(t,e){return"regexp"===m(e)&&o(t.toString(),e.toString())}/*!
	 * Assert deep equality of two `arguments` objects.
	 * Unfortunately, these must be sliced to arrays
	 * prior to test to ensure no bad behavior.
	 *
	 * @param {Arguments} a
	 * @param {Arguments} b
	 * @param {Array} memoize (optional)
	 * @return {Boolean} result
	 */
function u(t,e,n){return"arguments"===m(e)&&(t=[].slice.call(t),e=[].slice.call(e),r(t,e,n))}/*!
	 * Get enumerable properties of a given object.
	 *
	 * @param {Object} a
	 * @return {Array} property names
	 */
function c(t){var e=[];for(var n in t)e.push(n);return e}/*!
	 * Simple equality for flat iterable objects
	 * such as Arrays or Node.js buffers.
	 *
	 * @param {Iterable} a
	 * @param {Iterable} b
	 * @return {Boolean} result
	 */
function h(t,e){if(t.length!==e.length)return!1;for(var n=0,r=!0;n<t.length;n++)if(t[n]!==e[n]){r=!1;break}return r}/*!
	 * Extension to `iterableEqual` specifically
	 * for Node.js Buffers.
	 *
	 * @param {Buffer} a
	 * @param {Mixed} b
	 * @return {Boolean} result
	 */
function l(t,e){return!!d.isBuffer(e)&&h(t,e)}/*!
	 * Block for `objectEqual` ensuring non-existing
	 * values don't get in.
	 *
	 * @param {Mixed} object
	 * @return {Boolean} result
	 */
function f(t){return null!==t&&void 0!==t}/*!
	 * Recursively check the equality of two objects.
	 * Once basic sameness has been established it will
	 * defer to `deepEqual` for each enumerable key
	 * in the object.
	 *
	 * @param {Mixed} a
	 * @param {Mixed} b
	 * @return {Boolean} result
	 */
function p(t,e,n){if(!f(t)||!f(e))return!1;if(t.prototype!==e.prototype)return!1;var o;if(n){for(o=0;o<n.length;o++)if(n[o][0]===t&&n[o][1]===e||n[o][0]===e&&n[o][1]===t)return!0}else n=[];try{var i=c(t),s=c(e)}catch(t){return!1}if(i.sort(),s.sort(),!h(i,s))return!1;n.push([t,e]);var a;for(o=i.length-1;o>=0;o--)if(a=i[o],!r(t[a],e[a],n))return!1;return!0}/*!
	 * deep-eql
	 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependencies
	 */
var d,m=n(76);try{d=n(52).Buffer}catch(t){d={},d.isBuffer=function(){return!1}}/*!
	 * Primary Export
	 */
t.exports=r},function(t,e){e.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,c=u>>1,h=-7,l=n?o-1:0,f=n?-1:1,p=t[e+l];for(l+=f,i=p&(1<<-h)-1,p>>=-h,h+=a;h>0;i=256*i+t[e+l],l+=f,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=r;h>0;s=256*s+t[e+l],l+=f,h-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,r),i-=c}return(p?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var s,a,u,c=8*i-o-1,h=(1<<c)-1,l=h>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+l>=1?f/u:f*Math.pow(2,1-l),e*u>=2&&(s++,u/=2),s+l>=h?(a=0,s=h):s+l>=1?(a=(e*u-1)*Math.pow(2,o),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){t.exports=n(77)},function(t,e){function n(t){var e=Object.prototype.toString.call(t);return o[e]?o[e]:null===t?"null":void 0===t?"undefined":t===Object(t)?"object":typeof t}function r(){this.tests={}}/*!
	 * type-detect
	 * Copyright(c) 2013 jake luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Primary Exports
	 */
var e=t.exports=n,o={"[object Array]":"array","[object RegExp]":"regexp","[object Function]":"function","[object Arguments]":"arguments","[object Date]":"date"};e.Library=r,r.prototype.of=n,r.prototype.define=function(t,e){return 1===arguments.length?this.tests[t]:(this.tests[t]=e,this)},r.prototype.test=function(t,e){if(e===n(t))return!0;var r=this.tests[e];if(r&&"regexp"===n(r))return r.test(t);if(r&&"function"===n(r))return r(t);throw new ReferenceError('Type test "'+e+'" not defined or invalid.')}}]);
//# sourceMappingURL=tests.js.map