!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("SPScript",[],t):"object"==typeof exports?exports.SPScript=t():e.SPScript=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=37)}([,function(e,t,n){e.exports=n(40)},function(e,t){/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){var r=e.__flags||(e.__flags=Object.create(null));if(3!==arguments.length)return r[t];r[t]=n}},function(e,t){e.exports={includeStack:!1,showDiff:!0,truncateThreshold:40}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){function r(e,t,n,r){return o({showHidden:t,seen:[],stylize:function(e){return e}},e,void 0===n?2:n)}function o(e,n,r){if(n&&"function"==typeof n.inspect&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var d=n.inspect(r);return"string"!=typeof d&&(d=o(e,d,r)),d}var b=i(e,n);if(b)return b;if(g(n)){if("outerHTML"in n)return n.outerHTML;try{if(document.xmlVersion){return(new XMLSerializer).serializeToString(n)}var w=document.createElementNS("http://www.w3.org/1999/xhtml","_");return w.appendChild(n.cloneNode(!1)),html=w.innerHTML.replace("><",">"+n.innerHTML+"<"),w.innerHTML="",html}catch(e){}}var S=v(n),x=e.showHidden?y(n):S;if(0===x.length||p(n)&&(1===x.length&&"stack"===x[0]||2===x.length&&"description"===x[0]&&"stack"===x[1])){if("function"==typeof n){var A=m(n),j=A?": "+A:"";return e.stylize("[Function"+j+"]","special")}if(l(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(f(n))return e.stylize(Date.prototype.toUTCString.call(n),"date");if(p(n))return s(n)}var _="",P=!1,O=["{","}"];if(h(n)&&(P=!0,O=["[","]"]),"function"==typeof n){var A=m(n),j=A?": "+A:"";_=" [Function"+j+"]"}if(l(n)&&(_=" "+RegExp.prototype.toString.call(n)),f(n)&&(_=" "+Date.prototype.toUTCString.call(n)),p(n))return s(n);if(0===x.length&&(!P||0==n.length))return O[0]+_+O[1];if(r<0)return l(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var E;return E=P?a(e,n,r,S,x):x.map(function(t){return u(e,n,r,S,t,P)}),e.seen.pop(),c(E,_,O)}function i(e,t){switch(typeof t){case"undefined":return e.stylize("undefined","undefined");case"string":var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string");case"number":return 0===t&&1/t==-1/0?e.stylize("-0","number"):e.stylize(""+t,"number");case"boolean":return e.stylize(""+t,"boolean")}if(null===t)return e.stylize("null","null")}function s(e){return"["+Error.prototype.toString.call(e)+"]"}function a(e,t,n,r,o){for(var i=[],s=0,a=t.length;s<a;++s)Object.prototype.hasOwnProperty.call(t,String(s))?i.push(u(e,t,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(u(e,t,n,r,o,!0))}),i}function u(e,t,n,r,i,s){var a,u;if(t.__lookupGetter__&&(t.__lookupGetter__(i)?u=t.__lookupSetter__(i)?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):t.__lookupSetter__(i)&&(u=e.stylize("[Setter]","special"))),r.indexOf(i)<0&&(a="["+i+"]"),u||(e.seen.indexOf(t[i])<0?(u=null===n?o(e,t[i],null):o(e,t[i],n-1),u.indexOf("\n")>-1&&(u=s?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),void 0===a){if(s&&i.match(/^\d+$/))return u;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+u}function c(e,t,n){var r=0;return e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function h(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===d(e)}function l(e){return"object"==typeof e&&"[object RegExp]"===d(e)}function f(e){return"object"==typeof e&&"[object Date]"===d(e)}function p(e){return"object"==typeof e&&"[object Error]"===d(e)}function d(e){return Object.prototype.toString.call(e)}var m=n(11),y=n(46),v=n(47);e.exports=r;var g=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}},,,function(e,t){/*!
 * Chai - getActual utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){return t.length>4?t[4]:e._obj}},function(e,t){/*!
 * Chai - getName utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){if(e.name)return e.name;var t=/^\s?function ([^(]*)\(/.exec(e);return t&&t[1]?t[1]:""}},function(e,t,n){/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependancies
 */
var r=n(7),o=n(3);e.exports=function(e){var t=r(e),n=Object.prototype.toString.call(e);if(o.truncateThreshold&&t.length>=o.truncateThreshold){if("[object Function]"===n)return e.name&&""!==e.name?"[Function: "+e.name+"]":"[Function]";if("[object Array]"===n)return"[ Array("+e.length+") ]";if("[object Object]"===n){var i=Object.keys(e);return"{ Object ("+(i.length>2?i.splice(0,2).join(", ")+", ...":i.join(", "))+") }"}return t}return t}},function(e,t){/*!
 * Chai - transferFlags utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){var r=e.__flags||(e.__flags=Object.create(null));t.__flags||(t.__flags=Object.create(null)),n=3!==arguments.length||n;for(var o in r)(n||"object"!==o&&"ssfi"!==o&&"message"!=o)&&(t.__flags[o]=r[o])}},function(e,t,n){"use strict";n(1).should(),t.create=function(e,t,n){return"check"===t?function(){var t=null;before(function(r){e.permissions.check(n).then(function(e){t=e,r()}).catch(function(e){r(e)})}),it("Should return a promise that resolves to an array of base permission strings",function(){t.should.be.an("array"),t.should.not.be.empty}),it("Should reject the promise for an invalid email",function(t){e.permissions.check("invalid@invalid123.com").then(function(e){"one".should.equal("two"),t()}).catch(function(e){t()})})}:function(){var t=null;before(function(n){e.permissions.getRoleAssignments().then(function(e){t=e,n()})}),it("Should return a promise that resolves to an array of objects",function(){t.should.be.an("array"),t.should.not.be.empty}),it("Should return objects that each have a member and a roles array",function(){t.forEach(function(e){e.should.have.property("member"),e.should.have.property("roles"),e.roles.should.be.an("array")})}),it("Should return permission objects that contain member.name, member.login, and member.id",function(){t.forEach(function(e){e.member.should.have.property("name"),e.member.should.have.property("login"),e.member.should.have.property("id")})}),it("Should return permission objects, each with a roles array that has a name and description",function(){t.forEach(function(e){e.roles.forEach(function(e){e.should.have.property("name"),e.should.have.property("description")})})})}}},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";mocha.setup("bdd"),chai.should();var r=n(38);n(39).run(r),mocha.run()},function(e,t,n){"use strict";(function(e){var n,r,o,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(i,a){"object"==s(t)&&"object"==s(e)?e.exports=a():(r=[],n=a,void 0!==(o="function"==typeof n?n.apply(t,r):n)&&(e.exports=o))}(0,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=16)}([function(e,t,n){function r(){return!("undefined"==typeof window)}function o(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return null}return e}function s(e){e=o(e);var t=null;return e.d&&e.d.results&&null!=e.d.results.length?t=e.d.results:e.d&&(t=e.d),t||e}function a(e,t){p().then(function(){var n={title:" "},r=i({},n,t,{url:e});return SP.UI.ModalDialog.showModalDialog(r)})}Object.defineProperty(t,"__esModule",{value:!0});var u=n(18),c=n(21),h=n(22),l=n(23),f=function(e){if(e&&e instanceof File)return new Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.readAsArrayBuffer(e)});throw"SPScript.utils.getArrayBuffer: Cant get ArrayBuffer if you don't pass in a file"},p=function(){return l.validateNamespace("SP.UI.ModalDialog")?Promise.resolve(!0):h.loadScript("/_layouts/15/1033/sp.res.js").then(function(){return h.loadScript("/_layouts/15/sp.ui.dialog.js")})},d={isBrowser:r,headers:c.default,parseJSON:o,validateODataV2:s,qs:{toObj:u.toObj,fromObj:u.fromObj},loadScript:h.loadScript,loadScripts:h.loadScripts,loadCSS:h.loadCSS,getArrayBuffer:f,waitForLibraries:l.waitForLibraries,waitForLibrary:l.waitForLibrary,validateNamespace:l.validateNamespace,waitForElement:l.waitForElement,openModal:a};t.default=d},,,,function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==("undefined"==typeof window?"undefined":s(window))&&(n=window)}e.exports=n},function(e,t,n){t.decode=t.parse=n(19),t.encode=t.stringify=n(20)},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},,function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o={method:"GET",credentials:"include",redirect:"follow"},s=function(e,t){var n=i({},o,t);return fetch(e,n).then(function(e){return e.ok,e.ok?e.text().then(function(e){return r.default.parseJSON(e)||e}):e.text().then(function(e){throw new Error(e)})})};t.default=s},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(26),i=function(){function e(e,t){this.baseUrl=e,this._dao=t}return e.prototype.getRoleAssignments=function(){var e=this.baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(e).then(r.default.validateODataV2).then(function(e){return e.map(s)})},e.prototype.checkPrivs=function(e){var t=encodeURIComponent(e.LoginName),n=this.baseUrl+"/getusereffectivepermissions(@v)?@v='"+t+"'";return this._dao.get(n).then(r.default.validateODataV2)},e.prototype.check=function(e){var t=this;return e||r.default.isBrowser()?(e?this._dao.web.getUser(e):this._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(e){return e.d})).then(function(e){return t.checkPrivs(e)}).then(function(e){return a(e.GetUserEffectivePermissions.Low,e.GetUserEffectivePermissions.High)}):Promise.reject("Can't check permissions. No email passed and no current user")},e}();t.default=i;var s=function(e){return{member:{login:e.Member.LoginName,name:e.Member.Title,id:e.Member.Id},roles:e.RoleDefinitionBindings.results.map(function(e){return{name:e.Name,description:e.Description,basePermissions:a(e.BasePermissions.Low,e.BasePermissions.High)}})}},a=function(e,t){var n=[];return o.basePermissions.forEach(function(r){((r.low&e)>0||(r.high&t)>0)&&n.push(r.name)}),n}},,,,,,,function(e,t,n){var r=n(17);e.exports=r.default},function(e,t,n){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(24),i=n(37),s={utils:r.default,CSR:i.default,createContext:function(t,n){try{return!t&&e._spPageContextInfo&&(t=e._spPageContextInfo.webAbsoluteUrl),new o.default(t,n)}catch(e){throw new Error("Unable to create SPScript Context: "+e.message)}}};t.default=s}).call(t,n(4))},function(e,t,n){function r(e,t){var n=function(n){var r=(e[n]+"").trim();return(r.indexOf(" ")>-1||t)&&(r="'"+r+"'"),n+"="+r};return Object.keys(e).map(n).join("&")}function o(e){return void 0===e&&window&&window.location&&window.location.search&&(e=window.location.search),e?("?"===e[0]&&(e=e.substr(1)),i.parse(e)):{}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);t.fromObj=r,t.toObj=o},function(e,t,n){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var h=0;h<c;++h){var l,f,p,d,m=e[h].replace(a,"%20"),y=m.indexOf(n);y>=0?(l=m.substr(0,y),f=m.substr(y+1)):(l=m,f=""),p=decodeURIComponent(l),d=decodeURIComponent(f),r(s,p)?o(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=function(e){switch(void 0===e?"undefined":s(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,u){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==(void 0===e?"undefined":s(e))?r(a(e),function(s){var a=encodeURIComponent(o(s))+n;return i(e[s])?r(e[s],function(e){return a+encodeURIComponent(o(e))}).join(t):a+encodeURIComponent(o(e[s]))}).join(t):u?encodeURIComponent(o(u))+n+encodeURIComponent(o(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){function r(e){var t={Accept:o,"Content-Type":o};return e&&(t["X-RequestDigest"]=e),t}Object.defineProperty(t,"__esModule",{value:!0});var o="application/json;odata=verbose",s=r,a=function(e){return{Accept:o,"X-RequestDigest":e,"Content-Type":"application/octet-stream",binaryStringRequestBody:"true"}},u=function(e,t){return i({},r(t),{"X-HTTP-Method":e})},c=function(e,t){return t&&(e["If-Match"]=t),e},h=function(e,t){return c(u("MERGE",e),t)},l=function(e,t){return c(u("DELETE",e),t)},f={getStandardHeaders:r,getAddHeaders:s,getFilestreamHeaders:a,getUpdateHeaders:h,getDeleteHeaders:l,getActionHeaders:u};t.default=f},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.loadCSS=function(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),document.querySelector("head").appendChild(t)},t.loadScript=function(e){return new Promise(function(t,n){var r=window.document.createElement("script"),o=document.getElementsByTagName("script")[0];r.async=!0,o.parentNode.insertBefore(r,o),r.onload=r.onreadystatechange=function(e,n){(n||!r.readyState||/loaded|complete/.test(r.readyState))&&(r.onload=r.onreadystatechange=null,r=void 0,n||t())},r.src=e})},t.loadScripts=function(e){return Promise.all(e.map(t.loadScript))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.validateNamespace=function(e){for(var t=window,n=e.split("."),r=n.length,o=0;o<r;o++){var i=n[o];if(!(i in t))return!1;t=t[i]}return!0};var r=function e(n,r){0===n.filter(function(e){return!t.validateNamespace(e)}).length?r():setTimeout(function(){return e(n,r)},25)};t.waitForLibraries=function(e){return new Promise(function(t,n){return r(e,t)})},t.waitForLibrary=function(e){return t.waitForLibraries([e])},t.waitForElement=function(e,t){void 0===t&&(t=5e3);var n=0,r=t/25;return new Promise(function(t,o){!function i(){n>r&&o("Unable to find element: "+e);var s=document.querySelector(e);s?t(s):(n++,setTimeout(i,25))}()})}},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(8),a=n(0),u=n(25),c=n(27),h=n(28),l=n(30),f=n(32),p=n(33),d=function(){function e(e,t){void 0===t&&(t={});var n=this;this.webUrl=e,this.clientId=t.clientId,this.clientSecret=t.clientSecret,this.ensureToken=t.clientId?p.getAppOnlyToken(e,t.clientId,t.clientSecret).then(function(e){return n.accessToken=e}):Promise.resolve(!0),this.search=new h.default(this),this.customActions=new l.default(this),this.web=new c.default(this),this.profiles=new f.default(this)}return e.prototype.executeRequest=function(e,t){return r(this,void 0,void 0,function(){var n,r,a;return o(this,function(o){switch(o.label){case 0:return[4,this.ensureToken];case 1:return o.sent(),n=/^http/i.test(e)?e:this.webUrl+"/_api"+e,r={method:"GET",headers:{Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}},a=i({},r,t),this.accessToken&&(a.headers.Authorization="Bearer "+this.accessToken),[2,s.default(n,a)]}})})},e.prototype.get=function(e,t){var n=i({},{method:"GET"},t);return this.executeRequest(e,n).then(a.default.parseJSON)},e.prototype.post=function(e,t,n){t=this._packagePostBody(t,n);var r={method:"POST",body:t};return r=i({},r,n),this.executeRequest(e,r).then(a.default.parseJSON)},e.prototype.authorizedPost=function(e,t,n){var r=this;return this.getRequestDigest().then(function(e){return a.default.headers.getActionHeaders(n,e)}).then(function(n){return r.post(e,t,{headers:n})})},e.prototype._ensureRequestDigest=function(e){return e?Promise.resolve(e):this.getRequestDigest()},e.prototype.getRequestDigest=function(){return this.post("/contextInfo",{}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},e.prototype.lists=function(e){return new u.default(e,this)},e.prototype._packagePostBody=function(e,t){return"string"==typeof e?e:t&&t.headers&&t.headers["Content-Type"]&&-1===t.headers["Content-Type"].indexOf("json")?e:JSON.stringify(e)},e}();t.default=d},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(9),s=function(){function e(e,t){this.listName=e,this.baseUrl="/web/lists/getbytitle('"+this.listName+"')",this._dao=t,this.permissions=new o.default(this.baseUrl,t)}return e.prototype.getItems=function(e){return this._dao.get(this.baseUrl+"/items"+a(e)).then(r.default.validateODataV2)},e.prototype.getItemById=function(e,t){var n=this.baseUrl+"/items("+e+")"+a(t);return this._dao.get(n).then(r.default.validateODataV2)},e.prototype.getItemsByView=function(e){var t=this,n=this.baseUrl+"/Views/getByTitle('"+e+"')/ViewQuery";return this._dao.get(n).then(r.default.validateODataV2).then(function(e){var n=t.baseUrl+"/GetItems",r={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:e.ViewQuery}};return t._dao.authorizedPost(n,r)}).then(r.default.validateODataV2)},e.prototype.findItems=function(e,t,n){return n="$filter="+e+" eq "+("string"==typeof t?"'"+t+"'":t)+a(n,"&"),this.getItems(n)},e.prototype.findItem=function(e,t,n){return this.findItems(e,t,n).then(function(e){return e&&e.length&&e.length>0?e[0]:null})},e.prototype.getInfo=function(){return this._dao.get(this.baseUrl).then(r.default.validateODataV2)},e.prototype.addItem=function(e,t){var n=this;return this._dao._ensureRequestDigest(t).then(function(t){return n._dao.get(n.baseUrl).then(function(o){e=i({},{__metadata:{type:o.d.ListItemEntityTypeFullName}},e);var s={headers:r.default.headers.getAddHeaders(t)};return n._dao.post(n.baseUrl+"/items",e,s)}).then(r.default.validateODataV2)})},e.prototype.updateItem=function(e,t,n){var o=this;return this._dao._ensureRequestDigest(n).then(function(n){return o.getItemById(e).then(function(e){t=i({},{__metadata:{type:e.__metadata.type}},t);var s={headers:r.default.headers.getUpdateHeaders(n,e.__metadata.etag)};return o._dao.post(e.__metadata.uri,t,s)})})},e.prototype.deleteItem=function(e,t){var n=this;return this._dao._ensureRequestDigest(t).then(function(t){return n.getItemById(e).then(function(e){var o={headers:r.default.headers.getDeleteHeaders(t,e.__metadata.etag)};return n._dao.post(e.__metadata.uri,"",o)})})},e}();t.default=s;var a=function(e,t){return t=t||"?",e?t+e:""}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.basePermissions=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}]},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(9),i=function(){function e(e){this.baseUrl="/web",this._dao=e,this.permissions=new o.default(this.baseUrl,e)}return e.prototype.getInfo=function(){return this._dao.get(this.baseUrl).then(r.default.validateODataV2)},e.prototype.getSubsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(r.default.validateODataV2)},e.prototype.getUser=function(e){var t=e?this.baseUrl+"/SiteUsers/GetByEmail('"+e+"')":this.baseUrl+"/CurrentUser";return this._dao.get(t).then(r.default.validateODataV2)},e.prototype.ensureUser=function(e){return this._dao.post("/web/ensureUser('"+e+"')").then(r.default.validateODataV2)},e.prototype.getFile=function(e){var e="/web/getfilebyserverrelativeurl('"+e+"')";return this._dao.get(e).then(r.default.validateODataV2)},e.prototype._copyFile=function(e,t,n){var o="/web/getfilebyserverrelativeurl('"+e+"')/CopyTo",i={headers:r.default.headers.getAddHeaders(n)},s={strNewUrl:t,bOverWrite:!0};return this._dao.post(o,s,i)},e.prototype.copyFile=function(e,t,n){var r=this;return this._dao._ensureRequestDigest(n).then(function(n){return r._copyFile(e,t,n)})},e}();t.default=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(29),i=function(){function e(e){this._dao=e}return Object.defineProperty(e.prototype,"defaultQueryOptions",{get:function(){return{sourceid:null,startrow:null,rowlimit:100,selectedproperties:null,refiners:null,refinementfilters:null,hiddencontstraints:null,sortlist:null}},enumerable:!0,configurable:!0}),e.prototype.query=function(e,t){void 0===t&&(t={});var n=r.default.qs.fromObj(t,!0),i="/search/query?querytext='"+e+"'&"+n;return this._dao.get(i).then(r.default.validateODataV2).then(function(e){if(e.query)return o.mapResponse(e.query);throw new Error("Invalid response back from search service")})},e.prototype.people=function(e,t){return void 0===t&&(t={}),t.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(e,t)},e.prototype.sites=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n={}),t=t?"Path:"+t+"*":"";var r=(e+" contentclass:STS_Web "+t).trim();return n.rowlimit=n.rowlimit||499,this.query(r,n)},e}();t.default=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.mapResponse=function(e){return{elapsedTime:e.ElapsedTime,suggestion:e.SpellingSuggestion,resultsCount:e.PrimaryQueryResult.RelevantResults.RowCount,totalResults:e.PrimaryQueryResult.RelevantResults.TotalRows,totalResultsIncludingDuplicates:e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,items:t.mapItems(e.PrimaryQueryResult.RelevantResults.Table.Rows.results),refiners:t.mapRefiners(e.PrimaryQueryResult.RefinementResults)}},t.mapRefiners=function(e){var t=[];return e&&e.Refiners&&e.Refiners.results&&(t=e.Refiners.results.map(function(e){return{RefinerName:e.Name,RefinerOptions:e.Entries.results}})),t},t.mapItems=function(e){for(var t=[],n=0;n<e.length;n++){for(var r=e[n],o={},i=0;i<r.Cells.results.length;i++)o[r.Cells.results[i].Key]=r.Cells.results[i].Value;t.push(o)}return t}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(31),s=function(){function e(e){this._dao=e}return e.prototype.getScope=function(e){if(3===e)return o.scopes.Web;if(2===e)return o.scopes.Site;throw new Error("Invalid Custom Action Scope")},e.prototype.get=function(e){var t=this;return this._dao.get(o.scopes.Site.url).then(r.default.validateODataV2).then(function(e){return t._dao.get(o.scopes.Web.url).then(r.default.validateODataV2).then(function(t){return e.concat(t)})}).then(function(t){if(e){var n=t.filter(function(t){return t.Name===e});if(n.length)return n[0];throw new Error("Unable to find Custom Action with name: "+e)}return t})},e.prototype._getUrl=function(e){var t=this;return this.get(e).then(function(e){return t.getScope(e.Scope).url+"('"+e.Id+"')"})},e.prototype._getUrlAndDigest=function(e){var t=this,n={};return this._getUrl(e).then(function(e){return n.url=e,t._dao.getRequestDigest()}).then(function(e){return n.digest=e,n})},e.prototype.update=function(e){var t=this;if(!e||!e.Name)throw new Error("You must at least pass a Custom Action 'Name'");return this._getUrlAndDigest(e.Name).then(function(n){e=i({},o.metadata,e);var s={headers:r.default.headers.getUpdateHeaders(n.digest)};return t._dao.post(n.url,e,s)})},e.prototype.remove=function(e){var t=this;if(!e)throw new Error("You must at least pass an existing Custom Action name");return this._getUrlAndDigest(e).then(function(e){var n={headers:r.default.headers.getDeleteHeaders(e.digest)};return t._dao.post(e.url,{},n)})},e.prototype.add=function(e){var t=this;if(!e||!e.Name)throw new Error("You must at least pass a Custom Action 'Name'");var n={Name:e.Name,Title:e.Name,Description:e.Name,Group:e.Name,Sequence:100,Scope:"Site",Location:"ScriptLink"};return e=i({},n,e),this.get().then(function(n){return!n.filter(function(t){return t.Name===e.Name}).length||t.remove(e.Name)}).then(function(){return t._dao.getRequestDigest()}).then(function(n){e=i({},o.metadata,e);var s=o.scopes[e.Scope];e.Scope=s.id;var a={headers:r.default.headers.getAddHeaders(n)};return t._dao.post(s.url,e,a)})},e.prototype.addScriptBlock=function(e,t,n){void 0===n&&(n={});var r={Name:e,ScriptBlock:t};return r=i({},r,n),this.add(r)},e.prototype.addCSSLink=function(e,t,n){void 0===n&&(n={});var r='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar styleTag = document.createElement("style");\n\t\t\tstyleTag.appendChild(document.createTextNode("body { opacity: 0 }"));\n\t\t\t\n\t\t\tvar linkTag = document.createElement("link");\n\t\t\tlinkTag.rel = "stylesheet";\tlinkTag.href = "'+t+'"; linkTag.type = "text/css";\n\t\t\tlinkTag.addEventListener("load", function() {\n\t\t\t\thead.removeChild(styleTag);\n\t\t\t});\n\n\t\t\thead.appendChild(styleTag);\n\t\t\thead.appendChild(linkTag);\n\t\t})();';return this.addScriptBlock(e,r,n)},e.prototype.addScriptLink=function(e,t,n){void 0===n&&(n={});var r='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar scriptTag = document.createElement("script");\n            scriptTag.src = "'+t+'";\n            scriptTag.type = "text/javascript";\n\t\t\thead.appendChild(scriptTag);\n\t\t})();';return this.addScriptBlock(e,r,n)},e}();t.default=s},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.metadata={__metadata:{type:"SP.UserCustomAction"}},t.scopes={Web:{id:3,name:"Web",url:"/web/usercustomactions"},Site:{id:2,name:"Site",url:"/site/usercustomactions"}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e){this._dao=e,this.baseUrl="/SP.UserProfiles.PeopleManager"}return e.prototype.current=function(){var e=this.baseUrl+"/GetMyProperties";return this._dao.get(e).then(r.default.validateODataV2).then(i)},e.prototype.get=function(e){var t=this;return e?this.getUserObj(e).then(function(e){var n=encodeURIComponent(e.LoginName||e.AccountName),o=t.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+n+"'";return t._dao.get(o).then(r.default.validateODataV2).then(i)}):this.current()},e.prototype.getUserObj=function(e){if(e&&"string"!=typeof e){if(e.AccountName||e.LoginName)return Promise.resolve(e);throw new Error("profiles.setProperty Error: Invalid user parameter")}return this._dao.web.getUser(e)},e.prototype.setProperty=function(e,t,n){var r=this;return this.getUserObj(n).then(function(n){var o={propertyName:e,propertyValue:t,accountName:n.LoginName||n.AccountName},i=r.baseUrl+"/SetSingleValueProfileProperty";return r._dao.authorizedPost(i,o)})},e}();t.default=o;var i=function(e){return e.UserProfileProperties.results.forEach(function(t){e[t.Key]=t.Value}),e}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(34),o=n(5),i=n(8);t.getAppOnlyToken=function(e,t,n){var a=r.parse(e);return s(e).then(function(e){var r="https://accounts.accesscontrol.windows.net/"+e.realm+"/tokens/OAuth/2",s=t+"@"+e.realm,u=e.client_id+"/"+a.host+"@"+e.realm,c={grant_type:"client_credentials",client_id:s,client_secret:n,resource:u,scope:u},h=o.stringify(c),l={method:"POST",body:h,headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":h.length}};return i.default(r,l).then(function(e){return e.access_token})})};var s=function(e){var t=e+"/_api/web",n={method:"GET",headers:{Authorization:"Bearer ",Accept:"application/json;odata=verbose",response_type:"code"}};return new Promise(function(e,r){fetch(t,n).then(function(t){if(!t.ok){var n=a(t.headers["www-authenticate"]||t.headers._headers["www-authenticate"][0]);e(n)}r("Get Realm succeeded somehow?!")})})},a=function(e){return e&&e.startsWith("Bearer")?(e=e.substr(7),e.split(",").filter(function(e){return e.indexOf("=")>-1}).reduce(function(e,t){var n=t.split("=");return 2===n.length&&(e[n[0].trim()]=n[1].trim().replace(/\"/g,"")),e},{})):null}},function(e,t,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,n){if(e&&h.isObject(e)&&e instanceof r)return e;var o=new r;return o.parse(e,t,n),o}function i(e){return h.isString(e)&&(e=o(e)),e instanceof r?e.format():r.prototype.format.call(e)}function a(e,t){return o(e,!1,!0).resolve(t)}function u(e,t){return e?o(e,!1,!0).resolveObject(t):t}var c=n(35),h=n(36);t.parse=o,t.resolve=a,t.resolveObject=u,t.format=i,t.Url=r;var l=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,d=["<",">",'"',"`"," ","\r","\n","\t"],m=["{","}","|","\\","^","`"].concat(d),y=["'"].concat(m),v=["%","/","?",";","#"].concat(y),g=["/","?","#"],b=/^[+a-z0-9A-Z_-]{0,63}$/,w=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,S={javascript:!0,"javascript:":!0},x={javascript:!0,"javascript:":!0},A={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},j=n(5);r.prototype.parse=function(e,t,n){if(!h.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+(void 0===e?"undefined":s(e)));var r=e.indexOf("?"),o=-1!==r&&r<e.indexOf("#")?"?":"#",i=e.split(o),a=/\\/g;i[0]=i[0].replace(a,"/"),e=i.join(o);var u=e;if(u=u.trim(),!n&&1===e.split("#").length){var f=p.exec(u);if(f)return this.path=u,this.href=u,this.pathname=f[1],f[2]?(this.search=f[2],this.query=t?j.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var d=l.exec(u);if(d){d=d[0];var m=d.toLowerCase();this.protocol=m,u=u.substr(d.length)}if(n||d||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var _="//"===u.substr(0,2);!_||d&&x[d]||(u=u.substr(2),this.slashes=!0)}if(!x[d]&&(_||d&&!A[d])){for(var P=-1,O=0;O<g.length;O++){var E=u.indexOf(g[O]);-1!==E&&(-1===P||E<P)&&(P=E)}var T,q;q=-1===P?u.lastIndexOf("@"):u.lastIndexOf("@",P),-1!==q&&(T=u.slice(0,q),u=u.slice(q+1),this.auth=decodeURIComponent(T)),P=-1;for(var O=0;O<v.length;O++){var E=u.indexOf(v[O]);-1!==E&&(-1===P||E<P)&&(P=E)}-1===P&&(P=u.length),this.host=u.slice(0,P),u=u.slice(P),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var I=this.hostname.split(/\./),O=0,k=I.length;O<k;O++){var N=I[O];if(N&&!N.match(b)){for(var C="",M=0,U=N.length;M<U;M++)N.charCodeAt(M)>127?C+="x":C+=N[M];if(!C.match(b)){var D=I.slice(0,O),B=I.slice(O+1),L=N.match(w);L&&(D.push(L[1]),B.unshift(L[2])),B.length&&(u="/"+B.join(".")+u),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=c.toASCII(this.hostname));var F=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+F,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!S[m])for(var O=0,k=y.length;O<k;O++){var Y=y[O];if(-1!==u.indexOf(Y)){var H=encodeURIComponent(Y);H===Y&&(H=escape(Y)),u=u.split(Y).join(H)}}var z=u.indexOf("#");-1!==z&&(this.hash=u.substr(z),u=u.slice(0,z));var G=u.indexOf("?");if(-1!==G?(this.search=u.substr(G),this.query=u.substr(G+1),t&&(this.query=j.parse(this.query)),u=u.slice(0,G)):t&&(this.search="",this.query={}),u&&(this.pathname=u),A[m]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",J=this.search||"";this.path=F+J}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&h.isObject(this.query)&&Object.keys(this.query).length&&(i=j.stringify(this.query));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||A[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+o+n+s+r},r.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(h.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var s=o[i];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),u=0;u<a.length;u++){var c=a[u];"protocol"!==c&&(n[c]=e[c])}return A[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!A[e.protocol]){for(var l=Object.keys(e),f=0;f<l.length;f++){var p=l[f];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||x[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=g||v||n.host&&e.pathname,w=b,S=n.pathname&&n.pathname.split("/")||[],d=e.pathname&&e.pathname.split("/")||[],j=n.protocol&&!A[n.protocol];if(j&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),b=b&&(""===d[0]||""===S[0])),g)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,S=d;else if(d.length)S||(S=[]),S.pop(),S=S.concat(d),n.search=e.search,n.query=e.query;else if(!h.isNullOrUndefined(e.search)){if(j){n.hostname=n.host=S.shift();var _=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");_&&(n.auth=_.shift(),n.host=n.hostname=_.shift())}return n.search=e.search,n.query=e.query,h.isNull(n.pathname)&&h.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var P=S.slice(-1)[0],O=(n.host||e.host||S.length>1)&&("."===P||".."===P)||""===P,E=0,T=S.length;T>=0;T--)P=S[T],"."===P?S.splice(T,1):".."===P?(S.splice(T,1),E++):E&&(S.splice(T,1),E--);if(!b&&!w)for(;E--;E)S.unshift("..");!b||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),O&&"/"!==S.join("/").substr(-1)&&S.push("");var q=""===S[0]||S[0]&&"/"===S[0].charAt(0);if(j){n.hostname=n.host=q?"":S.length?S.shift():"";var _=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");_&&(n.auth=_.shift(),n.host=n.hostname=_.shift())}return b=b||n.host&&S.length,b&&!q&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),h.isNull(n.pathname)&&h.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,r){var o;!function(i){function a(e){throw new RangeError(I[e])}function u(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function c(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(R,"."),r+u(e.split("."),t).join(".")}function h(e){for(var t,n,r=[],o=0,i=e.length;o<i;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<i?(n=e.charCodeAt(o++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--)):r.push(t);return r}function l(e){return u(e,function(e){var t="";return e>65535&&(e-=65536,t+=C(e>>>10&1023|55296),e=56320|1023&e),t+=C(e)}).join("")}function f(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:S}function p(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function d(e,t,n){var r=0;for(e=n?N(e/_):e>>1,e+=N(e/t);e>k*A>>1;r+=S)e=N(e/k);return N(r+(k+1)*e/(e+j))}function m(e){var t,n,r,o,i,s,u,c,h,p,m=[],y=e.length,v=0,g=O,b=P;for(n=e.lastIndexOf(E),n<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&a("not-basic"),m.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<y;){for(i=v,s=1,u=S;o>=y&&a("invalid-input"),c=f(e.charCodeAt(o++)),(c>=S||c>N((w-v)/s))&&a("overflow"),v+=c*s,h=u<=b?x:u>=b+A?A:u-b,!(c<h);u+=S)p=S-h,s>N(w/p)&&a("overflow"),s*=p;t=m.length+1,b=d(v-i,t,0==i),N(v/t)>w-g&&a("overflow"),g+=N(v/t),v%=t,m.splice(v++,0,g)}return l(m)}function y(e){var t,n,r,o,i,s,u,c,l,f,m,y,v,g,b,j=[];for(e=h(e),y=e.length,t=O,n=0,i=P,s=0;s<y;++s)(m=e[s])<128&&j.push(C(m));for(r=o=j.length,o&&j.push(E);r<y;){for(u=w,s=0;s<y;++s)(m=e[s])>=t&&m<u&&(u=m);for(v=r+1,u-t>N((w-n)/v)&&a("overflow"),n+=(u-t)*v,t=u,s=0;s<y;++s)if(m=e[s],m<t&&++n>w&&a("overflow"),m==t){for(c=n,l=S;f=l<=i?x:l>=i+A?A:l-i,!(c<f);l+=S)b=c-f,g=S-f,j.push(C(p(f+b%g,0))),c=N(b/g);j.push(C(p(c,0))),i=d(n,v,r==o),n=0,++r}++n,++t}return j.join("")}function v(e){return c(e,function(e){return T.test(e)?m(e.slice(4).toLowerCase()):e})}function g(e){return c(e,function(e){return q.test(e)?"xn--"+y(e):e})}var b,w=("object"==(void 0===t?"undefined":s(t))&&t&&t.nodeType,"object"==(void 0===e?"undefined":s(e))&&e&&e.nodeType,void 0===r||s(r),2147483647),S=36,x=1,A=26,j=38,_=700,P=72,O=128,E="-",T=/^xn--/,q=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=S-x,N=Math.floor,C=String.fromCharCode;b={version:"1.4.1",ucs2:{decode:h,encode:l},decode:m,encode:y,toASCII:g,toUnicode:v},void 0!==(o=function(){return b}.call(t,n,t,e))&&(e.exports=o)}()}).call(t,n(6)(e),n(4))},function(e,t,n){e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==(void 0===e?"undefined":s(e))&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){function r(e){return function(t){var n=t.FormContext,r=i({},t);return e.onReady&&(n?n.registerInitCallback(e.name,e.onReady.bind(null,r)):setTimeout(e.onReady.bind(null,r),100)),e.getValue&&n&&n.registerGetValueCallback(e.name,e.getValue.bind(null,r)),n&&n.updateControlValue&&(e.setValue=function(t){n.updateControlValue(e.name,t)}),e.render(t)}}function o(e){return function(t){var n=t.FormContext;return n&&n.registerInitCallback&&e.onReady&&n.registerInitCallback(e.name,e.onReady),e.render(t)}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),a=function(e,t,n){if(void 0===n&&(n={}),!s.default.validateNamespace("SPClientTemplates.TemplateManager"))throw new Error("Unable to register CSR template.  SPClientTemplates.TemplateManager does not exist");var r={};e.locations.forEach(function(e){return r[e]=t});var o={Templates:{Fields:{}}},a=i({},o,n);return a.Templates.Fields[e.name]=r,SPClientTemplates.TemplateManager.RegisterTemplateOverrides(a),e},u=function(e,t){void 0===t&&(t={});var n=o(e);return e.locations=e.locations||["View","DisplayForm"],a(e,n,t)},c=function(e,t){void 0===t&&(t={});var n=r(e);return e.locations=e.locations||["NewForm","EditForm"],a(e,n,t)},h={registerDisplayField:u,registerFormField:c};t.default=h}])})}).call(t,n(6)(e))},function(e,t,n){"use strict";t.run=function(e,t){var r=!!t;n(1).should();describe("SPScript Global Namespace",function(){it("Should have a 'SPScript.createContext()' method",function(){e.should.have.property("createContext"),e.createContext.should.be.a("function")}),it("Should have a 'SPScript.utils' namespace",function(){e.should.not.be.null,e.should.have.property("utils")})}),r||(n(68).run(e),t=e.createContext()),n(69).run(t),n(70).run(t),n(71).run(t),r||(n(72).run(t),n(73).run(t)),n(74).run(e.utils)}},function(e,t,n){/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=[],t=e.exports={};/*!
 * Chai version
 */
t.version="1.10.0",/*!
 * Assertion Error
 */
t.AssertionError=n(41);/*!
 * Utils for plugins (not exported)
 */
var o=n(42);t.use=function(e){return~r.indexOf(e)||(e(this,o),r.push(e)),this};/*!
 * Configuration
 */
var i=n(3);t.config=i;/*!
 * Primary `Assertion` prototype
 */
var s=n(63);t.use(s);/*!
 * Core Assertions
 */
var a=n(64);t.use(a);/*!
 * Expect interface
 */
var u=n(65);t.use(u);/*!
 * Should interface
 */
var c=n(66);t.use(c);/*!
 * Assert interface
 */
var h=n(67);t.use(h)},function(e,t){/*!
 * assertion-error
 * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>
 * MIT Licensed
 */
/*!
 * Return a function that will copy properties from
 * one object to another excluding any originally
 * listed. Returned function will create a new `{}`.
 *
 * @param {String} excluded properties ...
 * @return {Function}
 */
function n(){function e(e,n){Object.keys(n).forEach(function(r){~t.indexOf(r)||(e[r]=n[r])})}var t=[].slice.call(arguments);return function(){for(var t=[].slice.call(arguments),n=0,r={};n<t.length;n++)e(r,t[n]);return r}}function r(e,t,r){var o=n("name","message","stack","constructor","toJSON"),i=o(t||{});this.message=e||"Unspecified AssertionError",this.showDiff=!1;for(var s in i)this[s]=i[s];(r=r||arguments.callee)&&Error.captureStackTrace&&Error.captureStackTrace(this,r)}/*!
 * Primary Exports
 */
e.exports=r,/*!
 * Inherit from Error.prototype
 */
r.prototype=Object.create(Error.prototype),/*!
 * Statically set name
 */
r.prototype.name="AssertionError",/*!
 * Ensure correct constructor
 */
r.prototype.constructor=r,r.prototype.toJSON=function(e){var t=n("constructor","toJSON","stack"),r=t({name:this.name},this);return!1!==e&&this.stack&&(r.stack=this.stack),r}},function(e,t,n){/*!
 * chai
 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Main exports
 */
var t=e.exports={};/*!
 * test utility
 */
t.test=n(43),/*!
 * type utility
 */
t.type=n(44),/*!
 * message utility
 */
t.getMessage=n(45),/*!
 * actual utility
 */
t.getActual=n(10),/*!
 * Inspect util
 */
t.inspect=n(7),/*!
 * Object Display util
 */
t.objDisplay=n(12),/*!
 * Flag utility
 */
t.flag=n(2),/*!
 * Flag transferring utility
 */
t.transferFlags=n(13),/*!
 * Deep equal utility
 */
t.eql=n(48),/*!
 * Deep path value
 */
t.getPathValue=n(56),/*!
 * Function name
 */
t.getName=n(11),/*!
 * add Property
 */
t.addProperty=n(57),/*!
 * add Method
 */
t.addMethod=n(58),/*!
 * overwrite Property
 */
t.overwriteProperty=n(59),/*!
 * overwrite Method
 */
t.overwriteMethod=n(60),/*!
 * Add a chainable method
 */
t.addChainableMethod=n(61),/*!
 * Overwrite chainable method
 */
t.overwriteChainableMethod=n(62)},function(e,t,n){/*!
 * Chai - test utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependancies
 */
var r=n(2);e.exports=function(e,t){var n=r(e,"negate"),o=t[0];return n?!o:o}},function(e,t){/*!
 * Chai - type utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Detectable javascript natives
 */
var n={"[object Arguments]":"arguments","[object Array]":"array","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string"};e.exports=function(e){var t=Object.prototype.toString.call(e);return n[t]?n[t]:null===e?"null":void 0===e?"undefined":e===Object(e)?"object":typeof e}},function(e,t,n){/*!
 * Chai - message composition utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependancies
 */
var r=n(2),o=n(10),i=(n(7),n(12));e.exports=function(e,t){var n=r(e,"negate"),s=r(e,"object"),a=t[3],u=o(e,t),c=n?t[2]:t[1],h=r(e,"message");return"function"==typeof c&&(c=c()),c=c||"",c=c.replace(/#{this}/g,i(s)).replace(/#{act}/g,i(u)).replace(/#{exp}/g,i(a)),h?h+": "+c:c}},function(e,t){/*!
 * Chai - getProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){function t(e){-1===n.indexOf(e)&&n.push(e)}for(var n=Object.getOwnPropertyNames(subject),r=Object.getPrototypeOf(subject);null!==r;)Object.getOwnPropertyNames(r).forEach(t),r=Object.getPrototypeOf(r);return n}},function(e,t){/*!
 * Chai - getEnumerableProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){var t=[];for(var n in e)t.push(n);return t}},function(e,t,n){e.exports=n(49)},function(e,t,n){function r(e,t,n){return!!o(e,t)||("date"===m(e)?s(e,t):"regexp"===m(e)?a(e,t):d.isBuffer(e)?l(e,t):"arguments"===m(e)?u(e,t,n):!!i(e,t)&&("object"!==m(e)&&"object"!==m(t)&&"array"!==m(e)&&"array"!==m(t)?o(e,t):p(e,t,n)))}/*!
 * Strict (egal) equality test. Ensures that NaN always
 * equals NaN and `-0` does not equal `+0`.
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} equal match
 */
function o(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}/*!
 * Compare the types of two given objects and
 * return if they are equal. Note that an Array
 * has a type of `array` (not `object`) and arguments
 * have a type of `arguments` (not `array`/`object`).
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} result
 */
function i(e,t){return m(e)===m(t)}/*!
 * Compare two Date objects by asserting that
 * the time values are equal using `saveValue`.
 *
 * @param {Date} a
 * @param {Date} b
 * @return {Boolean} result
 */
function s(e,t){return"date"===m(t)&&o(e.getTime(),t.getTime())}/*!
 * Compare two regular expressions by converting them
 * to string and checking for `sameValue`.
 *
 * @param {RegExp} a
 * @param {RegExp} b
 * @return {Boolean} result
 */
function a(e,t){return"regexp"===m(t)&&o(e.toString(),t.toString())}/*!
 * Assert deep equality of two `arguments` objects.
 * Unfortunately, these must be sliced to arrays
 * prior to test to ensure no bad behavior.
 *
 * @param {Arguments} a
 * @param {Arguments} b
 * @param {Array} memoize (optional)
 * @return {Boolean} result
 */
function u(e,t,n){return"arguments"===m(t)&&(e=[].slice.call(e),t=[].slice.call(t),r(e,t,n))}/*!
 * Get enumerable properties of a given object.
 *
 * @param {Object} a
 * @return {Array} property names
 */
function c(e){var t=[];for(var n in e)t.push(n);return t}/*!
 * Simple equality for flat iterable objects
 * such as Arrays or Node.js buffers.
 *
 * @param {Iterable} a
 * @param {Iterable} b
 * @return {Boolean} result
 */
function h(e,t){if(e.length!==t.length)return!1;for(var n=0,r=!0;n<e.length;n++)if(e[n]!==t[n]){r=!1;break}return r}/*!
 * Extension to `iterableEqual` specifically
 * for Node.js Buffers.
 *
 * @param {Buffer} a
 * @param {Mixed} b
 * @return {Boolean} result
 */
function l(e,t){return!!d.isBuffer(t)&&h(e,t)}/*!
 * Block for `objectEqual` ensuring non-existing
 * values don't get in.
 *
 * @param {Mixed} object
 * @return {Boolean} result
 */
function f(e){return null!==e&&void 0!==e}/*!
 * Recursively check the equality of two objects.
 * Once basic sameness has been established it will
 * defer to `deepEqual` for each enumerable key
 * in the object.
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} result
 */
function p(e,t,n){if(!f(e)||!f(t))return!1;if(e.prototype!==t.prototype)return!1;var o;if(n){for(o=0;o<n.length;o++)if(n[o][0]===e&&n[o][1]===t||n[o][0]===t&&n[o][1]===e)return!0}else n=[];try{var i=c(e),s=c(t)}catch(e){return!1}if(i.sort(),s.sort(),!h(i,s))return!1;n.push([e,t]);var a;for(o=i.length-1;o>=0;o--)if(a=i[o],!r(e[a],t[a],n))return!1;return!0}/*!
 * deep-eql
 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var d,m=n(50);try{d=n(52).Buffer}catch(e){d={},d.isBuffer=function(){return!1}}/*!
 * Primary Export
 */
e.exports=r},function(e,t,n){e.exports=n(51)},function(e,t){function n(e){var t=Object.prototype.toString.call(e);return o[t]?o[t]:null===e?"null":void 0===e?"undefined":e===Object(e)?"object":typeof e}function r(){this.tests={}}/*!
 * type-detect
 * Copyright(c) 2013 jake luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Primary Exports
 */
var t=e.exports=n,o={"[object Array]":"array","[object RegExp]":"regexp","[object Function]":"function","[object Arguments]":"arguments","[object Date]":"date"};t.Library=r,r.prototype.of=n,r.prototype.define=function(e,t){return 1===arguments.length?this.tests[e]:(this.tests[e]=t,this)},r.prototype.test=function(e,t){if(t===n(e))return!0;var r=this.tests[t];if(r&&"regexp"===n(r))return r.test(e);if(r&&"function"===n(r))return r(e);throw new ReferenceError('Type test "'+t+'" not defined or invalid.')}},function(e,t,n){"use strict";(function(e){function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=i.prototype):(null===e&&(e=new i(t)),e.length=t),e}function i(e,t,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?f(e,t,n,r):"string"==typeof t?h(e,t,n):p(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n,r){return a(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function c(e,t){if(a(t),e=o(e,t<0?0:0|d(t)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|y(t,n);e=o(e,r);var s=e.write(t,n);return s!==r&&(e=e.slice(0,s)),e}function l(e,t){var n=t.length<0?0:0|d(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),i.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=i.prototype):e=l(e,t),e}function p(e,t){if(i.isBuffer(t)){var n=0|d(t.length);return e=o(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||W(t.length)?o(e,0):l(e,t);if("Buffer"===t.type&&Z(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function m(e){return+e!=e&&(e=0),i.alloc(+e)}function y(e,t){if(i.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(e).length;default:if(r)return H(e).length;t=(""+t).toLowerCase(),r=!0}}function v(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return q(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return O(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=i.from(t,r)),i.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,o);if("number"==typeof t)return t&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,o){function i(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,n/=2}var c;if(o){var h=-1;for(c=n;c<a;c++)if(i(e,c)===i(t,-1===h?0:c-h)){if(-1===h&&(h=c),c-h+1===u)return h*s}else-1!==h&&(c-=c-h),h=-1}else for(n+u>a&&(n=a-u),c=n;c>=0;c--){for(var l=!0,f=0;f<u;f++)if(i(e,c+f)!==i(t,f)){l=!1;break}if(l)return c}return-1}function S(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function x(e,t,n,r){return X(H(t,e.length-n),e,n,r)}function A(e,t,n,r){return X(z(t),e,n,r)}function j(e,t,n,r){return A(e,t,n,r)}function _(e,t,n,r){return X(J(t),e,n,r)}function P(e,t,n,r){return X(G(t,e.length-n),e,n,r)}function O(e,t,n){return 0===t&&n===e.length?$.fromByteArray(e):$.fromByteArray(e.slice(t,n))}function E(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i=e[o],s=null,a=i>239?4:i>223?3:i>191?2:1;if(o+a<=n){var u,c,h,l;switch(a){case 1:i<128&&(s=i);break;case 2:u=e[o+1],128==(192&u)&&(l=(31&i)<<6|63&u)>127&&(s=l);break;case 3:u=e[o+1],c=e[o+2],128==(192&u)&&128==(192&c)&&(l=(15&i)<<12|(63&u)<<6|63&c)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:u=e[o+1],c=e[o+2],h=e[o+3],128==(192&u)&&128==(192&c)&&128==(192&h)&&(l=(15&i)<<18|(63&u)<<12|(63&c)<<6|63&h)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),o+=a}return T(r)}function T(e){var t=e.length;if(t<=K)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=K));return n}function q(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function I(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=Y(e[i]);return o}function k(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function C(e,t,n,r,o,s){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function M(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function U(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function D(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,o){return o||D(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,o){return o||D(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(e,t,n,r,52,8),n+8}function F(e){if(e=V(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function V(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Y(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function z(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function G(e,t){for(var n,r,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function J(e){return $.toByteArray(F(e))}function X(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function W(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var $=n(53),Q=n(54),Z=n(55);t.Buffer=i,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),i.poolSize=8192,i._augment=function(e){return e.__proto__=i.prototype,e},i.from=function(e,t,n){return s(null,e,t,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(e,t,n){return u(null,e,t,n)},i.allocUnsafe=function(e){return c(null,e)},i.allocUnsafeSlow=function(e){return c(null,e)},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.compare=function(e,t){if(!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,s=Math.min(n,r);o<s;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=i.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!i.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},i.byteLength=y,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},i.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):v.apply(this,arguments)},i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},i.prototype.compare=function(e,t,n,r,o){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var s=o-r,a=n-t,u=Math.min(s,a),c=this.slice(r,o),h=e.slice(t,n),l=0;l<u;++l)if(c[l]!==h[l]){s=c[l],a=h[l];break}return s<a?-1:a<s?1:0},i.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},i.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},i.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},i.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return S(this,e,t,n);case"utf8":case"utf-8":return x(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return j(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var K=4096;i.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(i.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=i.prototype;else{var o=t-e;r=new i(o,void 0);for(var s=0;s<o;++s)r[s]=this[s+e]}return r},i.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},i.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},i.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},i.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},i.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),Q.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),Q.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),Q.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),Q.read(this,e,!1,52,8)},i.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){C(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},i.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){C(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},i.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,1,255,0),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},i.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},i.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},i.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},i.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},i.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);C(this,e,t,n,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},i.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);C(this,e,t,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},i.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,1,127,-128),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},i.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},i.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},i.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},i.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},i.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},i.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},i.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},i.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,s=r-n;if(this===e&&n<t&&t<r)for(o=s-1;o>=0;--o)e[o+t]=this[o+n];else if(s<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},i.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var a=i.isBuffer(e)?e:H(new i(e,r).toString()),u=a.length;for(s=0;s<n-t;++s)this[s+t]=a[s%u]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(4))},function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function o(e){return 3*e.length/4-r(e)}function i(e){var t,n,o,i,s,a=e.length;i=r(e),s=new l(3*a/4-i),n=i>0?a-4:a;var u=0;for(t=0;t<n;t+=4)o=h[e.charCodeAt(t)]<<18|h[e.charCodeAt(t+1)]<<12|h[e.charCodeAt(t+2)]<<6|h[e.charCodeAt(t+3)],s[u++]=o>>16&255,s[u++]=o>>8&255,s[u++]=255&o;return 2===i?(o=h[e.charCodeAt(t)]<<2|h[e.charCodeAt(t+1)]>>4,s[u++]=255&o):1===i&&(o=h[e.charCodeAt(t)]<<10|h[e.charCodeAt(t+1)]<<4|h[e.charCodeAt(t+2)]>>2,s[u++]=o>>8&255,s[u++]=255&o),s}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function a(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16)+(e[i+1]<<8)+e[i+2],o.push(s(r));return o.join("")}function u(e){for(var t,n=e.length,r=n%3,o="",i=[],s=0,u=n-r;s<u;s+=16383)i.push(a(e,s,s+16383>u?u:s+16383));return 1===r?(t=e[n-1],o+=c[t>>2],o+=c[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=c[t>>10],o+=c[t>>4&63],o+=c[t<<2&63],o+="="),i.push(o),i.join("")}t.byteLength=o,t.toByteArray=i,t.fromByteArray=u;for(var c=[],h=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,d=f.length;p<d;++p)c[p]=f[p],h[f.charCodeAt(p)]=p;h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,c=u>>1,h=-7,l=n?o-1:0,f=n?-1:1,p=e[t+l];for(l+=f,i=p&(1<<-h)-1,p>>=-h,h+=a;h>0;i=256*i+e[t+l],l+=f,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=r;h>0;s=256*s+e[t+l],l+=f,h-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=c}return(p?-1:1)*s*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var s,a,u,c=8*i-o-1,h=(1<<c)-1,l=h>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+l>=1?f/u:f*Math.pow(2,1-l),t*u>=2&&(s++,u/=2),s+l>=h?(a=0,s=h):s+l>=1?(a=(t*u-1)*Math.pow(2,o),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;e[n+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;e[n+p]=255&s,p+=d,s/=256,c-=8);e[n+p-d]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){/*!
 * ## parsePath(path)
 *
 * Helper function used to parse string object
 * paths. Use in conjunction with `_getPathValue`.
 *
 *      var parsed = parsePath('myobject.property.subprop');
 *
 * ### Paths:
 *
 * * Can be as near infinitely deep and nested
 * * Arrays are also valid using the formal `myobject.document[3].property`.
 *
 * @param {String} path
 * @returns {Object} parsed
 * @api private
 */
function n(e){return e.replace(/\[/g,".[").match(/(\\\.|[^.]+?)+/g).map(function(e){var t=/\[(\d+)\]$/,n=t.exec(e);return n?{i:parseFloat(n[1])}:{p:e}})}/*!
 * ## _getPathValue(parsed, obj)
 *
 * Helper companion function for `.parsePath` that returns
 * the value located at the parsed address.
 *
 *      var value = getPathValue(parsed, obj);
 *
 * @param {Object} parsed definition from `parsePath`.
 * @param {Object} object to search against
 * @returns {Object|Undefined} value
 * @api private
 */
function r(e,t){for(var n,r=t,o=0,i=e.length;o<i;o++){var s=e[o];r?(void 0!==s.p?r=r[s.p]:void 0!==s.i&&(r=r[s.i]),o==i-1&&(n=r)):n=void 0}return n}/*!
 * Chai - getPathValue utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * @see https://github.com/logicalparadox/filtr
 * MIT Licensed
 */
e.exports=function(e,t){return r(n(e),t)}},function(e,t){/*!
 * Chai - addProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){Object.defineProperty(e,t,{get:function(){var e=n.call(this);return void 0===e?this:e},configurable:!0})}},function(e,t,n){/*!
 * Chai - addMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(3),o=n(2);e.exports=function(e,t,n){e[t]=function(){o(this,"ssfi")&&!1===r.includeStack&&o(this,"ssfi",e[t]);var i=n.apply(this,arguments);return void 0===i?this:i}}},function(e,t){/*!
 * Chai - overwriteProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t),o=function(){};r&&"function"==typeof r.get&&(o=r.get),Object.defineProperty(e,t,{get:function(){var e=n(o).call(this);return void 0===e?this:e},configurable:!0})}},function(e,t){/*!
 * Chai - overwriteMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){var r=e[t],o=function(){return this};r&&"function"==typeof r&&(o=r),e[t]=function(){var e=n(o).apply(this,arguments);return void 0===e?this:e}}},function(e,t,n){/*!
 * Chai - addChainingMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var r=n(13),o=n(2),i=n(3),s="__proto__"in Object,a=/^(?:length|name|arguments|caller)$/,u=Function.prototype.call,c=Function.prototype.apply;e.exports=function(e,t,n,h){"function"!=typeof h&&(h=function(){});var l={method:n,chainingBehavior:h};e.__methods||(e.__methods={}),e.__methods[t]=l,Object.defineProperty(e,t,{get:function(){l.chainingBehavior.call(this);var t=function e(){o(this,"ssfi")&&!1===i.includeStack&&o(this,"ssfi",e);var t=l.method.apply(this,arguments);return void 0===t?this:t};if(s){var n=t.__proto__=Object.create(this);n.call=u,n.apply=c}else{Object.getOwnPropertyNames(e).forEach(function(n){if(!a.test(n)){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r)}})}return r(this,t),t},configurable:!0})}},function(e,t){/*!
 * Chai - overwriteChainableMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n,r){var o=e.__methods[t],i=o.chainingBehavior;o.chainingBehavior=function(){var e=r(i).call(this);return void 0===e?this:e};var s=o.method;o.method=function(){var e=n(s).apply(this,arguments);return void 0===e?this:e}}},function(e,t,n){/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(3),o=function(){};e.exports=function(e,t){/*!
   * Assertion Constructor
   *
   * Creates object for chaining.
   *
   * @api private
   */
function n(e,t,n){s(this,"ssfi",n||arguments.callee),s(this,"object",e),s(this,"message",t)}/*!
   * Module dependencies.
   */
var i=e.AssertionError,s=t.flag;/*!
   * Module export.
   */
e.Assertion=n,Object.defineProperty(n,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack},set:function(e){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack=e}}),Object.defineProperty(n,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff},set:function(e){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff=e}}),n.addProperty=function(e,n){t.addProperty(this.prototype,e,n)},n.addMethod=function(e,n){t.addMethod(this.prototype,e,n)},n.addChainableMethod=function(e,n,r){t.addChainableMethod(this.prototype,e,n,r)},n.addChainableNoop=function(e,n){t.addChainableMethod(this.prototype,e,o,n)},n.overwriteProperty=function(e,n){t.overwriteProperty(this.prototype,e,n)},n.overwriteMethod=function(e,n){t.overwriteMethod(this.prototype,e,n)},n.overwriteChainableMethod=function(e,n,r){t.overwriteChainableMethod(this.prototype,e,n,r)},/*!
   * ### .assert(expression, message, negateMessage, expected, actual)
   *
   * Executes an expression and check expectations. Throws AssertionError for reporting if test doesn't pass.
   *
   * @name assert
   * @param {Philosophical} expression to be tested
   * @param {String or Function} message or function that returns message to display if fails
   * @param {String or Function} negatedMessage or function that returns negatedMessage to display if negated expression fails
   * @param {Mixed} expected value (remember to check for negation)
   * @param {Mixed} actual (optional) will default to `this.obj`
   * @api private
   */
n.prototype.assert=function(e,n,o,a,u,c){var h=t.test(this,arguments);if(!0!==c&&(c=!1),!0!==r.showDiff&&(c=!1),!h){var n=t.getMessage(this,arguments),l=t.getActual(this,arguments);throw new i(n,{actual:l,expected:a,showDiff:c},r.includeStack?this.assert:s(this,"ssfi"))}},/*!
   * ### ._obj
   *
   * Quick reference to stored `actual` value for plugin developers.
   *
   * @api private
   */
Object.defineProperty(n.prototype,"_obj",{get:function(){return s(this,"object")},set:function(e){s(this,"object",e)}})}},function(e,t){/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){function n(e,n){n&&w(this,"message",n),e=e.toLowerCase();var r=w(this,"object"),o=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an ":"a ";this.assert(e===t.type(r),"expected #{this} to be "+o+e,"expected #{this} not to be "+o+e)}function r(){w(this,"contains",!0)}function o(e,n){n&&w(this,"message",n);var r=w(this,"object"),o=!1;if("array"===t.type(r)&&"object"===t.type(e)){for(var i in r)if(t.eql(r[i],e)){o=!0;break}}else if("object"===t.type(e)){if(!w(this,"negate")){for(var s in e)new b(r).property(s,e[s]);return}var a={};for(var s in e)a[s]=r[s];o=t.eql(a,e)}else o=r&&~r.indexOf(e);this.assert(o,"expected #{this} to include "+t.inspect(e),"expected #{this} to not include "+t.inspect(e))}function i(){var e=w(this,"object"),t=Object.prototype.toString.call(e);this.assert("[object Arguments]"===t,"expected #{this} to be arguments but got "+t,"expected #{this} to not be arguments")}function s(e,t){t&&w(this,"message",t);var n=w(this,"object");if(w(this,"deep"))return this.eql(e);this.assert(e===n,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",e,this._obj,!0)}function a(e,n){n&&w(this,"message",n),this.assert(t.eql(e,w(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",e,this._obj,!0)}function u(e,t){t&&w(this,"message",t);var n=w(this,"object");if(w(this,"doLength")){new b(n,t).to.have.property("length");var r=n.length;this.assert(r>e,"expected #{this} to have a length above #{exp} but got #{act}","expected #{this} to not have a length above #{exp}",e,r)}else this.assert(n>e,"expected #{this} to be above "+e,"expected #{this} to be at most "+e)}function c(e,t){t&&w(this,"message",t);var n=w(this,"object");if(w(this,"doLength")){new b(n,t).to.have.property("length");var r=n.length;this.assert(r>=e,"expected #{this} to have a length at least #{exp} but got #{act}","expected #{this} to have a length below #{exp}",e,r)}else this.assert(n>=e,"expected #{this} to be at least "+e,"expected #{this} to be below "+e)}function h(e,t){t&&w(this,"message",t);var n=w(this,"object");if(w(this,"doLength")){new b(n,t).to.have.property("length");var r=n.length;this.assert(r<e,"expected #{this} to have a length below #{exp} but got #{act}","expected #{this} to not have a length below #{exp}",e,r)}else this.assert(n<e,"expected #{this} to be below "+e,"expected #{this} to be at least "+e)}function l(e,t){t&&w(this,"message",t);var n=w(this,"object");if(w(this,"doLength")){new b(n,t).to.have.property("length");var r=n.length;this.assert(r<=e,"expected #{this} to have a length at most #{exp} but got #{act}","expected #{this} to have a length above #{exp}",e,r)}else this.assert(n<=e,"expected #{this} to be at most "+e,"expected #{this} to be above "+e)}function f(e,n){n&&w(this,"message",n);var r=t.getName(e);this.assert(w(this,"object")instanceof e,"expected #{this} to be an instance of "+r,"expected #{this} to not be an instance of "+r)}function p(e,n){n&&w(this,"message",n);var r=w(this,"object");this.assert(r.hasOwnProperty(e),"expected #{this} to have own property "+t.inspect(e),"expected #{this} to not have own property "+t.inspect(e))}function d(){w(this,"doLength",!0)}function m(e,t){t&&w(this,"message",t);var n=w(this,"object");new b(n,t).to.have.property("length");var r=n.length;this.assert(r==e,"expected #{this} to have a length of #{exp} but got #{act}","expected #{this} to not have a length of #{act}",e,r)}function y(e){var n,r=w(this,"object"),o=!0;if(e=e instanceof Array?e:Array.prototype.slice.call(arguments),!e.length)throw new Error("keys required");var i=Object.keys(r),s=e,a=e.length;if(o=e.every(function(e){return~i.indexOf(e)}),w(this,"negate")||w(this,"contains")||(o=o&&e.length==i.length),a>1){e=e.map(function(e){return t.inspect(e)});var u=e.pop();n=e.join(", ")+", and "+u}else n=t.inspect(e[0]);n=(a>1?"keys ":"key ")+n,n=(w(this,"contains")?"contain ":"have ")+n,this.assert(o,"expected #{this} to "+n,"expected #{this} to not "+n,s.sort(),i.sort(),!0)}function v(e,n,r){r&&w(this,"message",r);var o=w(this,"object");new b(o,r).is.a("function");var i=!1,s=null,a=null,u=null;0===arguments.length?(n=null,e=null):e&&(e instanceof RegExp||"string"==typeof e)?(n=e,e=null):e&&e instanceof Error?(s=e,e=null,n=null):"function"==typeof e?"Error"===(a=e.prototype.name||e.name)&&e!==Error&&(a=(new e).name):e=null;try{o()}catch(r){if(s)return this.assert(r===s,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}",s instanceof Error?s.toString():s,r instanceof Error?r.toString():r),w(this,"object",r),this;if(e&&(this.assert(r instanceof e,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp} but #{act} was thrown",a,r instanceof Error?r.toString():r),!n))return w(this,"object",r),this;var c="object"===t.type(r)&&"message"in r?r.message:""+r;if(null!=c&&n&&n instanceof RegExp)return this.assert(n.exec(c),"expected #{this} to throw error matching #{exp} but got #{act}","expected #{this} to throw error not matching #{exp}",n,c),w(this,"object",r),this;if(null!=c&&n&&"string"==typeof n)return this.assert(~c.indexOf(n),"expected #{this} to throw error including #{exp} but got #{act}","expected #{this} to throw error not including #{act}",n,c),w(this,"object",r),this;i=!0,u=r}var h="",l=null!==a?a:s?"#{exp}":"an error";i&&(h=" but #{act} was thrown"),this.assert(!0===i,"expected #{this} to throw "+l+h,"expected #{this} to not throw "+l+h,s instanceof Error?s.toString():s,u instanceof Error?u.toString():u),w(this,"object",u)}function g(e,t,n){return e.every(function(e){return n?t.some(function(t){return n(e,t)}):-1!==t.indexOf(e)})}var b=e.Assertion,w=(Object.prototype.toString,t.flag);["to","be","been","is","and","has","have","with","that","at","of","same"].forEach(function(e){b.addProperty(e,function(){return this})}),b.addProperty("not",function(){w(this,"negate",!0)}),b.addProperty("deep",function(){w(this,"deep",!0)}),b.addChainableMethod("an",n),b.addChainableMethod("a",n),b.addChainableMethod("include",o,r),b.addChainableMethod("contain",o,r),b.addChainableNoop("ok",function(){this.assert(w(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),b.addChainableNoop("true",function(){this.assert(!0===w(this,"object"),"expected #{this} to be true","expected #{this} to be false",!this.negate)}),b.addChainableNoop("false",function(){this.assert(!1===w(this,"object"),"expected #{this} to be false","expected #{this} to be true",!!this.negate)}),b.addChainableNoop("null",function(){this.assert(null===w(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),b.addChainableNoop("undefined",function(){this.assert(void 0===w(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),b.addChainableNoop("exist",function(){this.assert(null!=w(this,"object"),"expected #{this} to exist","expected #{this} to not exist")}),b.addChainableNoop("empty",function(){var e=w(this,"object"),t=e;Array.isArray(e)||"string"==typeof object?t=e.length:"object"==typeof e&&(t=Object.keys(e).length),this.assert(!t,"expected #{this} to be empty","expected #{this} not to be empty")}),b.addChainableNoop("arguments",i),b.addChainableNoop("Arguments",i),b.addMethod("equal",s),b.addMethod("equals",s),b.addMethod("eq",s),b.addMethod("eql",a),b.addMethod("eqls",a),b.addMethod("above",u),b.addMethod("gt",u),b.addMethod("greaterThan",u),b.addMethod("least",c),b.addMethod("gte",c),b.addMethod("below",h),b.addMethod("lt",h),b.addMethod("lessThan",h),b.addMethod("most",l),b.addMethod("lte",l),b.addMethod("within",function(e,t,n){n&&w(this,"message",n);var r=w(this,"object"),o=e+".."+t;if(w(this,"doLength")){new b(r,n).to.have.property("length");var i=r.length;this.assert(i>=e&&i<=t,"expected #{this} to have a length within "+o,"expected #{this} to not have a length within "+o)}else this.assert(r>=e&&r<=t,"expected #{this} to be within "+o,"expected #{this} to not be within "+o)}),b.addMethod("instanceof",f),b.addMethod("instanceOf",f),b.addMethod("property",function(e,n,r){r&&w(this,"message",r);var o=w(this,"deep")?"deep property ":"property ",i=w(this,"negate"),s=w(this,"object"),a=w(this,"deep")?t.getPathValue(e,s):s[e];if(i&&void 0!==n){if(void 0===a)throw r=null!=r?r+": ":"",new Error(r+t.inspect(s)+" has no "+o+t.inspect(e))}else this.assert(void 0!==a,"expected #{this} to have a "+o+t.inspect(e),"expected #{this} to not have "+o+t.inspect(e));void 0!==n&&this.assert(n===a,"expected #{this} to have a "+o+t.inspect(e)+" of #{exp}, but got #{act}","expected #{this} to not have a "+o+t.inspect(e)+" of #{act}",n,a),w(this,"object",a)}),b.addMethod("ownProperty",p),b.addMethod("haveOwnProperty",p),b.addChainableMethod("length",m,d),b.addMethod("lengthOf",m),b.addMethod("match",function(e,t){t&&w(this,"message",t);var n=w(this,"object");this.assert(e.exec(n),"expected #{this} to match "+e,"expected #{this} not to match "+e)}),b.addMethod("string",function(e,n){n&&w(this,"message",n);var r=w(this,"object");new b(r,n).is.a("string"),this.assert(~r.indexOf(e),"expected #{this} to contain "+t.inspect(e),"expected #{this} to not contain "+t.inspect(e))}),b.addMethod("keys",y),b.addMethod("key",y),b.addMethod("throw",v),b.addMethod("throws",v),b.addMethod("Throw",v),b.addMethod("respondTo",function(e,n){n&&w(this,"message",n);var r=w(this,"object"),o=w(this,"itself"),i="function"!==t.type(r)||o?r[e]:r.prototype[e];this.assert("function"==typeof i,"expected #{this} to respond to "+t.inspect(e),"expected #{this} to not respond to "+t.inspect(e))}),b.addProperty("itself",function(){w(this,"itself",!0)}),b.addMethod("satisfy",function(e,n){n&&w(this,"message",n);var r=w(this,"object"),o=e(r);this.assert(o,"expected #{this} to satisfy "+t.objDisplay(e),"expected #{this} to not satisfy"+t.objDisplay(e),!this.negate,o)}),b.addMethod("closeTo",function(e,n,r){r&&w(this,"message",r);var o=w(this,"object");if(new b(o,r).is.a("number"),"number"!==t.type(e)||"number"!==t.type(n))throw new Error("the arguments to closeTo must be numbers");this.assert(Math.abs(o-e)<=n,"expected #{this} to be close to "+e+" +/- "+n,"expected #{this} not to be close to "+e+" +/- "+n)}),b.addMethod("members",function(e,n){n&&w(this,"message",n);var r=w(this,"object");new b(r).to.be.an("array"),new b(e).to.be.an("array");var o=w(this,"deep")?t.eql:void 0;if(w(this,"contains"))return this.assert(g(e,r,o),"expected #{this} to be a superset of #{act}","expected #{this} to not be a superset of #{act}",r,e);this.assert(g(r,e,o)&&g(e,r,o),"expected #{this} to have the same members as #{act}","expected #{this} to not have the same members as #{act}",r,e)})}},function(e,t){/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){e.expect=function(t,n){return new e.Assertion(t,n)}}},function(e,t){/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){function n(){function e(){return this instanceof String||this instanceof Number?new r(this.constructor(this),null,e):this instanceof Boolean?new r(1==this,null,e):new r(this,null,e)}function t(e){Object.defineProperty(this,"should",{value:e,enumerable:!0,configurable:!0,writable:!0})}Object.defineProperty(Object.prototype,"should",{set:t,get:e,configurable:!0});var n={};return n.equal=function(e,t,n){new r(e,n).to.equal(t)},n.Throw=function(e,t,n,o){new r(e,o).to.Throw(t,n)},n.exist=function(e,t){new r(e,t).to.exist},n.not={},n.not.equal=function(e,t,n){new r(e,n).to.not.equal(t)},n.not.Throw=function(e,t,n,o){new r(e,o).to.not.Throw(t,n)},n.not.exist=function(e,t){new r(e,t).to.not.exist},n.throw=n.Throw,n.not.throw=n.not.Throw,n}var r=e.Assertion;e.should=n,e.Should=n}},function(module,exports){/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
module.exports=function(chai,util){/*!
   * Chai dependencies.
   */
var Assertion=chai.Assertion,flag=util.flag,assert=chai.assert=function(e,t){new Assertion(null,null,chai.assert).assert(e,t,"[ negation message unavailable ]")};assert.fail=function(e,t,n,r){throw n=n||"assert.fail()",new chai.AssertionError(n,{actual:e,expected:t,operator:r},assert.fail)},assert.ok=function(e,t){new Assertion(e,t).is.ok},assert.notOk=function(e,t){new Assertion(e,t).is.not.ok},assert.equal=function(e,t,n){var r=new Assertion(e,n,assert.equal);r.assert(t==flag(r,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",t,e)},assert.notEqual=function(e,t,n){var r=new Assertion(e,n,assert.notEqual);r.assert(t!=flag(r,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",t,e)},assert.strictEqual=function(e,t,n){new Assertion(e,n).to.equal(t)},assert.notStrictEqual=function(e,t,n){new Assertion(e,n).to.not.equal(t)},assert.deepEqual=function(e,t,n){new Assertion(e,n).to.eql(t)},assert.notDeepEqual=function(e,t,n){new Assertion(e,n).to.not.eql(t)},assert.isTrue=function(e,t){new Assertion(e,t).is.true},assert.isFalse=function(e,t){new Assertion(e,t).is.false},assert.isNull=function(e,t){new Assertion(e,t).to.equal(null)},assert.isNotNull=function(e,t){new Assertion(e,t).to.not.equal(null)},assert.isUndefined=function(e,t){new Assertion(e,t).to.equal(void 0)},assert.isDefined=function(e,t){new Assertion(e,t).to.not.equal(void 0)},assert.isFunction=function(e,t){new Assertion(e,t).to.be.a("function")},assert.isNotFunction=function(e,t){new Assertion(e,t).to.not.be.a("function")},assert.isObject=function(e,t){new Assertion(e,t).to.be.a("object")},assert.isNotObject=function(e,t){new Assertion(e,t).to.not.be.a("object")},assert.isArray=function(e,t){new Assertion(e,t).to.be.an("array")},assert.isNotArray=function(e,t){new Assertion(e,t).to.not.be.an("array")},assert.isString=function(e,t){new Assertion(e,t).to.be.a("string")},assert.isNotString=function(e,t){new Assertion(e,t).to.not.be.a("string")},assert.isNumber=function(e,t){new Assertion(e,t).to.be.a("number")},assert.isNotNumber=function(e,t){new Assertion(e,t).to.not.be.a("number")},assert.isBoolean=function(e,t){new Assertion(e,t).to.be.a("boolean")},assert.isNotBoolean=function(e,t){new Assertion(e,t).to.not.be.a("boolean")},assert.typeOf=function(e,t,n){new Assertion(e,n).to.be.a(t)},assert.notTypeOf=function(e,t,n){new Assertion(e,n).to.not.be.a(t)},assert.instanceOf=function(e,t,n){new Assertion(e,n).to.be.instanceOf(t)},assert.notInstanceOf=function(e,t,n){new Assertion(e,n).to.not.be.instanceOf(t)},assert.include=function(e,t,n){new Assertion(e,n,assert.include).include(t)},assert.notInclude=function(e,t,n){new Assertion(e,n,assert.notInclude).not.include(t)},assert.match=function(e,t,n){new Assertion(e,n).to.match(t)},assert.notMatch=function(e,t,n){new Assertion(e,n).to.not.match(t)},assert.property=function(e,t,n){new Assertion(e,n).to.have.property(t)},assert.notProperty=function(e,t,n){new Assertion(e,n).to.not.have.property(t)},assert.deepProperty=function(e,t,n){new Assertion(e,n).to.have.deep.property(t)},assert.notDeepProperty=function(e,t,n){new Assertion(e,n).to.not.have.deep.property(t)},assert.propertyVal=function(e,t,n,r){new Assertion(e,r).to.have.property(t,n)},assert.propertyNotVal=function(e,t,n,r){new Assertion(e,r).to.not.have.property(t,n)},assert.deepPropertyVal=function(e,t,n,r){new Assertion(e,r).to.have.deep.property(t,n)},assert.deepPropertyNotVal=function(e,t,n,r){new Assertion(e,r).to.not.have.deep.property(t,n)},assert.lengthOf=function(e,t,n){new Assertion(e,n).to.have.length(t)},assert.Throw=function(e,t,n,r){("string"==typeof t||t instanceof RegExp)&&(n=t,t=null);var o=new Assertion(e,r).to.Throw(t,n);return flag(o,"object")},assert.doesNotThrow=function(e,t,n){"string"==typeof t&&(n=t,t=null),new Assertion(e,n).to.not.Throw(t)},assert.operator=function(val,operator,val2,msg){if(!~["==","===",">",">=","<","<=","!=","!=="].indexOf(operator))throw new Error('Invalid operator "'+operator+'"');var test=new Assertion(eval(val+operator+val2),msg);test.assert(!0===flag(test,"object"),"expected "+util.inspect(val)+" to be "+operator+" "+util.inspect(val2),"expected "+util.inspect(val)+" to not be "+operator+" "+util.inspect(val2))},assert.closeTo=function(e,t,n,r){new Assertion(e,r).to.be.closeTo(t,n)},assert.sameMembers=function(e,t,n){new Assertion(e,n).to.have.same.members(t)},assert.includeMembers=function(e,t,n){new Assertion(e,n).to.include.members(t)},/*!
   * Undocumented / untested
   */
assert.ifError=function(e,t){new Assertion(e,t).to.not.be.ok},/*!
   * Aliases.
   */
function e(t,n){return assert[n]=assert[t],e}("Throw","throw")("Throw","throws")}},function(e,t,n){"use strict";n(1).should();t.run=function(e){describe("SPScript Context",function(){var t=e.createContext();describe("var ctx = SPScript.createContext(url)",function(){it("Should create the primary object you use to interact with the site",function(){if(!t)throw new Error("Context is null");t.should.have.property("webUrl"),t.should.have.property("executeRequest"),t.should.have.property("get"),t.should.have.property("post"),t.should.have.property("authorizedPost"),t.should.have.property("lists")}),it("Should allow a url to be passed in",function(){var t="http://blah.sharepoint.com";e.createContext(t).webUrl.should.equal(t)}),it("Should default to the current web if no url is passed",function(){e.createContext().webUrl.should.equal(_spPageContextInfo.webAbsoluteUrl)})}),describe("Namespaces",function(){describe("ctx.web",function(){it("Should have an SPScript Web object with site methods (getUser, getSubsites etc...)",function(){t.should.have.property("web"),t.web.should.have.property("getUser"),t.web.should.have.property("getSubsites")})}),describe("ctx.search",function(){it("Should have an SPScript Search object with search methods (query, people, sites etc...)",function(){t.search.should.have.property("query"),t.search.should.have.property("people")})}),describe("ctx.profiles",function(){it("Should have an SPScript Profiles object with methods to hit the Profile Service (current, setProperty etc...)",function(){t.should.have.property("profiles"),t.profiles.should.have.property("get"),t.profiles.should.have.property("setProperty")})})}),describe("Methods",function(){describe("ctx.list(name)",function(){it("Should return an SPScript List instance",function(){var e=t.lists("My List");e.should.have.property("listName"),e.should.have.property("getInfo")})}),describe("ctx.get(url, [opts])",function(){var e;before(function(){e=t.get("/lists?$select=Title")}),it("Should return a Promise",function(){if(!e)throw new Error("Promise is null");e.should.have.property("then")}),it("Should resolve to a JS object, not a JSON string",function(t){e.then(function(e){e.should.have.property("d"),t()}).catch(function(e){return t(e)})}),it("Should return valid API results: ctx.get('/lists')",function(t){e.then(function(e){e.should.have.property("d"),e.d.should.have.property("results"),e.d.results.should.be.an("array"),t()}).catch(function(e){return t(e)})})}),describe("ctx.post(url, [body], [opts]",function(){it("Should return a Promise"),it("Should resolve to a JS object, not a JSON string")}),describe("ctx.authorizedPost(url, [body], [opts]",function(){it("Should include a request digest in the headers"),it("Should return a Promise"),it("Should resolve to a JS object, not a JSON string")}),describe("ctx.getRequestDigest()",function(){it("Should resolve to a string request digest",function(e){t.getRequestDigest().then(function(t){t.should.be.a("string"),t.should.not.be.empty,e()})})})})})}},function(e,t,n){"use strict";function r(){return!("undefined"==typeof window)}var o=n(14);n(1).should();t.run=function(e){describe("var web = ctx.web",function(){this.timeout(5e3),describe("ctx.web.getInfo()",function(){it("Should return a promise that resolves to web info",function(t){e.web.getInfo().then(function(e){e.should.have.property("Url"),e.should.have.property("Title"),t()}).catch(function(e){console.log(e)})})}),describe("ctx.web.getSubsites()",function(){it("Should return a promise that resolves to an array of subsite web infos.",function(t){e.web.getSubsites().then(function(e){e.should.be.an("array"),e.length&&(e[0].should.have.property("Title"),e[0].should.have.property("ServerRelativeUrl")),t()})})}),describe("ctx.web.getUser()",function(){var t=null;before(function(n){e.web.getUser().then(function(e){t=e,n()})}),it("Should return a promise that resolves to a user object",function(){t.should.not.be.null,t.should.have.property("Id"),t.should.have.property("LoginName"),t.should.have.property("Email")}),it("Should return the current user",function(){t.should.have.property("Id"),"undefined"!=typeof window&&window._spPageContextInfo&&t.Id.should.equal(_spPageContextInfo.userId)})}),describe("ctx.web.getUser(email)",function(){var t="andrew@andrewpetersen.onmicrosoft.com",n=null;before(function(r){e.web.getUser(t).then(function(e){n=e,r()})}),it("Should return a promise that resolves to a user object",function(){n.should.not.be.null,n.should.have.property("Id"),n.should.have.property("LoginName"),n.should.have.property("Email")}),it("Should return a user whose email matches the specified email",function(){n.should.have.property("Email"),n.Email.should.equal(t)})});var t="/spscript/Shared Documents/testfile.txt";describe("ctx.web.getFile(serverRelativeFileUrl)",function(){var n=null;before(function(r){e.web.getFile(t).then(function(e){n=e,r()})}),it("Should return a promise that resolves to a file object",function(){n.should.not.be.null,n.should.property("CheckOutType"),n.should.property("ETag"),n.should.property("Exists"),n.should.property("TimeLastModified"),n.should.property("Name"),n.should.property("UIVersionLabel")})});describe("ctx.web.copyFile(serverRelativeSourceUrl, serverRelativeDestUrl)",function(){var n=(new Date,null);before(function(r){e.web.copyFile(t,"/spscript/Shared%20Documents/testfile2.txt").then(function(){return e.web.getFile("/spscript/Shared%20Documents/testfile2.txt")}).then(function(e){n=e,r()}).catch(function(e){"one".should.equal("two","Error in CopyFile requst"),r()})}),it("Should return a promise, and once resolved, the new (copied) file should be retrievable.",function(){n.should.not.be.null,n.should.property("CheckOutType"),n.should.property("ETag"),n.should.property("Exists"),n.should.property("TimeLastModified"),n.should.property("Name"),n.should.property("UIVersionLabel")})}),describe("ctx.web.permissions.getRoleAssignments()",o.create(e.web)),r()&&describe("ctx.web.permissions.check()",o.create(e.web,"check")),describe("ctx.web.permissions.check(email)",o.create(e.web,"check","andrew@andrewpetersen.onmicrosoft.com"))})}},function(e,t,n){"use strict";function r(){return!("undefined"==typeof window)}var o=n(14);n(1).should();t.run=function(e){describe("var list = ctx.lists(listname)",function(){this.timeout(4e3);var t=e.lists("TestList");describe("list.info()",function(){var e=null;before(function(n){t.getInfo().then(function(t){e=t,n()})}),it("Should return a promise that resolves to list info",function(){e.should.be.an("object")}),it("Should bring back list info like Title, ItemCount, and ListItemEntityTypeFullName",function(){e.should.have.property("Title"),e.should.have.property("ItemCount"),e.should.have.property("ListItemEntityTypeFullName")})}),describe("list.getItems()",function(){var e=null;before(function(n){t.getItems().then(function(t){e=t,n()})}),it("Should return a promise that resolves to an array of items",function(){e.should.be.an("array")}),it("Should return all the items in the list",function(n){t.getInfo().then(function(t){e.length.should.equal(t.ItemCount),n()})})}),describe("list.getItems(odata)",function(){var e=null;before(function(n){t.getItems("$filter=MyStatus eq 'Green'").then(function(t){e=t,n()})}),it("Should return a promise that resolves to an array of items",function(){e.should.be.an("array")}),it("Should return only items that match the OData params",function(){e.forEach(function(e){e.should.have.property("MyStatus"),e.MyStatus.should.equal("Green")})})}),describe("list.getItemById(id)",function(){var e=null,n=-1;before(function(r){t.getItems().then(function(e){return n=e[0].Id}).then(function(e){return t.getItemById(e)}).then(function(t){e=t,r()})}),it("Should return a promise that resolves to a single item",function(){e.should.be.an("object"),e.should.have.property("Title")}),it("Should resolve an item with a matching ID",function(){e.should.have.property("Id"),e.Id.should.equal(n)}),it("Should be able to return attachments using the optional odata query",function(e){t.getItemById(n,"$expand=AttachmentFiles").then(function(t){t.should.have.property("AttachmentFiles"),t.AttachmentFiles.should.have.property("results"),t.AttachmentFiles.results.should.be.an("Array"),e()})})}),describe("list.findItems(key, value)",function(){var e=null;before(function(n){t.findItems("MyStatus","Green").then(function(t){e=t,n()})}),it("Should return a promise that resolves to an array of list items",function(){e.should.be.an("array"),e.should.not.be.empty}),it("Should only bring back items the match the key value query",function(){e.forEach(function(e){e.should.have.property("MyStatus"),e.MyStatus.should.equal("Green")})})}),describe("list.findItem(key, value)",function(){var e=null;before(function(n){t.findItem("MyStatus","Green").then(function(t){e=t,n()})}),it("Should resolve to one list item",function(){e.should.be.an("object")}),it("Should only bring back an item if it matches the key value query",function(){e.should.have.property("MyStatus"),e.MyStatus.should.equal("Green")})}),describe("list.addItem()",function(){var e={Title:"Test Created Item",MyStatus:"Red"},n=null;before(function(r){t.addItem(e).then(function(e){n=e,r()}).catch(function(e){console.log(e),r()})}),it("Should return a promise that resolves with the new list item",function(){n.should.not.be.null,n.should.be.an("object"),n.should.have.property("Id")}),it("Should save the item right away so it can be queried.",function(){t.getItemById(n.Id).then(function(t){t.should.not.be.null,t.should.have.property("Title"),t.Title.should.equal(e.Title)})}),it("Should throw an error if a invalid field is set",function(n){e.InvalidColumn="test",t.addItem(e).then(function(){"one".should.equal("two")}).catch(function(e,t,r){n()})})}),describe("list.deleteItem(id)",function(){var e=null;before(function(n){t.getItems("$orderby=Id").then(function(n){return e=n[n.length-1],t.deleteItem(e.Id)}).then(function(){n()}).catch(function(e){n(e)})}),it("Should delete that item",function(n){t.getItemById(e.Id).then(function(){throw"Should have failed because item has been deleted"}).catch(function(){n()})}),it("Should reject the promise if the item id can not be found",function(e){t.deleteItem(99999999).then(function(){throw"Should have failed because id doesnt exist"}).catch(function(){e()})})}),describe("list.updateItem()",function(){var e=null,n={Title:"Updated Title"};before(function(n){t.getItems("$orderby=Id desc").then(function(t){e=t[t.length-1],n()})}),it("Should return a promise",function(r){t.updateItem(e.Id,n).then(function(){r()})}),it("Should update only the properties that were passed",function(r){t.getItemById(e.Id).then(function(e){e.should.have.property("Title"),e.Title.should.equal(n.Title),r()})})}),describe("list.permissions.getRoleAssignments()",o.create(t)),r()&&describe("list.permissions.check()",o.create(t,"check")),describe("list.permissions.check(email)",o.create(t,"check","andrew@andrewpetersen.onmicrosoft.com"))})}},function(e,t,n){"use strict";t.run=function(e){describe("ctx.customActions",function(){this.timeout(1e4);var t={Name:"spscript-test",Location:"ScriptLink",ScriptBlock:"console.log('deployed from spscript-mocha test');"};describe("ctx.customActions.add(customAction)",function(){var n=0;before(function(t){e.customActions.get().then(function(e){n=e.length,t()})}),it("Should add a Custom Action with the given name",function(r){e.customActions.add(t).then(function(){e.customActions.get().then(function(e){e.length.should.equal(n+1),r()})})}),it("Should not add duplicate Custom Action names. It should remove old one first.",function(r){e.customActions.add(t).then(function(){e.customActions.get().then(function(e){e.length.should.equal(n+1),r()})})})}),describe("ctx.customActions.get()",function(){var t=null;before(function(n){e.customActions.get().then(function(e){t=e,n()})}),it("Should return a promise that resolves to an array of custom actions",function(){t.should.be.an("array"),t.should.not.be.empty}),it("Should bring back properties like Name, Url, and Location",function(){var e=t[0];e.should.have.property("Name"),e.should.have.property("Url"),e.should.have.property("Location")})}),describe("ctx.customActions.get(name)",function(){var t=null;before(function(n){e.customActions.get().then(function(r){e.customActions.get(r[0].Name).then(function(e){t=e,n()})})}),it("Should return one object w/ properties like Name, Location, Url, Id",function(){t.should.not.be.null,t.should.have.property("Name"),t.should.have.property("Location"),t.should.have.property("Id")}),it("Should reject the promise with a decent error if the Custom Action name is not found",function(t){e.customActions.get("INVALID-NAME").then(function(){"one".should.equal("two"),t()}).catch(function(e){console.log(e),t()})})}),describe("ctx.customActions.update(updates)",function(){var n=null;before(function(r){e.customActions.get(t.Name).then(function(e){n=e,r()})});var r="updated title - "+Date.now();it("Should update the property",function(t){e.customActions.update({Name:n.Name,Title:r}).then(function(){e.customActions.get(n.Name).then(function(e){e.Title.should.equal(r),t()})})})}),describe("dao.customActions.remove(name)",function(){var n=0;before(function(r){e.customActions.get().then(function(e){n=e.filter(function(e){return e.Name===t.Name}).length,r()}).catch(function(e){console.log(e),r()})}),it("Should remove all custom actions with that name",function(n){e.customActions.remove(t.Name).then(function(){e.customActions.get().then(function(e){e.filter(function(e){return e.Name===t.Name}).should.be.empty(),n()})})})}),describe("ctx.customActions.addScriptLink(name, url)",function(){var t="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",n="SPScriptJSTest-Web";before(function(r){e.customActions.addScriptLink(n,t).then(function(){r()})}),it("Should add a custom action with that name and ScriptBlock with specified URL",function(r){e.customActions.get(n).then(function(e){e.should.have.property("Name"),e.Name.should.equal(n),e.should.have.property("ScriptBlock"),e.ScriptBlock.should.contain(t),r()})}),after(function(t){e.customActions.remove(n).then(function(){t()})})}),describe("ctx.customActions.addScriptLink(name, url, opts)",function(){var t="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",n="SPScriptJSTest-Site",r={Sequence:25,Group:"Custom Group"};before(function(o){e.customActions.addScriptLink(n,t,r).then(function(){o()})}),it("Should add a custom action with that name and ScriptBlock with specified URL",function(o){e.customActions.get(n).then(function(e){e.should.have.property("Name"),e.Name.should.equal(n),e.should.have.property("ScriptBlock"),e.ScriptBlock.should.contain(t),e.should.have.property("Group"),e.Group.should.equal(r.Group),e.should.have.property("Sequence"),e.Sequence.should.equal(25),o()})}),after(function(t){e.customActions.remove(n).then(function(){t()})})}),describe("ctx.customActions.addCSSLink(name, url)",function(){var t="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css",n="SPScriptCSSTest-Web";before(function(r){e.customActions.addCSSLink(n,t).then(function(){r()})}),it("Should add a custom action with that name and ScriptBlock containing specified URL",function(r){e.customActions.get(n).then(function(e){e.should.have.property("Name"),e.Name.should.equal(n),e.should.have.property("ScriptBlock"),e.ScriptBlock.should.contain(t),r()})}),after(function(t){e.customActions.remove(n).then(function(){t()})})}),describe("ctx.customActions.addCSSLink(name, url, opts)",function(){var t="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css",n="SPScriptCSSTest-Site",r={Sequence:50,Group:"Custom Group"};before(function(o){e.customActions.addCSSLink(n,t,r).then(function(){o()})}),it("Should add a custom action with that name and ScriptBlock containing specified URL with Site scope",function(o){e.customActions.get(n).then(function(e){e.should.have.property("Name"),e.Name.should.equal(n),e.should.have.property("ScriptBlock"),e.ScriptBlock.should.contain(t),e.should.have.property("Group"),e.Group.should.equal(r.Group),e.should.have.property("Sequence"),e.Sequence.should.equal(50),o()})}),after(function(t){e.customActions.remove(n).then(function(){t()})})})})}},function(e,t,n){"use strict";n(1).should();t.run=function(e){describe("var search = ctx.search;",function(){this.timeout(5e3),describe("ctx.search.query(queryText)",function(){it("Should return promise that resolves to a SearchResults object",function(t){e.search.query("andrew").then(function(e){e.should.be.an("object"),e.should.have.property("resultsCount"),e.should.have.property("totalResults"),e.should.have.property("items"),e.should.have.property("refiners"),e.items.should.be.an("array"),e.items.should.not.be.empty,t()})})}),describe("ctx.search.query(queryText, queryOptions)",function(){it("Should obey the extra query options that were passed",function(t){var n={rowLimit:1};e.search.query("andrew",n).then(function(e){e.should.be.an("object"),e.should.have.property("resultsCount"),e.should.have.property("totalResults"),e.should.have.property("items"),e.should.have.property("refiners"),e.items.should.be.an("array"),e.items.should.not.be.empty,e.items.length.should.equal(1),t()})})}),describe("ctx.search.query(queryText, queryOptions) - w/ Refiners",function(){it("Should return SearchResults that include a refiners array",function(t){var n={refiners:"FileType"};e.search.query("andrew",n).then(function(e){e.should.be.an("object"),e.should.have.property("refiners"),e.refiners.should.not.be.empty;var n=e.refiners[0];n.should.have.property("RefinerName"),n.should.have.property("RefinerOptions"),n.RefinerName.should.equal("FileType"),n.RefinerOptions.should.be.an("array"),t()})})}),describe("ctx.search.people(queryText)",function(){it("Should only return search results that are people",function(t){e.search.people("andrew").then(function(e){e.should.be.an("object"),e.should.have.property("items"),e.items.should.be.an("array"),e.items.should.not.be.empty;var n=e.items[0];n.should.have.property("AccountName"),n.should.have.property("PreferredName"),n.should.have.property("AboutMe"),n.should.have.property("WorkEmail"),n.should.have.property("PictureURL"),t()})})}),describe("ctx.search.sites(queryText, scope)",function(){it("Should only return search results that are sites",function(t){e.search.sites("").then(function(e){e.should.be.an("object"),e.should.have.property("items"),e.items.should.be.an("array"),e.items.should.not.be.empty();for(var n,r=0;r<e.items.length;r++)n=e.items[r],n.should.have.property("Path"),n.should.have.property("contentclass"),n.contentclass.should.equal("STS_Web");t()})}),it("Should only return sites underneath the specified scope",function(t){var n="https://andrewpetersen.sharepoint.com/sites/ep";e.search.sites("",n).then(function(e){e.should.be.an("object"),e.should.have.property("items"),e.items.should.be.an("array"),e.items.should.not.be.empty();for(var r,o=0;o<e.items.length;o++)r=e.items[o],r.should.have.property("Path"),r.Path.indexOf(n).should.equal(0),r.should.have.property("contentclass"),r.contentclass.should.equal("STS_Web");t()})})})})}},function(e,t,n){"use strict";n(1).should();t.run=function(e){describe("var profiles = ctx.profiles",function(){this.timeout(5e3),describe("ctx.profiles.current()",function(){var t=null;before(function(n){e.profiles.current().then(function(e){t=e,n()})}),it("Should return a promise that resolves to a profile properties object",function(){t.should.be.an("object"),t.should.have.property("AccountName"),t.should.have.property("Email"),t.should.have.property("PreferredName")}),it("Should return the profile of the current user",function(){t.should.have.property("Email"),t.Email.should.equal(_spPageContextInfo.userEmail)})}),describe("ctx.profiles.get()",function(){var t=null;before(function(n){e.profiles.get().then(function(e){t=e,n()})}),it("Should return a promise that resolves to a profile properties object",function(){t.should.be.an("object"),t.should.have.property("AccountName"),t.should.have.property("Email"),t.should.have.property("PreferredName")}),it("Should return the profile of the current user",function(){t.should.have.property("Email"),t.Email.should.equal(_spPageContextInfo.userEmail)})}),describe("ctx.profiles.get(email)",function(){var t="andrew@andrewpetersen.onmicrosoft.com",n=null;before(function(r){e.profiles.get(t).then(function(e){n=e,r()}).catch(function(e){r(e)})}),it("Should return a promise that resolves to a profile properties object",function(){n.should.be.an("object"),n.should.have.property("AccountName"),n.should.have.property("Email"),n.should.have.property("PreferredName")}),it("Should give you the matching person",function(){n.should.have.property("Email"),n.Email.should.equal(t)}),it("Should reject the promise for an invalid email",function(t){e.profiles.get("invalid@invalid123.com").then(function(e){t("The request should have failed.")}).catch(function(){t()})})}),describe("ctx.profiles.get({ AccountName })",function(){var t=null;before(function(n){e.profiles.get({AccountName:"i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com"}).then(function(e){t=e,n()}).catch(function(e){n(e)})}),it("Should return a promise that resolves to a profile properties object",function(){t.should.be.an("object"),t.should.have.property("AccountName"),t.should.have.property("Email"),t.should.have.property("PreferredName")}),it("Should give you the matching person",function(){t.should.have.property("Email"),t.Email.should.equal("andrew@andrewpetersen.onmicrosoft.com")}),it("Should reject the promise for an invalid account name",function(t){e.profiles.get({AccountName:"Invalid"}).then(function(e){t("The request should have failed.")}).catch(function(){t()})})}),describe("ctx.profiles.get({ LoginName })",function(){var t=null;before(function(n){e.profiles.get({LoginName:"i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com"}).then(function(e){t=e,n()}).catch(function(e){n(e)})}),it("Should return a promise that resolves to a profile properties object",function(){t.should.be.an("object"),t.should.have.property("AccountName"),t.should.have.property("Email"),t.should.have.property("PreferredName")}),it("Should give you the matching person",function(){t.should.have.property("Email"),t.Email.should.equal("andrew@andrewpetersen.onmicrosoft.com")}),it("Should reject the promise for an invalid account name",function(t){e.profiles.get({LoginName:"Invalid"}).then(function(e){t("The request should have failed.")}).catch(function(){t()})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue)",function(){it("Should update the About Me profile property of the current user",function(t){var n="Hi there. I was updated with SPScript 1";e.profiles.setProperty("AboutMe",n).then(function(){return e.profiles.current()}).then(function(e){e.should.have.property("AboutMe"),e.AboutMe.should.equal(n),t()}).catch(function(e){t(e)})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue, email)",function(){var t="andrew@andrewpetersen.onmicrosoft.com";it("Should update the About Me profile property based on the specified email",function(n){var r="Hi there. I was updated with SPScript 2";e.profiles.setProperty("AboutMe",r,t).then(function(){return e.profiles.get(t)}).then(function(e){e.should.have.property("AboutMe"),e.AboutMe.should.equal(r),n()}).catch(function(e){n(e)})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue, { AccountName|LoginName })",function(){var t="i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com";it("Should update the About Me profile property of the passed in User object",function(n){var r="Hi there. I was updated with SPScript 3";e.profiles.setProperty("AboutMe",r,{AccountName:t}).then(function(){return e.profiles.get({AccountName:t})}).then(function(e){e.should.have.property("AboutMe"),e.AboutMe.should.equal(r),n()}).catch(function(e){n(e)})})})})}},function(e,t,n){"use strict";n(1).should();t.run=function(e){describe("var utils = SPScript.utils",function(){describe("utils.parseJSON(data)",function(){it("Should exist on the utils object",function(){e.should.have.property("parseJSON"),e.parseJSON.should.be.a("function")}),it("Should take a string or an object and return an object",function(){var t={one:"value of one",two:"value of two"},n=JSON.stringify(t),r=e.parseJSON(t);r.should.not.be.null,r.should.have.property("one"),r.one.should.equal(t.one);var o=e.parseJSON(n);o.should.not.be.null,o.should.have.property("one"),o.one.should.equal(t.one)})}),describe("Query String",function(){describe("utils.qs.toObj(str)",function(){it("Should take in a string in the form of key=value&key2=value and return an Object",function(){var t=e.qs.toObj("key1=value1");t.should.have.property("key1"),t.key1.should.equal("value1");var n=e.qs.toObj("key1=value1&key2=value2");n.should.have.property("key1"),n.should.have.property("key2"),n.key2.should.equal("value2")}),it("Should support an optional leading '?' ",function(){var t=e.qs.toObj("?key1=value1");t.should.have.property("key1"),t.key1.should.equal("value1")}),it("Should default to 'window.location.search' if no value is passed")}),describe("utils.qs.fromObj(obj, quoteValues?)",function(){it("Should turn { key1: 'value1', key2: 'value2' } into 'key1=value1&key2=value2'",function(){var t={key1:"value1",key2:"value2"};e.qs.fromObj(t).should.equal("key1=value1&key2=value2")}),it("Should put single quotes around words with spaces",function(){var t={key1:"my value"};e.qs.fromObj(t).should.equal("key1='my value'")}),it("Should put single quotes around every value is an optional 'quoteValues' param is set to true",function(){var t={key1:"value1",key2:"value2"};e.qs.fromObj(t,!0).should.equal("key1='value1'&key2='value2'")})})}),describe("Headers",function(){describe("utils.headers.getStandardHeaders(digest?)",function(){it("Should set the Accept header",function(){var t=e.headers.getStandardHeaders();t.should.have.property("Accept"),t.Accept.should.equal("application/json;odata=verbose")}),it("Should set the Request Digest if a digest is passed",function(){var t=e.headers.getStandardHeaders("123Fake");t.should.have.property("Accept"),t.Accept.should.equal("application/json;odata=verbose"),t.should.have.property("X-RequestDigest"),t["X-RequestDigest"].should.equal("123Fake")})}),describe("utils.headers.getAddHeaders(digest)",function(){it("Should set the Request Digest if a digest is passed",function(){var t=e.headers.getAddHeaders("123Fake");t.should.have.property("Accept"),t.Accept.should.equal("application/json;odata=verbose"),t.should.have.property("X-RequestDigest"),t["X-RequestDigest"].should.equal("123Fake")})}),describe("utils.headers.getUpdateHeaders(digest)",function(){it("Should set X-HTTP-Method to MERGE and include X-RequestDigest",function(){var t=e.headers.getUpdateHeaders("123Fake");t.should.have.property("Accept"),t.Accept.should.equal("application/json;odata=verbose"),t.should.have.property("X-RequestDigest"),t["X-RequestDigest"].should.equal("123Fake"),t.should.have.property("X-HTTP-Method"),t["X-HTTP-Method"].should.equal("MERGE")})}),describe("utils.headers.getDeleteHeaders(digest)",function(){it("Should set X-HTTP-Method to DELETE and include X-RequestDigest",function(){var t=e.headers.getDeleteHeaders("123Fake");t.should.have.property("Accept"),t.Accept.should.equal("application/json;odata=verbose"),t.should.have.property("X-RequestDigest"),t["X-RequestDigest"].should.equal("123Fake"),t.should.have.property("X-HTTP-Method"),t["X-HTTP-Method"].should.equal("DELETE")})})}),describe("Dependency Management",function(){describe("utils.validateNamespace(namespace)",function(){it("Should return false if that namespace is not on global window"),it("Should return true if that namespace is on global window")}),describe("utils.waitForLibrary(namespace)",function(){it("Should return a promise that resolves when that namespace is on the global")}),describe("utils.waitForLibraries(namespaces)",function(){it("Should return a promise that resolves when all the namespacea are on the global")}),describe("utils.waitForElement(selector)",function(){it("Should return a promise that resolves an element that matches the selector is on the page"),it("Should eventually time out")})})})}}])});
//# sourceMappingURL=tests.js.map