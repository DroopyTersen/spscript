!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("isomorphic-fetch")):"function"==typeof define&&define.amd?define("SPScript",["isomorphic-fetch"],e):"object"==typeof exports?exports.SPScript=e(require("isomorphic-fetch")):t.SPScript=e(t["isomorphic-fetch"])}(this,function(__WEBPACK_EXTERNAL_MODULE_5__){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=42)}([,function(t,e,n){t.exports=n(45)},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e,n){var r=t.__flags||(t.__flags=Object.create(null));if(3!==arguments.length)return r[e];r[e]=n}},function(t,e){t.exports={includeStack:!1,showDiff:!0,truncateThreshold:40}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_5__},,function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){function r(t,e,n,r){return o({showHidden:e,seen:[],stylize:function(t){return t}},t,void 0===n?2:n)}function o(t,n,r){if(n&&"function"==typeof n.inspect&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var d=n.inspect(r);return"string"!=typeof d&&(d=o(t,d,r)),d}var b=i(t,n);if(b)return b;if(g(n)){if("outerHTML"in n)return n.outerHTML;try{if(document.xmlVersion){return(new XMLSerializer).serializeToString(n)}var w=document.createElementNS("http://www.w3.org/1999/xhtml","_");return w.appendChild(n.cloneNode(!1)),html=w.innerHTML.replace("><",">"+n.innerHTML+"<"),w.innerHTML="",html}catch(t){}}var S=y(n),x=t.showHidden?v(n):S;if(0===x.length||p(n)&&(1===x.length&&"stack"===x[0]||2===x.length&&"description"===x[0]&&"stack"===x[1])){if("function"==typeof n){var A=m(n),_=A?": "+A:"";return t.stylize("[Function"+_+"]","special")}if(l(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(f(n))return t.stylize(Date.prototype.toUTCString.call(n),"date");if(p(n))return s(n)}var j="",P=!1,E=["{","}"];if(h(n)&&(P=!0,E=["[","]"]),"function"==typeof n){var A=m(n),_=A?": "+A:"";j=" [Function"+_+"]"}if(l(n)&&(j=" "+RegExp.prototype.toString.call(n)),f(n)&&(j=" "+Date.prototype.toUTCString.call(n)),p(n))return s(n);if(0===x.length&&(!P||0==n.length))return E[0]+j+E[1];if(r<0)return l(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var O;return O=P?a(t,n,r,S,x):x.map(function(e){return u(t,n,r,S,e,P)}),t.seen.pop(),c(O,j,E)}function i(t,e){switch(typeof e){case"undefined":return t.stylize("undefined","undefined");case"string":var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string");case"number":return 0===e&&1/e==-1/0?t.stylize("-0","number"):t.stylize(""+e,"number");case"boolean":return t.stylize(""+e,"boolean")}if(null===e)return t.stylize("null","null")}function s(t){return"["+Error.prototype.toString.call(t)+"]"}function a(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)Object.prototype.hasOwnProperty.call(e,String(s))?i.push(u(t,e,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(u(t,e,n,r,o,!0))}),i}function u(t,e,n,r,i,s){var a,u;if(e.__lookupGetter__&&(e.__lookupGetter__(i)?u=e.__lookupSetter__(i)?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):e.__lookupSetter__(i)&&(u=t.stylize("[Setter]","special"))),r.indexOf(i)<0&&(a="["+i+"]"),u||(t.seen.indexOf(e[i])<0?(u=null===n?o(t,e[i],null):o(t,e[i],n-1),u.indexOf("\n")>-1&&(u=s?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n"))):u=t.stylize("[Circular]","special")),void 0===a){if(s&&i.match(/^\d+$/))return u;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+u}function c(t,e,n){var r=0;return t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function h(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===d(t)}function l(t){return"object"==typeof t&&"[object RegExp]"===d(t)}function f(t){return"object"==typeof t&&"[object Date]"===d(t)}function p(t){return"object"==typeof t&&"[object Error]"===d(t)}function d(t){return Object.prototype.toString.call(t)}var m=n(12),v=n(51),y=n(52);t.exports=r;var g=function(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName}},,,function(t,e){/*!
 * Chai - getActual utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e){return e.length>4?e[4]:t._obj}},function(t,e){/*!
 * Chai - getName utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t){if(t.name)return t.name;var e=/^\s?function ([^(]*)\(/.exec(t);return e&&e[1]?e[1]:""}},function(t,e,n){/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependancies
 */
var r=n(8),o=n(4);t.exports=function(t){var e=r(t),n=Object.prototype.toString.call(t);if(o.truncateThreshold&&e.length>=o.truncateThreshold){if("[object Function]"===n)return t.name&&""!==t.name?"[Function: "+t.name+"]":"[Function]";if("[object Array]"===n)return"[ Array("+t.length+") ]";if("[object Object]"===n){var i=Object.keys(t);return"{ Object ("+(i.length>2?i.splice(0,2).join(", ")+", ...":i.join(", "))+") }"}return e}return e}},function(t,e){/*!
 * Chai - transferFlags utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e,n){var r=t.__flags||(t.__flags=Object.create(null));e.__flags||(e.__flags=Object.create(null)),n=3!==arguments.length||n;for(var o in r)(n||"object"!==o&&"ssfi"!==o&&"message"!=o)&&(e.__flags[o]=r[o])}},function(t,e,n){"use strict";n(1).should(),e.create=function(t,e,n){return"check"===e?function(){var e=null;before(function(r){t.permissions.check(n).then(function(t){e=t,r()}).catch(function(t){r(t)})}),it("Should return a promise that resolves to an array of base permission strings",function(){e.should.be.an("array"),e.should.not.be.empty}),it("Should reject the promise for an invalid email",function(e){t.permissions.check("invalid@invalid123.com").then(function(t){"one".should.equal("two"),e()}).catch(function(t){e()})})}:function(){var e=null;before(function(n){t.permissions.getRoleAssignments().then(function(t){e=t,n()})}),it("Should return a promise that resolves to an array of objects",function(){e.should.be.an("array"),e.should.not.be.empty}),it("Should return objects that each have a member and a roles array",function(){e.forEach(function(t){t.should.have.property("member"),t.should.have.property("roles"),t.roles.should.be.an("array")})}),it("Should return permission objects that contain member.name, member.login, and member.id",function(){e.forEach(function(t){t.member.should.have.property("name"),t.member.should.have.property("login"),t.member.should.have.property("id")})}),it("Should return permission objects, each with a roles array that has a name and description",function(){e.forEach(function(t){t.roles.forEach(function(t){t.should.have.property("name"),t.should.have.property("description")})})})}}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";mocha.setup("bdd"),chai.should();var r=n(43);n(44).run(r),mocha.run()},function(t,e,n){"use strict";(function(t){var r,o,i,s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(s,u){"object"==a(e)&&"object"==a(t)?t.exports=u(n(5)):(o=[n(5)],r=u,void 0!==(i="function"==typeof r?r.apply(e,o):r)&&(t.exports=i))}(0,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=15)}([function(t,e,n){function r(){return!("undefined"==typeof window)}function o(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return null}return t}function i(t){t=o(t);var e=null;return t.d&&t.d.results&&null!=t.d.results.length?e=t.d.results:t.d&&(e=t.d),e||t}function a(t,e){p().then(function(){var n={title:" "},r=s({},n,e,{url:t});return SP.UI.ModalDialog.showModalDialog(r)})}Object.defineProperty(e,"__esModule",{value:!0});var u=n(22),c=n(25),h=n(26),l=n(27),f=function(t){if(t&&t instanceof File)return new Promise(function(e,n){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.readAsArrayBuffer(t)});throw"SPScript.utils.getArrayBuffer: Cant get ArrayBuffer if you don't pass in a file"},p=function(){return l.validateNamespace("SP.UI.ModalDialog")?Promise.resolve(!0):h.loadScript("/_layouts/15/1033/sp.res.js").then(function(){return h.loadScript("/_layouts/15/sp.ui.dialog.js")})},d={isBrowser:r,headers:c.default,parseJSON:o,validateODataV2:i,qs:{toObj:u.toObj,fromObj:u.fromObj},loadScript:h.loadScript,loadScripts:h.loadScripts,loadCSS:h.loadCSS,getArrayBuffer:f,waitForLibraries:l.waitForLibraries,waitForLibrary:l.waitForLibrary,validateNamespace:l.validateNamespace,waitForElement:l.waitForElement,openModal:a};e.default=d},,function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==("undefined"==typeof window?"undefined":a(window))&&(n=window)}t.exports=n},,,function(t,e,n){e.decode=e.parse=n(23),e.encode=e.stringify=n(24)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},,function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o={method:"GET",credentials:"include",redirect:"follow"},i=function(t,e){var n=s({},o,e);return fetch(t,n).then(function(t){return t.ok,t.ok?t.text().then(function(t){return r.default.parseJSON(t)||t}):t.text().then(function(t){throw new Error(t)})})};e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(30),i=function(){function t(t,e){this.baseUrl=t,this._dao=e}return t.prototype.getRoleAssignments=function(){var t=this.baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(t).then(r.default.validateODataV2).then(function(t){return t.map(s)})},t.prototype.checkPrivs=function(t){var e=encodeURIComponent(t.LoginName),n=this.baseUrl+"/getusereffectivepermissions(@v)?@v='"+e+"'";return this._dao.get(n).then(r.default.validateODataV2)},t.prototype.check=function(t){var e=this;return t||r.default.isBrowser()?(t?this._dao.web.getUser(t):this._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(t){return t.d})).then(function(t){return e.checkPrivs(t)}).then(function(t){return a(t.GetUserEffectivePermissions.Low,t.GetUserEffectivePermissions.High)}):Promise.reject("Can't check permissions. No email passed and no current user")},t}();e.default=i;var s=function(t){return{member:{login:t.Member.LoginName,name:t.Member.Title,id:t.Member.Id},roles:t.RoleDefinitionBindings.results.map(function(t){return{name:t.Name,description:t.Description,basePermissions:a(t.BasePermissions.Low,t.BasePermissions.High)}})}},a=function(t,e){var n=[];return o.basePermissions.forEach(function(r){((r.low&t)>0||(r.high&e)>0)&&n.push(r.name)}),n}},,,,,,function(t,e,n){n(16),n(20);var r=n(21);t.exports=r.default},function(t,e,n){t.exports=n(17).polyfill()},function(t,e,n){(function(e,n){/*!
      * @overview es6-promise - a tiny implementation of Promises/A+.
      * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
      * @license   Licensed under MIT license
      *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
      * @version   4.1.1
      */
!function(e,r){t.exports=function(){function t(t){var e=void 0===t?"undefined":a(t);return null!==t&&("object"===e||"function"===e)}function o(t){return"function"==typeof t}function i(t){G=t}function s(t){J=t}function u(){return void 0!==z?function(){z(h)}:c()}function c(){var t=setTimeout;return function(){return t(h,1)}}function h(){for(var t=0;t<H;t+=2)(0,Z[t])(Z[t+1]),Z[t]=void 0,Z[t+1]=void 0;H=0}function l(t,e){var n=arguments,r=this,o=new this.constructor(p);void 0===o[et]&&k(o);var i=r._state;return i?function(){var t=n[i-1];J(function(){return T(i,o,t,r._result)})}():j(r,o,t,e),o}function f(t){var e=this;if(t&&"object"==(void 0===t?"undefined":a(t))&&t.constructor===e)return t;var n=new e(p);return S(n,t),n}function p(){}function d(){return new TypeError("You cannot resolve a promise with itself")}function m(){return new TypeError("A promises callback cannot return that same promise.")}function v(t){try{return t.then}catch(t){return it.error=t,it}}function y(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function g(t,e,n){J(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?S(t,n):A(t,n))},function(e){r||(r=!0,_(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,_(t,o))},t)}function b(t,e){e._state===rt?A(t,e._result):e._state===ot?_(t,e._result):j(e,void 0,function(e){return S(t,e)},function(e){return _(t,e)})}function w(t,e,n){e.constructor===t.constructor&&n===l&&e.constructor.resolve===f?b(t,e):n===it?(_(t,it.error),it.error=null):void 0===n?A(t,e):o(n)?g(t,e,n):A(t,e)}function S(e,n){e===n?_(e,d()):t(n)?w(e,n,v(n)):A(e,n)}function x(t){t._onerror&&t._onerror(t._result),P(t)}function A(t,e){t._state===nt&&(t._result=e,t._state=rt,0!==t._subscribers.length&&J(P,t))}function _(t,e){t._state===nt&&(t._state=ot,t._result=e,J(x,t))}function j(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+rt]=n,o[i+ot]=r,0===i&&t._state&&J(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?T(n,r,o,i):o(i);t._subscribers.length=0}}function E(){this.error=null}function O(t,e){try{return t(e)}catch(t){return st.error=t,st}}function T(t,e,n,r){var i=o(n),s=void 0,a=void 0,u=void 0,c=void 0;if(i){if(s=O(n,r),s===st?(c=!0,a=s.error,s.error=null):u=!0,e===s)return void _(e,m())}else s=r,u=!0;e._state!==nt||(i&&u?S(e,s):c?_(e,a):t===rt?A(e,s):t===ot&&_(e,s))}function q(t,e){try{e(function(e){S(t,e)},function(e){_(t,e)})}catch(e){_(t,e)}}function R(){return at++}function k(t){t[et]=at++,t._state=void 0,t._result=void 0,t._subscribers=[]}function I(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[et]||k(this.promise),Y(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&A(this.promise,this._result))):_(this.promise,C())}function C(){return new Error("Array Methods must be provided an Array")}function N(t){return new I(this,t).promise}function M(t){var e=this;return new e(Y(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function U(t){var e=this,n=new e(p);return _(n,t),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function L(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function B(t){this[et]=R(),this._result=this._state=void 0,this._subscribers=[],p!==t&&("function"!=typeof t&&D(),this instanceof B?q(this,t):L())}function F(){var t=void 0;if(void 0!==n)t=n;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=B}var V=void 0;V=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var Y=V,H=0,z=void 0,G=void 0,J=function(t,e){Z[H]=t,Z[H+1]=e,2===(H+=2)&&(G?G(h):tt())},X="undefined"!=typeof window?window:void 0,W=X||{},$=W.MutationObserver||W.WebKitMutationObserver,Q="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),K="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3),tt=void 0;tt=Q?function(){return function(){return e.nextTick(h)}}():$?function(){var t=0,e=new $(h),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():K?function(){var t=new MessageChannel;return t.port1.onmessage=h,function(){return t.port2.postMessage(0)}}():void 0===X?function(){try{var t=r(19);return z=t.runOnLoop||t.runOnContext,u()}catch(t){return c()}}():c();var et=Math.random().toString(36).substring(16),nt=void 0,rt=1,ot=2,it=new E,st=new E,at=0;return I.prototype._enumerate=function(t){for(var e=0;this._state===nt&&e<t.length;e++)this._eachEntry(t[e],e)},I.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===f){var o=v(t);if(o===l&&t._state!==nt)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===B){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},I.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===nt&&(this._remaining--,t===ot?_(r,n):this._result[e]=n),0===this._remaining&&A(r,this._result)},I.prototype._willSettleAt=function(t,e){var n=this;j(t,void 0,function(t){return n._settledAt(rt,e,t)},function(t){return n._settledAt(ot,e,t)})},B.all=N,B.race=M,B.resolve=f,B.reject=U,B._setScheduler=i,B._setAsap=s,B._asap=J,B.prototype={constructor:B,then:l,catch:function(t){return this.then(null,t)}},B.polyfill=F,B.Promise=B,B}()}()}).call(e,n(18),n(2))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(h===setTimeout)return setTimeout(t,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){m&&p&&(m=!1,p.length?d=p.concat(d):v=-1,d.length&&a())}function a(){if(!m){var t=o(s);m=!0;for(var e=d.length;e;){for(p=d,d=[];++v<e;)p&&p[v].run();v=-1,e=d.length}p=null,m=!1,i(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var h,l,f=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(t){h=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var p,d=[],m=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new u(t,e)),1!==d.length||m||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e){},function(e,n){e.exports=t},function(t,e,n){(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(28),i=n(41),s={utils:r.default,CSR:i.default,createContext:function(e,n){try{return!e&&t._spPageContextInfo&&(e=t._spPageContextInfo.webAbsoluteUrl),new o.default(e,n)}catch(t){throw new Error("Unable to create SPScript Context: "+t.message)}}};e.default=s}).call(e,n(2))},function(t,e,n){function r(t,e){var n=function(n){var r=(t[n]+"").trim();return(r.indexOf(" ")>-1||e)&&(r="'"+r+"'"),n+"="+r};return Object.keys(t).map(n).join("&")}function o(t){return void 0===t&&window&&window.location&&window.location.search&&(t=window.location.search),t?("?"===t[0]&&(t=t.substr(1)),i.parse(t)):{}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(5);e.fromObj=r,e.toObj=o},function(t,e,n){function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,i){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var h=0;h<c;++h){var l,f,p,d,m=t[h].replace(a,"%20"),v=m.indexOf(n);v>=0?(l=m.substr(0,v),f=m.substr(v+1)):(l=m,f=""),p=decodeURIComponent(l),d=decodeURIComponent(f),r(s,p)?o(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var o=function(t){switch(void 0===t?"undefined":a(t)){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,u){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==(void 0===t?"undefined":a(t))?r(s(t),function(s){var a=encodeURIComponent(o(s))+n;return i(t[s])?r(t[s],function(t){return a+encodeURIComponent(o(t))}).join(e):a+encodeURIComponent(o(t[s]))}).join(e):u?encodeURIComponent(o(u))+n+encodeURIComponent(o(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){function r(t){var e={Accept:o,"Content-Type":o};return t&&(e["X-RequestDigest"]=t),e}Object.defineProperty(e,"__esModule",{value:!0});var o="application/json;odata=verbose",i=r,a=function(t){return{Accept:o,"X-RequestDigest":t,"Content-Type":"application/octet-stream",binaryStringRequestBody:"true"}},u=function(t,e){return s({},r(e),{"X-HTTP-Method":t})},c=function(t,e){return e&&(t["If-Match"]=e),t},h=function(t,e){return c(u("MERGE",t),e)},l=function(t,e){return c(u("DELETE",t),e)},f={getStandardHeaders:r,getAddHeaders:i,getFilestreamHeaders:a,getUpdateHeaders:h,getDeleteHeaders:l,getActionHeaders:u};e.default=f},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.loadCSS=function(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t),document.querySelector("head").appendChild(e)},e.loadScript=function(t){return new Promise(function(e,n){var r=window.document.createElement("script"),o=document.getElementsByTagName("script")[0];r.async=!0,o.parentNode.insertBefore(r,o),r.onload=r.onreadystatechange=function(t,n){(n||!r.readyState||/loaded|complete/.test(r.readyState))&&(r.onload=r.onreadystatechange=null,r=void 0,n||e())},r.src=t})},e.loadScripts=function(t){return Promise.all(t.map(e.loadScript))}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.validateNamespace=function(t){for(var e=window,n=t.split("."),r=n.length,o=0;o<r;o++){var i=n[o];if(!(i in e))return!1;e=e[i]}return!0};var r=function t(n,r){0===n.filter(function(t){return!e.validateNamespace(t)}).length?r():setTimeout(function(){return t(n,r)},25)};e.waitForLibraries=function(t){return new Promise(function(e,n){return r(t,e)})},e.waitForLibrary=function(t){return e.waitForLibraries([t])},e.waitForElement=function(t,e){void 0===e&&(e=5e3);var n=0,r=e/25;return new Promise(function(e,o){!function i(){n>r&&o("Unable to find element: "+t);var s=document.querySelector(t);s?e(s):(n++,setTimeout(i,25))}()})}},function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),a=n(0),u=n(29),c=n(31),h=n(32),l=n(34),f=n(36),p=n(37),d=function(){function t(t,e){void 0===e&&(e={});var n=this;this.webUrl=t,this.clientId=e.clientId,this.clientSecret=e.clientSecret,this.ensureToken=e.clientId?p.getAppOnlyToken(t,e.clientId,e.clientSecret).then(function(t){return n.accessToken=t}):Promise.resolve(!0),this.search=new h.default(this),this.customActions=new l.default(this),this.web=new c.default(this),this.profiles=new f.default(this)}return t.prototype.executeRequest=function(t,e){return r(this,void 0,void 0,function(){var n,r,a;return o(this,function(o){switch(o.label){case 0:return[4,this.ensureToken];case 1:return o.sent(),n=/^http/i.test(t)?t:this.webUrl+"/_api"+t,r={method:"GET",headers:{Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}},a=s({},r,e),this.accessToken&&(a.headers.Authorization="Bearer "+this.accessToken),[2,i.default(n,a)]}})})},t.prototype.get=function(t,e){var n=s({},{method:"GET"},e);return this.executeRequest(t,n).then(a.default.parseJSON)},t.prototype.post=function(t,e,n){e=this._packagePostBody(e,n);var r={method:"POST",body:e};return r=s({},r,n),this.executeRequest(t,r).then(a.default.parseJSON)},t.prototype.authorizedPost=function(t,e,n){var r=this;return this.getRequestDigest().then(function(t){return a.default.headers.getActionHeaders(n,t)}).then(function(n){return r.post(t,e,{headers:n})})},t.prototype._ensureRequestDigest=function(t){return t?Promise.resolve(t):this.getRequestDigest()},t.prototype.getRequestDigest=function(){return this.post("/contextInfo",{}).then(function(t){return t.d.GetContextWebInformation.FormDigestValue})},t.prototype.lists=function(t){return new u.default(t,this)},t.prototype._packagePostBody=function(t,e){return"string"==typeof t?t:e&&e.headers&&e.headers["Content-Type"]&&-1===e.headers["Content-Type"].indexOf("json")?t:JSON.stringify(t)},t}();e.default=d},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(9),i=function(){function t(t,e){this.listName=t,this.baseUrl="/web/lists/getbytitle('"+this.listName+"')",this._dao=e,this.permissions=new o.default(this.baseUrl,e)}return t.prototype.getItems=function(t){return this._dao.get(this.baseUrl+"/items"+a(t)).then(r.default.validateODataV2)},t.prototype.getItemById=function(t,e){var n=this.baseUrl+"/items("+t+")"+a(e);return this._dao.get(n).then(r.default.validateODataV2)},t.prototype.getItemsByView=function(t){var e=this,n=this.baseUrl+"/Views/getByTitle('"+t+"')/ViewQuery";return this._dao.get(n).then(r.default.validateODataV2).then(function(t){var n=e.baseUrl+"/GetItems",r={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:t.ViewQuery}};return e._dao.authorizedPost(n,r)}).then(r.default.validateODataV2)},t.prototype.findItems=function(t,e,n){return n="$filter="+t+" eq "+("string"==typeof e?"'"+e+"'":e)+a(n,"&"),this.getItems(n)},t.prototype.findItem=function(t,e,n){return this.findItems(t,e,n).then(function(t){return t&&t.length&&t.length>0?t[0]:null})},t.prototype.getInfo=function(){return this._dao.get(this.baseUrl).then(r.default.validateODataV2)},t.prototype.addItem=function(t,e){var n=this;return this._dao._ensureRequestDigest(e).then(function(e){return n._dao.get(n.baseUrl).then(function(o){t=s({},{__metadata:{type:o.d.ListItemEntityTypeFullName}},t);var i={headers:r.default.headers.getAddHeaders(e)};return n._dao.post(n.baseUrl+"/items",t,i)}).then(r.default.validateODataV2)})},t.prototype.updateItem=function(t,e,n){var o=this;return this._dao._ensureRequestDigest(n).then(function(n){return o.getItemById(t).then(function(t){e=s({},{__metadata:{type:t.__metadata.type}},e);var i={headers:r.default.headers.getUpdateHeaders(n,t.__metadata.etag)};return o._dao.post(t.__metadata.uri,e,i)})})},t.prototype.deleteItem=function(t,e){var n=this;return this._dao._ensureRequestDigest(e).then(function(e){return n.getItemById(t).then(function(t){var o={headers:r.default.headers.getDeleteHeaders(e,t.__metadata.etag)};return n._dao.post(t.__metadata.uri,"",o)})})},t}();e.default=i;var a=function(t,e){return e=e||"?",t?e+t:""}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.basePermissions=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}]},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(9),i=function(){function t(t){this.baseUrl="/web",this._dao=t,this.permissions=new o.default(this.baseUrl,t)}return t.prototype.getInfo=function(){return this._dao.get(this.baseUrl).then(r.default.validateODataV2)},t.prototype.getSubsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(r.default.validateODataV2)},t.prototype.getUser=function(t){var e=t?this.baseUrl+"/SiteUsers/GetByEmail('"+t+"')":this.baseUrl+"/CurrentUser";return this._dao.get(e).then(r.default.validateODataV2)},t.prototype.ensureUser=function(t){return this._dao.post("/web/ensureUser('"+t+"')").then(r.default.validateODataV2)},t.prototype.getFile=function(t){var t="/web/getfilebyserverrelativeurl('"+t+"')";return this._dao.get(t).then(r.default.validateODataV2)},t.prototype._copyFile=function(t,e,n){var o="/web/getfilebyserverrelativeurl('"+t+"')/CopyTo",i={headers:r.default.headers.getAddHeaders(n)},s={strNewUrl:e,bOverWrite:!0};return this._dao.post(o,s,i)},t.prototype.copyFile=function(t,e,n){var r=this;return this._dao._ensureRequestDigest(n).then(function(n){return r._copyFile(t,e,n)})},t}();e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(33),i=function(){function t(t){this._dao=t}return Object.defineProperty(t.prototype,"defaultQueryOptions",{get:function(){return{sourceid:null,startrow:null,rowlimit:100,selectedproperties:null,refiners:null,refinementfilters:null,hiddencontstraints:null,sortlist:null}},enumerable:!0,configurable:!0}),t.prototype.query=function(t,e){void 0===e&&(e={});var n=r.default.qs.fromObj(e,!0),i="/search/query?querytext='"+t+"'&"+n;return this._dao.get(i).then(r.default.validateODataV2).then(function(t){if(t.query)return o.mapResponse(t.query);throw new Error("Invalid response back from search service")})},t.prototype.people=function(t,e){return void 0===e&&(e={}),e.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31",this.query(t,e)},t.prototype.sites=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===n&&(n={}),e=e?"Path:"+e+"*":"";var r=(t+" contentclass:STS_Web "+e).trim();return n.rowlimit=n.rowlimit||499,this.query(r,n)},t}();e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.mapResponse=function(t){return{elapsedTime:t.ElapsedTime,suggestion:t.SpellingSuggestion,resultsCount:t.PrimaryQueryResult.RelevantResults.RowCount,totalResults:t.PrimaryQueryResult.RelevantResults.TotalRows,totalResultsIncludingDuplicates:t.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,items:e.mapItems(t.PrimaryQueryResult.RelevantResults.Table.Rows.results),refiners:e.mapRefiners(t.PrimaryQueryResult.RefinementResults)}},e.mapRefiners=function(t){var e=[];return t&&t.Refiners&&t.Refiners.results&&(e=t.Refiners.results.map(function(t){return{RefinerName:t.Name,RefinerOptions:t.Entries.results}})),e},e.mapItems=function(t){for(var e=[],n=0;n<t.length;n++){for(var r=t[n],o={},i=0;i<r.Cells.results.length;i++)o[r.Cells.results[i].Key]=r.Cells.results[i].Value;e.push(o)}return e}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(35),i=function(){function t(t){this._dao=t}return t.prototype.getScope=function(t){if(3===t)return o.scopes.Web;if(2===t)return o.scopes.Site;throw new Error("Invalid Custom Action Scope")},t.prototype.get=function(t){var e=this;return this._dao.get(o.scopes.Site.url).then(r.default.validateODataV2).then(function(t){return e._dao.get(o.scopes.Web.url).then(r.default.validateODataV2).then(function(e){return t.concat(e)})}).then(function(e){if(t){var n=e.filter(function(e){return e.Name===t});if(n.length)return n[0];throw new Error("Unable to find Custom Action with name: "+t)}return e})},t.prototype._getUrl=function(t){var e=this;return this.get(t).then(function(t){return e.getScope(t.Scope).url+"('"+t.Id+"')"})},t.prototype._getUrlAndDigest=function(t){var e=this,n={};return this._getUrl(t).then(function(t){return n.url=t,e._dao.getRequestDigest()}).then(function(t){return n.digest=t,n})},t.prototype.update=function(t){var e=this;if(!t||!t.Name)throw new Error("You must at least pass a Custom Action 'Name'");return this._getUrlAndDigest(t.Name).then(function(n){t=s({},o.metadata,t);var i={headers:r.default.headers.getUpdateHeaders(n.digest)};return e._dao.post(n.url,t,i)})},t.prototype.remove=function(t){var e=this;if(!t)throw new Error("You must at least pass an existing Custom Action name");return this._getUrlAndDigest(t).then(function(t){var n={headers:r.default.headers.getDeleteHeaders(t.digest)};return e._dao.post(t.url,{},n)})},t.prototype.add=function(t){var e=this;if(!t||!t.Name)throw new Error("You must at least pass a Custom Action 'Name'");var n={Name:t.Name,Title:t.Name,Description:t.Name,Group:t.Name,Sequence:100,Scope:"Site",Location:"ScriptLink"};return t=s({},n,t),this.get().then(function(n){return!n.filter(function(e){return e.Name===t.Name}).length||e.remove(t.Name)}).then(function(){return e._dao.getRequestDigest()}).then(function(n){t=s({},o.metadata,t);var i=o.scopes[t.Scope];t.Scope=i.id;var a={headers:r.default.headers.getAddHeaders(n)};return e._dao.post(i.url,t,a)})},t.prototype.addScriptBlock=function(t,e,n){void 0===n&&(n={});var r={Name:t,ScriptBlock:e};return r=s({},r,n),this.add(r)},t.prototype.addCSSLink=function(t,e,n){void 0===n&&(n={});var r='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar styleTag = document.createElement("style");\n\t\t\tstyleTag.appendChild(document.createTextNode("body { opacity: 0 }"));\n\t\t\t\n\t\t\tvar linkTag = document.createElement("link");\n\t\t\tlinkTag.rel = "stylesheet";\tlinkTag.href = "'+e+'"; linkTag.type = "text/css";\n\t\t\tlinkTag.addEventListener("load", function() {\n\t\t\t\thead.removeChild(styleTag);\n\t\t\t});\n\n\t\t\thead.appendChild(styleTag);\n\t\t\thead.appendChild(linkTag);\n\t\t})();';return this.addScriptBlock(t,r,n)},t.prototype.addScriptLink=function(t,e,n){void 0===n&&(n={});var r='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar scriptTag = document.createElement("script");\n            scriptTag.src = "'+e+'";\n            scriptTag.type = "text/javascript";\n\t\t\thead.appendChild(scriptTag);\n\t\t})();';return this.addScriptBlock(t,r,n)},t}();e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.metadata={__metadata:{type:"SP.UserCustomAction"}},e.scopes={Web:{id:3,name:"Web",url:"/web/usercustomactions"},Site:{id:2,name:"Site",url:"/site/usercustomactions"}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(){function t(t){this._dao=t,this.baseUrl="/SP.UserProfiles.PeopleManager"}return t.prototype.current=function(){var t=this.baseUrl+"/GetMyProperties";return this._dao.get(t).then(r.default.validateODataV2).then(i)},t.prototype.get=function(t){var e=this;return t?this.getUserObj(t).then(function(t){var n=encodeURIComponent(t.LoginName||t.AccountName),o=e.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+n+"'";return e._dao.get(o).then(r.default.validateODataV2).then(i)}):this.current()},t.prototype.getUserObj=function(t){if(t&&"string"!=typeof t){if(t.AccountName||t.LoginName)return Promise.resolve(t);throw new Error("profiles.setProperty Error: Invalid user parameter")}return this._dao.web.getUser(t)},t.prototype.setProperty=function(t,e,n){var r=this;return this.getUserObj(n).then(function(n){var o={propertyName:t,propertyValue:e,accountName:n.LoginName||n.AccountName},i=r.baseUrl+"/SetSingleValueProfileProperty";return r._dao.authorizedPost(i,o)})},t}();e.default=o;var i=function(t){return t.UserProfileProperties.results.forEach(function(e){t[e.Key]=e.Value}),t}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(38),o=n(5),i=n(8);e.getAppOnlyToken=function(t,e,n){var a=r.parse(t);return s(t).then(function(t){var r="https://accounts.accesscontrol.windows.net/"+t.realm+"/tokens/OAuth/2",s=e+"@"+t.realm,u=t.client_id+"/"+a.host+"@"+t.realm,c={grant_type:"client_credentials",client_id:s,client_secret:n,resource:u,scope:u},h=o.stringify(c),l={method:"POST",body:h,headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":h.length}};return i.default(r,l).then(function(t){return t.access_token})})};var s=function(t){var e=t+"/_api/web",n={method:"GET",headers:{Authorization:"Bearer ",Accept:"application/json;odata=verbose",response_type:"code"}};return new Promise(function(t,r){fetch(e,n).then(function(e){if(!e.ok){var n=a(e.headers["www-authenticate"]||e.headers._headers["www-authenticate"][0]);t(n)}r("Get Realm succeeded somehow?!")})})},a=function(t){return t&&t.startsWith("Bearer")?(t=t.substr(7),t.split(",").filter(function(t){return t.indexOf("=")>-1}).reduce(function(t,e){var n=e.split("=");return 2===n.length&&(t[n[0].trim()]=n[1].trim().replace(/\"/g,"")),t},{})):null}},function(t,e,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,n){if(t&&h.isObject(t)&&t instanceof r)return t;var o=new r;return o.parse(t,e,n),o}function i(t){return h.isString(t)&&(t=o(t)),t instanceof r?t.format():r.prototype.format.call(t)}function s(t,e){return o(t,!1,!0).resolve(e)}function u(t,e){return t?o(t,!1,!0).resolveObject(e):e}var c=n(39),h=n(40);e.parse=o,e.resolve=s,e.resolveObject=u,e.format=i,e.Url=r;var l=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,d=["<",">",'"',"`"," ","\r","\n","\t"],m=["{","}","|","\\","^","`"].concat(d),v=["'"].concat(m),y=["%","/","?",";","#"].concat(v),g=["/","?","#"],b=/^[+a-z0-9A-Z_-]{0,63}$/,w=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,S={javascript:!0,"javascript:":!0},x={javascript:!0,"javascript:":!0},A={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=n(5);r.prototype.parse=function(t,e,n){if(!h.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+(void 0===t?"undefined":a(t)));var r=t.indexOf("?"),o=-1!==r&&r<t.indexOf("#")?"?":"#",i=t.split(o),s=/\\/g;i[0]=i[0].replace(s,"/"),t=i.join(o);var u=t;if(u=u.trim(),!n&&1===t.split("#").length){var f=p.exec(u);if(f)return this.path=u,this.href=u,this.pathname=f[1],f[2]?(this.search=f[2],this.query=e?_.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var d=l.exec(u);if(d){d=d[0];var m=d.toLowerCase();this.protocol=m,u=u.substr(d.length)}if(n||d||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var j="//"===u.substr(0,2);!j||d&&x[d]||(u=u.substr(2),this.slashes=!0)}if(!x[d]&&(j||d&&!A[d])){for(var P=-1,E=0;E<g.length;E++){var O=u.indexOf(g[E]);-1!==O&&(-1===P||O<P)&&(P=O)}var T,q;q=-1===P?u.lastIndexOf("@"):u.lastIndexOf("@",P),-1!==q&&(T=u.slice(0,q),u=u.slice(q+1),this.auth=decodeURIComponent(T)),P=-1;for(var E=0;E<y.length;E++){var O=u.indexOf(y[E]);-1!==O&&(-1===P||O<P)&&(P=O)}-1===P&&(P=u.length),this.host=u.slice(0,P),u=u.slice(P),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var k=this.hostname.split(/\./),E=0,I=k.length;E<I;E++){var C=k[E];if(C&&!C.match(b)){for(var N="",M=0,U=C.length;M<U;M++)C.charCodeAt(M)>127?N+="x":N+=C[M];if(!N.match(b)){var D=k.slice(0,E),L=k.slice(E+1),B=C.match(w);B&&(D.push(B[1]),L.unshift(B[2])),L.length&&(u="/"+L.join(".")+u),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=c.toASCII(this.hostname));var F=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+F,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!S[m])for(var E=0,I=v.length;E<I;E++){var Y=v[E];if(-1!==u.indexOf(Y)){var H=encodeURIComponent(Y);H===Y&&(H=escape(Y)),u=u.split(Y).join(H)}}var z=u.indexOf("#");-1!==z&&(this.hash=u.substr(z),u=u.slice(0,z));var G=u.indexOf("?");if(-1!==G?(this.search=u.substr(G),this.query=u.substr(G+1),e&&(this.query=_.parse(this.query)),u=u.slice(0,G)):e&&(this.search="",this.query={}),u&&(this.pathname=u),A[m]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",J=this.search||"";this.path=F+J}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&h.isObject(this.query)&&Object.keys(this.query).length&&(i=_.stringify(this.query));var s=this.search||i&&"?"+i||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||A[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+o+n+s+r},r.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(h.isString(t)){var e=new r;e.parse(t,!1,!0),t=e}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var s=o[i];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),u=0;u<a.length;u++){var c=a[u];"protocol"!==c&&(n[c]=t[c])}return A[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!A[t.protocol]){for(var l=Object.keys(t),f=0;f<l.length;f++){var p=l[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||x[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var m=n.pathname||"",v=n.search||"";n.path=m+v}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=g||y||n.host&&t.pathname,w=b,S=n.pathname&&n.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],_=n.protocol&&!A[n.protocol];if(_&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),b=b&&(""===d[0]||""===S[0])),g)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,S=d;else if(d.length)S||(S=[]),S.pop(),S=S.concat(d),n.search=t.search,n.query=t.query;else if(!h.isNullOrUndefined(t.search)){if(_){n.hostname=n.host=S.shift();var j=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");j&&(n.auth=j.shift(),n.host=n.hostname=j.shift())}return n.search=t.search,n.query=t.query,h.isNull(n.pathname)&&h.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var P=S.slice(-1)[0],E=(n.host||t.host||S.length>1)&&("."===P||".."===P)||""===P,O=0,T=S.length;T>=0;T--)P=S[T],"."===P?S.splice(T,1):".."===P?(S.splice(T,1),O++):O&&(S.splice(T,1),O--);if(!b&&!w)for(;O--;O)S.unshift("..");!b||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),E&&"/"!==S.join("/").substr(-1)&&S.push("");var q=""===S[0]||S[0]&&"/"===S[0].charAt(0);if(_){n.hostname=n.host=q?"":S.length?S.shift():"";var j=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");j&&(n.auth=j.shift(),n.host=n.hostname=j.shift())}return b=b||n.host&&S.length,b&&!q&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),h.isNull(n.pathname)&&h.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=f.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){(function(t,r){var o;!function(i){function s(t){throw new RangeError(k[t])}function u(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function c(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(R,"."),r+u(t.split("."),e).join(".")}function h(t){for(var e,n,r=[],o=0,i=t.length;o<i;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<i?(n=t.charCodeAt(o++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--)):r.push(e);return r}function l(t){return u(t,function(t){var e="";return t>65535&&(t-=65536,e+=N(t>>>10&1023|55296),t=56320|1023&t),e+=N(t)}).join("")}function f(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:S}function p(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function d(t,e,n){var r=0;for(t=n?C(t/j):t>>1,t+=C(t/e);t>I*A>>1;r+=S)t=C(t/I);return C(r+(I+1)*t/(t+_))}function m(t){var e,n,r,o,i,a,u,c,h,p,m=[],v=t.length,y=0,g=E,b=P;for(n=t.lastIndexOf(O),n<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&s("not-basic"),m.push(t.charCodeAt(r));for(o=n>0?n+1:0;o<v;){for(i=y,a=1,u=S;o>=v&&s("invalid-input"),c=f(t.charCodeAt(o++)),(c>=S||c>C((w-y)/a))&&s("overflow"),y+=c*a,h=u<=b?x:u>=b+A?A:u-b,!(c<h);u+=S)p=S-h,a>C(w/p)&&s("overflow"),a*=p;e=m.length+1,b=d(y-i,e,0==i),C(y/e)>w-g&&s("overflow"),g+=C(y/e),y%=e,m.splice(y++,0,g)}return l(m)}function v(t){var e,n,r,o,i,a,u,c,l,f,m,v,y,g,b,_=[];for(t=h(t),v=t.length,e=E,n=0,i=P,a=0;a<v;++a)(m=t[a])<128&&_.push(N(m));for(r=o=_.length,o&&_.push(O);r<v;){for(u=w,a=0;a<v;++a)(m=t[a])>=e&&m<u&&(u=m);for(y=r+1,u-e>C((w-n)/y)&&s("overflow"),n+=(u-e)*y,e=u,a=0;a<v;++a)if(m=t[a],m<e&&++n>w&&s("overflow"),m==e){for(c=n,l=S;f=l<=i?x:l>=i+A?A:l-i,!(c<f);l+=S)b=c-f,g=S-f,_.push(N(p(f+b%g,0))),c=C(b/g);_.push(N(p(c,0))),i=d(n,y,r==o),n=0,++r}++n,++e}return _.join("")}function y(t){return c(t,function(t){return T.test(t)?m(t.slice(4).toLowerCase()):t})}function g(t){return c(t,function(t){return q.test(t)?"xn--"+v(t):t})}var b,w=("object"==(void 0===e?"undefined":a(e))&&e&&e.nodeType,"object"==(void 0===t?"undefined":a(t))&&t&&t.nodeType,void 0===r||a(r),2147483647),S=36,x=1,A=26,_=38,j=700,P=72,E=128,O="-",T=/^xn--/,q=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=S-x,C=Math.floor,N=String.fromCharCode;b={version:"1.4.1",ucs2:{decode:h,encode:l},decode:m,encode:v,toASCII:g,toUnicode:y},void 0!==(o=function(){return b}.call(e,n,e,t))&&(t.exports=o)}()}).call(e,n(6)(t),n(2))},function(t,e,n){t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==(void 0===t?"undefined":a(t))&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){function r(t){return function(e){var n=e.FormContext,r=s({},e);return t.onReady&&(n?n.registerInitCallback(t.name,t.onReady.bind(null,r)):setTimeout(t.onReady.bind(null,r),100)),t.getValue&&n&&n.registerGetValueCallback(t.name,t.getValue.bind(null,r)),n&&n.updateControlValue&&(t.setValue=function(e){n.updateControlValue(t.name,e)}),t.render(e)}}function o(t){return function(e){var n=e.FormContext;return n&&n.registerInitCallback&&t.onReady&&n.registerInitCallback(t.name,t.onReady),t.render(e)}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=function(t,e,n){if(void 0===n&&(n={}),!i.default.validateNamespace("SPClientTemplates.TemplateManager"))throw new Error("Unable to register CSR template.  SPClientTemplates.TemplateManager does not exist");var r={};t.locations.forEach(function(t){return r[t]=e});var o={Templates:{Fields:{}}},a=s({},o,n);return a.Templates.Fields[t.name]=r,SPClientTemplates.TemplateManager.RegisterTemplateOverrides(a),t},u=function(t,e){void 0===e&&(e={});var n=o(t);return t.locations=t.locations||["View","DisplayForm"],a(t,n,e)},c=function(t,e){void 0===e&&(e={});var n=r(t);return t.locations=t.locations||["NewForm","EditForm"],a(t,n,e)},h={registerDisplayField:u,registerFormField:c};e.default=h}])})}).call(e,n(7)(t))},function(t,e,n){"use strict";e.run=function(t,e){var r=!!e;n(1).should();describe("SPScript Global Namespace",function(){it("Should have a 'SPScript.createContext()' method",function(){t.should.have.property("createContext"),t.createContext.should.be.a("function")}),it("Should have a 'SPScript.utils' namespace",function(){t.should.not.be.null,t.should.have.property("utils")})}),r||(n(73).run(t),e=t.createContext()),n(74).run(e),n(75).run(e),n(76).run(e),r||(n(77).run(e),n(78).run(e)),n(79).run(t.utils)}},function(t,e,n){/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=[],e=t.exports={};/*!
 * Chai version
 */
e.version="1.10.0",/*!
 * Assertion Error
 */
e.AssertionError=n(46);/*!
 * Utils for plugins (not exported)
 */
var o=n(47);e.use=function(t){return~r.indexOf(t)||(t(this,o),r.push(t)),this};/*!
 * Configuration
 */
var i=n(4);e.config=i;/*!
 * Primary `Assertion` prototype
 */
var s=n(68);e.use(s);/*!
 * Core Assertions
 */
var a=n(69);e.use(a);/*!
 * Expect interface
 */
var u=n(70);e.use(u);/*!
 * Should interface
 */
var c=n(71);e.use(c);/*!
 * Assert interface
 */
var h=n(72);e.use(h)},function(t,e){/*!
 * assertion-error
 * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>
 * MIT Licensed
 */
/*!
 * Return a function that will copy properties from
 * one object to another excluding any originally
 * listed. Returned function will create a new `{}`.
 *
 * @param {String} excluded properties ...
 * @return {Function}
 */
function n(){function t(t,n){Object.keys(n).forEach(function(r){~e.indexOf(r)||(t[r]=n[r])})}var e=[].slice.call(arguments);return function(){for(var e=[].slice.call(arguments),n=0,r={};n<e.length;n++)t(r,e[n]);return r}}function r(t,e,r){var o=n("name","message","stack","constructor","toJSON"),i=o(e||{});this.message=t||"Unspecified AssertionError",this.showDiff=!1;for(var s in i)this[s]=i[s];(r=r||arguments.callee)&&Error.captureStackTrace&&Error.captureStackTrace(this,r)}/*!
 * Primary Exports
 */
t.exports=r,/*!
 * Inherit from Error.prototype
 */
r.prototype=Object.create(Error.prototype),/*!
 * Statically set name
 */
r.prototype.name="AssertionError",/*!
 * Ensure correct constructor
 */
r.prototype.constructor=r,r.prototype.toJSON=function(t){var e=n("constructor","toJSON","stack"),r=e({name:this.name},this);return!1!==t&&this.stack&&(r.stack=this.stack),r}},function(t,e,n){/*!
 * chai
 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Main exports
 */
var e=t.exports={};/*!
 * test utility
 */
e.test=n(48),/*!
 * type utility
 */
e.type=n(49),/*!
 * message utility
 */
e.getMessage=n(50),/*!
 * actual utility
 */
e.getActual=n(11),/*!
 * Inspect util
 */
e.inspect=n(8),/*!
 * Object Display util
 */
e.objDisplay=n(13),/*!
 * Flag utility
 */
e.flag=n(3),/*!
 * Flag transferring utility
 */
e.transferFlags=n(14),/*!
 * Deep equal utility
 */
e.eql=n(53),/*!
 * Deep path value
 */
e.getPathValue=n(61),/*!
 * Function name
 */
e.getName=n(12),/*!
 * add Property
 */
e.addProperty=n(62),/*!
 * add Method
 */
e.addMethod=n(63),/*!
 * overwrite Property
 */
e.overwriteProperty=n(64),/*!
 * overwrite Method
 */
e.overwriteMethod=n(65),/*!
 * Add a chainable method
 */
e.addChainableMethod=n(66),/*!
 * Overwrite chainable method
 */
e.overwriteChainableMethod=n(67)},function(t,e,n){/*!
 * Chai - test utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependancies
 */
var r=n(3);t.exports=function(t,e){var n=r(t,"negate"),o=e[0];return n?!o:o}},function(t,e){/*!
 * Chai - type utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Detectable javascript natives
 */
var n={"[object Arguments]":"arguments","[object Array]":"array","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string"};t.exports=function(t){var e=Object.prototype.toString.call(t);return n[e]?n[e]:null===t?"null":void 0===t?"undefined":t===Object(t)?"object":typeof t}},function(t,e,n){/*!
 * Chai - message composition utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependancies
 */
var r=n(3),o=n(11),i=(n(8),n(13));t.exports=function(t,e){var n=r(t,"negate"),s=r(t,"object"),a=e[3],u=o(t,e),c=n?e[2]:e[1],h=r(t,"message");return"function"==typeof c&&(c=c()),c=c||"",c=c.replace(/#{this}/g,i(s)).replace(/#{act}/g,i(u)).replace(/#{exp}/g,i(a)),h?h+": "+c:c}},function(t,e){/*!
 * Chai - getProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t){function e(t){-1===n.indexOf(t)&&n.push(t)}for(var n=Object.getOwnPropertyNames(subject),r=Object.getPrototypeOf(subject);null!==r;)Object.getOwnPropertyNames(r).forEach(e),r=Object.getPrototypeOf(r);return n}},function(t,e){/*!
 * Chai - getEnumerableProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t){var e=[];for(var n in t)e.push(n);return e}},function(t,e,n){t.exports=n(54)},function(t,e,n){function r(t,e,n){return!!o(t,e)||("date"===m(t)?s(t,e):"regexp"===m(t)?a(t,e):d.isBuffer(t)?l(t,e):"arguments"===m(t)?u(t,e,n):!!i(t,e)&&("object"!==m(t)&&"object"!==m(e)&&"array"!==m(t)&&"array"!==m(e)?o(t,e):p(t,e,n)))}/*!
 * Strict (egal) equality test. Ensures that NaN always
 * equals NaN and `-0` does not equal `+0`.
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} equal match
 */
function o(t,e){return t===e?0!==t||1/t==1/e:t!==t&&e!==e}/*!
 * Compare the types of two given objects and
 * return if they are equal. Note that an Array
 * has a type of `array` (not `object`) and arguments
 * have a type of `arguments` (not `array`/`object`).
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} result
 */
function i(t,e){return m(t)===m(e)}/*!
 * Compare two Date objects by asserting that
 * the time values are equal using `saveValue`.
 *
 * @param {Date} a
 * @param {Date} b
 * @return {Boolean} result
 */
function s(t,e){return"date"===m(e)&&o(t.getTime(),e.getTime())}/*!
 * Compare two regular expressions by converting them
 * to string and checking for `sameValue`.
 *
 * @param {RegExp} a
 * @param {RegExp} b
 * @return {Boolean} result
 */
function a(t,e){return"regexp"===m(e)&&o(t.toString(),e.toString())}/*!
 * Assert deep equality of two `arguments` objects.
 * Unfortunately, these must be sliced to arrays
 * prior to test to ensure no bad behavior.
 *
 * @param {Arguments} a
 * @param {Arguments} b
 * @param {Array} memoize (optional)
 * @return {Boolean} result
 */
function u(t,e,n){return"arguments"===m(e)&&(t=[].slice.call(t),e=[].slice.call(e),r(t,e,n))}/*!
 * Get enumerable properties of a given object.
 *
 * @param {Object} a
 * @return {Array} property names
 */
function c(t){var e=[];for(var n in t)e.push(n);return e}/*!
 * Simple equality for flat iterable objects
 * such as Arrays or Node.js buffers.
 *
 * @param {Iterable} a
 * @param {Iterable} b
 * @return {Boolean} result
 */
function h(t,e){if(t.length!==e.length)return!1;for(var n=0,r=!0;n<t.length;n++)if(t[n]!==e[n]){r=!1;break}return r}/*!
 * Extension to `iterableEqual` specifically
 * for Node.js Buffers.
 *
 * @param {Buffer} a
 * @param {Mixed} b
 * @return {Boolean} result
 */
function l(t,e){return!!d.isBuffer(e)&&h(t,e)}/*!
 * Block for `objectEqual` ensuring non-existing
 * values don't get in.
 *
 * @param {Mixed} object
 * @return {Boolean} result
 */
function f(t){return null!==t&&void 0!==t}/*!
 * Recursively check the equality of two objects.
 * Once basic sameness has been established it will
 * defer to `deepEqual` for each enumerable key
 * in the object.
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} result
 */
function p(t,e,n){if(!f(t)||!f(e))return!1;if(t.prototype!==e.prototype)return!1;var o;if(n){for(o=0;o<n.length;o++)if(n[o][0]===t&&n[o][1]===e||n[o][0]===e&&n[o][1]===t)return!0}else n=[];try{var i=c(t),s=c(e)}catch(t){return!1}if(i.sort(),s.sort(),!h(i,s))return!1;n.push([t,e]);var a;for(o=i.length-1;o>=0;o--)if(a=i[o],!r(t[a],e[a],n))return!1;return!0}/*!
 * deep-eql
 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var d,m=n(55);try{d=n(57).Buffer}catch(t){d={},d.isBuffer=function(){return!1}}/*!
 * Primary Export
 */
t.exports=r},function(t,e,n){t.exports=n(56)},function(t,e){function n(t){var e=Object.prototype.toString.call(t);return o[e]?o[e]:null===t?"null":void 0===t?"undefined":t===Object(t)?"object":typeof t}function r(){this.tests={}}/*!
 * type-detect
 * Copyright(c) 2013 jake luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Primary Exports
 */
var e=t.exports=n,o={"[object Array]":"array","[object RegExp]":"regexp","[object Function]":"function","[object Arguments]":"arguments","[object Date]":"date"};e.Library=r,r.prototype.of=n,r.prototype.define=function(t,e){return 1===arguments.length?this.tests[t]:(this.tests[t]=e,this)},r.prototype.test=function(t,e){if(e===n(t))return!0;var r=this.tests[e];if(r&&"regexp"===n(r))return r.test(t);if(r&&"function"===n(r))return r(t);throw new ReferenceError('Type test "'+e+'" not defined or invalid.')}},function(t,e,n){"use strict";(function(t){function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=i.prototype):(null===t&&(t=new i(e)),t.length=e),t}function i(t,e,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,e,n)}function s(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?f(t,e,n,r):"string"==typeof e?h(t,e,n):p(t,e)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e,n,r){return a(e),e<=0?o(t,e):void 0!==n?"string"==typeof r?o(t,e).fill(n,r):o(t,e).fill(n):o(t,e)}function c(t,e){if(a(e),t=o(t,e<0?0:0|d(e)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|v(e,n);t=o(t,r);var s=t.write(e,n);return s!==r&&(t=t.slice(0,s)),t}function l(t,e){var n=e.length<0?0:0|d(e.length);t=o(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),i.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=i.prototype):t=l(t,e),t}function p(t,e){if(i.isBuffer(e)){var n=0|d(e.length);return t=o(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||W(e.length)?o(t,0):l(t,e);if("Buffer"===e.type&&K(e.data))return l(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function m(t){return+t!=t&&(t=0),i.alloc(+t)}function v(t,e){if(i.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(t).length;default:if(r)return H(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return q(this,e,n);case"latin1":case"binary":return R(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=i.from(e,r)),i.isBuffer(e))return 0===e.length?-1:w(t,e,n,r,o);if("number"==typeof e)return e&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):w(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function w(t,e,n,r,o){function i(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}var c;if(o){var h=-1;for(c=n;c<a;c++)if(i(t,c)===i(e,-1===h?0:c-h)){if(-1===h&&(h=c),c-h+1===u)return h*s}else-1!==h&&(c-=c-h),h=-1}else for(n+u>a&&(n=a-u),c=n;c>=0;c--){for(var l=!0,f=0;f<u;f++)if(i(t,c+f)!==i(e,f)){l=!1;break}if(l)return c}return-1}function S(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function x(t,e,n,r){return X(H(e,t.length-n),t,n,r)}function A(t,e,n,r){return X(z(e),t,n,r)}function _(t,e,n,r){return A(t,e,n,r)}function j(t,e,n,r){return X(J(e),t,n,r)}function P(t,e,n,r){return X(G(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?$.fromByteArray(t):$.fromByteArray(t.slice(e,n))}function O(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i=t[o],s=null,a=i>239?4:i>223?3:i>191?2:1;if(o+a<=n){var u,c,h,l;switch(a){case 1:i<128&&(s=i);break;case 2:u=t[o+1],128==(192&u)&&(l=(31&i)<<6|63&u)>127&&(s=l);break;case 3:u=t[o+1],c=t[o+2],128==(192&u)&&128==(192&c)&&(l=(15&i)<<12|(63&u)<<6|63&c)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:u=t[o+1],c=t[o+2],h=t[o+3],128==(192&u)&&128==(192&c)&&128==(192&h)&&(l=(15&i)<<18|(63&u)<<12|(63&c)<<6|63&h)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),o+=a}return T(r)}function T(t){var e=t.length;if(e<=Z)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=Z));return n}function q(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function R(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function k(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=Y(t[i]);return o}function I(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function C(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,n,r,o,s){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function M(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function U(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function D(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,r,o){return o||D(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(t,e,n,r,23,4),n+4}function B(t,e,n,r,o){return o||D(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(t,e,n,r,52,8),n+8}function F(t){if(t=V(t).replace(tt,""),t.length<2)return"";for(;t.length%4!=0;)t+="=";return t}function V(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Y(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){e=e||1/0;for(var n,r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function z(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function G(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function J(t){return $.toByteArray(F(t))}function X(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function W(t){return t!==t}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var $=n(58),Q=n(59),K=n(60);e.Buffer=i,e.SlowBuffer=m,e.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=r(),i.poolSize=8192,i._augment=function(t){return t.__proto__=i.prototype,t},i.from=function(t,e,n){return s(null,t,e,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(t,e,n){return u(null,t,e,n)},i.allocUnsafe=function(t){return c(null,t)},i.allocUnsafeSlow=function(t){return c(null,t)},i.isBuffer=function(t){return!(null==t||!t._isBuffer)},i.compare=function(t,e){if(!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,s=Math.min(n,r);o<s;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!K(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=i.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(!i.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},i.byteLength=v,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},i.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):y.apply(this,arguments)},i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},i.prototype.compare=function(t,e,n,r,o){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var s=o-r,a=n-e,u=Math.min(s,a),c=this.slice(r,o),h=t.slice(e,n),l=0;l<u;++l)if(c[l]!==h[l]){s=c[l],a=h[l];break}return s<a?-1:a<s?1:0},i.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},i.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},i.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},i.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return S(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return A(this,t,e,n);case"latin1":case"binary":return _(this,t,e,n);case"base64":return j(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;i.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r;if(i.TYPED_ARRAY_SUPPORT)r=this.subarray(t,e),r.__proto__=i.prototype;else{var o=e-t;r=new i(o,void 0);for(var s=0;s<o;++s)r[s]=this[s+t]}return r},i.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},i.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},i.prototype.readUInt8=function(t,e){return e||C(t,1,this.length),this[t]},i.prototype.readUInt16LE=function(t,e){return e||C(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUInt16BE=function(t,e){return e||C(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUInt32LE=function(t,e){return e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUInt32BE=function(t,e){return e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},i.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},i.prototype.readInt8=function(t,e){return e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){e||C(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(t,e){e||C(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(t,e){return e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return e||C(t,4,this.length),Q.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return e||C(t,4,this.length),Q.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return e||C(t,8,this.length),Q.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return e||C(t,8,this.length),Q.read(this,t,!1,52,8)},i.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){N(this,t,e,n,Math.pow(2,8*n)-1,0)}var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},i.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){N(this,t,e,n,Math.pow(2,8*n)-1,0)}var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},i.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,255,0),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},i.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},i.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},i.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):U(this,t,e,!0),e+4},i.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},i.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);N(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},i.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);N(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},i.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,127,-128),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},i.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},i.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):U(this,t,e,!0),e+4},i.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},i.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},i.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},i.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},i.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},i.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,s=r-n;if(this===t&&n<e&&e<r)for(o=s-1;o>=0;--o)t[o+e]=this[o+n];else if(s<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},i.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var s;if("number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var a=i.isBuffer(t)?t:H(new i(t,r).toString()),u=a.length;for(s=0;s<n-e;++s)this[s+e]=a[s%u]}return this};var tt=/[^+\/0-9A-Za-z-_]/g}).call(e,n(2))},function(t,e,n){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function o(t){return 3*t.length/4-r(t)}function i(t){var e,n,o,i,s,a=t.length;i=r(t),s=new l(3*a/4-i),n=i>0?a-4:a;var u=0;for(e=0;e<n;e+=4)o=h[t.charCodeAt(e)]<<18|h[t.charCodeAt(e+1)]<<12|h[t.charCodeAt(e+2)]<<6|h[t.charCodeAt(e+3)],s[u++]=o>>16&255,s[u++]=o>>8&255,s[u++]=255&o;return 2===i?(o=h[t.charCodeAt(e)]<<2|h[t.charCodeAt(e+1)]>>4,s[u++]=255&o):1===i&&(o=h[t.charCodeAt(e)]<<10|h[t.charCodeAt(e+1)]<<4|h[t.charCodeAt(e+2)]>>2,s[u++]=o>>8&255,s[u++]=255&o),s}function s(t){return c[t>>18&63]+c[t>>12&63]+c[t>>6&63]+c[63&t]}function a(t,e,n){for(var r,o=[],i=e;i<n;i+=3)r=(t[i]<<16)+(t[i+1]<<8)+t[i+2],o.push(s(r));return o.join("")}function u(t){for(var e,n=t.length,r=n%3,o="",i=[],s=0,u=n-r;s<u;s+=16383)i.push(a(t,s,s+16383>u?u:s+16383));return 1===r?(e=t[n-1],o+=c[e>>2],o+=c[e<<4&63],o+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],o+=c[e>>10],o+=c[e>>4&63],o+=c[e<<2&63],o+="="),i.push(o),i.join("")}e.byteLength=o,e.toByteArray=i,e.fromByteArray=u;for(var c=[],h=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,d=f.length;p<d;++p)c[p]=f[p],h[f.charCodeAt(p)]=p;h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,c=u>>1,h=-7,l=n?o-1:0,f=n?-1:1,p=t[e+l];for(l+=f,i=p&(1<<-h)-1,p>>=-h,h+=a;h>0;i=256*i+t[e+l],l+=f,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=r;h>0;s=256*s+t[e+l],l+=f,h-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=c}return(p?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var s,a,u,c=8*i-o-1,h=(1<<c)-1,l=h>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+l>=1?f/u:f*Math.pow(2,1-l),e*u>=2&&(s++,u/=2),s+l>=h?(a=0,s=h):s+l>=1?(a=(e*u-1)*Math.pow(2,o),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){/*!
 * ## parsePath(path)
 *
 * Helper function used to parse string object
 * paths. Use in conjunction with `_getPathValue`.
 *
 *      var parsed = parsePath('myobject.property.subprop');
 *
 * ### Paths:
 *
 * * Can be as near infinitely deep and nested
 * * Arrays are also valid using the formal `myobject.document[3].property`.
 *
 * @param {String} path
 * @returns {Object} parsed
 * @api private
 */
function n(t){return t.replace(/\[/g,".[").match(/(\\\.|[^.]+?)+/g).map(function(t){var e=/\[(\d+)\]$/,n=e.exec(t);return n?{i:parseFloat(n[1])}:{p:t}})}/*!
 * ## _getPathValue(parsed, obj)
 *
 * Helper companion function for `.parsePath` that returns
 * the value located at the parsed address.
 *
 *      var value = getPathValue(parsed, obj);
 *
 * @param {Object} parsed definition from `parsePath`.
 * @param {Object} object to search against
 * @returns {Object|Undefined} value
 * @api private
 */
function r(t,e){for(var n,r=e,o=0,i=t.length;o<i;o++){var s=t[o];r?(void 0!==s.p?r=r[s.p]:void 0!==s.i&&(r=r[s.i]),o==i-1&&(n=r)):n=void 0}return n}/*!
 * Chai - getPathValue utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * @see https://github.com/logicalparadox/filtr
 * MIT Licensed
 */
t.exports=function(t,e){return r(n(t),e)}},function(t,e){/*!
 * Chai - addProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e,n){Object.defineProperty(t,e,{get:function(){var t=n.call(this);return void 0===t?this:t},configurable:!0})}},function(t,e,n){/*!
 * Chai - addMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(4),o=n(3);t.exports=function(t,e,n){t[e]=function(){o(this,"ssfi")&&!1===r.includeStack&&o(this,"ssfi",t[e]);var i=n.apply(this,arguments);return void 0===i?this:i}}},function(t,e){/*!
 * Chai - overwriteProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e),o=function(){};r&&"function"==typeof r.get&&(o=r.get),Object.defineProperty(t,e,{get:function(){var t=n(o).call(this);return void 0===t?this:t},configurable:!0})}},function(t,e){/*!
 * Chai - overwriteMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e,n){var r=t[e],o=function(){return this};r&&"function"==typeof r&&(o=r),t[e]=function(){var t=n(o).apply(this,arguments);return void 0===t?this:t}}},function(t,e,n){/*!
 * Chai - addChainingMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var r=n(14),o=n(3),i=n(4),s="__proto__"in Object,a=/^(?:length|name|arguments|caller)$/,u=Function.prototype.call,c=Function.prototype.apply;t.exports=function(t,e,n,h){"function"!=typeof h&&(h=function(){});var l={method:n,chainingBehavior:h};t.__methods||(t.__methods={}),t.__methods[e]=l,Object.defineProperty(t,e,{get:function(){l.chainingBehavior.call(this);var e=function t(){o(this,"ssfi")&&!1===i.includeStack&&o(this,"ssfi",t);var e=l.method.apply(this,arguments);return void 0===e?this:e};if(s){var n=e.__proto__=Object.create(this);n.call=u,n.apply=c}else{Object.getOwnPropertyNames(t).forEach(function(n){if(!a.test(n)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r)}})}return r(this,e),e},configurable:!0})}},function(t,e){/*!
 * Chai - overwriteChainableMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e,n,r){var o=t.__methods[e],i=o.chainingBehavior;o.chainingBehavior=function(){var t=r(i).call(this);return void 0===t?this:t};var s=o.method;o.method=function(){var t=n(s).apply(this,arguments);return void 0===t?this:t}}},function(t,e,n){/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var r=n(4),o=function(){};t.exports=function(t,e){/*!
   * Assertion Constructor
   *
   * Creates object for chaining.
   *
   * @api private
   */
function n(t,e,n){s(this,"ssfi",n||arguments.callee),s(this,"object",t),s(this,"message",e)}/*!
   * Module dependencies.
   */
var i=t.AssertionError,s=e.flag;/*!
   * Module export.
   */
t.Assertion=n,Object.defineProperty(n,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack},set:function(t){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack=t}}),Object.defineProperty(n,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff},set:function(t){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff=t}}),n.addProperty=function(t,n){e.addProperty(this.prototype,t,n)},n.addMethod=function(t,n){e.addMethod(this.prototype,t,n)},n.addChainableMethod=function(t,n,r){e.addChainableMethod(this.prototype,t,n,r)},n.addChainableNoop=function(t,n){e.addChainableMethod(this.prototype,t,o,n)},n.overwriteProperty=function(t,n){e.overwriteProperty(this.prototype,t,n)},n.overwriteMethod=function(t,n){e.overwriteMethod(this.prototype,t,n)},n.overwriteChainableMethod=function(t,n,r){e.overwriteChainableMethod(this.prototype,t,n,r)},/*!
   * ### .assert(expression, message, negateMessage, expected, actual)
   *
   * Executes an expression and check expectations. Throws AssertionError for reporting if test doesn't pass.
   *
   * @name assert
   * @param {Philosophical} expression to be tested
   * @param {String or Function} message or function that returns message to display if fails
   * @param {String or Function} negatedMessage or function that returns negatedMessage to display if negated expression fails
   * @param {Mixed} expected value (remember to check for negation)
   * @param {Mixed} actual (optional) will default to `this.obj`
   * @api private
   */
n.prototype.assert=function(t,n,o,a,u,c){var h=e.test(this,arguments);if(!0!==c&&(c=!1),!0!==r.showDiff&&(c=!1),!h){var n=e.getMessage(this,arguments),l=e.getActual(this,arguments);throw new i(n,{actual:l,expected:a,showDiff:c},r.includeStack?this.assert:s(this,"ssfi"))}},/*!
   * ### ._obj
   *
   * Quick reference to stored `actual` value for plugin developers.
   *
   * @api private
   */
Object.defineProperty(n.prototype,"_obj",{get:function(){return s(this,"object")},set:function(t){s(this,"object",t)}})}},function(t,e){/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e){function n(t,n){n&&w(this,"message",n),t=t.toLowerCase();var r=w(this,"object"),o=~["a","e","i","o","u"].indexOf(t.charAt(0))?"an ":"a ";this.assert(t===e.type(r),"expected #{this} to be "+o+t,"expected #{this} not to be "+o+t)}function r(){w(this,"contains",!0)}function o(t,n){n&&w(this,"message",n);var r=w(this,"object"),o=!1;if("array"===e.type(r)&&"object"===e.type(t)){for(var i in r)if(e.eql(r[i],t)){o=!0;break}}else if("object"===e.type(t)){if(!w(this,"negate")){for(var s in t)new b(r).property(s,t[s]);return}var a={};for(var s in t)a[s]=r[s];o=e.eql(a,t)}else o=r&&~r.indexOf(t);this.assert(o,"expected #{this} to include "+e.inspect(t),"expected #{this} to not include "+e.inspect(t))}function i(){var t=w(this,"object"),e=Object.prototype.toString.call(t);this.assert("[object Arguments]"===e,"expected #{this} to be arguments but got "+e,"expected #{this} to not be arguments")}function s(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"deep"))return this.eql(t);this.assert(t===n,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",t,this._obj,!0)}function a(t,n){n&&w(this,"message",n),this.assert(e.eql(t,w(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",t,this._obj,!0)}function u(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"doLength")){new b(n,e).to.have.property("length");var r=n.length;this.assert(r>t,"expected #{this} to have a length above #{exp} but got #{act}","expected #{this} to not have a length above #{exp}",t,r)}else this.assert(n>t,"expected #{this} to be above "+t,"expected #{this} to be at most "+t)}function c(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"doLength")){new b(n,e).to.have.property("length");var r=n.length;this.assert(r>=t,"expected #{this} to have a length at least #{exp} but got #{act}","expected #{this} to have a length below #{exp}",t,r)}else this.assert(n>=t,"expected #{this} to be at least "+t,"expected #{this} to be below "+t)}function h(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"doLength")){new b(n,e).to.have.property("length");var r=n.length;this.assert(r<t,"expected #{this} to have a length below #{exp} but got #{act}","expected #{this} to not have a length below #{exp}",t,r)}else this.assert(n<t,"expected #{this} to be below "+t,"expected #{this} to be at least "+t)}function l(t,e){e&&w(this,"message",e);var n=w(this,"object");if(w(this,"doLength")){new b(n,e).to.have.property("length");var r=n.length;this.assert(r<=t,"expected #{this} to have a length at most #{exp} but got #{act}","expected #{this} to have a length above #{exp}",t,r)}else this.assert(n<=t,"expected #{this} to be at most "+t,"expected #{this} to be above "+t)}function f(t,n){n&&w(this,"message",n);var r=e.getName(t);this.assert(w(this,"object")instanceof t,"expected #{this} to be an instance of "+r,"expected #{this} to not be an instance of "+r)}function p(t,n){n&&w(this,"message",n);var r=w(this,"object");this.assert(r.hasOwnProperty(t),"expected #{this} to have own property "+e.inspect(t),"expected #{this} to not have own property "+e.inspect(t))}function d(){w(this,"doLength",!0)}function m(t,e){e&&w(this,"message",e);var n=w(this,"object");new b(n,e).to.have.property("length");var r=n.length;this.assert(r==t,"expected #{this} to have a length of #{exp} but got #{act}","expected #{this} to not have a length of #{act}",t,r)}function v(t){var n,r=w(this,"object"),o=!0;if(t=t instanceof Array?t:Array.prototype.slice.call(arguments),!t.length)throw new Error("keys required");var i=Object.keys(r),s=t,a=t.length;if(o=t.every(function(t){return~i.indexOf(t)}),w(this,"negate")||w(this,"contains")||(o=o&&t.length==i.length),a>1){t=t.map(function(t){return e.inspect(t)});var u=t.pop();n=t.join(", ")+", and "+u}else n=e.inspect(t[0]);n=(a>1?"keys ":"key ")+n,n=(w(this,"contains")?"contain ":"have ")+n,this.assert(o,"expected #{this} to "+n,"expected #{this} to not "+n,s.sort(),i.sort(),!0)}function y(t,n,r){r&&w(this,"message",r);var o=w(this,"object");new b(o,r).is.a("function");var i=!1,s=null,a=null,u=null;0===arguments.length?(n=null,t=null):t&&(t instanceof RegExp||"string"==typeof t)?(n=t,t=null):t&&t instanceof Error?(s=t,t=null,n=null):"function"==typeof t?"Error"===(a=t.prototype.name||t.name)&&t!==Error&&(a=(new t).name):t=null;try{o()}catch(r){if(s)return this.assert(r===s,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}",s instanceof Error?s.toString():s,r instanceof Error?r.toString():r),w(this,"object",r),this;if(t&&(this.assert(r instanceof t,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp} but #{act} was thrown",a,r instanceof Error?r.toString():r),!n))return w(this,"object",r),this;var c="object"===e.type(r)&&"message"in r?r.message:""+r;if(null!=c&&n&&n instanceof RegExp)return this.assert(n.exec(c),"expected #{this} to throw error matching #{exp} but got #{act}","expected #{this} to throw error not matching #{exp}",n,c),w(this,"object",r),this;if(null!=c&&n&&"string"==typeof n)return this.assert(~c.indexOf(n),"expected #{this} to throw error including #{exp} but got #{act}","expected #{this} to throw error not including #{act}",n,c),w(this,"object",r),this;i=!0,u=r}var h="",l=null!==a?a:s?"#{exp}":"an error";i&&(h=" but #{act} was thrown"),this.assert(!0===i,"expected #{this} to throw "+l+h,"expected #{this} to not throw "+l+h,s instanceof Error?s.toString():s,u instanceof Error?u.toString():u),w(this,"object",u)}function g(t,e,n){return t.every(function(t){return n?e.some(function(e){return n(t,e)}):-1!==e.indexOf(t)})}var b=t.Assertion,w=(Object.prototype.toString,e.flag);["to","be","been","is","and","has","have","with","that","at","of","same"].forEach(function(t){b.addProperty(t,function(){return this})}),b.addProperty("not",function(){w(this,"negate",!0)}),b.addProperty("deep",function(){w(this,"deep",!0)}),b.addChainableMethod("an",n),b.addChainableMethod("a",n),b.addChainableMethod("include",o,r),b.addChainableMethod("contain",o,r),b.addChainableNoop("ok",function(){this.assert(w(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),b.addChainableNoop("true",function(){this.assert(!0===w(this,"object"),"expected #{this} to be true","expected #{this} to be false",!this.negate)}),b.addChainableNoop("false",function(){this.assert(!1===w(this,"object"),"expected #{this} to be false","expected #{this} to be true",!!this.negate)}),b.addChainableNoop("null",function(){this.assert(null===w(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),b.addChainableNoop("undefined",function(){this.assert(void 0===w(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),b.addChainableNoop("exist",function(){this.assert(null!=w(this,"object"),"expected #{this} to exist","expected #{this} to not exist")}),b.addChainableNoop("empty",function(){var t=w(this,"object"),e=t;Array.isArray(t)||"string"==typeof object?e=t.length:"object"==typeof t&&(e=Object.keys(t).length),this.assert(!e,"expected #{this} to be empty","expected #{this} not to be empty")}),b.addChainableNoop("arguments",i),b.addChainableNoop("Arguments",i),b.addMethod("equal",s),b.addMethod("equals",s),b.addMethod("eq",s),b.addMethod("eql",a),b.addMethod("eqls",a),b.addMethod("above",u),b.addMethod("gt",u),b.addMethod("greaterThan",u),b.addMethod("least",c),b.addMethod("gte",c),b.addMethod("below",h),b.addMethod("lt",h),b.addMethod("lessThan",h),b.addMethod("most",l),b.addMethod("lte",l),b.addMethod("within",function(t,e,n){n&&w(this,"message",n);var r=w(this,"object"),o=t+".."+e;if(w(this,"doLength")){new b(r,n).to.have.property("length");var i=r.length;this.assert(i>=t&&i<=e,"expected #{this} to have a length within "+o,"expected #{this} to not have a length within "+o)}else this.assert(r>=t&&r<=e,"expected #{this} to be within "+o,"expected #{this} to not be within "+o)}),b.addMethod("instanceof",f),b.addMethod("instanceOf",f),b.addMethod("property",function(t,n,r){r&&w(this,"message",r);var o=w(this,"deep")?"deep property ":"property ",i=w(this,"negate"),s=w(this,"object"),a=w(this,"deep")?e.getPathValue(t,s):s[t];if(i&&void 0!==n){if(void 0===a)throw r=null!=r?r+": ":"",new Error(r+e.inspect(s)+" has no "+o+e.inspect(t))}else this.assert(void 0!==a,"expected #{this} to have a "+o+e.inspect(t),"expected #{this} to not have "+o+e.inspect(t));void 0!==n&&this.assert(n===a,"expected #{this} to have a "+o+e.inspect(t)+" of #{exp}, but got #{act}","expected #{this} to not have a "+o+e.inspect(t)+" of #{act}",n,a),w(this,"object",a)}),b.addMethod("ownProperty",p),b.addMethod("haveOwnProperty",p),b.addChainableMethod("length",m,d),b.addMethod("lengthOf",m),b.addMethod("match",function(t,e){e&&w(this,"message",e);var n=w(this,"object");this.assert(t.exec(n),"expected #{this} to match "+t,"expected #{this} not to match "+t)}),b.addMethod("string",function(t,n){n&&w(this,"message",n);var r=w(this,"object");new b(r,n).is.a("string"),this.assert(~r.indexOf(t),"expected #{this} to contain "+e.inspect(t),"expected #{this} to not contain "+e.inspect(t))}),b.addMethod("keys",v),b.addMethod("key",v),b.addMethod("throw",y),b.addMethod("throws",y),b.addMethod("Throw",y),b.addMethod("respondTo",function(t,n){n&&w(this,"message",n);var r=w(this,"object"),o=w(this,"itself"),i="function"!==e.type(r)||o?r[t]:r.prototype[t];this.assert("function"==typeof i,"expected #{this} to respond to "+e.inspect(t),"expected #{this} to not respond to "+e.inspect(t))}),b.addProperty("itself",function(){w(this,"itself",!0)}),b.addMethod("satisfy",function(t,n){n&&w(this,"message",n);var r=w(this,"object"),o=t(r);this.assert(o,"expected #{this} to satisfy "+e.objDisplay(t),"expected #{this} to not satisfy"+e.objDisplay(t),!this.negate,o)}),b.addMethod("closeTo",function(t,n,r){r&&w(this,"message",r);var o=w(this,"object");if(new b(o,r).is.a("number"),"number"!==e.type(t)||"number"!==e.type(n))throw new Error("the arguments to closeTo must be numbers");this.assert(Math.abs(o-t)<=n,"expected #{this} to be close to "+t+" +/- "+n,"expected #{this} not to be close to "+t+" +/- "+n)}),b.addMethod("members",function(t,n){n&&w(this,"message",n);var r=w(this,"object");new b(r).to.be.an("array"),new b(t).to.be.an("array");var o=w(this,"deep")?e.eql:void 0;if(w(this,"contains"))return this.assert(g(t,r,o),"expected #{this} to be a superset of #{act}","expected #{this} to not be a superset of #{act}",r,t);this.assert(g(r,t,o)&&g(t,r,o),"expected #{this} to have the same members as #{act}","expected #{this} to not have the same members as #{act}",r,t)})}},function(t,e){/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e){t.expect=function(e,n){return new t.Assertion(e,n)}}},function(t,e){/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
t.exports=function(t,e){function n(){function t(){return this instanceof String||this instanceof Number?new r(this.constructor(this),null,t):this instanceof Boolean?new r(1==this,null,t):new r(this,null,t)}function e(t){Object.defineProperty(this,"should",{value:t,enumerable:!0,configurable:!0,writable:!0})}Object.defineProperty(Object.prototype,"should",{set:e,get:t,configurable:!0});var n={};return n.equal=function(t,e,n){new r(t,n).to.equal(e)},n.Throw=function(t,e,n,o){new r(t,o).to.Throw(e,n)},n.exist=function(t,e){new r(t,e).to.exist},n.not={},n.not.equal=function(t,e,n){new r(t,n).to.not.equal(e)},n.not.Throw=function(t,e,n,o){new r(t,o).to.not.Throw(e,n)},n.not.exist=function(t,e){new r(t,e).to.not.exist},n.throw=n.Throw,n.not.throw=n.not.Throw,n}var r=t.Assertion;t.should=n,t.Should=n}},function(module,exports){/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
module.exports=function(chai,util){/*!
   * Chai dependencies.
   */
var Assertion=chai.Assertion,flag=util.flag,assert=chai.assert=function(t,e){new Assertion(null,null,chai.assert).assert(t,e,"[ negation message unavailable ]")};assert.fail=function(t,e,n,r){throw n=n||"assert.fail()",new chai.AssertionError(n,{actual:t,expected:e,operator:r},assert.fail)},assert.ok=function(t,e){new Assertion(t,e).is.ok},assert.notOk=function(t,e){new Assertion(t,e).is.not.ok},assert.equal=function(t,e,n){var r=new Assertion(t,n,assert.equal);r.assert(e==flag(r,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",e,t)},assert.notEqual=function(t,e,n){var r=new Assertion(t,n,assert.notEqual);r.assert(e!=flag(r,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",e,t)},assert.strictEqual=function(t,e,n){new Assertion(t,n).to.equal(e)},assert.notStrictEqual=function(t,e,n){new Assertion(t,n).to.not.equal(e)},assert.deepEqual=function(t,e,n){new Assertion(t,n).to.eql(e)},assert.notDeepEqual=function(t,e,n){new Assertion(t,n).to.not.eql(e)},assert.isTrue=function(t,e){new Assertion(t,e).is.true},assert.isFalse=function(t,e){new Assertion(t,e).is.false},assert.isNull=function(t,e){new Assertion(t,e).to.equal(null)},assert.isNotNull=function(t,e){new Assertion(t,e).to.not.equal(null)},assert.isUndefined=function(t,e){new Assertion(t,e).to.equal(void 0)},assert.isDefined=function(t,e){new Assertion(t,e).to.not.equal(void 0)},assert.isFunction=function(t,e){new Assertion(t,e).to.be.a("function")},assert.isNotFunction=function(t,e){new Assertion(t,e).to.not.be.a("function")},assert.isObject=function(t,e){new Assertion(t,e).to.be.a("object")},assert.isNotObject=function(t,e){new Assertion(t,e).to.not.be.a("object")},assert.isArray=function(t,e){new Assertion(t,e).to.be.an("array")},assert.isNotArray=function(t,e){new Assertion(t,e).to.not.be.an("array")},assert.isString=function(t,e){new Assertion(t,e).to.be.a("string")},assert.isNotString=function(t,e){new Assertion(t,e).to.not.be.a("string")},assert.isNumber=function(t,e){new Assertion(t,e).to.be.a("number")},assert.isNotNumber=function(t,e){new Assertion(t,e).to.not.be.a("number")},assert.isBoolean=function(t,e){new Assertion(t,e).to.be.a("boolean")},assert.isNotBoolean=function(t,e){new Assertion(t,e).to.not.be.a("boolean")},assert.typeOf=function(t,e,n){new Assertion(t,n).to.be.a(e)},assert.notTypeOf=function(t,e,n){new Assertion(t,n).to.not.be.a(e)},assert.instanceOf=function(t,e,n){new Assertion(t,n).to.be.instanceOf(e)},assert.notInstanceOf=function(t,e,n){new Assertion(t,n).to.not.be.instanceOf(e)},assert.include=function(t,e,n){new Assertion(t,n,assert.include).include(e)},assert.notInclude=function(t,e,n){new Assertion(t,n,assert.notInclude).not.include(e)},assert.match=function(t,e,n){new Assertion(t,n).to.match(e)},assert.notMatch=function(t,e,n){new Assertion(t,n).to.not.match(e)},assert.property=function(t,e,n){new Assertion(t,n).to.have.property(e)},assert.notProperty=function(t,e,n){new Assertion(t,n).to.not.have.property(e)},assert.deepProperty=function(t,e,n){new Assertion(t,n).to.have.deep.property(e)},assert.notDeepProperty=function(t,e,n){new Assertion(t,n).to.not.have.deep.property(e)},assert.propertyVal=function(t,e,n,r){new Assertion(t,r).to.have.property(e,n)},assert.propertyNotVal=function(t,e,n,r){new Assertion(t,r).to.not.have.property(e,n)},assert.deepPropertyVal=function(t,e,n,r){new Assertion(t,r).to.have.deep.property(e,n)},assert.deepPropertyNotVal=function(t,e,n,r){new Assertion(t,r).to.not.have.deep.property(e,n)},assert.lengthOf=function(t,e,n){new Assertion(t,n).to.have.length(e)},assert.Throw=function(t,e,n,r){("string"==typeof e||e instanceof RegExp)&&(n=e,e=null);var o=new Assertion(t,r).to.Throw(e,n);return flag(o,"object")},assert.doesNotThrow=function(t,e,n){"string"==typeof e&&(n=e,e=null),new Assertion(t,n).to.not.Throw(e)},assert.operator=function(val,operator,val2,msg){if(!~["==","===",">",">=","<","<=","!=","!=="].indexOf(operator))throw new Error('Invalid operator "'+operator+'"');var test=new Assertion(eval(val+operator+val2),msg);test.assert(!0===flag(test,"object"),"expected "+util.inspect(val)+" to be "+operator+" "+util.inspect(val2),"expected "+util.inspect(val)+" to not be "+operator+" "+util.inspect(val2))},assert.closeTo=function(t,e,n,r){new Assertion(t,r).to.be.closeTo(e,n)},assert.sameMembers=function(t,e,n){new Assertion(t,n).to.have.same.members(e)},assert.includeMembers=function(t,e,n){new Assertion(t,n).to.include.members(e)},/*!
   * Undocumented / untested
   */
assert.ifError=function(t,e){new Assertion(t,e).to.not.be.ok},/*!
   * Aliases.
   */
function t(e,n){return assert[n]=assert[e],t}("Throw","throw")("Throw","throws")}},function(t,e,n){"use strict";n(1).should();e.run=function(t){describe("SPScript Context",function(){var e=t.createContext();describe("var ctx = SPScript.createContext(url)",function(){it("Should create the primary object you use to interact with the site",function(){if(!e)throw new Error("Context is null");e.should.have.property("webUrl"),e.should.have.property("executeRequest"),e.should.have.property("get"),e.should.have.property("post"),e.should.have.property("authorizedPost"),e.should.have.property("lists")}),it("Should allow a url to be passed in",function(){var e="http://blah.sharepoint.com";t.createContext(e).webUrl.should.equal(e)}),it("Should default to the current web if no url is passed",function(){t.createContext().webUrl.should.equal(_spPageContextInfo.webAbsoluteUrl)})}),describe("Namespaces",function(){describe("ctx.web",function(){it("Should have an SPScript Web object with site methods (getUser, getSubsites etc...)",function(){e.should.have.property("web"),e.web.should.have.property("getUser"),e.web.should.have.property("getSubsites")})}),describe("ctx.search",function(){it("Should have an SPScript Search object with search methods (query, people, sites etc...)",function(){e.search.should.have.property("query"),e.search.should.have.property("people")})}),describe("ctx.profiles",function(){it("Should have an SPScript Profiles object with methods to hit the Profile Service (current, setProperty etc...)",function(){e.should.have.property("profiles"),e.profiles.should.have.property("get"),e.profiles.should.have.property("setProperty")})})}),describe("Methods",function(){describe("ctx.list(name)",function(){it("Should return an SPScript List instance",function(){var t=e.lists("My List");t.should.have.property("listName"),t.should.have.property("getInfo")})}),describe("ctx.get(url, [opts])",function(){var t;before(function(){t=e.get("/lists?$select=Title")}),it("Should return a Promise",function(){if(!t)throw new Error("Promise is null");t.should.have.property("then")}),it("Should resolve to a JS object, not a JSON string",function(e){t.then(function(t){t.should.have.property("d"),e()}).catch(function(t){return e(t)})}),it("Should return valid API results: ctx.get('/lists')",function(e){t.then(function(t){t.should.have.property("d"),t.d.should.have.property("results"),t.d.results.should.be.an("array"),e()}).catch(function(t){return e(t)})})}),describe("ctx.post(url, [body], [opts]",function(){it("Should return a Promise"),it("Should resolve to a JS object, not a JSON string")}),describe("ctx.authorizedPost(url, [body], [opts]",function(){it("Should include a request digest in the headers"),it("Should return a Promise"),it("Should resolve to a JS object, not a JSON string")}),describe("ctx.getRequestDigest()",function(){it("Should resolve to a string request digest",function(t){e.getRequestDigest().then(function(e){e.should.be.a("string"),e.should.not.be.empty,t()})})})})})}},function(t,e,n){"use strict";function r(){return!("undefined"==typeof window)}var o=n(15);n(1).should();e.run=function(t){describe("var web = ctx.web",function(){this.timeout(5e3),describe("ctx.web.getInfo()",function(){it("Should return a promise that resolves to web info",function(e){t.web.getInfo().then(function(t){t.should.have.property("Url"),t.should.have.property("Title"),e()}).catch(function(t){console.log(t)})})}),describe("ctx.web.getSubsites()",function(){it("Should return a promise that resolves to an array of subsite web infos.",function(e){t.web.getSubsites().then(function(t){t.should.be.an("array"),t.length&&(t[0].should.have.property("Title"),t[0].should.have.property("ServerRelativeUrl")),e()})})}),describe("ctx.web.getUser()",function(){var e=null;before(function(n){t.web.getUser().then(function(t){e=t,n()})}),it("Should return a promise that resolves to a user object",function(){e.should.not.be.null,e.should.have.property("Id"),e.should.have.property("LoginName"),e.should.have.property("Email")}),it("Should return the current user",function(){e.should.have.property("Id"),"undefined"!=typeof window&&window._spPageContextInfo&&e.Id.should.equal(_spPageContextInfo.userId)})}),describe("ctx.web.getUser(email)",function(){var e="andrew@andrewpetersen.onmicrosoft.com",n=null;before(function(r){t.web.getUser(e).then(function(t){n=t,r()})}),it("Should return a promise that resolves to a user object",function(){n.should.not.be.null,n.should.have.property("Id"),n.should.have.property("LoginName"),n.should.have.property("Email")}),it("Should return a user whose email matches the specified email",function(){n.should.have.property("Email"),n.Email.should.equal(e)})});var e="/spscript/Shared Documents/testfile.txt";describe("ctx.web.getFile(serverRelativeFileUrl)",function(){var n=null;before(function(r){t.web.getFile(e).then(function(t){n=t,r()})}),it("Should return a promise that resolves to a file object",function(){n.should.not.be.null,n.should.property("CheckOutType"),n.should.property("ETag"),n.should.property("Exists"),n.should.property("TimeLastModified"),n.should.property("Name"),n.should.property("UIVersionLabel")})});describe("ctx.web.copyFile(serverRelativeSourceUrl, serverRelativeDestUrl)",function(){var n=(new Date,null);before(function(r){t.web.copyFile(e,"/spscript/Shared%20Documents/testfile2.txt").then(function(){return t.web.getFile("/spscript/Shared%20Documents/testfile2.txt")}).then(function(t){n=t,r()}).catch(function(t){"one".should.equal("two","Error in CopyFile requst"),r()})}),it("Should return a promise, and once resolved, the new (copied) file should be retrievable.",function(){n.should.not.be.null,n.should.property("CheckOutType"),n.should.property("ETag"),n.should.property("Exists"),n.should.property("TimeLastModified"),n.should.property("Name"),n.should.property("UIVersionLabel")})}),describe("ctx.web.permissions.getRoleAssignments()",o.create(t.web)),r()&&describe("ctx.web.permissions.check()",o.create(t.web,"check")),describe("ctx.web.permissions.check(email)",o.create(t.web,"check","andrew@andrewpetersen.onmicrosoft.com"))})}},function(t,e,n){"use strict";function r(){return!("undefined"==typeof window)}var o=n(15);n(1).should();e.run=function(t){describe("var list = ctx.lists(listname)",function(){this.timeout(4e3);var e=t.lists("TestList");describe("list.info()",function(){var t=null;before(function(n){e.getInfo().then(function(e){t=e,n()})}),it("Should return a promise that resolves to list info",function(){t.should.be.an("object")}),it("Should bring back list info like Title, ItemCount, and ListItemEntityTypeFullName",function(){t.should.have.property("Title"),t.should.have.property("ItemCount"),t.should.have.property("ListItemEntityTypeFullName")})}),describe("list.getItems()",function(){var t=null;before(function(n){e.getItems().then(function(e){t=e,n()})}),it("Should return a promise that resolves to an array of items",function(){t.should.be.an("array")}),it("Should return all the items in the list",function(n){e.getInfo().then(function(e){t.length.should.equal(e.ItemCount),n()})})}),describe("list.getItems(odata)",function(){var t=null;before(function(n){e.getItems("$filter=MyStatus eq 'Green'").then(function(e){t=e,n()})}),it("Should return a promise that resolves to an array of items",function(){t.should.be.an("array")}),it("Should return only items that match the OData params",function(){t.forEach(function(t){t.should.have.property("MyStatus"),t.MyStatus.should.equal("Green")})})}),describe("list.getItemById(id)",function(){var t=null,n=-1;before(function(r){e.getItems().then(function(t){return n=t[0].Id}).then(function(t){return e.getItemById(t)}).then(function(e){t=e,r()})}),it("Should return a promise that resolves to a single item",function(){t.should.be.an("object"),t.should.have.property("Title")}),it("Should resolve an item with a matching ID",function(){t.should.have.property("Id"),t.Id.should.equal(n)}),it("Should be able to return attachments using the optional odata query",function(t){e.getItemById(n,"$expand=AttachmentFiles").then(function(e){e.should.have.property("AttachmentFiles"),e.AttachmentFiles.should.have.property("results"),e.AttachmentFiles.results.should.be.an("Array"),t()})})}),describe("list.findItems(key, value)",function(){var t=null;before(function(n){e.findItems("MyStatus","Green").then(function(e){t=e,n()})}),it("Should return a promise that resolves to an array of list items",function(){t.should.be.an("array"),t.should.not.be.empty}),it("Should only bring back items the match the key value query",function(){t.forEach(function(t){t.should.have.property("MyStatus"),t.MyStatus.should.equal("Green")})})}),describe("list.findItem(key, value)",function(){var t=null;before(function(n){e.findItem("MyStatus","Green").then(function(e){t=e,n()})}),it("Should resolve to one list item",function(){t.should.be.an("object")}),it("Should only bring back an item if it matches the key value query",function(){t.should.have.property("MyStatus"),t.MyStatus.should.equal("Green")})}),describe("list.addItem()",function(){var t={Title:"Test Created Item",MyStatus:"Red"},n=null;before(function(r){e.addItem(t).then(function(t){n=t,r()}).catch(function(t){console.log(t),r()})}),it("Should return a promise that resolves with the new list item",function(){n.should.not.be.null,n.should.be.an("object"),n.should.have.property("Id")}),it("Should save the item right away so it can be queried.",function(){e.getItemById(n.Id).then(function(e){e.should.not.be.null,e.should.have.property("Title"),e.Title.should.equal(t.Title)})}),it("Should throw an error if a invalid field is set",function(n){t.InvalidColumn="test",e.addItem(t).then(function(){"one".should.equal("two")}).catch(function(t,e,r){n()})})}),describe("list.deleteItem(id)",function(){var t=null;before(function(n){e.getItems("$orderby=Id").then(function(n){return t=n[n.length-1],e.deleteItem(t.Id)}).then(function(){n()}).catch(function(t){n(t)})}),it("Should delete that item",function(n){e.getItemById(t.Id).then(function(){throw"Should have failed because item has been deleted"}).catch(function(){n()})}),it("Should reject the promise if the item id can not be found",function(t){e.deleteItem(99999999).then(function(){throw"Should have failed because id doesnt exist"}).catch(function(){t()})})}),describe("list.updateItem()",function(){var t=null,n={Title:"Updated Title"};before(function(n){e.getItems("$orderby=Id desc").then(function(e){t=e[e.length-1],n()})}),it("Should return a promise",function(r){e.updateItem(t.Id,n).then(function(){r()})}),it("Should update only the properties that were passed",function(r){e.getItemById(t.Id).then(function(t){t.should.have.property("Title"),t.Title.should.equal(n.Title),r()})})}),describe("list.permissions.getRoleAssignments()",o.create(e)),r()&&describe("list.permissions.check()",o.create(e,"check")),describe("list.permissions.check(email)",o.create(e,"check","andrew@andrewpetersen.onmicrosoft.com"))})}},function(t,e,n){"use strict";e.run=function(t){describe("ctx.customActions",function(){this.timeout(1e4);var e={Name:"spscript-test",Location:"ScriptLink",ScriptBlock:"console.log('deployed from spscript-mocha test');"};describe("ctx.customActions.add(customAction)",function(){var n=0;before(function(e){t.customActions.get().then(function(t){n=t.length,e()})}),it("Should add a Custom Action with the given name",function(r){t.customActions.add(e).then(function(){t.customActions.get().then(function(t){t.length.should.equal(n+1),r()})})}),it("Should not add duplicate Custom Action names. It should remove old one first.",function(r){t.customActions.add(e).then(function(){t.customActions.get().then(function(t){t.length.should.equal(n+1),r()})})})}),describe("ctx.customActions.get()",function(){var e=null;before(function(n){t.customActions.get().then(function(t){e=t,n()})}),it("Should return a promise that resolves to an array of custom actions",function(){e.should.be.an("array"),e.should.not.be.empty}),it("Should bring back properties like Name, Url, and Location",function(){var t=e[0];t.should.have.property("Name"),t.should.have.property("Url"),t.should.have.property("Location")})}),describe("ctx.customActions.get(name)",function(){var e=null;before(function(n){t.customActions.get().then(function(r){t.customActions.get(r[0].Name).then(function(t){e=t,n()})})}),it("Should return one object w/ properties like Name, Location, Url, Id",function(){e.should.not.be.null,e.should.have.property("Name"),e.should.have.property("Location"),e.should.have.property("Id")}),it("Should reject the promise with a decent error if the Custom Action name is not found",function(e){t.customActions.get("INVALID-NAME").then(function(){"one".should.equal("two"),e()}).catch(function(t){console.log(t),e()})})}),describe("ctx.customActions.update(updates)",function(){var n=null;before(function(r){t.customActions.get(e.Name).then(function(t){n=t,r()})});var r="updated title - "+Date.now();it("Should update the property",function(e){t.customActions.update({Name:n.Name,Title:r}).then(function(){t.customActions.get(n.Name).then(function(t){t.Title.should.equal(r),e()})})})}),describe("dao.customActions.remove(name)",function(){var n=0;before(function(r){t.customActions.get().then(function(t){n=t.filter(function(t){return t.Name===e.Name}).length,r()}).catch(function(t){console.log(t),r()})}),it("Should remove all custom actions with that name",function(n){t.customActions.remove(e.Name).then(function(){t.customActions.get().then(function(t){t.filter(function(t){return t.Name===e.Name}).should.be.empty(),n()})})})}),describe("ctx.customActions.addScriptLink(name, url)",function(){var e="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",n="SPScriptJSTest-Web";before(function(r){t.customActions.addScriptLink(n,e).then(function(){r()})}),it("Should add a custom action with that name and ScriptBlock with specified URL",function(r){t.customActions.get(n).then(function(t){t.should.have.property("Name"),t.Name.should.equal(n),t.should.have.property("ScriptBlock"),t.ScriptBlock.should.contain(e),r()})}),after(function(e){t.customActions.remove(n).then(function(){e()})})}),describe("ctx.customActions.addScriptLink(name, url, opts)",function(){var e="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",n="SPScriptJSTest-Site",r={Sequence:25,Group:"Custom Group"};before(function(o){t.customActions.addScriptLink(n,e,r).then(function(){o()})}),it("Should add a custom action with that name and ScriptBlock with specified URL",function(o){t.customActions.get(n).then(function(t){t.should.have.property("Name"),t.Name.should.equal(n),t.should.have.property("ScriptBlock"),t.ScriptBlock.should.contain(e),t.should.have.property("Group"),t.Group.should.equal(r.Group),t.should.have.property("Sequence"),t.Sequence.should.equal(25),o()})}),after(function(e){t.customActions.remove(n).then(function(){e()})})}),describe("ctx.customActions.addCSSLink(name, url)",function(){var e="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css",n="SPScriptCSSTest-Web";before(function(r){t.customActions.addCSSLink(n,e).then(function(){r()})}),it("Should add a custom action with that name and ScriptBlock containing specified URL",function(r){t.customActions.get(n).then(function(t){t.should.have.property("Name"),t.Name.should.equal(n),t.should.have.property("ScriptBlock"),t.ScriptBlock.should.contain(e),r()})}),after(function(e){t.customActions.remove(n).then(function(){e()})})}),describe("ctx.customActions.addCSSLink(name, url, opts)",function(){var e="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css",n="SPScriptCSSTest-Site",r={Sequence:50,Group:"Custom Group"};before(function(o){t.customActions.addCSSLink(n,e,r).then(function(){o()})}),it("Should add a custom action with that name and ScriptBlock containing specified URL with Site scope",function(o){t.customActions.get(n).then(function(t){t.should.have.property("Name"),t.Name.should.equal(n),t.should.have.property("ScriptBlock"),t.ScriptBlock.should.contain(e),t.should.have.property("Group"),t.Group.should.equal(r.Group),t.should.have.property("Sequence"),t.Sequence.should.equal(50),o()})}),after(function(e){t.customActions.remove(n).then(function(){e()})})})})}},function(t,e,n){"use strict";n(1).should();e.run=function(t){describe("var search = ctx.search;",function(){this.timeout(5e3),describe("ctx.search.query(queryText)",function(){it("Should return promise that resolves to a SearchResults object",function(e){t.search.query("andrew").then(function(t){t.should.be.an("object"),t.should.have.property("resultsCount"),t.should.have.property("totalResults"),t.should.have.property("items"),t.should.have.property("refiners"),t.items.should.be.an("array"),t.items.should.not.be.empty,e()})})}),describe("ctx.search.query(queryText, queryOptions)",function(){it("Should obey the extra query options that were passed",function(e){var n={rowLimit:1};t.search.query("andrew",n).then(function(t){t.should.be.an("object"),t.should.have.property("resultsCount"),t.should.have.property("totalResults"),t.should.have.property("items"),t.should.have.property("refiners"),t.items.should.be.an("array"),t.items.should.not.be.empty,t.items.length.should.equal(1),e()})})}),describe("ctx.search.query(queryText, queryOptions) - w/ Refiners",function(){it("Should return SearchResults that include a refiners array",function(e){var n={refiners:"FileType"};t.search.query("andrew",n).then(function(t){t.should.be.an("object"),t.should.have.property("refiners"),t.refiners.should.not.be.empty;var n=t.refiners[0];n.should.have.property("RefinerName"),n.should.have.property("RefinerOptions"),n.RefinerName.should.equal("FileType"),n.RefinerOptions.should.be.an("array"),e()})})}),describe("ctx.search.people(queryText)",function(){it("Should only return search results that are people",function(e){t.search.people("andrew").then(function(t){t.should.be.an("object"),t.should.have.property("items"),t.items.should.be.an("array"),t.items.should.not.be.empty;var n=t.items[0];n.should.have.property("AccountName"),n.should.have.property("PreferredName"),n.should.have.property("AboutMe"),n.should.have.property("WorkEmail"),n.should.have.property("PictureURL"),e()})})}),describe("ctx.search.sites(queryText, scope)",function(){it("Should only return search results that are sites",function(e){t.search.sites("").then(function(t){t.should.be.an("object"),t.should.have.property("items"),t.items.should.be.an("array"),t.items.should.not.be.empty();for(var n,r=0;r<t.items.length;r++)n=t.items[r],n.should.have.property("Path"),n.should.have.property("contentclass"),n.contentclass.should.equal("STS_Web");e()})}),it("Should only return sites underneath the specified scope",function(e){var n="https://andrewpetersen.sharepoint.com/sites/ep";t.search.sites("",n).then(function(t){t.should.be.an("object"),t.should.have.property("items"),t.items.should.be.an("array"),t.items.should.not.be.empty();for(var r,o=0;o<t.items.length;o++)r=t.items[o],r.should.have.property("Path"),r.Path.indexOf(n).should.equal(0),r.should.have.property("contentclass"),r.contentclass.should.equal("STS_Web");e()})})})})}},function(t,e,n){"use strict";n(1).should();e.run=function(t){describe("var profiles = ctx.profiles",function(){this.timeout(5e3),describe("ctx.profiles.current()",function(){var e=null;before(function(n){t.profiles.current().then(function(t){e=t,n()})}),it("Should return a promise that resolves to a profile properties object",function(){e.should.be.an("object"),e.should.have.property("AccountName"),e.should.have.property("Email"),e.should.have.property("PreferredName")}),it("Should return the profile of the current user",function(){e.should.have.property("Email"),e.Email.should.equal(_spPageContextInfo.userEmail)})}),describe("ctx.profiles.get()",function(){var e=null;before(function(n){t.profiles.get().then(function(t){e=t,n()})}),it("Should return a promise that resolves to a profile properties object",function(){e.should.be.an("object"),e.should.have.property("AccountName"),e.should.have.property("Email"),e.should.have.property("PreferredName")}),it("Should return the profile of the current user",function(){e.should.have.property("Email"),e.Email.should.equal(_spPageContextInfo.userEmail)})}),describe("ctx.profiles.get(email)",function(){var e="andrew@andrewpetersen.onmicrosoft.com",n=null;before(function(r){t.profiles.get(e).then(function(t){n=t,r()}).catch(function(t){r(t)})}),it("Should return a promise that resolves to a profile properties object",function(){n.should.be.an("object"),n.should.have.property("AccountName"),n.should.have.property("Email"),n.should.have.property("PreferredName")}),it("Should give you the matching person",function(){n.should.have.property("Email"),n.Email.should.equal(e)}),it("Should reject the promise for an invalid email",function(e){t.profiles.get("invalid@invalid123.com").then(function(t){e("The request should have failed.")}).catch(function(){e()})})}),describe("ctx.profiles.get({ AccountName })",function(){var e=null;before(function(n){t.profiles.get({AccountName:"i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com"}).then(function(t){e=t,n()}).catch(function(t){n(t)})}),it("Should return a promise that resolves to a profile properties object",function(){e.should.be.an("object"),e.should.have.property("AccountName"),e.should.have.property("Email"),e.should.have.property("PreferredName")}),it("Should give you the matching person",function(){e.should.have.property("Email"),e.Email.should.equal("andrew@andrewpetersen.onmicrosoft.com")}),it("Should reject the promise for an invalid account name",function(e){t.profiles.get({AccountName:"Invalid"}).then(function(t){e("The request should have failed.")}).catch(function(){e()})})}),describe("ctx.profiles.get({ LoginName })",function(){var e=null;before(function(n){t.profiles.get({LoginName:"i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com"}).then(function(t){e=t,n()}).catch(function(t){n(t)})}),it("Should return a promise that resolves to a profile properties object",function(){e.should.be.an("object"),e.should.have.property("AccountName"),e.should.have.property("Email"),e.should.have.property("PreferredName")}),it("Should give you the matching person",function(){e.should.have.property("Email"),e.Email.should.equal("andrew@andrewpetersen.onmicrosoft.com")}),it("Should reject the promise for an invalid account name",function(e){t.profiles.get({LoginName:"Invalid"}).then(function(t){e("The request should have failed.")}).catch(function(){e()})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue)",function(){it("Should update the About Me profile property of the current user",function(e){var n="Hi there. I was updated with SPScript 1";t.profiles.setProperty("AboutMe",n).then(function(){return t.profiles.current()}).then(function(t){t.should.have.property("AboutMe"),t.AboutMe.should.equal(n),e()}).catch(function(t){e(t)})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue, email)",function(){var e="andrew@andrewpetersen.onmicrosoft.com";it("Should update the About Me profile property based on the specified email",function(n){var r="Hi there. I was updated with SPScript 2";t.profiles.setProperty("AboutMe",r,e).then(function(){return t.profiles.get(e)}).then(function(t){t.should.have.property("AboutMe"),t.AboutMe.should.equal(r),n()}).catch(function(t){n(t)})})}),describe("ctx.profiles.setProperty(propertyName, propertyValue, { AccountName|LoginName })",function(){var e="i:0#.f|membership|andrew@andrewpetersen.onmicrosoft.com";it("Should update the About Me profile property of the passed in User object",function(n){var r="Hi there. I was updated with SPScript 3";t.profiles.setProperty("AboutMe",r,{AccountName:e}).then(function(){return t.profiles.get({AccountName:e})}).then(function(t){t.should.have.property("AboutMe"),t.AboutMe.should.equal(r),n()}).catch(function(t){n(t)})})})})}},function(t,e,n){"use strict";n(1).should();e.run=function(t){describe("var utils = SPScript.utils",function(){describe("utils.parseJSON(data)",function(){it("Should exist on the utils object",function(){t.should.have.property("parseJSON"),t.parseJSON.should.be.a("function")}),it("Should take a string or an object and return an object",function(){var e={one:"value of one",two:"value of two"},n=JSON.stringify(e),r=t.parseJSON(e);r.should.not.be.null,r.should.have.property("one"),r.one.should.equal(e.one);var o=t.parseJSON(n);o.should.not.be.null,o.should.have.property("one"),o.one.should.equal(e.one)})}),describe("Query String",function(){describe("utils.qs.toObj(str)",function(){it("Should take in a string in the form of key=value&key2=value and return an Object",function(){var e=t.qs.toObj("key1=value1");e.should.have.property("key1"),e.key1.should.equal("value1");var n=t.qs.toObj("key1=value1&key2=value2");n.should.have.property("key1"),n.should.have.property("key2"),n.key2.should.equal("value2")}),it("Should support an optional leading '?' ",function(){var e=t.qs.toObj("?key1=value1");e.should.have.property("key1"),e.key1.should.equal("value1")}),it("Should default to 'window.location.search' if no value is passed")}),describe("utils.qs.fromObj(obj, quoteValues?)",function(){it("Should turn { key1: 'value1', key2: 'value2' } into 'key1=value1&key2=value2'",function(){var e={key1:"value1",key2:"value2"};t.qs.fromObj(e).should.equal("key1=value1&key2=value2")}),it("Should put single quotes around words with spaces",function(){var e={key1:"my value"};t.qs.fromObj(e).should.equal("key1='my value'")}),it("Should put single quotes around every value is an optional 'quoteValues' param is set to true",function(){var e={key1:"value1",key2:"value2"};t.qs.fromObj(e,!0).should.equal("key1='value1'&key2='value2'")})})}),describe("Headers",function(){describe("utils.headers.getStandardHeaders(digest?)",function(){it("Should set the Accept header",function(){var e=t.headers.getStandardHeaders();e.should.have.property("Accept"),e.Accept.should.equal("application/json;odata=verbose")}),it("Should set the Request Digest if a digest is passed",function(){var e=t.headers.getStandardHeaders("123Fake");e.should.have.property("Accept"),e.Accept.should.equal("application/json;odata=verbose"),e.should.have.property("X-RequestDigest"),e["X-RequestDigest"].should.equal("123Fake")})}),describe("utils.headers.getAddHeaders(digest)",function(){it("Should set the Request Digest if a digest is passed",function(){var e=t.headers.getAddHeaders("123Fake");e.should.have.property("Accept"),e.Accept.should.equal("application/json;odata=verbose"),e.should.have.property("X-RequestDigest"),e["X-RequestDigest"].should.equal("123Fake")})}),describe("utils.headers.getUpdateHeaders(digest)",function(){it("Should set X-HTTP-Method to MERGE and include X-RequestDigest",function(){var e=t.headers.getUpdateHeaders("123Fake");e.should.have.property("Accept"),e.Accept.should.equal("application/json;odata=verbose"),e.should.have.property("X-RequestDigest"),e["X-RequestDigest"].should.equal("123Fake"),e.should.have.property("X-HTTP-Method"),e["X-HTTP-Method"].should.equal("MERGE")})}),describe("utils.headers.getDeleteHeaders(digest)",function(){it("Should set X-HTTP-Method to DELETE and include X-RequestDigest",function(){var e=t.headers.getDeleteHeaders("123Fake");e.should.have.property("Accept"),e.Accept.should.equal("application/json;odata=verbose"),e.should.have.property("X-RequestDigest"),e["X-RequestDigest"].should.equal("123Fake"),e.should.have.property("X-HTTP-Method"),e["X-HTTP-Method"].should.equal("DELETE")})})}),describe("Dependency Management",function(){describe("utils.validateNamespace(namespace)",function(){it("Should return false if that namespace is not on global window"),it("Should return true if that namespace is on global window")}),describe("utils.waitForLibrary(namespace)",function(){it("Should return a promise that resolves when that namespace is on the global")}),describe("utils.waitForLibraries(namespaces)",function(){it("Should return a promise that resolves when all the namespacea are on the global")}),describe("utils.waitForElement(selector)",function(){it("Should return a promise that resolves an element that matches the selector is on the page"),it("Should eventually time out")})})})}}])});
//# sourceMappingURL=tests.js.map