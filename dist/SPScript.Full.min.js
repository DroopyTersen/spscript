SPScript=window.SPScript||{},function(e){var t=function(){};t.prototype.executeRequest=function(){throw"Not implemented exception"},t.prototype.get=function(e,t){var r={method:"GET"};return t&&$.extend(r,t),this.executeRequest(e,r)},t.prototype.lists=function(e){var t=this,r="/web/lists/getbytitle('"+e+"')",n=function(){var e=null!=oDataQuery?"?"+oDataQuery:"";return t.get(r+"/items"+e).then(function(e){return e&&e.d&&e.d.results?e.d.results:e})},i=function(){var e=r+"/items("+itemId+")";return t.get(e).then(function(e){return e.d?e.d:e})};return{info:function(){return t.get(r)},getById:i,items:n,addItem:function(e){return t.get(r).then(function(n){e=$.extend({__metadata:{type:n.d.ListItemEntityTypeFullName}},e);var i={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}};return t.post(r+"/items",e,i)})},updateItem:function(e,r){return i(e).then(function(e){r=$.extend({__metadata:{type:e.__metadata.type}},r);var n={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":e.__metadata.etag}};return t.post(url,r,n)})},find:function(e,t){var r="$filter="+e+" eq '"+t+"'";return n(r)},findOne:function(e,t){var r="$filter="+e+" eq '"+t+"'";return n(r).then(function(e){return e&&e.length&&e.length>0?e[0]:null})}}},t.prototype.post=function(e,t,r){var n=JSON.stringify(t),i={method:"POST",data:n,contentType:"application/json;odata=verbose"};return $.extend(i,r),this.executeRequest(e,i)},t.prototype.uploadFile=function(e,t,r){var n="/web/GetFolderByServerRelativeUrl('"+e+"')/Files/Add(url='"+t+"',overwrite=true)",i={binaryStringRequestBody:!0,state:"Update"};return this.post(n,r,i)},e.BaseDao=t}(SPScript),SPScript=window.SPScript||{},function(e){var t={};t.validateODataV2=function(e,t){t.resolve(e.d&&e.d.results&&null!=e.d.results.length?e.d.results:e.d?e.d:e)},t.validateCrossDomainODataV2=function(e,t){var r=$.parseJSON(e.body);SPScript.helpers.validateODataV2(r,t)},e.helpers=t}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(e){this.webUrl=e};t.prototype=new SPScript.BaseDao,t.prototype.executeRequest=function(e,t){var r=new $.Deferred,n=function(e){t.success?t.success(e,r):r.resolve(e)},i=function(e,n,i){t.error?t.error(e,n,i,r):r.reject(i)},s=this.webUrl+"/_api"+e,o={url:s,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:n,error:i};return $.extend(o,t),$.ajax(o),r.promise()},e.RestDao=t}(SPScript),SPScript=window.SPScript||{},function(e){e.queryString={_queryString:[],_processed:!1,_processQueryString:function(e){for(var t,r=e||window.location.search.substring(1),n=r.split("&"),i=0;i<n.length;i++)t=n[i].split("="),this._queryString.push(t[0]),this._queryString[t[0]]=decodeURIComponent(t[1].replace(/\+/g," "));this._processed=!0},contains:function(e){return this._processed||this._processQueryString(),this._queryString.hasOwnProperty(e)},getValue:function(e,t){return this._processed||this._processQueryString(t),this.contains(e)?this._queryString[e]:""},getAll:function(e){return this._processed||this._processQueryString(e),this._queryString},objectToQueryString:function(e,t){var r=[];for(var n in e)value=e[n],null!==value&&r.push(t?encodeURIComponent(n)+"='"+encodeURIComponent(value)+"'":encodeURIComponent(n)+"="+encodeURIComponent(value));return r.join("&")}}}(SPScript),SPScript=window.SPScript||{},function(e){var t=function(e){this.dao=new SPScript.RestDao(e),this.webUrl=e};t.QueryOptions=function(){this.sourceid=null,this.startrow=null,this.rowlimit=30,this.selectedproperties=null,this.refiners=null,this.refinementfilters=null,this.hiddenconstraints=null,this.sortlist=null};var r=function(e){for(var t=[],r=0;r<e.length;r++){for(var n=e[r],i={},s=0;s<n.Cells.results.length;s++)i[n.Cells.results[s].Key]=n.Cells.results[s].Value;t.push(i)}return t},n=function(e){this.elapsedTime=e.ElapsedTime,this.suggestion=e.SpellingSuggestion,this.resultsCount=e.PrimaryQueryResult.RelevantResults.RowCount,this.totalResults=e.PrimaryQueryResult.RelevantResults.TotalRows,this.totalResultsIncludingDuplicates=e.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates,this.items=r(e.PrimaryQueryResult.RelevantResults.Table.Rows.results)};t.prototype.query=function(e,t){var r=this,i=null!=t?"&"+SPScript.queryString.objectToQueryString(t,!0):"",s=new $.Deferred,o="/search/query?querytext='"+e+"'"+i,a=r.dao.get(o);return a.done(function(e){if(e.d&&e.d.query){var t=new n(e.d.query);s.resolve(t)}else s.reject(e)}),s.promise()},e.Search=t}(SPScript),SPScript=window.SPScript||{},function(e){e.templating={Placeholder:function(e){this.raw=e,this.fullProperty=e.slice(2,e.length-2)},getPlaceHolders:function(e,t){var r=t||/\{\{[^\}]+\}\}?/g;return e.match(r)},getObjectValue:function(e,t){for(var r=e,n=t.split("."),i=0;i<n.length;i++){var s=n[i];r=null!=r[s]?r[s]:"Not Found: "+t}return"string"==typeof r&&-1!==r.indexOf("/Date(")&&(dateValue=r.UTCJsonToDate(),r=dateValue.toLocaleDateString()),r},populateTemplate:function(e,t,r){for(var n=this.getPlaceHolders(e,r)||[],i=e,s=0;s<n.length;s++){var o=new this.Placeholder(n[s]);o.val=this.getObjectValue(t,o.fullProperty);var a=o.raw.replace("[","\\[").replace("]","\\]");modifier="g",i=i.replace(new RegExp(a,modifier),o.val)}return i}},e.templating.Each={regExp:/\{\[[^\]]+\]\}?/g,populateEachTemplates:function(t,r){var n=$(t),i=n.find("[data-each]");i.each(function(){var t="",i=$(this).html(),s=$(this).data("each"),o=e.templating.getObjectValue(r,s);if(null!=o&&$.isArray(o))for(var a=0;a<o.length;a++)t+=e.templating.populateTemplate(i,o[a],e.templating.Each.regExp);n.find($(this)).html(t)});var s=n.clone().wrap("<div>");return s.parent().html()}},e.templating.renderTemplate=function(t,r,n){var i=e.templating.populateTemplate(t,r);return n&&(i=e.templating.Each.populateEachTemplates(i,r)),i}}(SPScript),String.prototype.UTCJsonToDate=function(){var e=this.substring(this.indexOf("(")+1);e=e.substring(0,e.indexOf(")"));var t=new Date(parseInt(e,10)),r=t.getTimezoneOffset()/60;return t.setHours(t.getHours()+r),t};