{"version":3,"sources":["webpack:///spscript.js","webpack:///webpack/bootstrap 66cda6bfee26506be81b?0a24","webpack:///./lib/entry.browser.js","webpack:///./lib/context/headers.js","webpack:///./lib/utils.js","webpack:///./~/process/browser.js?82e4","webpack:///./~/promise-polyfill/promise.js?6ded","webpack:///./~/setimmediate/setImmediate.js?4a80","webpack:///./~/timers-browserify/main.js?b088","webpack:///./lib/List.js","webpack:///./lib/SPScript.js","webpack:///./lib/context/Context.js","webpack:///./lib/context/request.js","webpack:///./lib/context/xhr.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","global","promise_polyfill_1","SPScript_1","Promise","default","this","getStandardHeaders","digest","headers","Accept","jsonMimeType","Content-Type","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","defineProperty","value","getAddHeaders","getFilestreamHeaders","X-RequestDigest","binaryStringRequestBody","getActionHeaders","verb","X-HTTP-Method","decorateETag","etag","getUpdateHeaders","getDeleteHeaders","headerUtils","parseJSON","data","JSON","parse","e","validateODataV2","results","d","utils","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","setTimeout","runClearTimeout","marker","cachedClearTimeout","clearTimeout","cleanUpNextTick","draining","currentQueue","queue","concat","queueIndex","drainQueue","timeout","len","run","Item","array","noop","process","nextTick","args","Array","push","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","setImmediate","root","bind","fn","thisArg","TypeError","_state","_handled","_value","undefined","_deferreds","doResolve","handle","self","deferred","_immediateFn","cb","onFulfilled","onRejected","resolve","reject","promise","ret","newValue","then","finale","_unhandledRejectionFn","Handler","done","reason","ex","setTimeoutFunc","prom","all","arr","slice","res","val","remaining","constructor","race","values","err","console","warn","_setImmediateFn","_setUnhandledRejectionFn","callback","Function","task","tasksByHandle","nextHandle","registerImmediate","clearImmediate","runIfPresent","currentlyRunningATask","installNextTickImplementation","canUsePostMessage","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","installPostMessageImplementation","messagePrefix","Math","random","onGlobalMessage","event","indexOf","addEventListener","attachEvent","installMessageChannelImplementation","channel","MessageChannel","port1","port2","installReadyStateChangeImplementation","html","doc","documentElement","script","createElement","onreadystatechange","removeChild","appendChild","installSetTimeoutImplementation","document","attachTo","getPrototypeOf","toString","Timeout","clearFn","_id","_clearFn","window","setInterval","clearInterval","close","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","_classCallCheck","instance","Constructor","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","utils_1","headers_1","List","ctx","listName","baseUrl","_dao","odata","get","appendOData","url","filterValue","getItems","findItems","items","_this","ensureRequestDigest","__metadata","type","ListItemEntityTypeFullName","customOptions","post","itemId","updates","_this2","getItemById","uri","_this3","prefix","Context_1","createContext","create","_env","clientId","clientSecret","_spPageContextInfo","webAbsoluteUrl","Context","message","request_1","List_1","webUrl","ensureToken","opts","fullUrl","test","defaultOptions","method","accessToken","requestOptions","options","executeRequest","body","_packagePostBody","getRequestDigest","GetContextWebInformation","FormDigestValue","stringify","xhr_1","request","defaults","async","validMethods","errorHandlers","validateOptions","setHeaders","xhr","headersObj","keys","forEach","setRequestHeader","XMLHttpRequest","open","responseType","readyState","status","response","responseText","error","statusCode","send","addErrorHandler","setDefaults"],"mappings":"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","file":"spscript.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\t\n\tvar promise_polyfill_1 = __webpack_require__(8);\n\tvar SPScript_1 = __webpack_require__(17);\n\tif (!global.Promise) {\n\t    global.Promise = promise_polyfill_1.default;\n\t}\n\tmodule.exports = SPScript_1.default;\n\t//# sourceMappingURL=entry.browser.js.map\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ }),\n/* 1 */,\n/* 2 */,\n/* 3 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\t;\n\tvar jsonMimeType = \"application/json;odata=verbose\";\n\tfunction getStandardHeaders(digest) {\n\t    var headers = {\n\t        \"Accept\": jsonMimeType,\n\t        \"Content-Type\": jsonMimeType\n\t    };\n\t    if (digest) headers[\"X-RequestDigest\"] = digest;\n\t    return headers;\n\t}\n\tvar getAddHeaders = getStandardHeaders;\n\tvar getFilestreamHeaders = function getFilestreamHeaders(digest) {\n\t    return {\n\t        'Accept': jsonMimeType,\n\t        'X-RequestDigest': digest,\n\t        'Content-Type': \"application/octet-stream\",\n\t        'binaryStringRequestBody': \"true\"\n\t    };\n\t};\n\tvar getActionHeaders = function getActionHeaders(verb, digest) {\n\t    return _extends({}, getStandardHeaders(digest), {\n\t        \"X-HTTP-Method\": verb\n\t    });\n\t};\n\tvar decorateETag = function decorateETag(headers, etag) {\n\t    if (etag) headers[\"If-Match\"] = etag;\n\t    return headers;\n\t};\n\tvar getUpdateHeaders = function getUpdateHeaders(digest, etag) {\n\t    return decorateETag(getActionHeaders(\"MERGE\", digest), etag);\n\t};\n\tvar getDeleteHeaders = function getDeleteHeaders(digest, etag) {\n\t    return decorateETag(getActionHeaders(\"DELETE\", digest), etag);\n\t};\n\tvar headerUtils = {\n\t    getStandardHeaders: getStandardHeaders,\n\t    getAddHeaders: getAddHeaders,\n\t    getFilestreamHeaders: getFilestreamHeaders,\n\t    getActionHeaders: getActionHeaders,\n\t    getUpdateHeaders: getUpdateHeaders,\n\t    getDeleteHeaders: getDeleteHeaders\n\t};\n\texports.default = headerUtils;\n\t//# sourceMappingURL=headers.js.map\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tfunction parseJSON(data) {\n\t    if (typeof data === \"string\") {\n\t        try {\n\t            data = JSON.parse(data);\n\t        } catch (e) {\n\t            return null;\n\t        }\n\t    }\n\t    return data;\n\t}\n\tfunction validateODataV2(data) {\n\t    data = parseJSON(data);\n\t    var results = null;\n\t    if (data.d && data.d.results && data.d.results.length != null) {\n\t        results = data.d.results;\n\t    } else if (data.d) {\n\t        results = data.d;\n\t    }\n\t    return results || data;\n\t}\n\tvar utils = { parseJSON: parseJSON, validateODataV2: validateODataV2 };\n\texports.default = utils;\n\t//# sourceMappingURL=utils.js.map\n\n/***/ }),\n/* 5 */,\n/* 6 */,\n/* 7 */\n/***/ (function(module, exports) {\n\n\t// shim for using process in browser\n\tvar process = module.exports = {};\n\t\n\t// cached from whatever global is present so that test runners that stub it\n\t// don't break things.  But we need to wrap it in a try catch in case it is\n\t// wrapped in strict mode code which doesn't define any globals.  It's inside a\n\t// function because try/catches deoptimize in certain engines.\n\t\n\tvar cachedSetTimeout;\n\tvar cachedClearTimeout;\n\t\n\tfunction defaultSetTimout() {\n\t    throw new Error('setTimeout has not been defined');\n\t}\n\tfunction defaultClearTimeout () {\n\t    throw new Error('clearTimeout has not been defined');\n\t}\n\t(function () {\n\t    try {\n\t        if (typeof setTimeout === 'function') {\n\t            cachedSetTimeout = setTimeout;\n\t        } else {\n\t            cachedSetTimeout = defaultSetTimout;\n\t        }\n\t    } catch (e) {\n\t        cachedSetTimeout = defaultSetTimout;\n\t    }\n\t    try {\n\t        if (typeof clearTimeout === 'function') {\n\t            cachedClearTimeout = clearTimeout;\n\t        } else {\n\t            cachedClearTimeout = defaultClearTimeout;\n\t        }\n\t    } catch (e) {\n\t        cachedClearTimeout = defaultClearTimeout;\n\t    }\n\t} ())\n\tfunction runTimeout(fun) {\n\t    if (cachedSetTimeout === setTimeout) {\n\t        //normal enviroments in sane situations\n\t        return setTimeout(fun, 0);\n\t    }\n\t    // if setTimeout wasn't available but was latter defined\n\t    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n\t        cachedSetTimeout = setTimeout;\n\t        return setTimeout(fun, 0);\n\t    }\n\t    try {\n\t        // when when somebody has screwed with setTimeout but no I.E. maddness\n\t        return cachedSetTimeout(fun, 0);\n\t    } catch(e){\n\t        try {\n\t            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n\t            return cachedSetTimeout.call(null, fun, 0);\n\t        } catch(e){\n\t            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n\t            return cachedSetTimeout.call(this, fun, 0);\n\t        }\n\t    }\n\t\n\t\n\t}\n\tfunction runClearTimeout(marker) {\n\t    if (cachedClearTimeout === clearTimeout) {\n\t        //normal enviroments in sane situations\n\t        return clearTimeout(marker);\n\t    }\n\t    // if clearTimeout wasn't available but was latter defined\n\t    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n\t        cachedClearTimeout = clearTimeout;\n\t        return clearTimeout(marker);\n\t    }\n\t    try {\n\t        // when when somebody has screwed with setTimeout but no I.E. maddness\n\t        return cachedClearTimeout(marker);\n\t    } catch (e){\n\t        try {\n\t            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n\t            return cachedClearTimeout.call(null, marker);\n\t        } catch (e){\n\t            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n\t            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n\t            return cachedClearTimeout.call(this, marker);\n\t        }\n\t    }\n\t\n\t\n\t\n\t}\n\tvar queue = [];\n\tvar draining = false;\n\tvar currentQueue;\n\tvar queueIndex = -1;\n\t\n\tfunction cleanUpNextTick() {\n\t    if (!draining || !currentQueue) {\n\t        return;\n\t    }\n\t    draining = false;\n\t    if (currentQueue.length) {\n\t        queue = currentQueue.concat(queue);\n\t    } else {\n\t        queueIndex = -1;\n\t    }\n\t    if (queue.length) {\n\t        drainQueue();\n\t    }\n\t}\n\t\n\tfunction drainQueue() {\n\t    if (draining) {\n\t        return;\n\t    }\n\t    var timeout = runTimeout(cleanUpNextTick);\n\t    draining = true;\n\t\n\t    var len = queue.length;\n\t    while(len) {\n\t        currentQueue = queue;\n\t        queue = [];\n\t        while (++queueIndex < len) {\n\t            if (currentQueue) {\n\t                currentQueue[queueIndex].run();\n\t            }\n\t        }\n\t        queueIndex = -1;\n\t        len = queue.length;\n\t    }\n\t    currentQueue = null;\n\t    draining = false;\n\t    runClearTimeout(timeout);\n\t}\n\t\n\tprocess.nextTick = function (fun) {\n\t    var args = new Array(arguments.length - 1);\n\t    if (arguments.length > 1) {\n\t        for (var i = 1; i < arguments.length; i++) {\n\t            args[i - 1] = arguments[i];\n\t        }\n\t    }\n\t    queue.push(new Item(fun, args));\n\t    if (queue.length === 1 && !draining) {\n\t        runTimeout(drainQueue);\n\t    }\n\t};\n\t\n\t// v8 likes predictible objects\n\tfunction Item(fun, array) {\n\t    this.fun = fun;\n\t    this.array = array;\n\t}\n\tItem.prototype.run = function () {\n\t    this.fun.apply(null, this.array);\n\t};\n\tprocess.title = 'browser';\n\tprocess.browser = true;\n\tprocess.env = {};\n\tprocess.argv = [];\n\tprocess.version = ''; // empty string to avoid regexp issues\n\tprocess.versions = {};\n\t\n\tfunction noop() {}\n\t\n\tprocess.on = noop;\n\tprocess.addListener = noop;\n\tprocess.once = noop;\n\tprocess.off = noop;\n\tprocess.removeListener = noop;\n\tprocess.removeAllListeners = noop;\n\tprocess.emit = noop;\n\tprocess.prependListener = noop;\n\tprocess.prependOnceListener = noop;\n\t\n\tprocess.listeners = function (name) { return [] }\n\t\n\tprocess.binding = function (name) {\n\t    throw new Error('process.binding is not supported');\n\t};\n\t\n\tprocess.cwd = function () { return '/' };\n\tprocess.chdir = function (dir) {\n\t    throw new Error('process.chdir is not supported');\n\t};\n\tprocess.umask = function() { return 0; };\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(setImmediate) {(function (root) {\n\t\n\t  // Store setTimeout reference so promise-polyfill will be unaffected by\n\t  // other code modifying setTimeout (like sinon.useFakeTimers())\n\t  var setTimeoutFunc = setTimeout;\n\t\n\t  function noop() {}\n\t  \n\t  // Polyfill for Function.prototype.bind\n\t  function bind(fn, thisArg) {\n\t    return function () {\n\t      fn.apply(thisArg, arguments);\n\t    };\n\t  }\n\t\n\t  function Promise(fn) {\n\t    if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n\t    if (typeof fn !== 'function') throw new TypeError('not a function');\n\t    this._state = 0;\n\t    this._handled = false;\n\t    this._value = undefined;\n\t    this._deferreds = [];\n\t\n\t    doResolve(fn, this);\n\t  }\n\t\n\t  function handle(self, deferred) {\n\t    while (self._state === 3) {\n\t      self = self._value;\n\t    }\n\t    if (self._state === 0) {\n\t      self._deferreds.push(deferred);\n\t      return;\n\t    }\n\t    self._handled = true;\n\t    Promise._immediateFn(function () {\n\t      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\t      if (cb === null) {\n\t        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n\t        return;\n\t      }\n\t      var ret;\n\t      try {\n\t        ret = cb(self._value);\n\t      } catch (e) {\n\t        reject(deferred.promise, e);\n\t        return;\n\t      }\n\t      resolve(deferred.promise, ret);\n\t    });\n\t  }\n\t\n\t  function resolve(self, newValue) {\n\t    try {\n\t      // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n\t      if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\t      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n\t        var then = newValue.then;\n\t        if (newValue instanceof Promise) {\n\t          self._state = 3;\n\t          self._value = newValue;\n\t          finale(self);\n\t          return;\n\t        } else if (typeof then === 'function') {\n\t          doResolve(bind(then, newValue), self);\n\t          return;\n\t        }\n\t      }\n\t      self._state = 1;\n\t      self._value = newValue;\n\t      finale(self);\n\t    } catch (e) {\n\t      reject(self, e);\n\t    }\n\t  }\n\t\n\t  function reject(self, newValue) {\n\t    self._state = 2;\n\t    self._value = newValue;\n\t    finale(self);\n\t  }\n\t\n\t  function finale(self) {\n\t    if (self._state === 2 && self._deferreds.length === 0) {\n\t      Promise._immediateFn(function() {\n\t        if (!self._handled) {\n\t          Promise._unhandledRejectionFn(self._value);\n\t        }\n\t      });\n\t    }\n\t\n\t    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n\t      handle(self, self._deferreds[i]);\n\t    }\n\t    self._deferreds = null;\n\t  }\n\t\n\t  function Handler(onFulfilled, onRejected, promise) {\n\t    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n\t    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n\t    this.promise = promise;\n\t  }\n\t\n\t  /**\n\t   * Take a potentially misbehaving resolver function and make sure\n\t   * onFulfilled and onRejected are only called once.\n\t   *\n\t   * Makes no guarantees about asynchrony.\n\t   */\n\t  function doResolve(fn, self) {\n\t    var done = false;\n\t    try {\n\t      fn(function (value) {\n\t        if (done) return;\n\t        done = true;\n\t        resolve(self, value);\n\t      }, function (reason) {\n\t        if (done) return;\n\t        done = true;\n\t        reject(self, reason);\n\t      });\n\t    } catch (ex) {\n\t      if (done) return;\n\t      done = true;\n\t      reject(self, ex);\n\t    }\n\t  }\n\t\n\t  Promise.prototype['catch'] = function (onRejected) {\n\t    return this.then(null, onRejected);\n\t  };\n\t\n\t  Promise.prototype.then = function (onFulfilled, onRejected) {\n\t    var prom = new (this.constructor)(noop);\n\t\n\t    handle(this, new Handler(onFulfilled, onRejected, prom));\n\t    return prom;\n\t  };\n\t\n\t  Promise.all = function (arr) {\n\t    var args = Array.prototype.slice.call(arr);\n\t\n\t    return new Promise(function (resolve, reject) {\n\t      if (args.length === 0) return resolve([]);\n\t      var remaining = args.length;\n\t\n\t      function res(i, val) {\n\t        try {\n\t          if (val && (typeof val === 'object' || typeof val === 'function')) {\n\t            var then = val.then;\n\t            if (typeof then === 'function') {\n\t              then.call(val, function (val) {\n\t                res(i, val);\n\t              }, reject);\n\t              return;\n\t            }\n\t          }\n\t          args[i] = val;\n\t          if (--remaining === 0) {\n\t            resolve(args);\n\t          }\n\t        } catch (ex) {\n\t          reject(ex);\n\t        }\n\t      }\n\t\n\t      for (var i = 0; i < args.length; i++) {\n\t        res(i, args[i]);\n\t      }\n\t    });\n\t  };\n\t\n\t  Promise.resolve = function (value) {\n\t    if (value && typeof value === 'object' && value.constructor === Promise) {\n\t      return value;\n\t    }\n\t\n\t    return new Promise(function (resolve) {\n\t      resolve(value);\n\t    });\n\t  };\n\t\n\t  Promise.reject = function (value) {\n\t    return new Promise(function (resolve, reject) {\n\t      reject(value);\n\t    });\n\t  };\n\t\n\t  Promise.race = function (values) {\n\t    return new Promise(function (resolve, reject) {\n\t      for (var i = 0, len = values.length; i < len; i++) {\n\t        values[i].then(resolve, reject);\n\t      }\n\t    });\n\t  };\n\t\n\t  // Use polyfill for setImmediate for performance gains\n\t  Promise._immediateFn = (typeof setImmediate === 'function' && function (fn) { setImmediate(fn); }) ||\n\t    function (fn) {\n\t      setTimeoutFunc(fn, 0);\n\t    };\n\t\n\t  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n\t    if (typeof console !== 'undefined' && console) {\n\t      console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Set the immediate function to execute callbacks\n\t   * @param fn {function} Function to execute\n\t   * @deprecated\n\t   */\n\t  Promise._setImmediateFn = function _setImmediateFn(fn) {\n\t    Promise._immediateFn = fn;\n\t  };\n\t\n\t  /**\n\t   * Change the function to execute on unhandled rejection\n\t   * @param {function} fn Function to execute on unhandled rejection\n\t   * @deprecated\n\t   */\n\t  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n\t    Promise._unhandledRejectionFn = fn;\n\t  };\n\t  \n\t  if (typeof module !== 'undefined' && module.exports) {\n\t    module.exports = Promise;\n\t  } else if (!root.Promise) {\n\t    root.Promise = Promise;\n\t  }\n\t\n\t})(this);\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(10).setImmediate))\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global, process) {(function (global, undefined) {\n\t    \"use strict\";\n\t\n\t    if (global.setImmediate) {\n\t        return;\n\t    }\n\t\n\t    var nextHandle = 1; // Spec says greater than zero\n\t    var tasksByHandle = {};\n\t    var currentlyRunningATask = false;\n\t    var doc = global.document;\n\t    var registerImmediate;\n\t\n\t    function setImmediate(callback) {\n\t      // Callback can either be a function or a string\n\t      if (typeof callback !== \"function\") {\n\t        callback = new Function(\"\" + callback);\n\t      }\n\t      // Copy function arguments\n\t      var args = new Array(arguments.length - 1);\n\t      for (var i = 0; i < args.length; i++) {\n\t          args[i] = arguments[i + 1];\n\t      }\n\t      // Store and register the task\n\t      var task = { callback: callback, args: args };\n\t      tasksByHandle[nextHandle] = task;\n\t      registerImmediate(nextHandle);\n\t      return nextHandle++;\n\t    }\n\t\n\t    function clearImmediate(handle) {\n\t        delete tasksByHandle[handle];\n\t    }\n\t\n\t    function run(task) {\n\t        var callback = task.callback;\n\t        var args = task.args;\n\t        switch (args.length) {\n\t        case 0:\n\t            callback();\n\t            break;\n\t        case 1:\n\t            callback(args[0]);\n\t            break;\n\t        case 2:\n\t            callback(args[0], args[1]);\n\t            break;\n\t        case 3:\n\t            callback(args[0], args[1], args[2]);\n\t            break;\n\t        default:\n\t            callback.apply(undefined, args);\n\t            break;\n\t        }\n\t    }\n\t\n\t    function runIfPresent(handle) {\n\t        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n\t        // So if we're currently running a task, we'll need to delay this invocation.\n\t        if (currentlyRunningATask) {\n\t            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n\t            // \"too much recursion\" error.\n\t            setTimeout(runIfPresent, 0, handle);\n\t        } else {\n\t            var task = tasksByHandle[handle];\n\t            if (task) {\n\t                currentlyRunningATask = true;\n\t                try {\n\t                    run(task);\n\t                } finally {\n\t                    clearImmediate(handle);\n\t                    currentlyRunningATask = false;\n\t                }\n\t            }\n\t        }\n\t    }\n\t\n\t    function installNextTickImplementation() {\n\t        registerImmediate = function(handle) {\n\t            process.nextTick(function () { runIfPresent(handle); });\n\t        };\n\t    }\n\t\n\t    function canUsePostMessage() {\n\t        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n\t        // where `global.postMessage` means something completely different and can't be used for this purpose.\n\t        if (global.postMessage && !global.importScripts) {\n\t            var postMessageIsAsynchronous = true;\n\t            var oldOnMessage = global.onmessage;\n\t            global.onmessage = function() {\n\t                postMessageIsAsynchronous = false;\n\t            };\n\t            global.postMessage(\"\", \"*\");\n\t            global.onmessage = oldOnMessage;\n\t            return postMessageIsAsynchronous;\n\t        }\n\t    }\n\t\n\t    function installPostMessageImplementation() {\n\t        // Installs an event handler on `global` for the `message` event: see\n\t        // * https://developer.mozilla.org/en/DOM/window.postMessage\n\t        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\t\n\t        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n\t        var onGlobalMessage = function(event) {\n\t            if (event.source === global &&\n\t                typeof event.data === \"string\" &&\n\t                event.data.indexOf(messagePrefix) === 0) {\n\t                runIfPresent(+event.data.slice(messagePrefix.length));\n\t            }\n\t        };\n\t\n\t        if (global.addEventListener) {\n\t            global.addEventListener(\"message\", onGlobalMessage, false);\n\t        } else {\n\t            global.attachEvent(\"onmessage\", onGlobalMessage);\n\t        }\n\t\n\t        registerImmediate = function(handle) {\n\t            global.postMessage(messagePrefix + handle, \"*\");\n\t        };\n\t    }\n\t\n\t    function installMessageChannelImplementation() {\n\t        var channel = new MessageChannel();\n\t        channel.port1.onmessage = function(event) {\n\t            var handle = event.data;\n\t            runIfPresent(handle);\n\t        };\n\t\n\t        registerImmediate = function(handle) {\n\t            channel.port2.postMessage(handle);\n\t        };\n\t    }\n\t\n\t    function installReadyStateChangeImplementation() {\n\t        var html = doc.documentElement;\n\t        registerImmediate = function(handle) {\n\t            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n\t            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n\t            var script = doc.createElement(\"script\");\n\t            script.onreadystatechange = function () {\n\t                runIfPresent(handle);\n\t                script.onreadystatechange = null;\n\t                html.removeChild(script);\n\t                script = null;\n\t            };\n\t            html.appendChild(script);\n\t        };\n\t    }\n\t\n\t    function installSetTimeoutImplementation() {\n\t        registerImmediate = function(handle) {\n\t            setTimeout(runIfPresent, 0, handle);\n\t        };\n\t    }\n\t\n\t    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n\t    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n\t    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\t\n\t    // Don't get fooled by e.g. browserify environments.\n\t    if ({}.toString.call(global.process) === \"[object process]\") {\n\t        // For Node.js before 0.9\n\t        installNextTickImplementation();\n\t\n\t    } else if (canUsePostMessage()) {\n\t        // For non-IE10 modern browsers\n\t        installPostMessageImplementation();\n\t\n\t    } else if (global.MessageChannel) {\n\t        // For web workers, where supported\n\t        installMessageChannelImplementation();\n\t\n\t    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n\t        // For IE 6–8\n\t        installReadyStateChangeImplementation();\n\t\n\t    } else {\n\t        // For older browsers\n\t        installSetTimeoutImplementation();\n\t    }\n\t\n\t    attachTo.setImmediate = setImmediate;\n\t    attachTo.clearImmediate = clearImmediate;\n\t}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }()), __webpack_require__(7)))\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar apply = Function.prototype.apply;\n\t\n\t// DOM APIs, for completeness\n\t\n\texports.setTimeout = function() {\n\t  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n\t};\n\texports.setInterval = function() {\n\t  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n\t};\n\texports.clearTimeout =\n\texports.clearInterval = function(timeout) {\n\t  if (timeout) {\n\t    timeout.close();\n\t  }\n\t};\n\t\n\tfunction Timeout(id, clearFn) {\n\t  this._id = id;\n\t  this._clearFn = clearFn;\n\t}\n\tTimeout.prototype.unref = Timeout.prototype.ref = function() {};\n\tTimeout.prototype.close = function() {\n\t  this._clearFn.call(window, this._id);\n\t};\n\t\n\t// Does not start the time, just sets up the members needed.\n\texports.enroll = function(item, msecs) {\n\t  clearTimeout(item._idleTimeoutId);\n\t  item._idleTimeout = msecs;\n\t};\n\t\n\texports.unenroll = function(item) {\n\t  clearTimeout(item._idleTimeoutId);\n\t  item._idleTimeout = -1;\n\t};\n\t\n\texports._unrefActive = exports.active = function(item) {\n\t  clearTimeout(item._idleTimeoutId);\n\t\n\t  var msecs = item._idleTimeout;\n\t  if (msecs >= 0) {\n\t    item._idleTimeoutId = setTimeout(function onTimeout() {\n\t      if (item._onTimeout)\n\t        item._onTimeout();\n\t    }, msecs);\n\t  }\n\t};\n\t\n\t// setimmediate attaches itself to the global object\n\t__webpack_require__(9);\n\texports.setImmediate = setImmediate;\n\texports.clearImmediate = clearImmediate;\n\n\n/***/ }),\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar utils_1 = __webpack_require__(4);\n\tvar headers_1 = __webpack_require__(3);\n\t\n\tvar List = function () {\n\t    // TODO permissions. Inherit securable?\n\t    function List(name, ctx) {\n\t        _classCallCheck(this, List);\n\t\n\t        this.listName = name;\n\t        this.baseUrl = \"/web/lists/getbytitle('\" + this.listName + \"')\";\n\t        this._dao = ctx;\n\t    }\n\t\n\t    _createClass(List, [{\n\t        key: \"getItems\",\n\t        value: function getItems(odata) {\n\t            return this._dao.get(this.baseUrl + \"/items\" + appendOData(odata)).then(utils_1.default.validateODataV2);\n\t        }\n\t    }, {\n\t        key: \"getItemById\",\n\t        value: function getItemById(id, odata) {\n\t            var url = this.baseUrl + \"/items(\" + id + \")\" + appendOData(odata);\n\t            return this._dao.get(url).then(utils_1.default.validateODataV2);\n\t        }\n\t    }, {\n\t        key: \"findItems\",\n\t        value: function findItems(key, value, odata) {\n\t            var filterValue = typeof value === \"string\" ? \"'\" + value + \"'\" : value;\n\t            odata = \"$filter=\" + key + \" eq \" + filterValue + appendOData(odata, \"&\");\n\t            return this.getItems(odata);\n\t        }\n\t    }, {\n\t        key: \"findItem\",\n\t        value: function findItem(key, value, odata) {\n\t            return this.findItems(key, value, odata).then(function (items) {\n\t                if (items && items.length && items.length > 0) return items[0];\n\t                return null;\n\t            });\n\t        }\n\t    }, {\n\t        key: \"getInfo\",\n\t        value: function getInfo() {\n\t            return this._dao.get(this.baseUrl).then(utils_1.default.validateODataV2);\n\t        }\n\t    }, {\n\t        key: \"addItem\",\n\t        value: function addItem(item, digest) {\n\t            var _this = this;\n\t\n\t            return this._dao.ensureRequestDigest(digest).then(function (digest) {\n\t                return _this._dao.get(_this.baseUrl).then(function (data) {\n\t                    //decorate the item with the 'type' metadata\n\t                    item = _extends({}, {\n\t                        \"__metadata\": {\n\t                            \"type\": data[\"d\"].ListItemEntityTypeFullName\n\t                        }\n\t                    }, item);\n\t                    var customOptions = {\n\t                        headers: headers_1.default.getAddHeaders(digest)\n\t                    };\n\t                    return _this._dao.post(_this.baseUrl + \"/items\", item, customOptions);\n\t                }).then(utils_1.default.validateODataV2);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"updateItem\",\n\t        value: function updateItem(itemId, updates, digest) {\n\t            var _this2 = this;\n\t\n\t            return this._dao.ensureRequestDigest(digest).then(function (digest) {\n\t                return _this2.getItemById(itemId).then(function (item) {\n\t                    //decorate the item with the 'type' metadata\n\t                    updates = _extends({}, {\n\t                        \"__metadata\": {\n\t                            \"type\": item[\"__metadata\"].type\n\t                        }\n\t                    }, updates);\n\t                    var customOptions = {\n\t                        headers: headers_1.default.getUpdateHeaders(digest, item[\"__metadata\"].etag)\n\t                    };\n\t                    return _this2._dao.post(item[\"__metadata\"].uri, updates, customOptions);\n\t                });\n\t            });\n\t        }\n\t    }, {\n\t        key: \"deleteItem\",\n\t        value: function deleteItem(itemId, digest) {\n\t            var _this3 = this;\n\t\n\t            return this._dao.ensureRequestDigest(digest).then(function (digest) {\n\t                return _this3.getItemById(itemId).then(function (item) {\n\t                    var customOptions = {\n\t                        headers: headers_1.default.getDeleteHeaders(digest, item[\"__metadata\"].etag)\n\t                    };\n\t                    return _this3._dao.post(item[\"__metadata\"].uri, \"\", customOptions);\n\t                });\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return List;\n\t}();\n\t\n\texports.default = List;\n\tvar appendOData = function appendOData(odata, prefix) {\n\t    prefix = prefix || \"?\";\n\t    if (odata) return prefix + odata;\n\t    return \"\";\n\t};\n\t//# sourceMappingURL=List.js.map\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar utils_1 = __webpack_require__(4);\n\tvar Context_1 = __webpack_require__(18);\n\tvar headers_1 = __webpack_require__(3);\n\t// export interface ISPScript {\n\t//     _env:string\n\t//     utils:Utils;\n\t//     createContext(url?:string): Context,\n\t//     headers:HeaderUtils,\n\t// }\n\t// var SPScript: ISPScript = {\n\texports.default = {\n\t    utils: utils_1.default,\n\t    createContext: Context_1.create,\n\t    _env: \"browser\",\n\t    headers: headers_1.default\n\t};\n\t// export default SPScript; \n\t//# sourceMappingURL=SPScript.js.map\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar request_1 = __webpack_require__(19);\n\tvar utils_1 = __webpack_require__(4);\n\tvar headers_1 = __webpack_require__(3);\n\tvar List_1 = __webpack_require__(16);\n\t// If no url and browser context, use w\n\tfunction create(url, clientId, clientSecret) {\n\t    try {\n\t        if (!url && global._spPageContextInfo) {\n\t            url = global._spPageContextInfo.webAbsoluteUrl;\n\t        }\n\t        return new Context(url);\n\t    } catch (ex) {\n\t        throw new Error(\"Unable to create SPScript Context: \" + ex.message);\n\t    }\n\t}\n\texports.create = create;\n\t\n\tvar Context = function () {\n\t    function Context(url, clientId, clientSecret) {\n\t        _classCallCheck(this, Context);\n\t\n\t        this.webUrl = url;\n\t        this.clientId = clientId;\n\t        this.clientSecret = clientSecret;\n\t        // TODO serverside: replace with tokenHelper.getAppOnlyToken(this.webUrl, this.clientKey, this.clientSecret).then(token => this.accessToken = token);\n\t        this.ensureToken = !clientId ? Promise.resolve() : Promise.resolve();\n\t    }\n\t\n\t    _createClass(Context, [{\n\t        key: \"executeRequest\",\n\t        value: function executeRequest(url, opts) {\n\t            var fullUrl = /^http/i.test(url) ? url : this.webUrl + \"/_api\" + url;\n\t            var defaultOptions = {\n\t                url: fullUrl,\n\t                method: \"GET\",\n\t                headers: {\n\t                    \"Accept\": \"application/json; odata=verbose\",\n\t                    \"Content-Type\": \"application/json; odata=verbose\"\n\t                }\n\t            };\n\t            if (this.accessToken) {\n\t                defaultOptions.headers['Authorization'] = 'Bearer ' + this.accessToken;\n\t            }\n\t            var requestOptions = _extends({}, defaultOptions, opts);\n\t            return request_1.default(requestOptions);\n\t        }\n\t    }, {\n\t        key: \"get\",\n\t        value: function get(url, opts) {\n\t            var options = _extends({}, { method: \"GET\" }, opts);\n\t            return this.executeRequest(url, options).then(utils_1.default.parseJSON);\n\t        }\n\t    }, {\n\t        key: \"post\",\n\t        value: function post(url, body, opts) {\n\t            body = this._packagePostBody(body, opts);\n\t            var options = {\n\t                method: \"POST\",\n\t                data: body\n\t            };\n\t            options = _extends({}, options, opts);\n\t            return this.executeRequest(url, options).then(utils_1.default.parseJSON);\n\t        }\n\t    }, {\n\t        key: \"authorizedPost\",\n\t        value: function authorizedPost(url, body, verb) {\n\t            var _this = this;\n\t\n\t            return this.getRequestDigest().then(function (digest) {\n\t                return headers_1.default.getActionHeaders(verb, digest);\n\t            }).then(function (headers) {\n\t                return _this.post(url, body, { headers: headers });\n\t            });\n\t        }\n\t    }, {\n\t        key: \"ensureRequestDigest\",\n\t        value: function ensureRequestDigest(digest) {\n\t            return digest ? Promise.resolve(digest) : this.getRequestDigest();\n\t        }\n\t    }, {\n\t        key: \"getRequestDigest\",\n\t        value: function getRequestDigest() {\n\t            return this.post(\"/contextInfo\", {}).then(function (data) {\n\t                return data[\"d\"].GetContextWebInformation.FormDigestValue;\n\t            });\n\t        }\n\t    }, {\n\t        key: \"lists\",\n\t        value: function lists(name) {\n\t            return new List_1.default(name, this);\n\t        }\n\t    }, {\n\t        key: \"_packagePostBody\",\n\t        value: function _packagePostBody(body, opts) {\n\t            // if its already a string just return\n\t            if (typeof body === \"string\") return body;\n\t            // if it has an explicit content-type, asssume the body is already that type\n\t            if (opts && opts.headers && opts.headers[\"Content-Type\"] && opts.headers[\"Content-Type\"].indexOf(\"json\") === -1) {\n\t                return body;\n\t            }\n\t            //others stringify\n\t            return JSON.stringify(body);\n\t        }\n\t    }]);\n\t\n\t    return Context;\n\t}();\n\t\n\texports.default = Context;\n\t//# sourceMappingURL=Context.js.map\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar xhr_1 = __webpack_require__(20);\n\tvar request = function request(options) {\n\t    // if node, use request-promise-native\n\t    // if fetch is available, use that\n\t    // else use xhr\n\t    if (typeof window === \"undefined\") {\n\t        throw new Error(\"No Node.js HTTP request module available yet.\");\n\t    }\n\t    return xhr_1.default(options);\n\t};\n\texports.default = request;\n\t//# sourceMappingURL=request.js.map\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar defaults = {\n\t    method: \"GET\",\n\t    async: true,\n\t    data: undefined\n\t};\n\tvar validMethods = [\"GET\", \"POST\", \"PUT\", \"HEAD\", \"DELETE\", \"PATCH\"];\n\tvar errorHandlers = [];\n\tvar validateOptions = function validateOptions(options) {\n\t    if (!options || !options.url || validMethods.indexOf(options.method) < 0) return false;else return true;\n\t};\n\tvar setHeaders = function setHeaders(xhr, headersObj) {\n\t    if (headersObj) {\n\t        Object.keys(headersObj).forEach(function (key) {\n\t            xhr.setRequestHeader(key, headersObj[key]);\n\t        });\n\t    }\n\t};\n\tvar xhr = function xhr(options) {\n\t    var opts = _extends({}, defaults, options);\n\t    if (!validateOptions(options)) return Promise.reject(new Error(\"Invalid options passed into ajax call.\"));\n\t    var xhr = new XMLHttpRequest();\n\t    if (xhr == null) return Promise.reject(new Error(\"Your browser doesn't support XMLHttpRequest (ajax).\"));\n\t    xhr.open(opts.method, opts.url, opts.async);\n\t    setHeaders(xhr, opts.headers);\n\t    xhr.responseType = \"json\";\n\t    return new Promise(function (resolve, reject) {\n\t        xhr.onreadystatechange = function () {\n\t            //completed\n\t            if (xhr.readyState === 4) {\n\t                // SUCCESS\n\t                if (xhr.status < 400 && xhr.status >= 100) {\n\t                    if (xhr.status >= 200 && xhr.status < 300 && xhr.status !== 204) {\n\t                        resolve(xhr.response || xhr.responseText);\n\t                    } else resolve(xhr.response);\n\t                } else {\n\t                    var error = { message: \"AJAX Request Error: Response Code = \" + xhr.status };\n\t                    error.statusCode = xhr.status;\n\t                    error.body = xhr.response;\n\t                    errorHandlers.forEach(function (fn) {\n\t                        return fn(error, xhr);\n\t                    });\n\t                    reject(error);\n\t                }\n\t            }\n\t        };\n\t        xhr.send(opts.data);\n\t    });\n\t};\n\txhr.addErrorHandler = function (fn) {\n\t    return errorHandlers.push(fn);\n\t};\n\txhr.setDefaults = function (options) {\n\t    return _extends(defaults, options);\n\t};\n\texports.default = xhr;\n\t//# sourceMappingURL=xhr.js.map\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// spscript.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 66cda6bfee26506be81b","\"use strict\";\r\nconst promise_polyfill_1 = require(\"promise-polyfill\");\r\nconst SPScript_1 = require(\"./SPScript\");\r\nif (!global.Promise) {\r\n    global.Promise = promise_polyfill_1.default;\r\n}\r\nmodule.exports = SPScript_1.default;\r\n//# sourceMappingURL=entry.browser.js.map\n\n\n// WEBPACK FOOTER //\n// ./lib/entry.browser.js","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n;\r\nconst jsonMimeType = \"application/json;odata=verbose\";\r\nfunction getStandardHeaders(digest) {\r\n    var headers = {\r\n        \"Accept\": jsonMimeType,\r\n        \"Content-Type\": jsonMimeType\r\n    };\r\n    if (digest)\r\n        headers[\"X-RequestDigest\"] = digest;\r\n    return headers;\r\n}\r\nvar getAddHeaders = getStandardHeaders;\r\nvar getFilestreamHeaders = function (digest) {\r\n    return {\r\n        'Accept': jsonMimeType,\r\n        'X-RequestDigest': digest,\r\n        'Content-Type': \"application/octet-stream\",\r\n        'binaryStringRequestBody': \"true\"\r\n    };\r\n};\r\nvar getActionHeaders = function (verb, digest) {\r\n    return Object.assign({}, getStandardHeaders(digest), {\r\n        \"X-HTTP-Method\": verb\r\n    });\r\n};\r\nvar decorateETag = function (headers, etag) {\r\n    if (etag)\r\n        headers[\"If-Match\"] = etag;\r\n    return headers;\r\n};\r\nvar getUpdateHeaders = (digest, etag) => decorateETag(getActionHeaders(\"MERGE\", digest), etag);\r\nvar getDeleteHeaders = (digest, etag) => decorateETag(getActionHeaders(\"DELETE\", digest), etag);\r\nvar headerUtils = {\r\n    getStandardHeaders,\r\n    getAddHeaders,\r\n    getFilestreamHeaders,\r\n    getActionHeaders,\r\n    getUpdateHeaders,\r\n    getDeleteHeaders,\r\n};\r\nexports.default = headerUtils;\r\n//# sourceMappingURL=headers.js.map\n\n\n// WEBPACK FOOTER //\n// ./lib/context/headers.js","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction parseJSON(data) {\r\n    if (typeof data === \"string\") {\r\n        try {\r\n            data = JSON.parse(data);\r\n        }\r\n        catch (e) {\r\n            return null;\r\n        }\r\n    }\r\n    return data;\r\n}\r\nfunction validateODataV2(data) {\r\n    data = parseJSON(data);\r\n    var results = null;\r\n    if (data.d && data.d.results && data.d.results.length != null) {\r\n        results = data.d.results;\r\n    }\r\n    else if (data.d) {\r\n        results = data.d;\r\n    }\r\n    return results || data;\r\n}\r\nvar utils = { parseJSON, validateODataV2 };\r\nexports.default = utils;\r\n//# sourceMappingURL=utils.js.map\n\n\n// WEBPACK FOOTER //\n// ./lib/utils.js","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/process/browser.js\n// module id = 7\n// module chunks = 0 1","(function (root) {\n\n  // Store setTimeout reference so promise-polyfill will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var setTimeoutFunc = setTimeout;\n\n  function noop() {}\n  \n  // Polyfill for Function.prototype.bind\n  function bind(fn, thisArg) {\n    return function () {\n      fn.apply(thisArg, arguments);\n    };\n  }\n\n  function Promise(fn) {\n    if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n    if (typeof fn !== 'function') throw new TypeError('not a function');\n    this._state = 0;\n    this._handled = false;\n    this._value = undefined;\n    this._deferreds = [];\n\n    doResolve(fn, this);\n  }\n\n  function handle(self, deferred) {\n    while (self._state === 3) {\n      self = self._value;\n    }\n    if (self._state === 0) {\n      self._deferreds.push(deferred);\n      return;\n    }\n    self._handled = true;\n    Promise._immediateFn(function () {\n      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n      if (cb === null) {\n        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n        return;\n      }\n      var ret;\n      try {\n        ret = cb(self._value);\n      } catch (e) {\n        reject(deferred.promise, e);\n        return;\n      }\n      resolve(deferred.promise, ret);\n    });\n  }\n\n  function resolve(self, newValue) {\n    try {\n      // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n      if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n        var then = newValue.then;\n        if (newValue instanceof Promise) {\n          self._state = 3;\n          self._value = newValue;\n          finale(self);\n          return;\n        } else if (typeof then === 'function') {\n          doResolve(bind(then, newValue), self);\n          return;\n        }\n      }\n      self._state = 1;\n      self._value = newValue;\n      finale(self);\n    } catch (e) {\n      reject(self, e);\n    }\n  }\n\n  function reject(self, newValue) {\n    self._state = 2;\n    self._value = newValue;\n    finale(self);\n  }\n\n  function finale(self) {\n    if (self._state === 2 && self._deferreds.length === 0) {\n      Promise._immediateFn(function() {\n        if (!self._handled) {\n          Promise._unhandledRejectionFn(self._value);\n        }\n      });\n    }\n\n    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n      handle(self, self._deferreds[i]);\n    }\n    self._deferreds = null;\n  }\n\n  function Handler(onFulfilled, onRejected, promise) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.promise = promise;\n  }\n\n  /**\n   * Take a potentially misbehaving resolver function and make sure\n   * onFulfilled and onRejected are only called once.\n   *\n   * Makes no guarantees about asynchrony.\n   */\n  function doResolve(fn, self) {\n    var done = false;\n    try {\n      fn(function (value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      }, function (reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      });\n    } catch (ex) {\n      if (done) return;\n      done = true;\n      reject(self, ex);\n    }\n  }\n\n  Promise.prototype['catch'] = function (onRejected) {\n    return this.then(null, onRejected);\n  };\n\n  Promise.prototype.then = function (onFulfilled, onRejected) {\n    var prom = new (this.constructor)(noop);\n\n    handle(this, new Handler(onFulfilled, onRejected, prom));\n    return prom;\n  };\n\n  Promise.all = function (arr) {\n    var args = Array.prototype.slice.call(arr);\n\n    return new Promise(function (resolve, reject) {\n      if (args.length === 0) return resolve([]);\n      var remaining = args.length;\n\n      function res(i, val) {\n        try {\n          if (val && (typeof val === 'object' || typeof val === 'function')) {\n            var then = val.then;\n            if (typeof then === 'function') {\n              then.call(val, function (val) {\n                res(i, val);\n              }, reject);\n              return;\n            }\n          }\n          args[i] = val;\n          if (--remaining === 0) {\n            resolve(args);\n          }\n        } catch (ex) {\n          reject(ex);\n        }\n      }\n\n      for (var i = 0; i < args.length; i++) {\n        res(i, args[i]);\n      }\n    });\n  };\n\n  Promise.resolve = function (value) {\n    if (value && typeof value === 'object' && value.constructor === Promise) {\n      return value;\n    }\n\n    return new Promise(function (resolve) {\n      resolve(value);\n    });\n  };\n\n  Promise.reject = function (value) {\n    return new Promise(function (resolve, reject) {\n      reject(value);\n    });\n  };\n\n  Promise.race = function (values) {\n    return new Promise(function (resolve, reject) {\n      for (var i = 0, len = values.length; i < len; i++) {\n        values[i].then(resolve, reject);\n      }\n    });\n  };\n\n  // Use polyfill for setImmediate for performance gains\n  Promise._immediateFn = (typeof setImmediate === 'function' && function (fn) { setImmediate(fn); }) ||\n    function (fn) {\n      setTimeoutFunc(fn, 0);\n    };\n\n  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n    if (typeof console !== 'undefined' && console) {\n      console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n    }\n  };\n\n  /**\n   * Set the immediate function to execute callbacks\n   * @param fn {function} Function to execute\n   * @deprecated\n   */\n  Promise._setImmediateFn = function _setImmediateFn(fn) {\n    Promise._immediateFn = fn;\n  };\n\n  /**\n   * Change the function to execute on unhandled rejection\n   * @param {function} fn Function to execute on unhandled rejection\n   * @deprecated\n   */\n  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n    Promise._unhandledRejectionFn = fn;\n  };\n  \n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = Promise;\n  } else if (!root.Promise) {\n    root.Promise = Promise;\n  }\n\n})(this);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/promise-polyfill/promise.js\n// module id = 8\n// module chunks = 0 1","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/setimmediate/setImmediate.js\n// module id = 9\n// module chunks = 0 1","var apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(window, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\nexports.setImmediate = setImmediate;\nexports.clearImmediate = clearImmediate;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/timers-browserify/main.js\n// module id = 10\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst utils_1 = require(\"./utils\");\r\nconst headers_1 = require(\"./context/headers\");\r\nclass List {\r\n    // TODO permissions. Inherit securable?\r\n    constructor(name, ctx) {\r\n        this.listName = name;\r\n        this.baseUrl = `/web/lists/getbytitle('${this.listName}')`;\r\n        this._dao = ctx;\r\n    }\r\n    ;\r\n    getItems(odata) {\r\n        return this._dao\r\n            .get(this.baseUrl + \"/items\" + appendOData(odata))\r\n            .then(utils_1.default.validateODataV2);\r\n    }\r\n    ;\r\n    getItemById(id, odata) {\r\n        var url = this.baseUrl + \"/items(\" + id + \")\" + appendOData(odata);\r\n        return this._dao.get(url).then(utils_1.default.validateODataV2);\r\n    }\r\n    ;\r\n    findItems(key, value, odata) {\r\n        var filterValue = typeof value === \"string\" ? \"'\" + value + \"'\" : value;\r\n        odata = \"$filter=\" + key + \" eq \" + filterValue + appendOData(odata, \"&\");\r\n        return this.getItems(odata);\r\n    }\r\n    ;\r\n    findItem(key, value, odata) {\r\n        return this.findItems(key, value, odata)\r\n            .then(items => {\r\n            if (items && items.length && items.length > 0)\r\n                return items[0];\r\n            return null;\r\n        });\r\n    }\r\n    ;\r\n    getInfo() {\r\n        return this._dao.get(this.baseUrl).then(utils_1.default.validateODataV2);\r\n    }\r\n    ;\r\n    addItem(item, digest) {\r\n        return this._dao.ensureRequestDigest(digest).then(digest => {\r\n            return this._dao.get(this.baseUrl).then(data => {\r\n                //decorate the item with the 'type' metadata\r\n                item = Object.assign({}, {\r\n                    \"__metadata\": {\r\n                        \"type\": data[\"d\"].ListItemEntityTypeFullName\r\n                    }\r\n                }, item);\r\n                var customOptions = {\r\n                    headers: headers_1.default.getAddHeaders(digest)\r\n                };\r\n                return this._dao.post(this.baseUrl + \"/items\", item, customOptions);\r\n            })\r\n                .then(utils_1.default.validateODataV2);\r\n        });\r\n    }\r\n    ;\r\n    updateItem(itemId, updates, digest) {\r\n        return this._dao.ensureRequestDigest(digest).then(digest => {\r\n            return this.getItemById(itemId).then(item => {\r\n                //decorate the item with the 'type' metadata\r\n                updates = Object.assign({}, {\r\n                    \"__metadata\": {\r\n                        \"type\": item[\"__metadata\"].type\r\n                    }\r\n                }, updates);\r\n                var customOptions = {\r\n                    headers: headers_1.default.getUpdateHeaders(digest, item[\"__metadata\"].etag)\r\n                };\r\n                return this._dao.post(item[\"__metadata\"].uri, updates, customOptions);\r\n            });\r\n        });\r\n    }\r\n    ;\r\n    deleteItem(itemId, digest) {\r\n        return this._dao.ensureRequestDigest(digest).then(digest => {\r\n            return this.getItemById(itemId).then(item => {\r\n                var customOptions = {\r\n                    headers: headers_1.default.getDeleteHeaders(digest, item[\"__metadata\"].etag)\r\n                };\r\n                return this._dao.post(item[\"__metadata\"].uri, \"\", customOptions);\r\n            });\r\n        });\r\n    }\r\n    ;\r\n}\r\nexports.default = List;\r\nvar appendOData = function (odata, prefix) {\r\n    prefix = prefix || \"?\";\r\n    if (odata)\r\n        return prefix + odata;\r\n    return \"\";\r\n};\r\n//# sourceMappingURL=List.js.map\n\n\n// WEBPACK FOOTER //\n// ./lib/List.js","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst utils_1 = require(\"./utils\");\r\nconst Context_1 = require(\"./context/Context\");\r\nconst headers_1 = require(\"./context/headers\");\r\n// export interface ISPScript {\r\n//     _env:string\r\n//     utils:Utils;\r\n//     createContext(url?:string): Context,\r\n//     headers:HeaderUtils,\r\n// }\r\n// var SPScript: ISPScript = {\r\nexports.default = {\r\n    utils: utils_1.default,\r\n    createContext: Context_1.create,\r\n    _env: \"browser\",\r\n    headers: headers_1.default\r\n};\r\n// export default SPScript; \r\n//# sourceMappingURL=SPScript.js.map\n\n\n// WEBPACK FOOTER //\n// ./lib/SPScript.js","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst request_1 = require(\"./request\");\r\nconst utils_1 = require(\"../utils\");\r\nconst headers_1 = require(\"./headers\");\r\nconst List_1 = require(\"../List\");\r\n// If no url and browser context, use w\r\nfunction create(url, clientId, clientSecret) {\r\n    try {\r\n        if (!url && global._spPageContextInfo) {\r\n            url = global._spPageContextInfo.webAbsoluteUrl;\r\n        }\r\n        return new Context(url);\r\n    }\r\n    catch (ex) {\r\n        throw new Error(\"Unable to create SPScript Context: \" + ex.message);\r\n    }\r\n}\r\nexports.create = create;\r\nclass Context {\r\n    constructor(url, clientId, clientSecret) {\r\n        this.webUrl = url;\r\n        this.clientId = clientId;\r\n        this.clientSecret = clientSecret;\r\n        // TODO serverside: replace with tokenHelper.getAppOnlyToken(this.webUrl, this.clientKey, this.clientSecret).then(token => this.accessToken = token);\r\n        this.ensureToken = !clientId ? Promise.resolve() : Promise.resolve();\r\n    }\r\n    executeRequest(url, opts) {\r\n        var fullUrl = (/^http/i).test(url) ? url : this.webUrl + \"/_api\" + url;\r\n        var defaultOptions = {\r\n            url: fullUrl,\r\n            method: \"GET\",\r\n            headers: {\r\n                \"Accept\": \"application/json; odata=verbose\",\r\n                \"Content-Type\": \"application/json; odata=verbose\"\r\n            }\r\n        };\r\n        if (this.accessToken) {\r\n            defaultOptions.headers['Authorization'] = 'Bearer ' + this.accessToken;\r\n        }\r\n        var requestOptions = Object.assign({}, defaultOptions, opts);\r\n        return request_1.default(requestOptions);\r\n    }\r\n    ;\r\n    get(url, opts) {\r\n        let options = Object.assign({}, { method: \"GET\" }, opts);\r\n        return this.executeRequest(url, options).then(utils_1.default.parseJSON);\r\n    }\r\n    ;\r\n    post(url, body, opts) {\r\n        body = this._packagePostBody(body, opts);\r\n        var options = {\r\n            method: \"POST\",\r\n            data: body,\r\n        };\r\n        options = Object.assign({}, options, opts);\r\n        return this.executeRequest(url, options).then(utils_1.default.parseJSON);\r\n    }\r\n    ;\r\n    authorizedPost(url, body, verb) {\r\n        return this.getRequestDigest()\r\n            .then(digest => headers_1.default.getActionHeaders(verb, digest))\r\n            .then(headers => this.post(url, body, { headers }));\r\n    }\r\n    ;\r\n    ensureRequestDigest(digest) {\r\n        return digest ? Promise.resolve(digest) : this.getRequestDigest();\r\n    }\r\n    ;\r\n    getRequestDigest() {\r\n        return this.post(\"/contextInfo\", {}).then(data => data[\"d\"].GetContextWebInformation.FormDigestValue);\r\n    }\r\n    ;\r\n    lists(name) {\r\n        return new List_1.default(name, this);\r\n    }\r\n    _packagePostBody(body, opts) {\r\n        // if its already a string just return\r\n        if (typeof body === \"string\")\r\n            return body;\r\n        // if it has an explicit content-type, asssume the body is already that type\r\n        if (opts && opts.headers && opts.headers[\"Content-Type\"] && opts.headers[\"Content-Type\"].indexOf(\"json\") === -1) {\r\n            return body;\r\n        }\r\n        //others stringify\r\n        return JSON.stringify(body);\r\n    }\r\n    ;\r\n}\r\nexports.default = Context;\r\n//# sourceMappingURL=Context.js.map\n\n\n// WEBPACK FOOTER //\n// ./lib/context/Context.js","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst xhr_1 = require(\"./xhr\");\r\nvar request = function (options) {\r\n    // if node, use request-promise-native\r\n    // if fetch is available, use that\r\n    // else use xhr\r\n    if (typeof window === \"undefined\") {\r\n        throw new Error(\"No Node.js HTTP request module available yet.\");\r\n    }\r\n    return xhr_1.default(options);\r\n};\r\nexports.default = request;\r\n//# sourceMappingURL=request.js.map\n\n\n// WEBPACK FOOTER //\n// ./lib/context/request.js","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar defaults = {\r\n    method: \"GET\",\r\n    async: true,\r\n    data: undefined\r\n};\r\nvar validMethods = [\r\n    \"GET\",\r\n    \"POST\",\r\n    \"PUT\",\r\n    \"HEAD\",\r\n    \"DELETE\",\r\n    \"PATCH\"\r\n];\r\nvar errorHandlers = [];\r\nvar validateOptions = function (options) {\r\n    if (!options || !options.url || validMethods.indexOf(options.method) < 0)\r\n        return false;\r\n    else\r\n        return true;\r\n};\r\nvar setHeaders = function (xhr, headersObj) {\r\n    if (headersObj) {\r\n        Object.keys(headersObj).forEach(key => {\r\n            xhr.setRequestHeader(key, headersObj[key]);\r\n        });\r\n    }\r\n};\r\nvar xhr = function (options) {\r\n    var opts = Object.assign({}, defaults, options);\r\n    if (!validateOptions(options))\r\n        return Promise.reject(new Error(\"Invalid options passed into ajax call.\"));\r\n    var xhr = new XMLHttpRequest();\r\n    if (xhr == null)\r\n        return Promise.reject(new Error(\"Your browser doesn't support XMLHttpRequest (ajax).\"));\r\n    xhr.open(opts.method, opts.url, opts.async);\r\n    setHeaders(xhr, opts.headers);\r\n    xhr.responseType = \"json\";\r\n    return new Promise((resolve, reject) => {\r\n        xhr.onreadystatechange = function () {\r\n            //completed\r\n            if (xhr.readyState === 4) {\r\n                // SUCCESS\r\n                if (xhr.status < 400 && xhr.status >= 100) {\r\n                    if (xhr.status >= 200 && xhr.status < 300 && xhr.status !== 204) {\r\n                        resolve(xhr.response || xhr.responseText);\r\n                    }\r\n                    else\r\n                        resolve(xhr.response);\r\n                }\r\n                else {\r\n                    var error = { message: \"AJAX Request Error: Response Code = \" + xhr.status };\r\n                    error.statusCode = xhr.status;\r\n                    error.body = xhr.response;\r\n                    errorHandlers.forEach(fn => fn(error, xhr));\r\n                    reject(error);\r\n                }\r\n            }\r\n        };\r\n        xhr.send(opts.data);\r\n    });\r\n};\r\nxhr.addErrorHandler = (fn) => errorHandlers.push(fn);\r\nxhr.setDefaults = (options) => Object.assign(defaults, options);\r\nexports.default = xhr;\r\n//# sourceMappingURL=xhr.js.map\n\n\n// WEBPACK FOOTER //\n// ./lib/context/xhr.js"],"sourceRoot":""}