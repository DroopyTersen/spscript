!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(t){"use strict";var r=n(8),o=n(17);t.Promise||(t.Promise=r.default),e.exports=o.default}).call(t,function(){return this}())},,,function(e,t){"use strict";function n(e){var t={Accept:o,"Content-Type":o};return e&&(t["X-RequestDigest"]=e),t}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var o="application/json;odata=verbose",i=n,a=function(e){return{Accept:o,"X-RequestDigest":e,"Content-Type":"application/octet-stream",binaryStringRequestBody:"true"}},u=function(e,t){return r({},n(t),{"X-HTTP-Method":e})},s=function(e,t){return t&&(e["If-Match"]=t),e},c=function(e,t){return s(u("MERGE",e),t)},f=function(e,t){return s(u("DELETE",e),t)},l={getStandardHeaders:n,getAddHeaders:i,getFilestreamHeaders:a,getActionHeaders:u,getUpdateHeaders:c,getDeleteHeaders:f};t.default=l},function(e,t){"use strict";function n(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return null}return e}function r(e){e=n(e);var t=null;return e.d&&e.d.results&&null!=e.d.results.length?t=e.d.results:e.d&&(t=e.d),t||e}Object.defineProperty(t,"__esModule",{value:!0});var o={parseJSON:n,validateODataV2:r};t.default=o},,,function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function a(){v&&h&&(v=!1,h.length?p=h.concat(p):m=-1,p.length&&u())}function u(){if(!v){var e=o(a);v=!0;for(var t=p.length;t;){for(h=p,p=[];++m<t;)h&&h[m].run();m=-1,t=p.length}h=null,v=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function c(){}var f,l,d=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var h,p=[],v=!1,m=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new s(e,t)),1!==p.length||v||o(u)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){(function(t){!function(n){function r(){}function o(e,t){return function(){e.apply(t,arguments)}}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function a(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void i._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?u:s)(t.promise,e._value);var r;try{r=n(e._value)}catch(e){return void s(t.promise,e)}u(t.promise,r)}))}function u(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void c(e);if("function"==typeof n)return void l(o(n,t),e)}e._state=1,e._value=t,c(e)}catch(t){s(e,t)}}function s(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function f(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}var d=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return a(this,new f(e,t,n)),n},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){function r(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var u=a.then;if("function"==typeof u)return void u.call(a,function(e){r(i,e)},n)}t[i]=a,0===--o&&e(t)}catch(e){n(e)}}if(0===t.length)return e([]);for(var o=t.length,i=0;i<t.length;i++)r(i,t[i])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)})},i._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){d(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},"undefined"!=typeof e&&e.exports?e.exports=i:n.Promise||(n.Promise=i)}(this)}).call(t,n(10).setImmediate)},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return v[p]=r,h(p),p++}function o(e){delete v[e]}function i(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(m)setTimeout(a,0,e);else{var t=v[e];if(t){m=!0;try{i(t)}finally{o(e),m=!1}}}}function u(){h=function(e){t.nextTick(function(){a(e)})}}function s(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function c(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),h=function(n){e.postMessage(t+n,"*")}}function f(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;a(t)},h=function(t){e.port2.postMessage(t)}}function l(){var e=y.documentElement;h=function(t){var n=y.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function d(){h=function(e){setTimeout(a,0,e)}}if(!e.setImmediate){var h,p=1,v={},m=!1,y=e.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(e);g=g&&g.setTimeout?g:e,"[object process]"==={}.toString.call(e.process)?u():s()?c():e.MessageChannel?f():y&&"onreadystatechange"in y.createElement("script")?l():d(),g.setImmediate=r,g.clearImmediate=o}}("undefined"==typeof self?"undefined"==typeof e?this:e:self)}).call(t,function(){return this}(),n(7))},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var o=Function.prototype.apply;t.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(9),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},,,,,,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),u=n(3),s=function(){function e(t,n){r(this,e),this.listName=t,this.baseUrl="/web/lists/getbytitle('"+this.listName+"')",this._dao=n}return i(e,[{key:"getItems",value:function(e){return this._dao.get(this.baseUrl+"/items"+c(e)).then(a.default.validateODataV2)}},{key:"getItemById",value:function(e,t){var n=this.baseUrl+"/items("+e+")"+c(t);return this._dao.get(n).then(a.default.validateODataV2)}},{key:"findItems",value:function(e,t,n){var r="string"==typeof t?"'"+t+"'":t;return n="$filter="+e+" eq "+r+c(n,"&"),this.getItems(n)}},{key:"findItem",value:function(e,t,n){return this.findItems(e,t,n).then(function(e){return e&&e.length&&e.length>0?e[0]:null})}},{key:"getInfo",value:function(){return this._dao.get(this.baseUrl).then(a.default.validateODataV2)}},{key:"addItem",value:function(e,t){var n=this;return this._dao.ensureRequestDigest(t).then(function(t){return n._dao.get(n.baseUrl).then(function(r){e=o({},{__metadata:{type:r.d.ListItemEntityTypeFullName}},e);var i={headers:u.default.getAddHeaders(t)};return n._dao.post(n.baseUrl+"/items",e,i)}).then(a.default.validateODataV2)})}},{key:"updateItem",value:function(e,t,n){var r=this;return this._dao.ensureRequestDigest(n).then(function(n){return r.getItemById(e).then(function(e){t=o({},{__metadata:{type:e.__metadata.type}},t);var i={headers:u.default.getUpdateHeaders(n,e.__metadata.etag)};return r._dao.post(e.__metadata.uri,t,i)})})}},{key:"deleteItem",value:function(e,t){var n=this;return this._dao.ensureRequestDigest(t).then(function(t){return n.getItemById(e).then(function(e){var r={headers:u.default.getDeleteHeaders(t,e.__metadata.etag)};return n._dao.post(e.__metadata.uri,"",r)})})}}]),e}();t.default=s;var c=function(e,t){return t=t||"?",e?t+e:""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(18),i=n(3);t.default={utils:r.default,createContext:o.create,_env:"browser",headers:i.default}},function(e,t,n){(function(e){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(t,n,r){try{return!t&&e._spPageContextInfo&&(t=e._spPageContextInfo.webAbsoluteUrl),new l(t)}catch(e){throw new Error("Unable to create SPScript Context: "+e.message)}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=n(19),s=n(4),c=n(3),f=n(16);t.create=o;var l=function(){function e(t,n,o){r(this,e),this.webUrl=t,this.clientId=n,this.clientSecret=o,this.ensureToken=n?Promise.resolve():Promise.resolve()}return a(e,[{key:"executeRequest",value:function(e,t){var n=/^http/i.test(e)?e:this.webUrl+"/_api"+e,r={url:n,method:"GET",headers:{Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}};this.accessToken&&(r.headers.Authorization="Bearer "+this.accessToken);var o=i({},r,t);return u.default(o)}},{key:"get",value:function(e,t){var n=i({},{method:"GET"},t);return this.executeRequest(e,n).then(s.default.parseJSON)}},{key:"post",value:function(e,t,n){t=this._packagePostBody(t,n);var r={method:"POST",data:t};return r=i({},r,n),this.executeRequest(e,r).then(s.default.parseJSON)}},{key:"authorizedPost",value:function(e,t,n){var r=this;return this.getRequestDigest().then(function(e){return c.default.getActionHeaders(n,e)}).then(function(n){return r.post(e,t,{headers:n})})}},{key:"ensureRequestDigest",value:function(e){return e?Promise.resolve(e):this.getRequestDigest()}},{key:"getRequestDigest",value:function(){return this.post("/contextInfo",{}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})}},{key:"lists",value:function(e){return new f.default(e,this)}},{key:"_packagePostBody",value:function(e,t){return"string"==typeof e?e:t&&t.headers&&t.headers["Content-Type"]&&t.headers["Content-Type"].indexOf("json")===-1?e:JSON.stringify(e)}}]),e}();t.default=l}).call(t,function(){return this}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),o=function(e){if("undefined"==typeof window)throw new Error("No Node.js HTTP request module available yet.");return r.default(e)};t.default=o},function(e,t){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r={method:"GET",async:!0,data:void 0},o=["GET","POST","PUT","HEAD","DELETE","PATCH"],i=[],a=function(e){return!(!e||!e.url||o.indexOf(e.method)<0)},u=function(e,t){t&&Object.keys(t).forEach(function(n){e.setRequestHeader(n,t[n])})},s=function e(t){var o=n({},r,t);if(!a(t))return Promise.reject(new Error("Invalid options passed into ajax call."));var e=new XMLHttpRequest;return null==e?Promise.reject(new Error("Your browser doesn't support XMLHttpRequest (ajax).")):(e.open(o.method,o.url,o.async),u(e,o.headers),e.responseType="json",new Promise(function(t,n){e.onreadystatechange=function(){if(4===e.readyState)if(e.status<400&&e.status>=100)t(e.status>=200&&e.status<300&&204!==e.status?e.response||e.responseText:e.response);else{var r={message:"AJAX Request Error: Response Code = "+e.status};r.statusCode=e.status,r.body=e.response,i.forEach(function(t){return t(r,e)}),n(r)}},e.send(o.data)}))};s.addErrorHandler=function(e){return i.push(e)},s.setDefaults=function(e){return n(r,e)},t.default=s}]);
//# sourceMappingURL=spscript.js.map