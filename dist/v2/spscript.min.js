(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)})([function(module,exports,__webpack_require__){(function(global){var promisePolyfill=__webpack_require__(4);if(!global.Promise){global.Promise=promisePolyfill}var SPScript={};SPScript.RestDao=__webpack_require__(7);SPScript.queryString=__webpack_require__(17);SPScript.templating=__webpack_require__(23);SPScript.templating.renderTemplate=SPScript.templating.render;SPScript.utils=__webpack_require__(10);SPScript.ajax=__webpack_require__(22);SPScript.CSR=__webpack_require__(24);module.exports=global.SPScript=SPScript}).call(exports,function(){return this}())},,,,function(module,exports,__webpack_require__){var require;(function(process,global){(function(global,factory){true?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.ES6Promise=factory()})(this,function(){"use strict";function objectOrFunction(x){return typeof x==="function"||typeof x==="object"&&x!==null}function isFunction(x){return typeof x==="function"}var _isArray=undefined;if(!Array.isArray){_isArray=function(x){return Object.prototype.toString.call(x)==="[object Array]"}}else{_isArray=Array.isArray}var isArray=_isArray;var len=0;var vertxNext=undefined;var customSchedulerFn=undefined;var asap=function asap(callback,arg){queue[len]=callback;queue[len+1]=arg;len+=2;if(len===2){if(customSchedulerFn){customSchedulerFn(flush)}else{scheduleFlush()}}};function setScheduler(scheduleFn){customSchedulerFn=scheduleFn}function setAsap(asapFn){asap=asapFn}var browserWindow=typeof window!=="undefined"?window:undefined;var browserGlobal=browserWindow||{};var BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver;var isNode=typeof self==="undefined"&&typeof process!=="undefined"&&{}.toString.call(process)==="[object process]";var isWorker=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function useNextTick(){return function(){return process.nextTick(flush)}}function useVertxTimer(){return function(){vertxNext(flush)}}function useMutationObserver(){var iterations=0;var observer=new BrowserMutationObserver(flush);var node=document.createTextNode("");observer.observe(node,{characterData:true});return function(){node.data=iterations=++iterations%2}}function useMessageChannel(){var channel=new MessageChannel;channel.port1.onmessage=flush;return function(){return channel.port2.postMessage(0)}}function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1)}}var queue=new Array(1e3);function flush(){for(var i=0;i<len;i+=2){var callback=queue[i];var arg=queue[i+1];callback(arg);queue[i]=undefined;queue[i+1]=undefined}len=0}function attemptVertx(){try{var r=require;var vertx=__webpack_require__(6);vertxNext=vertx.runOnLoop||vertx.runOnContext;return useVertxTimer()}catch(e){return useSetTimeout()}}var scheduleFlush=undefined;if(isNode){scheduleFlush=useNextTick()}else if(BrowserMutationObserver){scheduleFlush=useMutationObserver()}else if(isWorker){scheduleFlush=useMessageChannel()}else if(browserWindow===undefined&&"function"==="function"){scheduleFlush=attemptVertx()}else{scheduleFlush=useSetTimeout()}function then(onFulfillment,onRejection){var _arguments=arguments;var parent=this;var child=new this.constructor(noop);if(child[PROMISE_ID]===undefined){makePromise(child)}var _state=parent._state;if(_state){(function(){var callback=_arguments[_state-1];asap(function(){return invokeCallback(_state,child,callback,parent._result)})})()}else{subscribe(parent,child,onFulfillment,onRejection)}return child}function resolve(object){var Constructor=this;if(object&&typeof object==="object"&&object.constructor===Constructor){return object}var promise=new Constructor(noop);_resolve(promise,object);return promise}var PROMISE_ID=Math.random().toString(36).substring(16);function noop(){}var PENDING=void 0;var FULFILLED=1;var REJECTED=2;var GET_THEN_ERROR=new ErrorObject;function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function getThen(promise){try{return promise.then}catch(error){GET_THEN_ERROR.error=error;return GET_THEN_ERROR}}function tryThen(then,value,fulfillmentHandler,rejectionHandler){try{then.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function handleForeignThenable(promise,thenable,then){asap(function(promise){var sealed=false;var error=tryThen(then,thenable,function(value){if(sealed){return}sealed=true;if(thenable!==value){_resolve(promise,value)}else{fulfill(promise,value)}},function(reason){if(sealed){return}sealed=true;_reject(promise,reason)},"Settle: "+(promise._label||" unknown promise"));if(!sealed&&error){sealed=true;_reject(promise,error)}},promise)}function handleOwnThenable(promise,thenable){if(thenable._state===FULFILLED){fulfill(promise,thenable._result)}else if(thenable._state===REJECTED){_reject(promise,thenable._result)}else{subscribe(thenable,undefined,function(value){return _resolve(promise,value)},function(reason){return _reject(promise,reason)})}}function handleMaybeThenable(promise,maybeThenable,then$$){if(maybeThenable.constructor===promise.constructor&&then$$===then&&maybeThenable.constructor.resolve===resolve){handleOwnThenable(promise,maybeThenable)}else{if(then$$===GET_THEN_ERROR){_reject(promise,GET_THEN_ERROR.error)}else if(then$$===undefined){fulfill(promise,maybeThenable)}else if(isFunction(then$$)){handleForeignThenable(promise,maybeThenable,then$$)}else{fulfill(promise,maybeThenable)}}}function _resolve(promise,value){if(promise===value){_reject(promise,selfFulfillment())}else if(objectOrFunction(value)){handleMaybeThenable(promise,value,getThen(value))}else{fulfill(promise,value)}}function publishRejection(promise){if(promise._onerror){promise._onerror(promise._result)}publish(promise)}function fulfill(promise,value){if(promise._state!==PENDING){return}promise._result=value;promise._state=FULFILLED;if(promise._subscribers.length!==0){asap(publish,promise)}}function _reject(promise,reason){if(promise._state!==PENDING){return}promise._state=REJECTED;promise._result=reason;asap(publishRejection,promise)}function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers;var length=_subscribers.length;parent._onerror=null;_subscribers[length]=child;_subscribers[length+FULFILLED]=onFulfillment;_subscribers[length+REJECTED]=onRejection;if(length===0&&parent._state){asap(publish,parent)}}function publish(promise){var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0){return}var child=undefined,callback=undefined,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child){invokeCallback(settled,child,callback,detail)}else{callback(detail)}}promise._subscribers.length=0}function ErrorObject(){this.error=null}var TRY_CATCH_ERROR=new ErrorObject;function tryCatch(callback,detail){try{return callback(detail)}catch(e){TRY_CATCH_ERROR.error=e;return TRY_CATCH_ERROR}}function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value=undefined,error=undefined,succeeded=undefined,failed=undefined;if(hasCallback){value=tryCatch(callback,detail);if(value===TRY_CATCH_ERROR){failed=true;error=value.error;value=null}else{succeeded=true}if(promise===value){_reject(promise,cannotReturnOwn());return}}else{value=detail;succeeded=true}if(promise._state!==PENDING){}else if(hasCallback&&succeeded){_resolve(promise,value)}else if(failed){_reject(promise,error)}else if(settled===FULFILLED){fulfill(promise,value)}else if(settled===REJECTED){_reject(promise,value)}}function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){_resolve(promise,value)},function rejectPromise(reason){_reject(promise,reason)})}catch(e){_reject(promise,e)}}var id=0;function nextId(){return id++}function makePromise(promise){promise[PROMISE_ID]=id++;promise._state=undefined;promise._result=undefined;promise._subscribers=[]}function Enumerator(Constructor,input){this._instanceConstructor=Constructor;this.promise=new Constructor(noop);if(!this.promise[PROMISE_ID]){makePromise(this.promise)}if(isArray(input)){this._input=input;this.length=input.length;this._remaining=input.length;this._result=new Array(this.length);if(this.length===0){fulfill(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){fulfill(this.promise,this._result)}}}else{_reject(this.promise,validationError())}}function validationError(){return new Error("Array Methods must be provided an Array")}Enumerator.prototype._enumerate=function(){var length=this.length;var _input=this._input;for(var i=0;this._state===PENDING&&i<length;i++){this._eachEntry(_input[i],i)}};Enumerator.prototype._eachEntry=function(entry,i){var c=this._instanceConstructor;var resolve$$=c.resolve;if(resolve$$===resolve){var _then=getThen(entry);if(_then===then&&entry._state!==PENDING){this._settledAt(entry._state,i,entry._result)}else if(typeof _then!=="function"){this._remaining--;this._result[i]=entry}else if(c===Promise){var promise=new c(noop);handleMaybeThenable(promise,entry,_then);this._willSettleAt(promise,i)}else{this._willSettleAt(new c(function(resolve$$){return resolve$$(entry)}),i)}}else{this._willSettleAt(resolve$$(entry),i)}};Enumerator.prototype._settledAt=function(state,i,value){var promise=this.promise;if(promise._state===PENDING){this._remaining--;if(state===REJECTED){_reject(promise,value)}else{this._result[i]=value}}if(this._remaining===0){fulfill(promise,this._result)}};Enumerator.prototype._willSettleAt=function(promise,i){var enumerator=this;subscribe(promise,undefined,function(value){return enumerator._settledAt(FULFILLED,i,value)},function(reason){return enumerator._settledAt(REJECTED,i,reason)})};function all(entries){return new Enumerator(this,entries).promise}function race(entries){var Constructor=this;if(!isArray(entries)){return new Constructor(function(_,reject){return reject(new TypeError("You must pass an array to race."))})}else{return new Constructor(function(resolve,reject){var length=entries.length;for(var i=0;i<length;i++){Constructor.resolve(entries[i]).then(resolve,reject)}})}}function reject(reason){var Constructor=this;var promise=new Constructor(noop);_reject(promise,reason);return promise}function needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Promise(resolver){this[PROMISE_ID]=nextId();this._result=this._state=undefined;this._subscribers=[];if(noop!==resolver){typeof resolver!=="function"&&needsResolver();this instanceof Promise?initializePromise(this,resolver):needsNew()}}Promise.all=all;Promise.race=race;Promise.resolve=resolve;Promise.reject=reject;Promise._setScheduler=setScheduler;Promise._setAsap=setAsap;Promise._asap=asap;Promise.prototype={constructor:Promise,then:then,catch:function _catch(onRejection){return this.then(null,onRejection)}};function polyfill(){var local=undefined;if(typeof global!=="undefined"){local=global}else if(typeof self!=="undefined"){local=self}else{try{local=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve())}catch(e){}if(promiseToString==="[object Promise]"&&!P.cast){return}}local.Promise=Promise}polyfill();Promise.polyfill=polyfill;Promise.Promise=Promise;return Promise})}).call(exports,__webpack_require__(5),function(){return this}())},function(module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},function(module,exports){},function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var BaseDao=__webpack_require__(8);var ajax=__webpack_require__(22);var utils=__webpack_require__(10);var RestDao=function RestDao(url){var self=this;BaseDao.call(this);this.webUrl=url||_spPageContextInfo.webAbsoluteUrl};RestDao.prototype=Object.create(BaseDao.prototype);RestDao.prototype.executeRequest=function(url,options){var fullUrl=/^http/i.test(url)?url:this.webUrl+"/_api"+url;var defaultOptions={url:fullUrl,method:"GET",headers:{Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}};var ajaxOptions=_extends({},defaultOptions,options);return ajax(ajaxOptions).catch(utils.handleErrorResponse)};module.exports=RestDao},function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var List=__webpack_require__(9);var Web=__webpack_require__(13);var Profiles=__webpack_require__(15);var Search=__webpack_require__(16);var utils=__webpack_require__(10);var CustomActions=__webpack_require__(21);var BaseDao=function BaseDao(){this.web=new Web(this);this.search=new Search(this);this.profiles=new Profiles(this);this.customActions=new CustomActions(this)};BaseDao.prototype.executeRequest=function(){throw"Not implemented exception"};BaseDao.prototype.get=function(relativeQueryUrl,extendedOptions){var options=_extends({},{method:"GET"},extendedOptions);return this.executeRequest(relativeQueryUrl,options).then(utils.parseJSON)};BaseDao.prototype.getRequestDigest=function(){return this.web.getRequestDigest()};BaseDao.prototype.lists=function(listname){if(!listname){return this.get("/web/lists").then(utils.validateODataV2)}return new List(listname,this)};BaseDao.prototype.post=function(relativePostUrl,body,opts){body=packagePostBody(body,opts);var options={method:"POST",data:body};options=_extends({},options,opts);return this.executeRequest(relativePostUrl,options).then(utils.parseJSON)};var packagePostBody=function packagePostBody(body,opts){if(typeof body==="string")return body;if(opts&&opts.headers&&opts.headers["Content-Type"]&&opts.headers["Content-Type"].indexOf("json")===-1){return body}return JSON.stringify(body)};module.exports=BaseDao},function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var utils=__webpack_require__(10);var Permissions=__webpack_require__(11);var headers=__webpack_require__(12);var List=function List(listname,dao){this.listname=listname;this.baseUrl="/web/lists/getbytitle('"+listname+"')";this._dao=dao;this.permissions=new Permissions(this.baseUrl,this._dao)};List.prototype.getItems=function(odataQuery){return this._dao.get(this.baseUrl+"/items"+appendOData(odataQuery)).then(utils.validateODataV2)};List.prototype.getItemById=function(id,odata){var url=this.baseUrl+"/items("+id+")"+appendOData(odata);return this._dao.get(url).then(utils.validateODataV2)};List.prototype.info=function(){return this._dao.get(this.baseUrl).then(utils.validateODataV2)};List.prototype.addItem=function(item,requestDigest){var _this=this;if(requestDigest)return this._addItem(item,requestDigest);return this._dao.getRequestDigest().then(function(requestDigest){return _this._addItem(item,requestDigest)})};List.prototype._addItem=function(item,requestDigest){var _this2=this;return this._dao.get(this.baseUrl).then(function(data){item=_extends({},{__metadata:{type:data.d.ListItemEntityTypeFullName}},item);var customOptions={headers:headers.getAddHeaders(requestDigest)};return _this2._dao.post(_this2.baseUrl+"/items",item,customOptions)}).then(utils.validateODataV2)};List.prototype.updateItem=function(itemId,updates,requestDigest){var _this3=this;if(requestDigest)return this._updateItem(itemId,updates,requestDigest);return this._dao.getRequestDigest().then(function(requestDigest){return _this3._updateItem(itemId,updates,requestDigest)})};List.prototype._updateItem=function(itemId,updates,digest){var _this4=this;return this.getItemById(itemId).then(function(item){updates=_extends({},{__metadata:{type:item.__metadata.type}},updates);var customOptions={headers:headers.getUpdateHeaders(digest,item.__metadata.etag)};return _this4._dao.post(item.__metadata.uri,updates,customOptions)})};List.prototype.deleteItem=function(itemId,requestDigest){var _this5=this;if(requestDigest)return this._deleteItem(itemId,requestDigest);return this._dao.getRequestDigest().then(function(requestDigest){return _this5._deleteItem(itemId,requestDigest)})};List.prototype._deleteItem=function(itemId,digest){var _this6=this;return this.getItemById(itemId).then(function(item){var customOptions={headers:headers.getDeleteHeaders(digest,item.__metadata.etag)};return _this6._dao.post(item.__metadata.uri,"",customOptions)})};List.prototype.addAttachment=function(itemId,filename,content,requestDigest){var _this7=this;if(requestDigest)return this._addAttachment(itemId,filename,content,requestDigest);return this._dao.getRequestDigest().then(function(requestDigest){return _this7._addAttachment(itemId,filename,content,requestDigest)})};List.prototype._addAttachment=function(itemId,filename,content,requestDigest){var customOptions={headers:headers.getFilestreamHeaders(requestDigest),data:content};return this._dao.post(this.baseUrl+"/items("+itemId+")/AttachmentFiles/add(FileName='"+filename+"')",null,customOptions)};List.prototype.deleteAttachment=function(itemId,filename,requestDigest){var _this8=this;if(requestDigest)return this._deleteAttachment(itemId,filename,requestDigest);return this._dao.getRequestDigest().then(function(requestDigest){return _this8._deleteAttachment(itemId,filename,requestDigest)})};List.prototype._deleteAttachment=function(itemId,filename,requestDigest){var _this9=this;return this._dao.get(this.baseUrl).then(function(data){var customOptions={headers:{Accept:"application/json;odata=verbose","X-RequestDigest":requestDigest,"X-HTTP-Method":"DELETE"}};return _this9._dao.post(_this9.baseUrl+"/items("+itemId+")/AttachmentFiles('"+filename+"')",null,customOptions)})};List.prototype.findItems=function(key,value,extraOData){var filterValue=typeof value==="string"?"'"+value+"'":value;var odata="$filter="+key+" eq "+filterValue+appendOData(extraOData,"&");return this.getItems(odata)};List.prototype.findItem=function(key,value,odata){return this.findItems(key,value,odata).then(function(items){if(items&&items.length&&items.length>0){return items[0]}return null})};var appendOData=function appendOData(odata,prefix){prefix=prefix||"?";if(odata)return prefix+odata;return""};module.exports=List},function(module,exports){"use strict";var isBrowser=exports.isBrowser=function(){return!(typeof window==="undefined")};var parseJSON=exports.parseJSON=function(data){if(typeof data==="string"){try{data=JSON.parse(data)}catch(e){return null}}return data};var validateODataV2=exports.validateODataV2=function(data){var results=parseJSON(data);if(data.d&&data.d.results&&data.d.results.length!=null){results=data.d.results}else if(data.d){results=data.d}return results};var arrayFromBitMask=exports.arrayFromBitMask=function(nMask){if(typeof nMask==="string"){nMask=parseInt(nMask)}for(var nShifted=nMask,aFromMask=[];nShifted;aFromMask.push(Boolean(nShifted&1)),nShifted>>>=1){}return aFromMask};var _waitForLibraries=function _waitForLibraries(namespaces,resolve){var missing=namespaces.filter(function(namespace){return!validateNamespace(namespace)});if(missing.length===0)resolve();else setTimeout(function(){return _waitForLibraries(namespaces,resolve)},25)};var waitForLibraries=exports.waitForLibraries=function(namespaces){return new Promise(function(resolve,reject){return _waitForLibraries(namespaces,resolve)})};var waitForLibrary=exports.waitForLibrary=function(namespace){return waitForLibraries([namespace])};var validateNamespace=exports.validateNamespace=function(namespace){var scope=window;var sections=namespace.split(".");var sectionsLength=sections.length;for(var i=0;i<sectionsLength;i++){var prop=sections[i];if(prop in scope){scope=scope[prop]}else{return false}}return true};var getScripts=exports.getScripts=function(urls){return Promise.all(urls.map(getScript))};var getScript=exports.getScript=function(url){return new Promise(function(resolve,reject){var scriptTag=window.document.createElement("script");var firstScriptTag=document.getElementsByTagName("script")[0];scriptTag.async=1;firstScriptTag.parentNode.insertBefore(scriptTag,firstScriptTag);scriptTag.onload=scriptTag.onreadystatechange=function(arg,isAbort){if(isAbort||!scriptTag.readyState||/loaded|complete/.test(scriptTag.readyState)){scriptTag.onload=scriptTag.onreadystatechange=null;scriptTag=undefined;if(!isAbort)resolve();else reject}};scriptTag.src=url})};var getArrayBuffer=exports.getArrayBuffer=function(file){if(file&&file instanceof File){return new Promise(function(resolve,reject){var reader=new FileReader;reader.onload=function(e){resolve(e.target.result)};reader.readAsArrayBuffer(file)})}else{throw"SPScript.utils.getArrayBuffer: Cant get ArrayBuffer if you don't pass in a file"}};var loadCss=exports.loadCss=function(url){var link=document.createElement("link");link.setAttribute("rel","stylesheet");link.setAttribute("type","text/css");link.setAttribute("href",url);document.querySelector("head").appendChild(link)};var handleErrorResponse=exports.handleErrorResponse=function(err,res){console.log("REQUEST ERROR - "+err.statusCode||err.code);var msg=err.body;try{var data=err.body;if(typeof data==="string")data=JSON.parse(err.body);if(data.error)msg=data.error.message.value}catch(ex){}console.log(msg);return err}},function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(10);var Permissions=function Permissions(baseUrl,dao){this._dao=dao;this.baseUrl=baseUrl};Permissions.prototype.getRoleAssignments=function(){var url=this.baseUrl+"/RoleAssignments?$expand=Member,RoleDefinitionBindings";return this._dao.get(url).then(utils.validateODataV2).then(function(results){return results.map(transforms.roleAssignment)})};Permissions.prototype.check=function(email){var _this=this;var checkPrivs=function checkPrivs(user){var login=encodeURIComponent(user.LoginName);var url=_this.baseUrl+"/getusereffectivepermissions(@v)?@v='"+login+"'";return _this._dao.get(url).then(utils.validateODataV2)};if(!email&&!utils.isBrowser()){return Promise.reject("Can't Check Permissions.  No email passed and no current user")}var req=!email?this._dao.get("/web/getuserbyid("+_spPageContextInfo.userId+")").then(function(data){return data.d}):this._dao.web.getUser(email);return req.then(checkPrivs).then(function(privs){return permissionMaskToStrings(privs.GetUserEffectivePermissions.Low,privs.GetUserEffectivePermissions.High)})};var transforms={roleAssignment:function roleAssignment(raw){var priv={member:{login:raw.Member.LoginName,name:raw.Member.Title,id:raw.Member.Id}};priv.roles=raw.RoleDefinitionBindings.results.map(function(roleDef){return{name:roleDef.Name,description:roleDef.Description,basePermissions:permissionMaskToStrings(roleDef.BasePermissions.Low,roleDef.BasePermissions.High)}});return priv}};var permissionMaskToStrings=function permissionMaskToStrings(lowMask,highMask){var basePermissions=[];spBasePermissions.forEach(function(basePermission){if((basePermission.low&lowMask)>0||(basePermission.high&highMask)>0){basePermissions.push(basePermission.name)}});return basePermissions};var spBasePermissions=[{name:"emptyMask",low:0,high:0},{name:"viewListItems",low:1,high:0},{name:"addListItems",low:2,high:0},{name:"editListItems",low:4,high:0},{name:"deleteListItems",low:8,high:0},{name:"approveItems",low:16,high:0},{name:"openItems",low:32,high:0},{name:"viewVersions",low:64,high:0},{name:"deleteVersions",low:128,high:0},{name:"cancelCheckout",low:256,high:0},{name:"managePersonalViews",low:512,high:0},{name:"manageLists",low:2048,high:0},{name:"viewFormPages",low:4096,high:0},{name:"anonymousSearchAccessList",low:8192,high:0},{name:"open",low:65536,high:0},{name:"viewPages",low:131072,high:0},{name:"addAndCustomizePages",low:262144,high:0},{name:"applyThemeAndBorder",low:524288,high:0},{name:"applyStyleSheets",low:1048576,high:0},{name:"viewUsageData",low:2097152,high:0},{name:"createSSCSite",low:4194304,high:0},{name:"manageSubwebs",low:8388608,high:0},{name:"createGroups",low:16777216,high:0},{name:"managePermissions",low:33554432,high:0},{name:"browseDirectories",low:67108864,high:0},{name:"browseUserInfo",low:134217728,high:0},{name:"addDelPrivateWebParts",low:268435456,high:0},{name:"updatePersonalWebParts",low:536870912,high:0},{name:"manageWeb",low:1073741824,high:0},{name:"anonymousSearchAccessWebLists",low:-2147483648,high:0},{name:"useClientIntegration",low:0,high:16},{name:"useRemoteAPIs",low:0,high:32},{name:"manageAlerts",low:0,high:64},{name:"createAlerts",low:0,high:128},{name:"editMyUserInfo",low:0,high:256},{name:"enumeratePermissions",low:0,high:1073741824}];module.exports=Permissions},function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var utils=__webpack_require__(10);var jsonMimeType=exports.jsonMimeType="application/json;odata=verbose";var getStandardHeaders=exports.getStandardHeaders=function(digest){var headers={Accept:jsonMimeType,"Content-Type":jsonMimeType};if(digest)headers["X-RequestDigest"]=digest;return headers};exports.getAddHeaders=getStandardHeaders;var getFilestreamHeaders=exports.getFilestreamHeaders=function(digest){return{Accept:jsonMimeType,"X-RequestDigest":digest,"Content-Type":"application/octet-stream",binaryStringRequestBody:"true"}};var getActionHeaders=function getActionHeaders(verb,digest){return _extends({},getStandardHeaders(digest),{"X-HTTP-Method":verb})};var decorateETag=function decorateETag(headers,etag){if(etag)headers["If-Match"]=etag;return headers};exports.getUpdateHeaders=function(digest,etag){return decorateETag(getActionHeaders("MERGE",digest),etag)};exports.getDeleteHeaders=function(digest,etag){return decorateETag(getActionHeaders("DELETE",digest),etag)}},function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var utils=__webpack_require__(10);var Permissions=__webpack_require__(11);var headers=__webpack_require__(12);var Folder=__webpack_require__(14).Folder;var Web=function Web(dao){this._dao=dao;this.baseUrl="/web";this.permissions=new Permissions(this.baseUrl,this._dao)};Web.prototype.info=function(){return this._dao.get(this.baseUrl).then(utils.validateODataV2)};Web.prototype.subsites=function(){return this._dao.get(this.baseUrl+"/webinfos").then(utils.validateODataV2)};Web.prototype.getRequestDigest=function(){return this._dao.post("/contextinfo",{}).then(function(data){return data.d.GetContextWebInformation.FormDigestValue})};Web.prototype.getFolder=function(serverRelativeUrl){if(serverRelativeUrl.charAt(0)==="/"){serverRelativeUrl=serverRelativeUrl.substr(1)}var url="/web/GetFolderByServerRelativeUrl('"+serverRelativeUrl+"')?$expand=Folders,Files";return this._dao.get(url).then(utils.validateODataV2).then(function(spFolder){var folder=new Folder(spFolder);folder.populateChildren(spFolder);return folder})};Web.prototype.uploadFile=function(fileContent,folderUrl,fields,digest){var _this=this;if(digest)return this._uploadFile(fileContent,folderUrl,fields,digest);return this.getRequestDigest().then(function(digest){return _this._uploadFile(fileContent,folderUrl,fields,digest)})};Web.prototype._uploadFile=function(fileContent,folderUrl,fields,digest){var _this2=this;fields=fields||{};if(typeof fileContent==="string"){fields.name=fields.name||"NewFile.txt";return this._uploadBinaryData(fileContent,folderUrl,fields,digest)}if(fileContent instanceof File){fields.name=fields.name||fileContent.name;return utils.getArrayBuffer(fileContent).then(function(arrayBuffer){return _this2._uploadBinaryData(arrayBuffer,folderUrl,fields,digest)})}};Web.prototype._setFileFields=function(spFile,fields,digest){
var _this3=this;return this._dao.get(spFile.__metadata.uri+"/ListItemAllFields?$expand=ParentList").then(utils.validateODataV2).then(function(item){delete fields.name;if(Object.keys(fields).length===0){return{item:item,file:spFile}}return _this3._dao.lists(item.ParentList.Title).updateItem(item.Id,fields,digest).then(function(){item=_extends({},item,fields);return{item:item,file:spFile}})})};Web.prototype._uploadBinaryData=function(binaryContent,folderUrl,fields,digest){var _this4=this;var uploadUrl="/web/GetFolderByServerRelativeUrl('"+folderUrl+"')/Files/Add(url='"+fields.name+"',overwrite=true)";var options={headers:headers.getFilestreamHeaders(digest)};return this._dao.post(uploadUrl,binaryContent,options).then(utils.validateODataV2).then(function(spFile){return _this4._setFileFields(spFile,fields,digest)})};Web.prototype.getFile=function(url){var url="/web/getfilebyserverrelativeurl('"+url+"')";return this._dao.get(url).then(utils.validateODataV2)};Web.prototype.copyFile=function(sourceUrl,destinationUrl,digest){var _this5=this;if(digest)return this._copyFile(sourceUrl,destinationUrl,digest);return this.getRequestDigest().then(function(requestDigest){return _this5._copyFile(sourceUrl,destinationUrl,requestDigest)})};Web.prototype._copyFile=function(sourceUrl,destinationUrl,digest){var url="/web/getfilebyserverrelativeurl('"+sourceUrl+"')/CopyTo";var options={headers:headers.getAddHeaders(digest)};var body={strNewUrl:destinationUrl,bOverWrite:true};return this._dao.post(url,body,options)};Web.prototype.fileAction=function(file,action){var _this6=this;var params=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];var digest=arguments[3];if(digest)this._fileAction(file,action,params,digest);return this.getRequestDigest().then(function(requestDigest){return _this6._fileAction(file,action,params,requestDigest)})};Web.prototype._fileAction=function(file,action,params,digest){var url="/web/getfilebyserverrelativeurl('"+file+"')/"+action;var options={headers:headers.getAddHeaders(digest)};return this._dao.post(url,params,options)};Web.prototype.deleteFile=function(fileUrl,digest){var _this7=this;if(digest)return this._deleteFile(fileUrl,digest);return this.getRequestDigest().then(function(requestDigest){return _this7._deleteFile(fileUrl,requestDigest)})};Web.prototype._deleteFile=function(sourceUrl,requestDigest){var url="/web/getfilebyserverrelativeurl(@url)/?@Url='"+sourceUrl+"'";var options={headers:headers.getDeleteHeaders(requestDigest)};return this._dao.post(url,{},options)};Web.prototype.getUser=function(email){var url=this.baseUrl+"/SiteUsers/GetByEmail('"+email+"')";return this._dao.get(url).then(utils.validateODataV2)};module.exports=Web},function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(10);var Folder=function Folder(spFolder){this.mapProperties(spFolder);this.populateChildren(spFolder)};Folder.prototype.populateChildren=function(spFolder){if(spFolder&&spFolder.Folders&&spFolder.Folders.results){this.folders=spFolder.Folders.results.map(function(f){return new Folder(f)})}if(spFolder&&spFolder.Files&&spFolder.Files.results){this.files=spFolder.Files.results.map(function(f){return new File(f)})}};Folder.prototype.mapProperties=function(spFolder){this.name=spFolder.Name;this.serverRelativeUrl=spFolder.ServerRelativeUrl;this.itemCount=spFolder.ItemCount;this.guid=spFolder.UniqueId;this.uri=spFolder.__metadata.uri};var File=function File(spFile){this.mapProperties(spFile)};File.prototype.mapProperties=function(spFile){this.name=spFile.Name,this.title=spFile.Title,this.checkoutType=spFile.CheckOutType,this.byteLength=spFile.Length,this.majorVersion=spFile.MajorVersion,this.minorVersion=spFile.MinorVersion,this.serverRelativeUrl=spFile.ServerRelativeUrl,this.uri=spFile.__metadata.uri};module.exports={File:File,Folder:Folder}},function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(10);var headers=__webpack_require__(12);var Profiles=function Profiles(dao){this._dao=dao;this.baseUrl="/SP.UserProfiles.PeopleManager"};var transformPersonProperties=function transformPersonProperties(profile){profile.UserProfileProperties.results.forEach(function(keyvalue){profile[keyvalue.Key]=keyvalue.Value});return profile};Profiles.prototype.current=function(){var url=this.baseUrl+"/GetMyProperties";return this._dao.get(url).then(utils.validateODataV2).then(transformPersonProperties)};Profiles.prototype.setProperty=function(userOrEmail,key,value,digest){var _this=this;if(digest)return this._setProperty(userOrEmail,key,value,digest);return this._dao.getRequestDigest().then(function(digest){return _this._setProperty(userOrEmail,key,value,digest)})};Profiles.prototype._setProperty=function(userOrEmail,key,value,digest){var _this2=this;var url=this.baseUrl+"/SetSingleValueProfileProperty";var args={propertyName:key,propertyValue:value};var customOptions={headers:headers.getStandardHeaders(digest)};if(typeof userOrEmail==="string"){return this.getByEmail(userOrEmail).then(function(user){args.accountName=user.AccountName;return _this2._dao.post(url,args,customOptions)})}else{args.accountName=userOrEmail.LoginName||userOrEmail.AccountName;return this._dao.post(url,args,customOptions)}};Profiles.prototype.getProfile=function(user){var login=encodeURIComponent(user.LoginName);var url=this.baseUrl+"/GetPropertiesFor(accountName=@v)?@v='"+login+"'";return this._dao.get(url).then(utils.validateODataV2).then(transformPersonProperties)};Profiles.prototype.getByEmail=function(email){var _this3=this;return this._dao.web.getUser(email).then(function(user){return _this3.getProfile(user)})};module.exports=Profiles},function(module,exports,__webpack_require__){"use strict";var queryString=__webpack_require__(17);var utils=__webpack_require__(10);var Search=function Search(dao){this._dao=dao};Search.QueryOptions=function(){this.sourceid=null;this.startrow=null;this.rowlimit=30;this.selectedproperties=null;this.refiners=null;this.refinementfilters=null;this.hiddenconstraints=null;this.sortlist=null};var convertRowsToObjects=function convertRowsToObjects(itemRows){var items=[];for(var i=0;i<itemRows.length;i++){var row=itemRows[i],item={};for(var j=0;j<row.Cells.results.length;j++){item[row.Cells.results[j].Key]=row.Cells.results[j].Value}items.push(item)}return items};var SearchResults=function SearchResults(queryResponse){this.elapsedTime=queryResponse.ElapsedTime;this.suggestion=queryResponse.SpellingSuggestion;this.resultsCount=queryResponse.PrimaryQueryResult.RelevantResults.RowCount;this.totalResults=queryResponse.PrimaryQueryResult.RelevantResults.TotalRows;this.totalResultsIncludingDuplicates=queryResponse.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates;this.items=convertRowsToObjects(queryResponse.PrimaryQueryResult.RelevantResults.Table.Rows.results);this.refiners=mapRefiners(queryResponse.PrimaryQueryResult.RefinementResults)};var mapRefiners=function mapRefiners(refinementResults){var refiners=[];if(refinementResults&&refinementResults.Refiners&&refinementResults.Refiners.results){refiners=refinementResults.Refiners.results.map(function(r){return{RefinerName:r.Name,RefinerOptions:r.Entries.results}})}return refiners};Search.prototype.query=function(queryText,queryOptions){var optionsQueryString=queryOptions!=null?"&"+queryString.fromObj(queryOptions,true):"";var url="/search/query?querytext='"+queryText+"'"+optionsQueryString;return this._dao.get(url).then(utils.validateODataV2).then(function(resp){if(resp.query){return new SearchResults(resp.query)}throw new Error("Invalid response back from search service")})};Search.prototype.people=function(queryText,queryOptions){var options=queryOptions||{};options.sourceid="b09a7990-05ea-4af9-81ef-edfab16c4e31";return this.query(queryText,options)};module.exports=Search},function(module,exports,__webpack_require__){"use strict";var qs=__webpack_require__(18);var fromObj=exports.fromObj=function(obj,quoteValues){var writeParam=function writeParam(key){var value=(obj[key]+"").trim();if(value.indexOf(" ")>-1||quoteValues)value="'"+value+"'";return key+"="+value};var str=Object.keys(obj).map(writeParam).join("&");return str};var toObj=exports.toObj=function(str){if(str===undefined&&window&&window.location&&window.location.search){str=window.location.search}if(!str)return{};if(str[0]==="?")str=str.substr(1);return qs.parse(str)};exports.contains=function(key,text){return toObj(text).hasOwnProperty(key)};exports.getValue=function(key,text){return toObj(text)[key]||""}},function(module,exports,__webpack_require__){"use strict";exports.decode=exports.parse=__webpack_require__(19);exports.encode=exports.stringify=__webpack_require__(20)},function(module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(Array.isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj}},function(module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return Object.keys(obj).map(function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(Array.isArray(obj[k])){return obj[k].map(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))}},function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var utils=__webpack_require__(10);var headers=__webpack_require__(12);var metadata={__metadata:{type:"SP.UserCustomAction"}};var CustomActions=function CustomActions(dao){var _this=this;this._dao=dao;this.scopes={Web:{id:3,name:"Web",url:"/web/usercustomactions"},Site:{id:2,name:"Site",url:"/site/usercustomactions"}};this.scopes.getById=function(id){return id===2?_this.scopes.Site:_this.scopes.Web}};CustomActions.prototype.get=function(name){var _this2=this;return this._dao.get(this.scopes.Site.url).then(utils.validateODataV2).then(function(siteCustomActions){return _this2._dao.get(_this2.scopes.Web.url).then(utils.validateODataV2).then(function(webCustomActions){return siteCustomActions.concat(webCustomActions)})}).then(function(customActions){if(name){var matches=customActions.filter(function(a){return a.Name===name});if(matches.length){return matches[0]}throw new Error("Unable to find Custom Action with name: "+name)}else return customActions})};CustomActions.prototype._getUrl=function(name){var _this3=this;return this.get(name).then(function(a){return _this3.scopes.getById(a.Scope).url+"('"+a.Id+"')"})};CustomActions.prototype._getUrlAndDigest=function(name){var _this4=this;var prep={};return this._getUrl(name).then(function(url){prep.url=url;return _this4._dao.getRequestDigest()}).then(function(digest){prep.digest=digest;return prep})};CustomActions.prototype.update=function(updates){var _this5=this;if(!updates||!updates.Name)throw new Error("You must at least pass a Custom Action 'Name'");return this._getUrlAndDigest(updates.Name).then(function(prep){updates=_extends({},metadata,updates);var opts={headers:headers.getUpdateHeaders(prep.digest)};return _this5._dao.post(prep.url,updates,opts)})};CustomActions.prototype.remove=function(name){var _this6=this;if(!name)throw new Error("You must at least pass a Custom Action 'Name'");return this._getUrlAndDigest(name).then(function(prep){var opts={headers:headers.getDeleteHeaders(prep.digest)};return _this6._dao.post(prep.url,{},opts)})};CustomActions.prototype.add=function(customAction){var _this7=this;if(!customAction||!customAction.Name||!customAction.Location)throw new Error("You must at least pass a Custom Action 'Name' and 'Location'");customAction.Scope=customAction.Scope||"Web";return this._dao.getRequestDigest().then(function(digest){customAction=_extends({},metadata,customAction);var scope=_this7.scopes[customAction.Scope];customAction.Scope=scope.id;var opts={headers:headers.getAddHeaders(digest)};return _this7._dao.post(scope.url,customAction,opts)})};CustomActions.prototype.addScriptLink=function(name,url,opts){var customAction={Name:name,Title:name,Description:name,Group:name,Sequence:100,Scope:"Web",Location:"ScriptLink",ScriptSrc:url};customAction=_extends({},customAction,opts||{});return this.add(customAction)};CustomActions.prototype.addCSSLink=function(name,url,opts){var scriptBlockStr='\n\t\t(function() {\n\t\t\tvar head = document.querySelector("head");\n\t\t\tvar styleTag = document.createElement("style");\n\t\t\tstyleTag.appendChild(document.createTextNode("body { opacity: 0 }"));\n\t\t\t\n\t\t\tvar linkTag = document.createElement("link");\n\t\t\tlinkTag.rel = "stylesheet";\tlinkTag.href = "'+url+'"; linkTag.type = "text/css";\n\t\t\tlinkTag.addEventListener("load", function() {\n\t\t\t\thead.removeChild(styleTag);\n\t\t\t});\n\n\t\t\thead.appendChild(styleTag);\n\t\t\thead.appendChild(linkTag);\n\t\t})();';var customAction={Name:name,Title:name,Description:name,Group:name,Sequence:100,Scope:"Web",Location:"ScriptLink",ScriptBlock:scriptBlockStr};customAction=_extends({},customAction,opts||{});return this.add(customAction)};CustomActions.metadata=metadata;module.exports=CustomActions},function(module,exports){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var defaults={method:"GET",async:true,type:"json",data:undefined};var validMethods=["GET","POST","PUT","HEAD","DELETE","PATCH"];var errorHandlers=[];var validateOptions=function validateOptions(options){if(!options||!options.url||validMethods.indexOf(options.method)<0)return false;else return true};var setHeaders=function setHeaders(xhr,headersObj){if(headersObj){Object.keys(headersObj).forEach(function(key){xhr.setRequestHeader(key,headersObj[key])})}};var ajax=function ajax(options){var opts=_extends({},defaults,options);if(!validateOptions(options))return Promise.reject(new Error("Invalid options passed into ajax call."));var xhr=new XMLHttpRequest;if(xhr==null)return Promise.reject(new Error("Your browser doesn't support XMLHttpRequest (ajax)."));xhr.open(opts.method,opts.url,opts.async);setHeaders(xhr,opts.headers);xhr.responseType=opts.type;return new Promise(function(resolve,reject){xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status<400&&xhr.status>=100){resolve(xhr.response)}else{var error=new Error("AJAX Request Error: Response Code = "+xhr.status);error.statusCode=xhr.status;error.body=xhr.response;errorHandlers.forEach(function(fn){return fn(error,xhr)});reject(error)}}};xhr.send(opts.data)})};ajax.addErrorHandler=function(fn){return errorHandlers.push(fn)};ajax.setDefaults=function(options){return _extends(defaults,options)};module.exports=ajax},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function defineMustache(global,factory){if(typeof exports==="object"&&exports&&typeof exports.nodeName!=="string"){factory(exports)}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[exports],__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{global.Mustache={};factory(global.Mustache)}})(this,function mustacheFactory(mustache){var objectToString=Object.prototype.toString;var isArray=Array.isArray||function isArrayPolyfill(object){return objectToString.call(object)==="[object Array]"};function isFunction(object){return typeof object==="function"}function typeStr(obj){return isArray(obj)?"array":typeof obj}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(obj,propName){return obj!=null&&typeof obj==="object"&&propName in obj}var regExpTest=RegExp.prototype.test;function testRegExp(re,string){return regExpTest.call(re,string)}var nonSpaceRe=/\S/;function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function escapeHtml(string){return String(string).replace(/[&<>"'`=\/]/g,function fromEntityMap(s){return entityMap[s]})}var whiteRe=/\s*/;var spaceRe=/\s+/;var equalsRe=/\s*=/;var curlyRe=/\s*\}/;var tagRe=/#|\^|\/|>|\{|&|=|!/;function parseTemplate(template,tags){if(!template)return[];var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length)delete tokens[spaces.pop()]}else{spaces=[]}hasTag=false;nonSpace=false}var openingTagRe,closingTagRe,closingCurlyRe;function compileTags(tagsToCompile){if(typeof tagsToCompile==="string")tagsToCompile=tagsToCompile.split(spaceRe,2);if(!isArray(tagsToCompile)||tagsToCompile.length!==2)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*");closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1]));closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}compileTags(tags||mustache.tags);var scanner=new Scanner(template);var start,type,value,chr,token,openSection;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(openingTagRe);if(value){for(var i=0,valueLength=value.length;i<valueLength;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push(["text",chr,start,start+1]);start+=1;if(chr==="\n")stripSpace()}}if(!scanner.scan(openingTagRe))break;hasTag=true;type=scanner.scan(tagRe)||"name";scanner.scan(whiteRe);if(type==="="){value=scanner.scanUntil(equalsRe);scanner.scan(equalsRe);scanner.scanUntil(closingTagRe)}else if(type==="{"){value=scanner.scanUntil(closingCurlyRe);scanner.scan(curlyRe);scanner.scanUntil(closingTagRe);type="&"}else{value=scanner.scanUntil(closingTagRe)}if(!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type==="#"||type==="^"){sections.push(token)}else if(type==="/"){openSection=sections.pop();if(!openSection)throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else if(type==="name"||type==="{"||type==="&"){nonSpace=true}else if(type==="="){compileTags(value)}}openSection=sections.pop();if(openSection)throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];if(token){if(token[0]==="text"&&lastToken&&lastToken[0]==="text"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{squashedTokens.push(token);lastToken=token}}}return squashedTokens}function nestTokens(tokens){var nestedTokens=[];var collector=nestedTokens;var sections=[];var token,section;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];switch(token[0]){case"#":case"^":collector.push(token);sections.push(token);collector=token[4]=[];break;case"/":section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}}return nestedTokens}function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function eos(){return this.tail===""};Scanner.prototype.scan=function scan(re){var match=this.tail.match(re);if(!match||match.index!==0)return"";var string=match[0];this.tail=this.tail.substring(string.length);this.pos+=string.length;return string};Scanner.prototype.scanUntil=function scanUntil(re){var index=this.tail.search(re),match;switch(index){case-1:match=this.tail;this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index);this.tail=this.tail.substring(index)}this.pos+=match.length;return match};function Context(view,parentContext){this.view=view;this.cache={".":this.view};this.parent=parentContext}Context.prototype.push=function push(view){return new Context(view,this)};Context.prototype.lookup=function lookup(name){var cache=this.cache;var value;if(cache.hasOwnProperty(name)){value=cache[name]}else{var context=this,names,index,lookupHit=false;while(context){if(name.indexOf(".")>0){value=context.view;names=name.split(".");index=0;while(value!=null&&index<names.length){if(index===names.length-1)lookupHit=hasProperty(value,names[index]);value=value[names[index++]]}}else{value=context.view[name];lookupHit=hasProperty(context.view,name)}if(lookupHit)break;context=context.parent}cache[name]=value}if(isFunction(value))value=value.call(this.view);return value};function Writer(){this.cache={}}Writer.prototype.clearCache=function clearCache(){this.cache={}};Writer.prototype.parse=function parse(template,tags){var cache=this.cache;var tokens=cache[template];if(tokens==null)tokens=cache[template]=parseTemplate(template,tags);return tokens};Writer.prototype.render=function render(template,view,partials){var tokens=this.parse(template);var context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)};Writer.prototype.renderTokens=function renderTokens(tokens,context,partials,originalTemplate){var buffer="";var token,symbol,value;for(var i=0,numTokens=tokens.length;i<numTokens;++i){value=undefined;token=tokens[i];symbol=token[0];if(symbol==="#")value=this.renderSection(token,context,partials,originalTemplate);else if(symbol==="^")value=this.renderInverted(token,context,partials,originalTemplate);else if(symbol===">")value=this.renderPartial(token,context,partials,originalTemplate);else if(symbol==="&")value=this.unescapedValue(token,context);else if(symbol==="name")value=this.escapedValue(token,context);else if(symbol==="text")value=this.rawValue(token);if(value!==undefined)buffer+=value}return buffer};Writer.prototype.renderSection=function renderSection(token,context,partials,originalTemplate){var self=this;var buffer="";var value=context.lookup(token[1]);function subRender(template){return self.render(template,context,partials)}if(!value)return;if(isArray(value)){for(var j=0,valueLength=value.length;j<valueLength;++j){buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate)}}else if(typeof value==="object"||typeof value==="string"||typeof value==="number"){buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate)}else if(isFunction(value)){if(typeof originalTemplate!=="string")throw new Error("Cannot use higher-order sections without the original template");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender);if(value!=null)buffer+=value}else{buffer+=this.renderTokens(token[4],context,partials,originalTemplate)}return buffer};Writer.prototype.renderInverted=function renderInverted(token,context,partials,originalTemplate){var value=context.lookup(token[1]);if(!value||isArray(value)&&value.length===0)return this.renderTokens(token[4],context,partials,originalTemplate)};Writer.prototype.renderPartial=function renderPartial(token,context,partials){if(!partials)return;var value=isFunction(partials)?partials(token[1]):partials[token[1]];if(value!=null)return this.renderTokens(this.parse(value),context,partials,value)};Writer.prototype.unescapedValue=function unescapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return value};Writer.prototype.escapedValue=function escapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return mustache.escape(value)};Writer.prototype.rawValue=function rawValue(token){return token[1]};mustache.name="mustache.js";mustache.version="2.2.1";mustache.tags=["{{","}}"];var defaultWriter=new Writer;mustache.clearCache=function clearCache(){return defaultWriter.clearCache()};mustache.parse=function parse(template,tags){return defaultWriter.parse(template,tags)};mustache.render=function render(template,view,partials){if(typeof template!=="string"){throw new TypeError('Invalid template! Template should be a "string" '+'but "'+typeStr(template)+'" was given as the first '+"argument for mustache#render(template, view, partials)")}return defaultWriter.render(template,view,partials)};mustache.to_html=function to_html(template,view,partials,send){var result=mustache.render(template,view,partials);if(isFunction(send)){send(result)}else{return result}};mustache.escape=escapeHtml;mustache.Scanner=Scanner;mustache.Context=Context;mustache.Writer=Writer})},function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var renderers=exports.renderers=__webpack_require__(25);var registerFormField=exports.registerFormField=function(fieldComponent,opts){var renderer=renderers.formField.create(fieldComponent);fieldComponent.locations=fieldComponent.locations||["NewForm","EditForm"];return registerField(fieldComponent,renderer,opts)};var registerDisplayField=exports.registerDisplayField=function(fieldComponent,opts){var renderer=renderers.displayField.create(fieldComponent);fieldComponent.locations=fieldComponent.locations||["View","DisplayForm"];return registerField(fieldComponent,renderer,opts)};var registerField=exports.registerField=function(field,renderer,opts){var renderers={};field.locations.forEach(function(l){return renderers[l]=renderer});var defaults={Templates:{Fields:{}}};var templateOverride=_extends({},defaults,opts);templateOverride.Templates.Fields[field.name]=renderers;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(templateOverride);return field};var registerView=exports.registerView=function(templates,options){var defaults={Templates:{Header:function Header(){return""},Footer:function Footer(){return""}}};var templateOverride=_extends({},defaults,options);templateOverride.Templates=_extends({},templateOverride.Templates,templates);SPClientTemplates.TemplateManager.RegisterTemplateOverrides(templateOverride)}},function(module,exports,__webpack_require__){"use strict";var templating=__webpack_require__(23);function createTemplateRenderer(htmlTemplate,events){return function(ctx){return templating.render(htmlTemplate,ctx)}}function createFormFieldRenderer(field){return function(ctx){var formCtx=ctx.FormContext;if(field.onReady){formCtx.registerInitCallback(field.name,field.onReady)}if(field.getValue){formCtx.registerGetValueCallback(field.name,field.getValue.bind(null,ctx))}if(formCtx.updateControlValue){field.setValue=function(value){formCtx.updateControlValue(field.name,value)}}return field.render(ctx)}}function createDisplayFieldRenderer(field){return function(ctx){var formCtx=ctx.FormContext;if(formCtx&&formCtx.registerInitCallback&&field.onReady){formCtx.registerInitCallback(field.name,field.onReady)}return field.render(ctx)}}var renderers={template:{create:createTemplateRenderer},formField:{create:createFormFieldRenderer},displayField:{create:createDisplayFieldRenderer}};module.exports=renderers}]);