{"version":3,"sources":["../src/baseDao.js"],"names":[],"mappings":";;;;AACA,IAAI,OAAU,QAAQ,QAAR,CAAd;AACA,IAAI,MAAS,QAAQ,OAAR,CAAb;AACA,IAAI,WAAa,QAAQ,YAAR,CAAjB;AACA,IAAI,SAAY,QAAQ,UAAR,CAAhB;AACA,IAAI,QAAW,QAAQ,SAAR,CAAf;AACA,IAAI,gBAAiB,QAAQ,iBAAR,CAArB;;;;;;;;;AASA,IAAI,UAAU,SAAV,OAAU,GAAW;AACxB,MAAK,GAAL,GAAW,IAAI,GAAJ,CAAQ,IAAR,CAAX;AACA,MAAK,MAAL,GAAc,IAAI,MAAJ,CAAW,IAAX,CAAd;AACA,MAAK,QAAL,GAAgB,IAAI,QAAJ,CAAa,IAAb,CAAhB;AACA,MAAK,aAAL,GAAqB,IAAI,aAAJ,CAAkB,IAAlB,CAArB;AAEA,CAND;;AAQA,QAAQ,SAAR,CAAkB,cAAlB,GAAmC,YAAW;AAC7C,OAAM,2BAAN;AACA,CAFD;;;;;;;;;;AAYA,QAAQ,SAAR,CAAkB,GAAlB,GAAwB,UAAS,gBAAT,EAA2B,eAA3B,EAA4C;AACnE,KAAI,UAAU,SAAc,EAAd,EAAkB;AAC/B,UAAQ;AADuB,EAAlB,EAEX,eAFW,CAAd;AAGA,QAAO,KAAK,cAAL,CAAoB,gBAApB,EAAsC,OAAtC,EAA+C,IAA/C,CAAoD,MAAM,SAA1D,CAAP;AACA,CALD;;AAOA,QAAQ,SAAR,CAAkB,gBAAlB,GAAqC,YAAW;AAC/C,QAAO,KAAK,IAAL,CAAU,cAAV,EAA0B,EAA1B,EACL,IADK,CACA,gBAAQ;AACb,SAAO,KAAK,CAAL,CAAO,wBAAP,CAAgC,eAAvC;AACA,EAHK,CAAP;AAIA,CALD;;;;;;;;;;;AAgBA,QAAQ,SAAR,CAAkB,KAAlB,GAA0B,UAAS,QAAT,EAAmB;AAC5C,KAAI,CAAC,QAAL,EAAe;AACd,SAAO,KAAK,GAAL,CAAS,YAAT,EAAuB,IAAvB,CAA4B,MAAM,eAAlC,CAAP;AACA;AACD,QAAO,IAAI,IAAJ,CAAS,QAAT,EAAmB,IAAnB,CAAP;AACA,CALD;;;;;;;;AAaA,QAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAS,eAAT,EAA0B,IAA1B,EAAgC,IAAhC,EAAsC;AAC9D,QAAO,gBAAgB,IAAhB,EAAsB,IAAtB,CAAP;AACA,KAAI,UAAU;AACb,UAAQ,MADK;AAEb,QAAM;AAFO,EAAd;AAIA,WAAU,SAAc,EAAd,EAAkB,OAAlB,EAA2B,IAA3B,CAAV;AACA,QAAO,KAAK,cAAL,CAAoB,eAApB,EAAqC,OAArC,EAA8C,IAA9C,CAAmD,MAAM,SAAzD,CAAP;AACA,CARD;;AAUA,QAAQ,SAAR,CAAkB,mBAAlB,GAAwC,UAAS,MAAT,EAAiB;AACxD,QAAO,SAAS,QAAQ,OAAR,CAAgB,MAAhB,CAAT,GAAmC,KAAK,gBAAL,EAA1C;AACA,CAFD;;;AAKA,IAAI,kBAAkB,SAAlB,eAAkB,CAAS,IAAT,EAAe,IAAf,EAAqB;;AAE1C,KAAI,OAAO,IAAP,KAAgB,QAApB,EAA8B,OAAO,IAAP;;AAE9B,KAAI,QAAQ,KAAK,OAAb,IAAwB,KAAK,OAAL,CAAa,cAAb,CAAxB,IAAwD,KAAK,OAAL,CAAa,cAAb,EAA6B,OAA7B,CAAqC,MAArC,MAAiD,CAAC,CAA9G,EAAiH;AAChH,SAAO,IAAP;AACA;;AAED,QAAO,KAAK,SAAL,CAAe,IAAf,CAAP;AACA,CATD;AAUA,OAAO,OAAP,GAAiB,OAAjB","file":"baseDao.js","sourcesContent":["\r\nvar List \t\t\t= require(\"./list\");\r\nvar Web \t\t\t= require(\"./web\");\r\nvar Profiles \t\t= require(\"./profiles\")\r\nvar Search \t\t\t= require(\"./search\");\r\nvar utils \t\t\t= require(\"./utils\");\r\nvar CustomActions \t= require(\"./customActions\");\r\n/**\r\n * Abstract class. You'll never work with this directly. \r\n * @abstract\r\n * @private\r\n * @property {Web} web - Allows interacting with the SharePoint site you connected to\r\n * @property {Search} search - Allows querying through the SP Search Service\r\n * @property {Profiles} profiles - Allows interacting with the SP Profile Service\r\n */\r\nvar BaseDao = function() {\r\n\tthis.web = new Web(this);\r\n\tthis.search = new Search(this);\r\n\tthis.profiles = new Profiles(this);\r\n\tthis.customActions = new CustomActions(this);\r\n\r\n};\r\n\r\nBaseDao.prototype.executeRequest = function() {\r\n\tthrow \"Not implemented exception\";\r\n};\r\n\r\n/**\r\n * Generic helper to make AJAX GET request\r\n  * @example <caption>Use generic GET method to retrieve a site's content types</caption>\r\n * dao.get('/web/contentTypes').then(function(data) { console.log(data.d.results)})\r\n * @param {string} relativeQueryUrl - the API url relative to \"/_api\"\r\n * @param {Object} [extendedOptions] - AJAX options (like custom request headers)\r\n * @returns {Promise} - An ES6 Promise that resolves to the an object probably in the form of data.d\r\n */\r\nBaseDao.prototype.get = function(relativeQueryUrl, extendedOptions) {\r\n\tvar options = Object.assign({}, {\r\n\t\tmethod: \"GET\"\r\n\t}, extendedOptions);\r\n\treturn this.executeRequest(relativeQueryUrl, options).then(utils.parseJSON);\r\n};\r\n\r\nBaseDao.prototype.getRequestDigest = function() {\r\n\treturn this.post('/contextinfo', {})\r\n\t\t.then(data => {\r\n\t\t\treturn data.d.GetContextWebInformation.FormDigestValue\r\n\t\t});\r\n};\r\n/**\r\n * If a list name is passed, an SPScript.List object, otherwise performs a request to get all the site's lists\r\n * @param {string} [listname] - If a list name is passed, method is synchronous returning an SPScript.List\r\n * @returns {List|Promise} - SPScript.List object or a Promise that resolves to an Array of lists\r\n * @example <caption>Option 1: No List Name gets all the lists of a site</caption>\r\n * dao.lists().then(function(lists) { console.log(lists)});\r\n * @example <caption>Option 2: Pass a List Name to get a list object</caption>\r\n * var list = dao.lists('MyList');\r\n * list.getItemById(12).then(function(item) { console.log(item)});\r\n */\r\nBaseDao.prototype.lists = function(listname) {\r\n\tif (!listname) {\r\n\t\treturn this.get(\"/web/lists\").then(utils.validateODataV2);\r\n\t}\r\n\treturn new List(listname, this);\r\n};\r\n\r\n/**\r\n * Generic helper to make AJAX POST request\r\n * @param {string} relativeQueryUrl - the API url relative to \"/_api\"\r\n * @param {Object} [extendedOptions] - AJAX options (like custom request headers)\r\n * @returns {Promise} - An ES6 Promise\r\n */\r\nBaseDao.prototype.post = function(relativePostUrl, body, opts) {\r\n\tbody = packagePostBody(body, opts);\r\n\tvar options = {\r\n\t\tmethod: \"POST\",\r\n\t\tdata: body\r\n\t};\r\n\toptions = Object.assign({}, options, opts);\r\n\treturn this.executeRequest(relativePostUrl, options).then(utils.parseJSON);\r\n};\r\n\r\nBaseDao.prototype.ensureRequestDigest = function(digest) {\r\n\treturn digest ? Promise.resolve(digest) : this.getRequestDigest();\r\n}\r\n\r\n//Skip stringify it its already a string or it has an explicit Content-Type that is not JSON\r\nvar packagePostBody = function(body, opts) {\r\n\t// if its already a string just return\r\n\tif (typeof body === \"string\") return body;\r\n\t// if it has an explicit content-type, asssume the body is already that type\r\n\tif (opts && opts.headers && opts.headers[\"Content-Type\"] && opts.headers[\"Content-Type\"].indexOf(\"json\") === -1) {\r\n\t\treturn body\r\n\t}\r\n\t//others stringify\r\n\treturn JSON.stringify(body);\r\n}\r\nmodule.exports = BaseDao;"]}