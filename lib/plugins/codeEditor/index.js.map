{"version":3,"sources":["../../../src/plugins/codeEditor/index.js"],"names":["CSR","require","exports","register","fieldName","editorId","editor","setupEditor","ctx","console","log","ace","edit","setTheme","language","document","getElementById","getAttribute","getSession","setMode","codeEditorField","name","onReady","SPScript","utils","waitForLibrary","then","render","item","CurrentItem","Language","getValue","locations","registerFormField","setTimeout","getScript"],"mappings":";;AAAA,IAAIA,MAAMC,QAAQ,WAAR,CAAV;AACAC,QAAQC,QAAR,GAAmB,UAASC,SAAT,EAAoB;AACnC,QAAIC,WAAW,YAAf;AACA,QAAIC,MAAJ;;AAEA,QAAIC,cAAc,SAAdA,WAAc,CAASC,GAAT,EAAc;AAC5BC,gBAAQC,GAAR,CAAY,cAAZ;AACAJ,iBAASK,IAAIC,IAAJ,CAASP,QAAT,CAAT;AACAC,eAAOO,QAAP,CAAgB,mBAAhB;AACA,YAAIC,WAAWC,SAASC,cAAT,CAAwBX,QAAxB,EAAkCY,YAAlC,CAA+C,eAA/C,CAAf;AACA,YAAIH,QAAJ,EAAc;AACVR,mBAAOY,UAAP,GAAoBC,OAApB,CAA4B,cAAcL,QAA1C;AACH;AACJ,KARD;;AAUA,QAAIM,kBAAkB;AAClBC,cAAMjB,SADY;AAElBkB,eAFkB,mBAEVd,GAFU,EAEL;AACTC,oBAAQC,GAAR,CAAY,QAAZ;AACAD,oBAAQC,GAAR,CAAYF,GAAZ;AACAe,qBAASC,KAAT,CAAeC,cAAf,CAA8B,KAA9B,EAAqCC,IAArC,CAA0C;AAAA,uBAAMnB,YAAYC,GAAZ,CAAN;AAAA,aAA1C;AACH,SANiB;AAOlBmB,cAPkB,kBAOXnB,GAPW,EAON;AACR,gBAAIoB,OAAOpB,IAAIqB,WAAf;AACA,gBAAIf,WAAWc,KAAK,UAAL,yBAAsCA,KAAKE,QAA3C,UAA0D,EAAzE;AACA,iCAAmBzB,QAAnB,UAAgCS,QAAhC,oDAAsFc,KAAKxB,SAAL,KAAmB,EAAzG;AACH,SAXiB;AAYlB2B,gBAZkB,oBAYTvB,GAZS,EAYJ;AACVC,oBAAQC,GAAR,CAAY,WAAZ;AACA,mBAAOJ,OAAOyB,QAAP,EAAP;AACH,SAfiB;;AAgBlBC,mBAAU,CAAC,MAAD,EAAS,SAAT,EAAmB,aAAnB,EAAkC,UAAlC;AAhBQ,KAAtB;;AAmBAT,aAASC,KAAT,CAAeC,cAAf,CAA8B,mCAA9B,EAAmEC,IAAnE,CAAwE,YAAM;AAC1E1B,YAAIiC,iBAAJ,CAAsBb,eAAtB;AACH,KAFD;AAGH,CApCD;AAqCAc,WAAW,YAAM;AAChBX,aAASC,KAAT,CAAeW,SAAf,CAAyB,yDAAzB;AACA,CAFD,EAEE,EAFF","file":"index.js","sourcesContent":["var CSR = require(\"../../csr\");\r\nexports.register = function(fieldName) {\r\n    var editorId = \"ace-editor\";\r\n    var editor;\r\n\r\n    var setupEditor = function(ctx) {\r\n        console.log(\"SETUP EDITOR\");\r\n        editor = ace.edit(editorId);\r\n        editor.setTheme(\"ace/theme/monokai\");\r\n        var language = document.getElementById(editorId).getAttribute(\"data-language\");\r\n        if (language) {\r\n            editor.getSession().setMode(\"ace/mode/\" + language)\r\n        }\r\n    };\r\n\r\n    var codeEditorField = {\r\n        name: fieldName,\r\n        onReady(ctx) {\r\n            console.log(\"Onload\");\r\n            console.log(ctx)\r\n            SPScript.utils.waitForLibrary(\"ace\").then(() => setupEditor(ctx));\r\n        },\r\n        render(ctx) {\r\n            var item = ctx.CurrentItem;\r\n            var language = item[\"Language\"] ? ` data-language='${item.Language}' ` : \"\";\r\n            return `<div id='${editorId}' ${language} style='min-height:200px; min-width:300px'>${item[fieldName] || \"\"}</div>`\r\n        },\r\n        getValue(ctx) {\r\n            console.log(\"GET VALUE\");\r\n            return editor.getValue();\r\n        },\r\n        locations:[\"View\", \"NewForm\",\"DisplayForm\", \"EditForm\"]\r\n    };\r\n\r\n    SPScript.utils.waitForLibrary(\"SPClientTemplates.TemplateManager\").then(() => {\r\n        CSR.registerFormField(codeEditorField);\r\n    })\r\n};\r\nsetTimeout(() => {\r\n\tSPScript.utils.getScript(\"https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.5/ace.js\");\r\n},10)"]}