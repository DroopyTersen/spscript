{"version":3,"sources":["../../../src/plugins/VisibilityManager/index.js"],"names":["global","VisibilityManager","columnLabels","document","querySelectorAll","prototype","findRow","fieldName","i","length","innerText","textContent","replace","trim","parentNode","hideField","style","display","toggleVisiblity","fields","shouldShow","createCheckboxToggle","checkboxName","childFields","self","checkbox","querySelector","onclick","checked","createDropdownToggle","dropdownName","choices","dropdown","update","value","onchange","createRadioToggle","radio","radios","String","window"],"mappings":"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","file":"index.js","sourcesContent":["//USAGE\r\n// //Create the overall visibility manager\r\n// var visibilityManager = new VisibilityManager();\r\n// //create a checkbox toggle\r\n// var checkboxToggle = visibilityManager.createCheckboxToggle(\"YesNoTest\", [\"Poster\", \"Backdrop\"]);\r\n\r\n// //The radio and dropdown toggle both take in a 'choices' array\r\n// var choices = [\r\n// \t{ value: \"Enter Choice #1\", childFields: [\"ChoiceTestMultiple\", \"ChoiceTestSingle\"] },\r\n// \t{ value: \"Enter Choice #2\", childFields: [\"LookupSingle\", \"LookupMultiple\"] },\r\n// \t{ value: \"Enter Choice #3\", childFields: [\"PersonTest\"] }\r\n// ];\r\n// var radioToggle = visibilityManager.createRadioToggle(\"ChoiceTestRadio\", choices);\r\n// var dropdownToggle = visibilityManager.createDropdownToggle(\"ChoiceTestSingle\", choices);\r\n(function(global) {\r\n\t//Constructor\r\n\tvar VisibilityManager = function() {\r\n\t\tthis.columnLabels = document.querySelectorAll(\".ms-standardheader\");\r\n\t};\r\n\r\n\r\n\tVisibilityManager.prototype.findRow = function(fieldName) {\r\n\t\tfor (var i = 0; i < this.columnLabels.length; i++) {\r\n\t\t\tvar innerText = (this.columnLabels[i].innerText || this.columnLabels[i].textContent);\r\n\t\t\tinnerText = innerText.replace(\"*\", \"\").trim();\r\n\t\t\tif (innerText === fieldName) {\r\n\t\t\t\treturn this.columnLabels[i].parentNode.parentNode;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tVisibilityManager.prototype.hideField = function(fieldName) {\r\n\t\tthis.findRow(fieldName).style.display = \"none\";\r\n\r\n\t};\r\n\r\n\tVisibilityManager.prototype.toggleVisiblity = function(fields, shouldShow) {\r\n\t\tfor (var i = 0; i < fields.length; i++) {\r\n\t\t\tthis.findRow(fields[i]).style.display = shouldShow ? \"table-row\" : \"none\";\r\n\t\t}\r\n\t};\r\n\r\n\tVisibilityManager.prototype.createCheckboxToggle = function(checkboxName, childFields) {\r\n\t\tvar self = this;\r\n\t\tvar checkbox = self.findRow(checkboxName).querySelector(\"input[type='checkbox'\");\r\n\t\tcheckbox.onclick = function() {\r\n\t\t\tself.toggleVisiblity(childFields, checkbox.checked);\r\n\t\t};\r\n\t\tself.toggleVisiblity(childFields, checkbox.checked);\r\n\t\treturn checkbox;\r\n\t};\r\n\r\n\tVisibilityManager.prototype.createDropdownToggle = function(dropdownName, choices) {\r\n\t\tvar self = this;\r\n\t\tvar dropdown = self.findRow(dropdownName).querySelector(\"select\");\r\n\t\tvar update = function() {\r\n\t\t\tvar value = dropdown.value;\r\n\t\t\tfor (var i = 0; i < choices.length; i++) {\r\n\t\t\t\tself.toggleVisiblity(choices[i].childFields, value == choices[i].value);\r\n\t\t\t}\r\n\t\t};\r\n\t\tdropdown.onchange = update;\r\n\t\tupdate();\r\n\t\treturn dropdown;\r\n\t};\r\n\r\n\tVisibilityManager.prototype.createRadioToggle = function(radio, choices) {\r\n\t\tvar self = this;\r\n\t\tvar radios = self.findRow(radio).querySelectorAll(\"input[type='radio']\");\r\n\t\tvar update = function() {\r\n\t\t\tvar value = \"\";\r\n\t\t\tfor (var i = 0; i < radios.length; i++) {\r\n\t\t\t\tif (radios[i].checked) {\r\n\t\t\t\t\tvalue = radios[i].value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (i = 0; i < choices.length; i++) {\r\n\t\t\t\tself.toggleVisiblity(choices[i].childFields, value == choices[i].value);\r\n\t\t\t}\r\n\t\t};\r\n\t\tfor (var i = 0; i < radios.length; i++) {\r\n\t\t\tradios[i].onclick = update;\r\n\t\t}\r\n\r\n\t\tupdate();\r\n\t\treturn radios;\r\n\t};\r\n\r\n\t//Manually implement String.trim() for IE8 (we'll need it to trim the label because IE likes to toss whitespace in there)\r\n\tif (!String.prototype.trim) {\r\n\t\tString.prototype.trim = function() {\r\n\t\t\treturn this.replace(/^\\s+|\\s+$/gm, '');\r\n\t\t};\r\n\t}\r\n\r\n\tglobal.VisibilityManager = VisibilityManager;\r\n})(window);\r\n"]}