{"version":3,"sources":["../../../src/plugins/SPExplorer/spExplorer.js"],"names":[],"mappings":"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","file":"spExplorer.js","sourcesContent":["(function(sp) {\r\n\tvar SPExplorer = function(webUrl) {\r\n\t\tthis.webUrl = webUrl;\r\n\t\tthis.parentWebUrl = null;\r\n\t\tthis.parentWeb = null;\r\n\t\tthis.rootSite = null;\r\n\t\tthis.serverUrl = window.location.protocol + \"//\" + window.location.host;\r\n\t};\r\n\r\n\tSPExplorer.prototype.getParentWeb = function(currentWebUrl) {\r\n\t\tvar dao = new sp.RestDao(currentWebUrl);\r\n\t\tvar relativeUrl = \"/Web/ParentWeb\";\r\n\t\t\r\n\t\treturn dao.get(relativeUrl).then(function(data){\r\n\t\t\t\t\r\n\t\t\tif (data && data.d && data.d.ParentWeb !== null) {\r\n\t\t\t\treturn data.d;\r\n\t\t\t} \r\n\t\t\treturn null;\r\n\t\t}, function() {\r\n\t\t\treturn null;\r\n\t\t});\r\n\t};\r\n\r\n\tSPExplorer.prototype._recursiveSetParent = function(url) {\r\n\t\tvar self = this;\r\n\t\treturn self.getParentWeb(url)\r\n\t\t\t.then(function(parentWeb){\r\n\r\n\t\t\t\tif (parentWeb !== null) {\r\n\t\t\t\t\tself.parentWeb = parentWeb;\r\n\t\t\t\t\treturn self._recursiveSetParent(self.serverUrl + parentWeb.ServerRelativeUrl);\r\n\t\t\t\t} \r\n\t\t\t});\r\n\t};\r\n\r\n\tSPExplorer.prototype.setRootWeb = function(){\r\n\t\tvar self = this;\r\n\t\treturn self._recursiveSetParent(this.webUrl).then(function(){\r\n\t\t\tself.rootSite = new SPExplorerSite(self.parentWeb);\r\n\t\t\tconsole.log(self.rootSite);\r\n\t\t});\r\n\t};\r\n\r\n\tvar SPExplorerSite = function(spWeb) {\r\n\t\tthis._spWeb = spWeb;\r\n\t\tthis.title = spWeb.Title;\r\n\t\tthis.description = spWeb.Description;\r\n\t\tthis.url = window.location.protocol + \"//\" + window.location.host + spWeb.ServerRelativeUrl;\r\n\t\tthis.lists = [];\r\n\t\tthis.sites = [];\r\n\t};\r\n\r\n\tSPExplorerSite.fromSPWeb = function(spWeb) {\r\n\t\treturn new SPExplorerSite(spWeb);\r\n\t};\r\n\r\n\tSPExplorerSite.prototype.populate = function() {\r\n\t\tvar self = this;\r\n\t\tvar dao = new sp.RestDao(self.url);\r\n\t\treturn dao.get(\"/web/lists\")\r\n\t\t\t.then(function(data){\r\n\t\t\t\tself.lists = data.d.results;\r\n\t\t\t})\r\n\t\t\t.then(function() {\r\n\t\t\t\treturn dao.get(\"/web/webinfos\");\r\n\t\t\t})\r\n\t\t\t.then(function(data) {\r\n\t\t\t\tvar spWebs = data.d.results;\r\n\t\t\t\tself.sites = $.map(spWebs, SPExplorerSite.fromSPWeb);\r\n\t\t\t});\r\n\t};\r\n\r\n\tsp.SPExplorer = SPExplorer;\r\n\r\n}) (SPScript);\r\n\r\n"]}