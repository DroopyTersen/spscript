{"version":3,"sources":["../../../src/plugins/SPExplorer/spExplorer.js"],"names":["sp","SPExplorer","webUrl","parentWebUrl","parentWeb","rootSite","serverUrl","window","location","protocol","host","prototype","getParentWeb","currentWebUrl","dao","RestDao","relativeUrl","get","then","data","d","ParentWeb","_recursiveSetParent","url","self","ServerRelativeUrl","setRootWeb","SPExplorerSite","console","log","spWeb","_spWeb","title","Title","description","Description","lists","sites","fromSPWeb","populate","results","spWebs","$","map","SPScript"],"mappings":"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","file":"spExplorer.js","sourcesContent":["(function(sp) {\r\n\tvar SPExplorer = function(webUrl) {\r\n\t\tthis.webUrl = webUrl;\r\n\t\tthis.parentWebUrl = null;\r\n\t\tthis.parentWeb = null;\r\n\t\tthis.rootSite = null;\r\n\t\tthis.serverUrl = window.location.protocol + \"//\" + window.location.host;\r\n\t};\r\n\r\n\tSPExplorer.prototype.getParentWeb = function(currentWebUrl) {\r\n\t\tvar dao = new sp.RestDao(currentWebUrl);\r\n\t\tvar relativeUrl = \"/Web/ParentWeb\";\r\n\t\t\r\n\t\treturn dao.get(relativeUrl).then(function(data){\r\n\t\t\t\t\r\n\t\t\tif (data && data.d && data.d.ParentWeb !== null) {\r\n\t\t\t\treturn data.d;\r\n\t\t\t} \r\n\t\t\treturn null;\r\n\t\t}, function() {\r\n\t\t\treturn null;\r\n\t\t});\r\n\t};\r\n\r\n\tSPExplorer.prototype._recursiveSetParent = function(url) {\r\n\t\tvar self = this;\r\n\t\treturn self.getParentWeb(url)\r\n\t\t\t.then(function(parentWeb){\r\n\r\n\t\t\t\tif (parentWeb !== null) {\r\n\t\t\t\t\tself.parentWeb = parentWeb;\r\n\t\t\t\t\treturn self._recursiveSetParent(self.serverUrl + parentWeb.ServerRelativeUrl);\r\n\t\t\t\t} \r\n\t\t\t});\r\n\t};\r\n\r\n\tSPExplorer.prototype.setRootWeb = function(){\r\n\t\tvar self = this;\r\n\t\treturn self._recursiveSetParent(this.webUrl).then(function(){\r\n\t\t\tself.rootSite = new SPExplorerSite(self.parentWeb);\r\n\t\t\tconsole.log(self.rootSite);\r\n\t\t});\r\n\t};\r\n\r\n\tvar SPExplorerSite = function(spWeb) {\r\n\t\tthis._spWeb = spWeb;\r\n\t\tthis.title = spWeb.Title;\r\n\t\tthis.description = spWeb.Description;\r\n\t\tthis.url = window.location.protocol + \"//\" + window.location.host + spWeb.ServerRelativeUrl;\r\n\t\tthis.lists = [];\r\n\t\tthis.sites = [];\r\n\t};\r\n\r\n\tSPExplorerSite.fromSPWeb = function(spWeb) {\r\n\t\treturn new SPExplorerSite(spWeb);\r\n\t};\r\n\r\n\tSPExplorerSite.prototype.populate = function() {\r\n\t\tvar self = this;\r\n\t\tvar dao = new sp.RestDao(self.url);\r\n\t\treturn dao.get(\"/web/lists\")\r\n\t\t\t.then(function(data){\r\n\t\t\t\tself.lists = data.d.results;\r\n\t\t\t})\r\n\t\t\t.then(function() {\r\n\t\t\t\treturn dao.get(\"/web/webinfos\");\r\n\t\t\t})\r\n\t\t\t.then(function(data) {\r\n\t\t\t\tvar spWebs = data.d.results;\r\n\t\t\t\tself.sites = $.map(spWebs, SPExplorerSite.fromSPWeb);\r\n\t\t\t});\r\n\t};\r\n\r\n\tsp.SPExplorer = SPExplorer;\r\n\r\n}) (SPScript);\r\n\r\n"]}