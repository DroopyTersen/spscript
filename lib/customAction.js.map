{"version":3,"sources":["../src/customAction.js"],"names":[],"mappings":";;;;AAAA,IAAI,QAAQ,QAAQ,SAAR,CAAZ;AACA,IAAI,UAAU,QAAQ,kBAAR,CAAd;;;;;AAOA,IAAI,WAAW;AACd,aAAY;AACX,UAAQ;AADG;AADE,CAAf;;AAMA,IAAI,gBAAgB,SAAhB,aAAgB,CAAS,GAAT,EAAc;AACjC,MAAK,GAAL,GAAW,GAAX;AACA,MAAK,OAAL,GAAe,wBAAf;AACA,CAHD;;AAKA,cAAc,SAAd,CAAwB,GAAxB,GAA8B,UAAS,IAAT,EAAe;AAC5C,QAAO,KAAK,GAAL,CAAS,IAAT,CAAc,GAAd,CAAkB,KAAK,OAAvB,EACL,IADK,CACA,MAAM,eADN,EAEL,IAFK,CAEA,yBAAiB;AACtB,MAAI,IAAJ,EAAU,OAAO,cAAc,IAAd,CAAmB;AAAA,UAAK,EAAE,IAAF,KAAW,IAAhB;AAAA,GAAnB,CAAP,CAAV,KACK,OAAO,aAAP;AACL,EALK,CAAP;AAMA,CAPD;;AASA,cAAc,SAAd,CAAwB,OAAxB,GAAkC,UAAS,IAAT,EAAe;AAAA;;AAChD,QAAO,KAAK,GAAL,CAAS,QAAQ,IAAjB,EAAuB,IAAvB,CAA4B;AAAA,SAAQ,MAAK,OAAb,UAAyB,EAAE,EAA3B;AAAA,EAA5B,CAAP;AACA,CAFD;;AAIA,cAAc,SAAd,CAAwB,gBAAxB,GAA2C,UAAS,IAAT,EAAe;AAAA;;AACzD,KAAI,MAAM,IAAV;AACA,QAAO,KAAK,MAAL,CAAY,QAAQ,IAApB,EACL,IADK,CACA,eAAO;AACZ,QAAM,GAAN;AACA,SAAO,OAAK,GAAL,CAAS,gBAAT,EAAP;AACA,EAJK,EAKL,IALK,CAKA,kBAAU;AAAC,UAAQ,GAAR;AAAY,EALvB,CAAP;AAMA,CARD;;AAUA,cAAc,SAAd,CAAwB,MAAxB,GAAiC,UAAS,OAAT,EAAkB;AAAA;;AAClD,KAAI,CAAC,OAAD,IAAY,CAAC,QAAQ,IAAzB,EAA+B,MAAM,IAAI,KAAJ,CAAU,+CAAV,CAAN;AAC/B,KAAI,MAAM,IAAV;AACA,QAAO,KAAK,eAAL,CAAqB,QAAQ,IAA7B,EACL,IADK,CACA,gBAAQ;AACb,YAAU,SAAc,EAAd,EAAkB,QAAlB,EAA4B,OAA5B,CAAV;AACA,MAAI,gBAAgB;AACnB,YAAS,QAAQ,gBAAR,CAAyB,KAAK,MAA9B;AADU,GAApB;AAGA,SAAO,OAAK,IAAL,CAAU,IAAV,CAAe,IAAf,CAAoB,KAAK,GAAzB,EAA8B,OAA9B,EAAuC,aAAvC,CAAP;AACA,EAPK,CAAP;AAQA,CAXD;;AAaA,cAAc,QAAd,GAAyB,QAAzB;AACA,OAAO,OAAP,GAAiB,aAAjB","file":"customAction.js","sourcesContent":["var utils = require(\"./utils\");\r\nvar headers = require(\"./requestHeaders\");\r\n\r\n// MSDN Info\r\n// https://msdn.microsoft.com/en-us/library/office/dn531432.aspx#bk_UserCustomActionCollection\r\n\r\n\r\n\r\nvar metadata = {\r\n\t__metadata: {\r\n\t\t\"type\": \"SP.UserCustomAction\"\r\n\t}\r\n};\r\n\r\nvar CustomActions = function(web) {\r\n\tthis.web = web;\r\n\tthis.baseUrl = \"/web/userCustomActions\";\r\n};\r\n\r\nCustomActions.prototype.get = function(name) {\r\n\treturn this.web._dao.get(this.baseUrl)\r\n\t\t.then(utils.validateODataV2)\r\n\t\t.then(customActions => {\r\n\t\t\tif (name) return customActions.find(a => a.Name === name);\r\n\t\t\telse return customActions;\r\n\t\t});\r\n};\r\n\r\nCustomActions.prototype._getUrl = function(name) {\r\n\treturn this.get(updates.Name).then(a => `${this.baseUrl}('${a.Id}')`);\r\n};\r\n\r\nCustomActions.prototype._getUrlAndDigest = function(name) {\r\n\tvar url = null;\r\n\treturn this.getUrl(updates.Name)\r\n\t\t.then(url => {\r\n\t\t\turl = url;\r\n\t\t\treturn this.web.getRequestDigest()\r\n\t\t})\r\n\t\t.then(digest => {digest, url});\r\n};\r\n\r\nCustomActions.prototype.update = function(updates) {\r\n\tif (!updates || !updates.Name) throw new Error(\"You must at least pass a Custom Action 'Name'\");\r\n\tvar url = null;\r\n\treturn this.getUrlAndDigest(updates.Name)\r\n\t\t.then(prep => {\r\n\t\t\tupdates = Object.assign({}, metadata, updates);\r\n\t\t\tvar customOptions = {\r\n\t\t\t\theaders: headers.getUpdateHeaders(prep.digest)\r\n\t\t\t};\r\n\t\t\treturn this._web._dao.post(prep.url, updates, customOptions);\r\n\t\t})\r\n};\r\n\r\nCustomActions.metadata = metadata;\r\nmodule.exports = CustomActions;"]}