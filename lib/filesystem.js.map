{"version":3,"sources":["../src/filesystem.js"],"names":[],"mappings":";;AAAA,IAAI,QAAQ,QAAQ,SAAR,CAAZ;;;;;;;;;;;;;;;;;;;AAmBA,IAAI,SAAS,SAAT,MAAS,CAAS,QAAT,EAAmB;AAC/B,OAAK,aAAL,CAAmB,QAAnB;AACA,OAAK,gBAAL,CAAsB,QAAtB;AACA,CAHD;;AAKA,OAAO,SAAP,CAAiB,gBAAjB,GAAoC,UAAS,QAAT,EAAmB;AACtD,MAAI,YAAY,SAAS,OAArB,IAAgC,SAAS,OAAT,CAAiB,OAArD,EAA8D;AAC7D,SAAK,OAAL,GAAe,SAAS,OAAT,CAAiB,OAAjB,CAAyB,GAAzB,CAA6B;AAAA,aAAK,IAAI,MAAJ,CAAW,CAAX,CAAL;AAAA,KAA7B,CAAf;AACA;AACD,MAAI,YAAY,SAAS,KAArB,IAA8B,SAAS,KAAT,CAAe,OAAjD,EAA0D;AACzD,SAAK,KAAL,GAAa,SAAS,KAAT,CAAe,OAAf,CAAuB,GAAvB,CAA2B;AAAA,aAAK,IAAI,IAAJ,CAAS,CAAT,CAAL;AAAA,KAA3B,CAAb;AACA;AACD,CAPD;;AASA,OAAO,SAAP,CAAiB,aAAjB,GAAiC,UAAS,QAAT,EAAmB;AACnD,OAAK,IAAL,GAAY,SAAS,IAArB;AACA,OAAK,iBAAL,GAAyB,SAAS,iBAAlC;AACA,OAAK,SAAL,GAAiB,SAAS,SAA1B;AACA,OAAK,IAAL,GAAY,SAAS,QAArB;AACA,OAAK,GAAL,GAAW,SAAS,UAAT,CAAoB,GAA/B;AACA,CAND;;;;;;;;;;;;;;;;;;;;AA0BA,IAAI,OAAO,SAAP,IAAO,CAAS,MAAT,EAAiB;AAC3B,OAAK,aAAL,CAAmB,MAAnB;AACA,CAFD;;AAIA,KAAK,SAAL,CAAe,aAAf,GAA+B,UAAS,MAAT,EAAiB;AAC/C,OAAK,IAAL,GAAY,OAAO,IAAnB,EACA,KAAK,KAAL,GAAa,OAAO,KADpB,EAEA,KAAK,YAAL,GAAoB,OAAO,YAF3B,EAGA,KAAK,UAAL,GAAkB,OAAO,MAHzB,EAIA,KAAK,YAAL,GAAoB,OAAO,YAJ3B,EAKA,KAAK,YAAL,GAAoB,OAAO,YAL3B,EAMA,KAAK,iBAAL,GAAyB,OAAO,iBANhC,EAOA,KAAK,GAAL,GAAY,OAAO,UAAP,CAAkB,GAP9B;AAQA,CATD;;AAYA,OAAO,OAAP,GAAiB;AAChB,QAAM,IADU;AAEhB,UAAQ;AAFQ,CAAjB","file":"filesystem.js","sourcesContent":["var utils = require(\"./utils\");\r\n\r\n/**\r\n * Represents a SharePoint Folder.  Keep in mind, and File or Folder objects obtained from the 'files' and 'folders' array will not have their child items populated.\r\n * @typedef Folder\r\n * @property {string} name - Folder name\r\n * @property {string} serverRelativeUrl - Server relative url\r\n * @property {int} itemCount - Number of items in the folder\r\n * @property {string} guid - Unique ID of the folder\r\n * @property {string} uri - API url to get the raw SP.Folder object\r\n * @property {Array<File>} files - An array of files in that folder\r\n * @property {Array<Folder>} folders - An array of sub folders\r\n * @example\r\n *  dao.web.getFolder(\"/sites/mysite/Shared Documents\")\r\n *\t\t\t.then(function(folder) { \r\n *\t\t\t\tconsole.log(folder.name);\r\n *\t\t\t\tconsole.log(folder.files);\r\n *\t\t\t});\r\n */\r\nvar Folder = function(spFolder) {\r\n\tthis.mapProperties(spFolder);\r\n\tthis.populateChildren(spFolder);\r\n};\r\n\r\nFolder.prototype.populateChildren = function(spFolder) {\r\n\tif (spFolder && spFolder.Folders && spFolder.Folders.results) {\r\n\t\tthis.folders = spFolder.Folders.results.map(f => new Folder(f));\r\n\t}\r\n\tif (spFolder && spFolder.Files && spFolder.Files.results) {\r\n\t\tthis.files = spFolder.Files.results.map(f => new File(f));\r\n\t}\r\n};\r\n\r\nFolder.prototype.mapProperties = function(spFolder) {\r\n\tthis.name = spFolder.Name;\r\n\tthis.serverRelativeUrl = spFolder.ServerRelativeUrl;\r\n\tthis.itemCount = spFolder.ItemCount;\r\n\tthis.guid = spFolder.UniqueId;\r\n\tthis.uri = spFolder.__metadata.uri;\r\n};\r\n\r\n/**\r\n * Represents a SharePoint File\r\n * @typedef File\r\n * @property {string} name - Folder name\r\n * @property {string} title - Folder title\r\n * @property {string} serverRelativeUrl - Server relative url\r\n * @property {int} byteLength - File size in bytes\r\n * @property {string} checkoutType - Checked out status of file.  \"none\", \"offline\", \"online\".\r\n * @property {number} majorVersion - Major version of the file\r\n * @property {number} minorVersion - Minor version of the file\r\n * @property {string} uri - API url to get the raw SP.Folder object\r\n * @example\r\n *  dao.web.getFile(\"/sites/mysite/Shared Documents/myFile.docx\")\r\n *\t\t\t.then(function(file) { \r\n *\t\t\t\tconsole.log(file.name);\r\n *\t\t\t\tconsole.log(\"Size:\" + (file.byteLength / 1000) + \"KB\");\r\n *\t\t\t});\r\n */\r\nvar File = function(spFile) {\r\n\tthis.mapProperties(spFile);\r\n};\r\n\r\nFile.prototype.mapProperties = function(spFile) {\r\n\tthis.name = spFile.Name,\r\n\tthis.title = spFile.Title,\r\n\tthis.checkoutType = spFile.CheckOutType,\r\n\tthis.byteLength = spFile.Length,\r\n\tthis.majorVersion = spFile.MajorVersion,\r\n\tthis.minorVersion = spFile.MinorVersion,\r\n\tthis.serverRelativeUrl = spFile.ServerRelativeUrl,\r\n\tthis.uri =  spFile.__metadata.uri\r\n};\r\n\t\r\n\r\nmodule.exports = {\r\n\tFile: File,\r\n\tFolder: Folder\r\n};"]}