{"version":3,"sources":["../src/restDao.js"],"names":[],"mappings":";;;;AAAA,IAAI,UAAU,QAAQ,WAAR,CAAd;AACA,IAAI,OAAO,QAAQ,QAAR,CAAX;AACA,IAAI,QAAQ,QAAQ,SAAR,CAAZ;;;;;;;;;;;;;;AAcA,IAAI,UAAU,SAAV,OAAU,CAAS,GAAT,EAAc;AAC3B,KAAI,OAAO,IAAX;AACA,SAAQ,IAAR,CAAa,IAAb;AACA,MAAK,MAAL,GAAc,OAAO,mBAAmB,cAAxC;AACA,CAJD;;AAMA,QAAQ,SAAR,GAAoB,OAAO,MAAP,CAAc,QAAQ,SAAtB,CAApB;;AAEA,QAAQ,SAAR,CAAkB,cAAlB,GAAmC,UAAS,GAAT,EAAc,OAAd,EAAuB;AACzD,KAAI,UAAW,QAAD,CAAW,IAAX,CAAgB,GAAhB,IAAuB,GAAvB,GAA6B,KAAK,MAAL,GAAc,OAAd,GAAwB,GAAnE;;AAEA,KAAI,iBAAiB;AACpB,OAAK,OADe;AAEpB,UAAQ,KAFY;AAGpB,WAAS;AACR,aAAU,iCADF;AAER,mBAAgB;AAFR;AAHW,EAArB;;AASA,KAAI,cAAc,SAAc,EAAd,EAAkB,cAAlB,EAAkC,OAAlC,CAAlB;AACA,QAAO,KAAK,WAAL,EAAkB,KAAlB,CAAwB,MAAM,mBAA9B,CAAP;AACA,CAdD;;AAiBA,OAAO,OAAP,GAAiB,OAAjB","file":"restDao.js","sourcesContent":["var BaseDao = require(\"./baseDao\");\r\nvar ajax = require('./ajax') \r\nvar utils = require(\"./utils\");\r\n/**\r\n * Main point of entry. Big Daddy class that all SP requests are routed through. Data Access Object (DAO)\r\n * @class\r\n * @augments BaseDao\r\n\r\n * @param {string} [url] - Url of the site you are connected to. _spPageContextInfo.webAbsoluteUrl will be used if no value is passed.\r\n * @property {string} webUrl - Url of the site you are connected to\r\n * @property {Web} web - Allows interacting with the SharePoint site you connected to\r\n * @property {Search} search - Allows querying through the SP Search Service\r\n * @property {Profiles} profiles - Allows interacting with the SP Profile Service\r\n * @example <caption>Create a new instance of a RestDao</caption>\r\n * var dao = new SPScript.RestDao(_spPageContextInfo.webAbsoluteUrl);\r\n */ \r\nvar RestDao = function(url) {\r\n\tvar self = this;\r\n\tBaseDao.call(this);\r\n\tthis.webUrl = url || _spPageContextInfo.webAbsoluteUrl;\r\n};\r\n\r\nRestDao.prototype = Object.create(BaseDao.prototype);\r\n\r\nRestDao.prototype.executeRequest = function(url, options) {\r\n\tvar fullUrl = (/^http/i).test(url) ? url : this.webUrl + \"/_api\" + url;\r\n\r\n\tvar defaultOptions = {\r\n\t\turl: fullUrl,\r\n\t\tmethod: \"GET\",\r\n\t\theaders: {\r\n\t\t\t\"Accept\": \"application/json; odata=verbose\",\r\n\t\t\t\"Content-Type\": \"application/json; odata=verbose\"\r\n\t\t}\r\n\t};\r\n\r\n\tvar ajaxOptions = Object.assign({}, defaultOptions, options);\r\n\treturn ajax(ajaxOptions).catch(utils.handleErrorResponse);\r\n};\r\n\r\n\r\nmodule.exports = RestDao;"]}