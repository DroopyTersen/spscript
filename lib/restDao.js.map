{"version":3,"sources":["../src/restDao.js"],"names":["BaseDao","require","ajax","utils","RestDao","url","self","call","webUrl","_spPageContextInfo","webAbsoluteUrl","prototype","Object","create","executeRequest","options","fullUrl","test","defaultOptions","method","headers","ajaxOptions","catch","handleErrorResponse","module","exports"],"mappings":";;;;AAAA,IAAIA,UAAUC,QAAQ,WAAR,CAAd;AACA,IAAIC,OAAOD,QAAQ,QAAR,CAAX;AACA,IAAIE,QAAQF,QAAQ,SAAR,CAAZ;AACA;;;;;;;;;;;;;AAaA,IAAIG,UAAU,SAAVA,OAAU,CAASC,GAAT,EAAc;AAC3B,KAAIC,OAAO,IAAX;AACAN,SAAQO,IAAR,CAAa,IAAb;AACA,MAAKC,MAAL,GAAcH,OAAOI,mBAAmBC,cAAxC;AACA,CAJD;;AAMAN,QAAQO,SAAR,GAAoBC,OAAOC,MAAP,CAAcb,QAAQW,SAAtB,CAApB;;AAEAP,QAAQO,SAAR,CAAkBG,cAAlB,GAAmC,UAAST,GAAT,EAAcU,OAAd,EAAuB;AACzD,KAAIC,UAAW,QAAD,CAAWC,IAAX,CAAgBZ,GAAhB,IAAuBA,GAAvB,GAA6B,KAAKG,MAAL,GAAc,OAAd,GAAwBH,GAAnE;;AAEA,KAAIa,iBAAiB;AACpBb,OAAKW,OADe;AAEpBG,UAAQ,KAFY;AAGpBC,WAAS;AACR,aAAU,iCADF;AAER,mBAAgB;AAFR;AAHW,EAArB;;AASA,KAAIC,cAAc,SAAc,EAAd,EAAkBH,cAAlB,EAAkCH,OAAlC,CAAlB;AACA,QAAOb,KAAKmB,WAAL,EAAkBC,KAAlB,CAAwBnB,MAAMoB,mBAA9B,CAAP;AACA,CAdD;;AAiBAC,OAAOC,OAAP,GAAiBrB,OAAjB","file":"restDao.js","sourcesContent":["var BaseDao = require(\"./baseDao\");\r\nvar ajax = require('./ajax') \r\nvar utils = require(\"./utils\");\r\n/**\r\n * Main point of entry. Big Daddy class that all SP requests are routed through. Data Access Object (DAO)\r\n * @class\r\n * @augments BaseDao\r\n\r\n * @param {string} [url] - Url of the site you are connected to. _spPageContextInfo.webAbsoluteUrl will be used if no value is passed.\r\n * @property {string} webUrl - Url of the site you are connected to\r\n * @property {Web} web - Allows interacting with the SharePoint site you connected to\r\n * @property {Search} search - Allows querying through the SP Search Service\r\n * @property {Profiles} profiles - Allows interacting with the SP Profile Service\r\n * @example <caption>Create a new instance of a RestDao</caption>\r\n * var dao = new SPScript.RestDao(_spPageContextInfo.webAbsoluteUrl);\r\n */ \r\nvar RestDao = function(url) {\r\n\tvar self = this;\r\n\tBaseDao.call(this);\r\n\tthis.webUrl = url || _spPageContextInfo.webAbsoluteUrl;\r\n};\r\n\r\nRestDao.prototype = Object.create(BaseDao.prototype);\r\n\r\nRestDao.prototype.executeRequest = function(url, options) {\r\n\tvar fullUrl = (/^http/i).test(url) ? url : this.webUrl + \"/_api\" + url;\r\n\r\n\tvar defaultOptions = {\r\n\t\turl: fullUrl,\r\n\t\tmethod: \"GET\",\r\n\t\theaders: {\r\n\t\t\t\"Accept\": \"application/json; odata=verbose\",\r\n\t\t\t\"Content-Type\": \"application/json; odata=verbose\"\r\n\t\t}\r\n\t};\r\n\r\n\tvar ajaxOptions = Object.assign({}, defaultOptions, options);\r\n\treturn ajax(ajaxOptions).catch(utils.handleErrorResponse);\r\n};\r\n\r\n\r\nmodule.exports = RestDao;"]}