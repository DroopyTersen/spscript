<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"global.html":{"id":"global.html","title":"Global","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Global Methods &lt;abstract&gt; BaseDao() Abstract class. You'll never work with this directly. Properties: Name Type Description web Web Allows interacting with the SharePoint site you connected to search Search Allows querying through the SP Search Service profiles Profiles Allows interacting with the SP Profile Service Requires: module:src/utils module:src/list module:src/profiles module:src/web module:src/search × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Classes Classes File Folder RestDao Web Namespaces ajax utils × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Namespaces Classes File Folder RestDao Web Namespaces ajax utils × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"File.html":{"id":"File.html","title":"Class: File","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Class: File File new File(spFile) Represents a SharePoint File Parameters: Name Type Description spFile SP.File A raw SP.File object Properties: Name Type Description name string Folder name title string Folder title serverRelativeUrl string Server relative url byteLength int File size in bytes checkoutType string Checked out status of file. &quot;none&quot;, &quot;offline&quot;, &quot;online&quot;. majorVersion number Major version of the file minorVersion number Minor version of the file uri string API url to get the raw SP.Folder object Example dao.web.getFile(&quot;/sites/mysite/Shared Documents/myFile.docx&quot;) .then(function(file) { console.log(file.name); console.log(&quot;Size:&quot; + (file.byteLength / 1000) + &quot;KB&quot;); }); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"Folder.html":{"id":"Folder.html","title":"Class: Folder","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Class: Folder Folder new Folder(spFolder) Represents a SharePoint Folder. Keep in mind, and File or Folder objects obtained from the 'files' and 'folders' array will not have their child items populated. Parameters: Name Type Description spFolder SP.Folder A raw SP.Folder object Properties: Name Type Description name string Folder name serverRelativeUrl string Server relative url itemCount int Number of items in the folder guid string Unique ID of the folder uri string API url to get the raw SP.Folder object files Array.&lt;File&gt; An array of files in that folder folders Array.&lt;Folder&gt; An array of sub folders Example dao.web.getFolder(&quot;/sites/mysite/Shared Documents&quot;) .then(function(folder) { console.log(folder.name); console.log(folder.files); }); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"RestDao.html":{"id":"RestDao.html","title":"Class: RestDao","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Class: RestDao RestDao new RestDao(url) Main point of entry. Big Daddy class that all SP requests are routed through. Parameters: Name Type Argument Description url string &lt;optional&gt; Url of the site you are connected to. _spPageContextInfo.webAbsoluteUrl will be used if no value is passed. Properties: Name Type Description webUrl string Url of the site you are connected to web Web Allows interacting with the SharePoint site you connected to search Search Allows querying through the SP Search Service profiles Profiles Allows interacting with the SP Profile Service Extends BaseDao Methods get(relativeQueryUrl, extendedOptions) Generic helper to make AJAX GET request Parameters: Name Type Argument Description relativeQueryUrl string the API url relative to &quot;/_api&quot; extendedOptions Object &lt;optional&gt; AJAX options (like custom request headers) Inherited From: BaseDao#get Returns: - An ES6 Promise that resolves to the an object probably in the form of data.d Type Promise Example Example usage of to log a site's content types dao.get('/web/contentTypes').then(function(data) { console.log(data.d.results)}) lists(listname) If a list name is passed, an SPScript.List object, otherwise performs a request to get all the site's lists Parameters: Name Type Argument Description listname string &lt;optional&gt; If a list name is passed, method is synchronous returning an SPScript.List Inherited From: BaseDao#lists Returns: - SPScript.List object or a Promise that resolves to an Array of lists Type List | Promise.&lt;Array.&lt;lists&gt;&gt; Examples Option 1: No List Name gets all the lists of a site dao.lists().then(function(lists) { console.log(lists)}); Option 2: Pass a List Name to get a list object var list = dao.lists('MyList'); list.getItemById(12).then(function(item) { console.log(item)}); post(relativeQueryUrl, extendedOptions) Generic helper to make AJAX POST request Parameters: Name Type Argument Description relativeQueryUrl string the API url relative to &quot;/_api&quot; extendedOptions Object &lt;optional&gt; AJAX options (like custom request headers) Inherited From: BaseDao#post Returns: - An ES6 Promise Type Promise × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"SPScript.ajax.html":{"id":"SPScript.ajax.html","title":"Namespace: ajax","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Namespace: ajax ajax Methods &lt;static&gt; ajax(options) Performs and AJAX request based on options you pass you. Your options must at least have a url. Parameters: Name Type Description options object Request options like { url, headers, method }; Returns: - A Promise that resolves or rejects when the request comes back Type Promise Example var ajaxOptions = { url: '/_api/web/contentTypes', method: &quot;GET&quot;, headers: { Accept: &quot;application/json;odata=verbose&quot; } }; SPScript.utils.ajax(ajaxOptions) .then(SPScript.utils.parseJSON) .then(function(data){ console.log(data.d.results) }) .catch(function(error) { console.log(error)}) × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"SPScript.utils.html":{"id":"SPScript.utils.html","title":"Namespace: utils","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Namespace: utils utils Methods &lt;static&gt; getScript(url) A method to load a javascript file onto your page Parameters: Name Type Description url string Url to the java script file you want to load Returns: - A Promise that resolves when the file is done loading Type Promise Example function doMyStuff() { }; var momentjsUrl = &quot;https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js&quot; SPScript.utils.getScript(momentjsUrl).then(doMyStuff); &lt;static&gt; getScripts(urls) A method to load a javascript file onto your page Parameters: Name Type Description urls Array.&lt;string&gt; An Array of urls to javascript files you want to load on your page Returns: - A Promise that resolves when all the files are done loading Type Promise Example function doMyStuff() { }; var momentjsUrl = &quot;https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js&quot; var jQueryUrl = &quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js&quot; SPScript.utils.getScript([momentjsUrl, jQueryUrl]).then(doMyStuff); &lt;static&gt; parseJSON(data) If you pass in string, it will try to run JSON.parse(). Different browsers handle JSON response differently so it is safest to call this method if you are making a generic GET or POST request Parameters: Name Type Description data string Raw response from JSON request Returns: - JSON parsed object. Returns null if JSON.parse fails Type object Example dao.get('/web/contentTypes') .then(SPScript.utils.parseJSON) .then(function(data) { console.log(data.d.results)}) &lt;static&gt; validateNamespace(namespace) A method to check if a given namespace is on the global object (window). Parameters: Name Type Description namespace string A global namespace Returns: - True or False if the namespace is on the page Type Bool Example var canUseModals = SPScript.utils.validateNamespace(&quot;SP.UI.Dialog&quot;); &lt;static&gt; validateODataV2(data) Helps parse raw json response to remove ceremonious OData data.d namespace. Tries JSON.parse() and then pulling out actual result from data.d or data.d.results Parameters: Name Type Description data string | object Raw response from JSON request Returns: - JSON parsed object with that removes data.d OData structure Type object Example dao.get('/web/contentTypes') .then(SPScript.utils.validateODataV2) .then(function(contentTypes) { console.log(contentTypes)}) &lt;static&gt; waitForLibraries(namespaces) A method to allow you to wait for script dependencies to load. Parameters: Name Type Description namespaces Array An array of global namespaces, things on the global 'window'. For example, when jQuery is on the page, window.jQuery is valid. So 'jQuery' is the namespace. Returns: - A Promise that resolves when all your namespaces are on the page Type Promise Example function doMyStuff() { }; SPScript.utils.waitForLibraries([&quot;jQuery&quot;, &quot;SP.UI.Dialog&quot;]).then(doMyStuff); &lt;static&gt; waitForLibrary(namespace) A method to allow you to wait for a single script dependency to load. Parameters: Name Type Description namespace string A global namespace. For example, when jQuery is on the page, window.jQuery is valid. So 'jQuery' is the namespace. Returns: - A Promise that resolves when all your namespace is on the page Type Promise Example function doMyStuff() { }; SPScript.utils.waitForLibrary(&quot;jQuery&quot;).then(doMyStuff); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "},"Web.html":{"id":"Web.html","title":"Class: Web","body":" Documentation Namespaces SPScript.ajaxSPScript.utils Classes FileFolderRestDaoWeb Global BaseDao Class: Web Web new Web(dao) Represents a SharePoint site Parameters: Name Type Description dao BaseDao Data access object used to make requests. Properties: Name Type Description permissions Permissions allows checking security information of the Web baseUrl string API relative url (value = &quot;/web&quot;) Example You access this Web class using the 'web' property of the dao var dao = new SPScript.RestDao(_spPageContextInfo.webAbsoluteUrl); dao.web.info().then(function(info) { console.log(info) }); Methods copyFile(sourceUrl, destinationUrl, requestDigest) Copies a file Parameters: Name Type Argument Description sourceUrl string The server relative url of the file you want to copy destinationUrl string The server relative url of the destination requestDigest string &lt;optional&gt; The request digest token used to authorize the request. One will be automatically retrieve if not passed. Example var sourceFile = &quot;/sites/mysite/Shared Documents/myfile.docx&quot;; var destination = &quot;/sites/mysite/Restricted Docs/myFile.docx&quot;; dao.web.copyFile(sourceFile, destination).then(function() { console.log(&quot;Success&quot;) }); deleteFile(fileUrl, requestDigest) Deletes a file Parameters: Name Type Argument Description fileUrl string The server relative url of the file you want to delete requestDigest string &lt;optional&gt; The request digest token used to authorize the request. One will be automatically retrieve if not passed. Example dao.web.deleteFile(&quot;/sites/mysite/Shared Documents/myFile.docx&quot;) .then(function() { console.log(&quot;Success&quot;)}); getFile(url) Retrieves a file object Parameters: Name Type Description url string The server relative url of the file Returns: - A Promise that resolves to a file object Type Promise.&lt;File&gt; Example dao.web.getFile(&quot;/sites/mysite/Shared Documents/myfile.docx&quot;) .then(function(file) { console.log(file) }); getFolder(serverRelativeUrl) Retrieves a folder Parameters: Name Type Description serverRelativeUrl string The server relative url of the folder Returns: - A Promise that resolves to a folder object contain a files and folders arrays Type Promise.&lt;Folder&gt; Example dao.web.getFolder(&quot;/sites/mysite/Shared Documents&quot;) .then(function(folder) { console.log(folder) }); getRequestDigest() Retrieves a token needed to authorize any updates Returns: - A Promise that resolves to a the token that needs to added to the &quot;X-RequestDigest&quot; request header Type string Example dao.web.getRequestDigest().then(function(digest) { console.log(digest) }); getUser(email) Retrieves a users object based on an email address Parameters: Name Type Description email string The email address of the user to retrieve Returns: - A Promise that resolves to a an SP.User object Type Promise.&lt;SP.User&gt; Example dao.web.getUser(&quot;andrew@andrewpetersen.onmicrosoft.com&quot;) .then(function(user) { console.log(user)}); info() Retrieves basic information about the site Returns: - A Promise that resolves to an object containing non-deferred properties of SP.Web (https://msdn.microsoft.com/en-us/library/office/jj244873.aspx) Type Promise.&lt;SP.Web&gt; Example dao.web.info().then(function(info) { console.log(info) }); subsites() Retrieves all of the subsites Returns: - A Promise that resolves to an array of subsite object, each loaded with all non-deferred properties Type Promise.&lt;Array.&lt;SP.Web&gt;&gt; Example dao.web.subsites().then(function(sites) { console.log(sites) }); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-04-30T15:30:56-05:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
